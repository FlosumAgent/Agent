function a108_0x4dec(_0xa97e19,_0x21cccf){const _0x4cb4cd=a108_0x3679();return a108_0x4dec=function(_0x444ebc,_0x14e7c8){_0x444ebc=_0x444ebc-0x65;let _0x3679b2=_0x4cb4cd[_0x444ebc];return _0x3679b2;},a108_0x4dec(_0xa97e19,_0x21cccf);}const a108_0x35cc0d=a108_0x4dec;(function(_0x2d7167,_0x280353){const _0x2c6a33=a108_0x4dec,_0x37ece7=_0x2d7167();while(!![]){try{const _0x14567c=-parseInt(_0x2c6a33(0x9c))/0x1+-parseInt(_0x2c6a33(0x91))/0x2*(parseInt(_0x2c6a33(0x70))/0x3)+-parseInt(_0x2c6a33(0x71))/0x4*(-parseInt(_0x2c6a33(0x79))/0x5)+parseInt(_0x2c6a33(0x94))/0x6*(-parseInt(_0x2c6a33(0x66))/0x7)+-parseInt(_0x2c6a33(0x74))/0x8+parseInt(_0x2c6a33(0x7c))/0x9*(parseInt(_0x2c6a33(0x73))/0xa)+-parseInt(_0x2c6a33(0xad))/0xb*(-parseInt(_0x2c6a33(0x7e))/0xc);if(_0x14567c===_0x280353)break;else _0x37ece7['push'](_0x37ece7['shift']());}catch(_0x2ed687){_0x37ece7['push'](_0x37ece7['shift']());}}}(a108_0x3679,0xed264));const a108_0x14e7c8=function(){let _0x5afea1=!![];return function(_0x475c2c,_0x311ce0){const _0x4486ee=_0x5afea1?function(){if(_0x311ce0){const _0x2f8daf=_0x311ce0['apply'](_0x475c2c,arguments);return _0x311ce0=null,_0x2f8daf;}}:function(){};return _0x5afea1=![],_0x4486ee;};}(),a108_0x444ebc=a108_0x14e7c8(this,function(){const _0x371cb7=a108_0x4dec;return a108_0x444ebc[_0x371cb7(0x90)]()[_0x371cb7(0xa7)](_0x371cb7(0xa2))[_0x371cb7(0x90)]()[_0x371cb7(0x98)](a108_0x444ebc)['search'](_0x371cb7(0xa2));});a108_0x444ebc();'use strict';var __decorate=this&&this['__decorate']||function(_0x40475d,_0x471e4f,_0x2af49a,_0xf1046f){const _0x47927b=a108_0x4dec;var _0x2ab34a=arguments[_0x47927b(0x6f)],_0x18a327=_0x2ab34a<0x3?_0x471e4f:_0xf1046f===null?_0xf1046f=Object[_0x47927b(0xa9)](_0x471e4f,_0x2af49a):_0xf1046f,_0x5b7f4e;if(typeof Reflect===_0x47927b(0x8e)&&typeof Reflect[_0x47927b(0x95)]===_0x47927b(0x9a))_0x18a327=Reflect[_0x47927b(0x95)](_0x40475d,_0x471e4f,_0x2af49a,_0xf1046f);else{for(var _0x511f9f=_0x40475d['length']-0x1;_0x511f9f>=0x0;_0x511f9f--)if(_0x5b7f4e=_0x40475d[_0x511f9f])_0x18a327=(_0x2ab34a<0x3?_0x5b7f4e(_0x18a327):_0x2ab34a>0x3?_0x5b7f4e(_0x471e4f,_0x2af49a,_0x18a327):_0x5b7f4e(_0x471e4f,_0x2af49a))||_0x18a327;}return _0x2ab34a>0x3&&_0x18a327&&Object[_0x47927b(0xa6)](_0x471e4f,_0x2af49a,_0x18a327),_0x18a327;},__metadata=this&&this['__metadata']||function(_0x43c89e,_0x3c2dc8){const _0x361eec=a108_0x4dec;if(typeof Reflect===_0x361eec(0x8e)&&typeof Reflect['metadata']===_0x361eec(0x9a))return Reflect['metadata'](_0x43c89e,_0x3c2dc8);},__importDefault=this&&this['__importDefault']||function(_0x18378d){const _0xfb0177=a108_0x4dec;return _0x18378d&&_0x18378d[_0xfb0177(0x9b)]?_0x18378d:{'default':_0x18378d};},SalesforceAuthService_1;Object[a108_0x35cc0d(0xa6)](exports,a108_0x35cc0d(0x9b),{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=require('typedi'),errors_1=require(a108_0x35cc0d(0x6e)),core_1=require(a108_0x35cc0d(0x82)),salesforce_settings_service_1=require(a108_0x35cc0d(0x6a)),axios_1=__importDefault(require('axios')),utils_1=require(a108_0x35cc0d(0x80)),invalid_refresh_token_error_1=require(a108_0x35cc0d(0x7d)),auth_state_enum_1=require(a108_0x35cc0d(0x67)),unauthorized_salesforce_error_1=require(a108_0x35cc0d(0xa1)),constants_1=require(a108_0x35cc0d(0x92));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x5ba5a5){const _0x2f6ac0=a108_0x35cc0d;this[_0x2f6ac0(0x65)]=_0x5ba5a5,this[_0x2f6ac0(0x6d)]=0x1388,this[_0x2f6ac0(0x96)]=auth_state_enum_1[_0x2f6ac0(0x8c)]['Idle'],this[_0x2f6ac0(0xb1)]=new core_1[(_0x2f6ac0(0xaa))](SalesforceAuthService_1[_0x2f6ac0(0x6b)]),this[_0x2f6ac0(0x78)]();}get[a108_0x35cc0d(0x68)](){const _0xdf4de2=a108_0x35cc0d;return this[_0xdf4de2(0x65)][_0xdf4de2(0x68)];}async['setAuthDetails'](){const _0x1875b9=a108_0x35cc0d;this[_0x1875b9(0xb1)][_0x1875b9(0x6c)]('check\x20auth:\x20current\x20state\x20-\x20%s',auth_state_enum_1[_0x1875b9(0x8c)][this[_0x1875b9(0x96)]]);try{if(this['authState']===auth_state_enum_1[_0x1875b9(0x8c)][_0x1875b9(0x8a)])return;if(this['authState']===auth_state_enum_1[_0x1875b9(0x8c)][_0x1875b9(0x9d)])await this[_0x1875b9(0xae)]();else{const _0x3c55f1=await this[_0x1875b9(0x86)](),_0x922797=await axios_1['default'][_0x1875b9(0xa5)](_0x1875b9(0x9e)+constants_1[_0x1875b9(0xb2)],_0x3c55f1)[_0x1875b9(0x77)](()=>!![])['catch'](()=>![]);!_0x922797&&await this['updateAccessToken']();}}catch(_0x53100d){}}async['updateAccessToken'](){const _0x2f5a44=a108_0x35cc0d;var _0x21eae5,_0x59b2b5,_0x22e4e7;this[_0x2f5a44(0xb1)]['log'](_0x2f5a44(0x72));try{this[_0x2f5a44(0x96)]=auth_state_enum_1[_0x2f5a44(0x8c)][_0x2f5a44(0x99)];const {refreshToken:_0x168f28,clientId:_0x76abc7,clientSecret:_0x5cc2d2}=this[_0x2f5a44(0x68)],{data:_0x38a9b9}=await axios_1[_0x2f5a44(0x8b)][_0x2f5a44(0x8d)]((0x0,utils_1[_0x2f5a44(0x81)])(this[_0x2f5a44(0x65)][_0x2f5a44(0xa3)],'/services/oauth2/token'),null,{'params':{'grant_type':_0x2f5a44(0x69),'refresh_token':_0x168f28,'client_id':_0x76abc7,'client_secret':_0x5cc2d2}});this['instanceUrl']=_0x38a9b9[_0x2f5a44(0x93)],this[_0x2f5a44(0xac)]=_0x38a9b9['access_token'],this[_0x2f5a44(0xa8)]=_0x38a9b9[_0x2f5a44(0xab)],this[_0x2f5a44(0x96)]=auth_state_enum_1[_0x2f5a44(0x8c)][_0x2f5a44(0xaf)],this[_0x2f5a44(0xb1)][_0x2f5a44(0x6c)](_0x2f5a44(0x7b),this[_0x2f5a44(0x8f)]);}catch(_0x359699){const _0x2304a2=((_0x59b2b5=(_0x21eae5=_0x359699===null||_0x359699===void 0x0?void 0x0:_0x359699['response'])===null||_0x21eae5===void 0x0?void 0x0:_0x21eae5['data'])===null||_0x59b2b5===void 0x0?void 0x0:_0x59b2b5[_0x2f5a44(0xa0)])||((_0x22e4e7=_0x359699===null||_0x359699===void 0x0?void 0x0:_0x359699[_0x2f5a44(0x7a)])===null||_0x22e4e7===void 0x0?void 0x0:_0x22e4e7[_0x2f5a44(0x84)])||_0x359699['message'];this[_0x2f5a44(0xb1)][_0x2f5a44(0xa0)](_0x2f5a44(0x97),_0x2304a2),this[_0x2f5a44(0x96)]=auth_state_enum_1['AuthState'][_0x2f5a44(0x8a)];throw new invalid_refresh_token_error_1['InvalidRefreshTokenError'](errors_1[_0x2f5a44(0x9f)]);}}async['forceUpdateToken'](){const _0x229f61=a108_0x35cc0d;this[_0x229f61(0xb1)][_0x229f61(0x6c)](_0x229f61(0x89));if(this['authState']===auth_state_enum_1[_0x229f61(0x8c)][_0x229f61(0x99)]||this['authState']===auth_state_enum_1[_0x229f61(0x8c)]['Idle'])return await(0x0,utils_1[_0x229f61(0x85)])(this[_0x229f61(0x6d)]),this[_0x229f61(0x7f)]();if(this['authState']===auth_state_enum_1[_0x229f61(0x8c)][_0x229f61(0x8a)])throw new invalid_refresh_token_error_1[(_0x229f61(0x87))](errors_1[_0x229f61(0x9f)]);await this[_0x229f61(0xae)]();}async['requestConfig'](){const _0x431b6b=a108_0x35cc0d;if(this['authState']===auth_state_enum_1[_0x431b6b(0x8c)][_0x431b6b(0x8a)]){this[_0x431b6b(0xb1)][_0x431b6b(0x6c)](_0x431b6b(0x83));throw new unauthorized_salesforce_error_1[(_0x431b6b(0xb0))]();}if(this[_0x431b6b(0x96)]!==auth_state_enum_1[_0x431b6b(0x8c)][_0x431b6b(0xaf)])return this[_0x431b6b(0xb1)][_0x431b6b(0x6c)](_0x431b6b(0xa4)),await(0x0,utils_1[_0x431b6b(0x85)])(this[_0x431b6b(0x6d)]),this[_0x431b6b(0x86)]();return{'baseURL':this[_0x431b6b(0x8f)],'headers':{'accept':'application/json','content-type':_0x431b6b(0x75),'authorization':this[_0x431b6b(0xa8)]+'\x20'+this[_0x431b6b(0xac)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([(0x0,typedi_1['Service'])(),__metadata(a108_0x35cc0d(0x76),[salesforce_settings_service_1[a108_0x35cc0d(0x88)]])],SalesforceAuthService),exports['SalesforceAuthService']=SalesforceAuthService;function a108_0x3679(){const _0x4e4dcf=['7317HsvFtT','../errors/invalid-refresh-token.error','612URXBPh','forceUpdateToken','../../shared/utils','joinURL','../../../core','create\x20authorized\x20request\x20failed:\x20authorization\x20error','data','sleep','requestConfig','InvalidRefreshTokenError','SalesforceSettingsService','force\x20update\x20token','Error','default','AuthState','post','object','instanceUrl','toString','1318DvbZoc','../../../constants','instance_url','1308072fhXpmi','decorate','authState','update\x20access\x20token\x20failed:\x20%s','constructor','Updating','function','__esModule','924331GKgOvX','Idle','services/data/','ERR_INVALID_SALESFORCE_TOKEN','error','../errors/unauthorized-salesforce.error','(((.+)+)+)+$','loginUrl','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','get','defineProperty','search','tokenType','getOwnPropertyDescriptor','Logger','token_type','accessToken','807488YOzQYr','updateAccessToken','Active','UnauthorizedSalesforceError','logger','SALESFORCE_API_VERSION','salesforseSettings','28avJcis','../enums/auth-state.enum','settings','refresh_token','../../shared/services/salesforce-settings.service','name','log','AUTH_WAIT_TIME','../../../constants/errors','length','8763vwuQht','844AkTapz','update\x20access\x20token','14030guEdpj','13851456ZThZLQ','application/json','design:paramtypes','then','setAuthDetails','36485Qnzmcb','response','access\x20token\x20updated\x20for\x20%s'];a108_0x3679=function(){return _0x4e4dcf;};return a108_0x3679();}