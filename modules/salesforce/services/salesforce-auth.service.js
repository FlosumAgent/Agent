const a106_0x23d0=['../../../core','UnauthorizedSalesforceError','get','create\x20authorized\x20request\x20failed:\x20authorization\x20error','instance_url','apply','loginUrl','2835027flmidp','InvalidRefreshTokenError','response','forceUpdateToken','defineProperty','catch','AUTH_WAIT_TIME','2skrvmj','force\x20update\x20token','data','806247cuWRUL','settings','../../shared/utils','../../shared/services/salesforce-settings.service','access\x20token\x20updated\x20for\x20%s','check\x20auth:\x20current\x20state\x20-\x20%s','../errors/unauthorized-salesforce.error','561388eEuDSr','AuthState','17744sHHUls','logger','axios','__esModule','constructor','object','getOwnPropertyDescriptor','/services/oauth2/token','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','ERR_INVALID_SALESFORCE_TOKEN','1ZKTgTi','log','61zJpFaO','message','length','sleep','update\x20access\x20token','refresh_token','function','authState','design:paramtypes','Updating','accessToken','instanceUrl','../../../constants/errors','Idle','requestConfig','services/data/','__importDefault','typedi','2857CsdCdS','__metadata','updateAccessToken','__decorate','SalesforceAuthService','28dcXjQL','default','application/json','joinURL','name','165001uFHwVQ','decorate','token_type','Service','salesforseSettings','Error','update\x20access\x20token\x20failed:\x20%s','metadata','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','667371xhAOwG','error','../../../constants'];const a106_0x370e70=a106_0x26ef;function a106_0x26ef(_0x4f385a,_0x321e6b){return a106_0x26ef=function(_0x2e60f6,_0x4ec882){_0x2e60f6=_0x2e60f6-0x91;let _0x3f791d=a106_0x23d0[_0x2e60f6];return _0x3f791d;},a106_0x26ef(_0x4f385a,_0x321e6b);}(function(_0x2c6fca,_0x4cc476){const _0x400fdc=a106_0x26ef;while(!![]){try{const _0x26d947=parseInt(_0x400fdc(0xc3))*parseInt(_0x400fdc(0xb7))+parseInt(_0x400fdc(0xda))*-parseInt(_0x400fdc(0xd5))+parseInt(_0x400fdc(0x9a))+parseInt(_0x400fdc(0x91))*-parseInt(_0x400fdc(0xc1))+parseInt(_0x400fdc(0xae))+parseInt(_0x400fdc(0xab))*parseInt(_0x400fdc(0xb5))+-parseInt(_0x400fdc(0xa4));if(_0x26d947===_0x4cc476)break;else _0x2c6fca['push'](_0x2c6fca['shift']());}catch(_0x15ac2b){_0x2c6fca['push'](_0x2c6fca['shift']());}}}(a106_0x23d0,0x922e2));const a106_0x3f791d=function(){let _0x4618af=!![];return function(_0x1166ba,_0x286a5c){const _0x75ce3b=_0x4618af?function(){const _0x26f3c1=a106_0x26ef;if(_0x286a5c){const _0x22226c=_0x286a5c[_0x26f3c1(0xa2)](_0x1166ba,arguments);return _0x286a5c=null,_0x22226c;}}:function(){};return _0x4618af=![],_0x75ce3b;};}(),a106_0x4ec882=a106_0x3f791d(this,function(){const _0x509cba=function(){const _0x151298=a106_0x26ef,_0x2e477f=_0x509cba[_0x151298(0xbb)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x151298(0xbb)](_0x151298(0xbf));return!_0x2e477f['test'](a106_0x4ec882);};return _0x509cba();});a106_0x4ec882();'use strict';var __decorate=this&&this[a106_0x370e70(0xd8)]||function(_0x285550,_0xe7532f,_0x1191c9,_0x3a31bf){const _0x28447e=a106_0x370e70;var _0x26a1c0=arguments[_0x28447e(0xc5)],_0x3b681d=_0x26a1c0<0x3?_0xe7532f:_0x3a31bf===null?_0x3a31bf=Object[_0x28447e(0xbd)](_0xe7532f,_0x1191c9):_0x3a31bf,_0x1af110;if(typeof Reflect===_0x28447e(0xbc)&&typeof Reflect[_0x28447e(0x92)]===_0x28447e(0xc9))_0x3b681d=Reflect['decorate'](_0x285550,_0xe7532f,_0x1191c9,_0x3a31bf);else{for(var _0x18fdf4=_0x285550[_0x28447e(0xc5)]-0x1;_0x18fdf4>=0x0;_0x18fdf4--)if(_0x1af110=_0x285550[_0x18fdf4])_0x3b681d=(_0x26a1c0<0x3?_0x1af110(_0x3b681d):_0x26a1c0>0x3?_0x1af110(_0xe7532f,_0x1191c9,_0x3b681d):_0x1af110(_0xe7532f,_0x1191c9))||_0x3b681d;}return _0x26a1c0>0x3&&_0x3b681d&&Object['defineProperty'](_0xe7532f,_0x1191c9,_0x3b681d),_0x3b681d;},__metadata=this&&this[a106_0x370e70(0xd6)]||function(_0x23e643,_0x5765f1){const _0x2a433b=a106_0x370e70;if(typeof Reflect===_0x2a433b(0xbc)&&typeof Reflect[_0x2a433b(0x98)]===_0x2a433b(0xc9))return Reflect[_0x2a433b(0x98)](_0x23e643,_0x5765f1);},__importDefault=this&&this[a106_0x370e70(0xd3)]||function(_0xb63d79){const _0x379914=a106_0x370e70;return _0xb63d79&&_0xb63d79[_0x379914(0xba)]?_0xb63d79:{'default':_0xb63d79};},SalesforceAuthService_1;Object[a106_0x370e70(0xa8)](exports,a106_0x370e70(0xba),{'value':!![]}),exports['SalesforceAuthService']=void 0x0;const typedi_1=require(a106_0x370e70(0xd4)),errors_1=require(a106_0x370e70(0xcf)),core_1=require(a106_0x370e70(0x9d)),salesforce_settings_service_1=require(a106_0x370e70(0xb1)),axios_1=__importDefault(require(a106_0x370e70(0xb9))),utils_1=require(a106_0x370e70(0xb0)),invalid_refresh_token_error_1=require('../errors/invalid-refresh-token.error'),auth_state_enum_1=require('../enums/auth-state.enum'),unauthorized_salesforce_error_1=require(a106_0x370e70(0xb4)),constants_1=require(a106_0x370e70(0x9c));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x18c9d4){const _0x127f7c=a106_0x370e70;this[_0x127f7c(0x95)]=_0x18c9d4,this[_0x127f7c(0xaa)]=0x1388,this[_0x127f7c(0xca)]=auth_state_enum_1[_0x127f7c(0xb6)][_0x127f7c(0xd0)],this[_0x127f7c(0xb8)]=new core_1['Logger'](SalesforceAuthService_1[_0x127f7c(0xde)]),this['setAuthDetails']();}get[a106_0x370e70(0xaf)](){const _0x34ef68=a106_0x370e70;return this[_0x34ef68(0x95)]['settings'];}async['setAuthDetails'](){const _0x254883=a106_0x370e70;this[_0x254883(0xb8)][_0x254883(0xc2)](_0x254883(0xb3),auth_state_enum_1[_0x254883(0xb6)][this['authState']]);try{if(this[_0x254883(0xca)]===auth_state_enum_1[_0x254883(0xb6)]['Error'])return;if(this[_0x254883(0xca)]===auth_state_enum_1['AuthState'][_0x254883(0xd0)])await this[_0x254883(0xd7)]();else{const _0x217fe9=await this[_0x254883(0xd1)](),_0x5effdf=await axios_1[_0x254883(0xdb)][_0x254883(0x9f)](_0x254883(0xd2)+constants_1['SALESFORCE_API_VERSION'],_0x217fe9)['then'](()=>!![])[_0x254883(0xa9)](()=>![]);!_0x5effdf&&await this[_0x254883(0xd7)]();}}catch(_0x4d6aa2){}}async[a106_0x370e70(0xd7)](){const _0xbf7e4c=a106_0x370e70;var _0x45aa95,_0x525b9,_0x4c39f3;this[_0xbf7e4c(0xb8)][_0xbf7e4c(0xc2)](_0xbf7e4c(0xc7));try{this[_0xbf7e4c(0xca)]=auth_state_enum_1[_0xbf7e4c(0xb6)][_0xbf7e4c(0xcc)];const {refreshToken:_0x752df6,clientId:_0x4d8b6e,clientSecret:_0x19e6f6}=this[_0xbf7e4c(0xaf)],{data:_0x4f9531}=await axios_1[_0xbf7e4c(0xdb)]['post'](utils_1[_0xbf7e4c(0xdd)](this[_0xbf7e4c(0x95)][_0xbf7e4c(0xa3)],_0xbf7e4c(0xbe)),null,{'params':{'grant_type':_0xbf7e4c(0xc8),'refresh_token':_0x752df6,'client_id':_0x4d8b6e,'client_secret':_0x19e6f6}});this[_0xbf7e4c(0xce)]=_0x4f9531[_0xbf7e4c(0xa1)],this[_0xbf7e4c(0xcd)]=_0x4f9531['access_token'],this['tokenType']=_0x4f9531[_0xbf7e4c(0x93)],this[_0xbf7e4c(0xca)]=auth_state_enum_1[_0xbf7e4c(0xb6)]['Active'],this[_0xbf7e4c(0xb8)][_0xbf7e4c(0xc2)](_0xbf7e4c(0xb2),this[_0xbf7e4c(0xce)]);}catch(_0xedfd01){const _0x4581c8=((_0x525b9=(_0x45aa95=_0xedfd01===null||_0xedfd01===void 0x0?void 0x0:_0xedfd01[_0xbf7e4c(0xa6)])===null||_0x45aa95===void 0x0?void 0x0:_0x45aa95[_0xbf7e4c(0xad)])===null||_0x525b9===void 0x0?void 0x0:_0x525b9['error'])||((_0x4c39f3=_0xedfd01===null||_0xedfd01===void 0x0?void 0x0:_0xedfd01[_0xbf7e4c(0xa6)])===null||_0x4c39f3===void 0x0?void 0x0:_0x4c39f3[_0xbf7e4c(0xad)])||_0xedfd01[_0xbf7e4c(0xc4)];this[_0xbf7e4c(0xb8)][_0xbf7e4c(0x9b)](_0xbf7e4c(0x97),_0x4581c8),this[_0xbf7e4c(0xca)]=auth_state_enum_1[_0xbf7e4c(0xb6)][_0xbf7e4c(0x96)];throw new invalid_refresh_token_error_1[(_0xbf7e4c(0xa5))](errors_1[_0xbf7e4c(0xc0)]);}}async[a106_0x370e70(0xa7)](){const _0x305db5=a106_0x370e70;this[_0x305db5(0xb8)][_0x305db5(0xc2)](_0x305db5(0xac));if(this[_0x305db5(0xca)]===auth_state_enum_1[_0x305db5(0xb6)][_0x305db5(0xcc)]||this[_0x305db5(0xca)]===auth_state_enum_1[_0x305db5(0xb6)]['Idle'])return await utils_1[_0x305db5(0xc6)](this[_0x305db5(0xaa)]),this[_0x305db5(0xa7)]();if(this[_0x305db5(0xca)]===auth_state_enum_1[_0x305db5(0xb6)][_0x305db5(0x96)])throw new invalid_refresh_token_error_1[(_0x305db5(0xa5))](errors_1[_0x305db5(0xc0)]);await this[_0x305db5(0xd7)]();}async['requestConfig'](){const _0x27f7ee=a106_0x370e70;if(this['authState']===auth_state_enum_1[_0x27f7ee(0xb6)][_0x27f7ee(0x96)]){this[_0x27f7ee(0xb8)]['log'](_0x27f7ee(0xa0));throw new unauthorized_salesforce_error_1[(_0x27f7ee(0x9e))]();}if(this['authState']!==auth_state_enum_1[_0x27f7ee(0xb6)]['Active'])return this[_0x27f7ee(0xb8)]['log'](_0x27f7ee(0x99)),await utils_1[_0x27f7ee(0xc6)](this[_0x27f7ee(0xaa)]),this[_0x27f7ee(0xd1)]();return{'baseURL':this['instanceUrl'],'headers':{'accept':_0x27f7ee(0xdc),'content-type':_0x27f7ee(0xdc),'authorization':this['tokenType']+'\x20'+this[_0x27f7ee(0xcd)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1[a106_0x370e70(0x94)](),__metadata(a106_0x370e70(0xcb),[salesforce_settings_service_1['SalesforceSettingsService']])],SalesforceAuthService),exports[a106_0x370e70(0xd9)]=SalesforceAuthService;