const a105_0x3703=['error','AUTH_WAIT_TIME','services/data/','decorate','/services/oauth2/token','then','length','Active','1ctICmU','test','name','constructor','update\x20access\x20token\x20failed:\x20%s','get','ERR_INVALID_SALESFORCE_TOKEN','2876ZblDsk','InvalidRefreshTokenError','__metadata','AuthState','function','post','752047osMGHs','88077hTQxjg','settings','2edESIe','object','refresh_token','instance_url','../enums/auth-state.enum','../errors/unauthorized-salesforce.error','update\x20access\x20token','salesforseSettings','../../shared/services/salesforce-settings.service','forceUpdateToken','Idle','SALESFORCE_API_VERSION','log','loginUrl','authState','check\x20auth:\x20current\x20state\x20-\x20%s','data','__decorate','Error','logger','accessToken','__esModule','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../../shared/utils','updateAccessToken','UnauthorizedSalesforceError','Updating','defineProperty','apply','../../../constants/errors','application/json','default','return\x20/\x22\x20+\x20this\x20+\x20\x22/','instanceUrl','tokenType','628276XuueFZ','getOwnPropertyDescriptor','177453cBAaly','create\x20authorized\x20request\x20failed:\x20authorization\x20error','create\x20authorized\x20request\x20failed:\x20authorization\x20is\x20not\x20done','../errors/invalid-refresh-token.error','metadata','3MVHuBN','__importDefault','design:paramtypes','token_type','typedi','45642xvMEEn','../../../constants','SalesforceAuthService','setAuthDetails','requestConfig','force\x20update\x20token','53hwahpB','axios','10239UkOYIq','sleep','catch'];const a105_0x2dc815=a105_0x7550;(function(_0x57467f,_0x37aece){const _0x126b7b=a105_0x7550;while(!![]){try{const _0x4a08b9=parseInt(_0x126b7b(0x14a))+parseInt(_0x126b7b(0x156))+parseInt(_0x126b7b(0x127))*-parseInt(_0x126b7b(0x14c))+parseInt(_0x126b7b(0x15c))*parseInt(_0x126b7b(0x15e))+parseInt(_0x126b7b(0x176))*-parseInt(_0x126b7b(0x169))+parseInt(_0x126b7b(0x151))*parseInt(_0x126b7b(0x177))+parseInt(_0x126b7b(0x170));if(_0x4a08b9===_0x37aece)break;else _0x57467f['push'](_0x57467f['shift']());}catch(_0x1d056b){_0x57467f['push'](_0x57467f['shift']());}}}(a105_0x3703,0x5bfa3));const a105_0x1c0328=function(){let _0x1a8bbb=!![];return function(_0x1cf85e,_0x4d7d31){const _0x5d24a5=_0x1a8bbb?function(){const _0x1c9f33=a105_0x7550;if(_0x4d7d31){const _0x21b7e8=_0x4d7d31[_0x1c9f33(0x143)](_0x1cf85e,arguments);return _0x4d7d31=null,_0x21b7e8;}}:function(){};return _0x1a8bbb=![],_0x5d24a5;};}(),a105_0x5b7f47=a105_0x1c0328(this,function(){const _0x567df8=function(){const _0x5a0847=a105_0x7550,_0x71039b=_0x567df8[_0x5a0847(0x16c)](_0x5a0847(0x147))()[_0x5a0847(0x16c)](_0x5a0847(0x13d));return!_0x71039b[_0x5a0847(0x16a)](a105_0x5b7f47);};return _0x567df8();});a105_0x5b7f47();'use strict';function a105_0x7550(_0x1100eb,_0x219fb9){return a105_0x7550=function(_0x335c49,_0x5b7f47){_0x335c49=_0x335c49-0x126;let _0x1c0328=a105_0x3703[_0x335c49];return _0x1c0328;},a105_0x7550(_0x1100eb,_0x219fb9);}var __decorate=this&&this[a105_0x2dc815(0x138)]||function(_0x244d0b,_0x4daa63,_0x3ab93f,_0x714816){const _0x222de3=a105_0x2dc815;var _0x5ee7cb=arguments['length'],_0x37e36d=_0x5ee7cb<0x3?_0x4daa63:_0x714816===null?_0x714816=Object[_0x222de3(0x14b)](_0x4daa63,_0x3ab93f):_0x714816,_0x2a0b39;if(typeof Reflect===_0x222de3(0x128)&&typeof Reflect[_0x222de3(0x164)]===_0x222de3(0x174))_0x37e36d=Reflect[_0x222de3(0x164)](_0x244d0b,_0x4daa63,_0x3ab93f,_0x714816);else{for(var _0x953c47=_0x244d0b[_0x222de3(0x167)]-0x1;_0x953c47>=0x0;_0x953c47--)if(_0x2a0b39=_0x244d0b[_0x953c47])_0x37e36d=(_0x5ee7cb<0x3?_0x2a0b39(_0x37e36d):_0x5ee7cb>0x3?_0x2a0b39(_0x4daa63,_0x3ab93f,_0x37e36d):_0x2a0b39(_0x4daa63,_0x3ab93f))||_0x37e36d;}return _0x5ee7cb>0x3&&_0x37e36d&&Object[_0x222de3(0x142)](_0x4daa63,_0x3ab93f,_0x37e36d),_0x37e36d;},__metadata=this&&this[a105_0x2dc815(0x172)]||function(_0x453a1c,_0x438bf7){const _0x13ee20=a105_0x2dc815;if(typeof Reflect===_0x13ee20(0x128)&&typeof Reflect[_0x13ee20(0x150)]===_0x13ee20(0x174))return Reflect['metadata'](_0x453a1c,_0x438bf7);},__importDefault=this&&this[a105_0x2dc815(0x152)]||function(_0x4ad46d){const _0x20e67c=a105_0x2dc815;return _0x4ad46d&&_0x4ad46d[_0x20e67c(0x13c)]?_0x4ad46d:{'default':_0x4ad46d};},SalesforceAuthService_1;Object[a105_0x2dc815(0x142)](exports,'__esModule',{'value':!![]}),exports[a105_0x2dc815(0x158)]=void 0x0;const typedi_1=require(a105_0x2dc815(0x155)),errors_1=require(a105_0x2dc815(0x144)),core_1=require('../../../core'),salesforce_settings_service_1=require(a105_0x2dc815(0x12f)),axios_1=__importDefault(require(a105_0x2dc815(0x15d))),utils_1=require(a105_0x2dc815(0x13e)),invalid_refresh_token_error_1=require(a105_0x2dc815(0x14f)),auth_state_enum_1=require(a105_0x2dc815(0x12b)),unauthorized_salesforce_error_1=require(a105_0x2dc815(0x12c)),constants_1=require(a105_0x2dc815(0x157));let SalesforceAuthService=SalesforceAuthService_1=class SalesforceAuthService{constructor(_0x2ac763){const _0x3a5029=a105_0x2dc815;this[_0x3a5029(0x12e)]=_0x2ac763,this[_0x3a5029(0x162)]=0x1388,this['authState']=auth_state_enum_1[_0x3a5029(0x173)][_0x3a5029(0x131)],this[_0x3a5029(0x13a)]=new core_1['Logger'](SalesforceAuthService_1[_0x3a5029(0x16b)]),this[_0x3a5029(0x159)]();}get[a105_0x2dc815(0x126)](){const _0x59a30c=a105_0x2dc815;return this[_0x59a30c(0x12e)][_0x59a30c(0x126)];}async[a105_0x2dc815(0x159)](){const _0x4d6dab=a105_0x2dc815;this['logger'][_0x4d6dab(0x133)](_0x4d6dab(0x136),auth_state_enum_1[_0x4d6dab(0x173)][this[_0x4d6dab(0x135)]]);try{if(this[_0x4d6dab(0x135)]===auth_state_enum_1[_0x4d6dab(0x173)][_0x4d6dab(0x139)])return;if(this['authState']===auth_state_enum_1['AuthState'][_0x4d6dab(0x131)])await this[_0x4d6dab(0x13f)]();else{const _0x32c85=await this['requestConfig'](),_0x538dc3=await axios_1[_0x4d6dab(0x146)][_0x4d6dab(0x16e)](_0x4d6dab(0x163)+constants_1[_0x4d6dab(0x132)],_0x32c85)[_0x4d6dab(0x166)](()=>!![])[_0x4d6dab(0x160)](()=>![]);!_0x538dc3&&await this[_0x4d6dab(0x13f)]();}}catch(_0x106cf0){}}async[a105_0x2dc815(0x13f)](){const _0x4bc343=a105_0x2dc815;var _0x41601d,_0x1f098f,_0x39db76;this['logger'][_0x4bc343(0x133)](_0x4bc343(0x12d));try{this[_0x4bc343(0x135)]=auth_state_enum_1[_0x4bc343(0x173)][_0x4bc343(0x141)];const {refreshToken:_0x1a7322,clientId:_0x1d2b58,clientSecret:_0x4849b7}=this['settings'],{data:_0x19ef6e}=await axios_1['default'][_0x4bc343(0x175)](utils_1['joinURL'](this[_0x4bc343(0x12e)][_0x4bc343(0x134)],_0x4bc343(0x165)),null,{'params':{'grant_type':_0x4bc343(0x129),'refresh_token':_0x1a7322,'client_id':_0x1d2b58,'client_secret':_0x4849b7}});this['instanceUrl']=_0x19ef6e[_0x4bc343(0x12a)],this['accessToken']=_0x19ef6e['access_token'],this[_0x4bc343(0x149)]=_0x19ef6e[_0x4bc343(0x154)],this[_0x4bc343(0x135)]=auth_state_enum_1[_0x4bc343(0x173)][_0x4bc343(0x168)],this['logger'][_0x4bc343(0x133)]('access\x20token\x20updated\x20for\x20%s',this[_0x4bc343(0x148)]);}catch(_0x42023c){const _0x526b4f=((_0x1f098f=(_0x41601d=_0x42023c===null||_0x42023c===void 0x0?void 0x0:_0x42023c['response'])===null||_0x41601d===void 0x0?void 0x0:_0x41601d[_0x4bc343(0x137)])===null||_0x1f098f===void 0x0?void 0x0:_0x1f098f[_0x4bc343(0x161)])||((_0x39db76=_0x42023c===null||_0x42023c===void 0x0?void 0x0:_0x42023c['response'])===null||_0x39db76===void 0x0?void 0x0:_0x39db76['data'])||_0x42023c['message'];this[_0x4bc343(0x13a)][_0x4bc343(0x161)](_0x4bc343(0x16d),_0x526b4f),this['authState']=auth_state_enum_1[_0x4bc343(0x173)][_0x4bc343(0x139)];throw new invalid_refresh_token_error_1[(_0x4bc343(0x171))](errors_1[_0x4bc343(0x16f)]);}}async[a105_0x2dc815(0x130)](){const _0x22dec7=a105_0x2dc815;this[_0x22dec7(0x13a)][_0x22dec7(0x133)](_0x22dec7(0x15b));if(this[_0x22dec7(0x135)]===auth_state_enum_1[_0x22dec7(0x173)][_0x22dec7(0x141)]||this[_0x22dec7(0x135)]===auth_state_enum_1[_0x22dec7(0x173)][_0x22dec7(0x131)])return await utils_1[_0x22dec7(0x15f)](this['AUTH_WAIT_TIME']),this[_0x22dec7(0x130)]();if(this[_0x22dec7(0x135)]===auth_state_enum_1[_0x22dec7(0x173)][_0x22dec7(0x139)])throw new invalid_refresh_token_error_1[(_0x22dec7(0x171))](errors_1['ERR_INVALID_SALESFORCE_TOKEN']);await this['updateAccessToken']();}async['requestConfig'](){const _0x4007aa=a105_0x2dc815;if(this[_0x4007aa(0x135)]===auth_state_enum_1[_0x4007aa(0x173)]['Error']){this['logger'][_0x4007aa(0x133)](_0x4007aa(0x14d));throw new unauthorized_salesforce_error_1[(_0x4007aa(0x140))]();}if(this['authState']!==auth_state_enum_1[_0x4007aa(0x173)][_0x4007aa(0x168)])return this[_0x4007aa(0x13a)][_0x4007aa(0x133)](_0x4007aa(0x14e)),await utils_1[_0x4007aa(0x15f)](this[_0x4007aa(0x162)]),this[_0x4007aa(0x15a)]();return{'baseURL':this[_0x4007aa(0x148)],'headers':{'accept':_0x4007aa(0x145),'content-type':_0x4007aa(0x145),'authorization':this['tokenType']+'\x20'+this[_0x4007aa(0x13b)]}};}};SalesforceAuthService=SalesforceAuthService_1=__decorate([typedi_1['Service'](),__metadata(a105_0x2dc815(0x153),[salesforce_settings_service_1['SalesforceSettingsService']])],SalesforceAuthService),exports[a105_0x2dc815(0x158)]=SalesforceAuthService;