const a129_0x2c3155=a129_0x3110;(function(_0x52a447,_0x25d800){const _0x16814d=a129_0x3110,_0x1e7f99=_0x52a447();while(!![]){try{const _0xf144e0=-parseInt(_0x16814d(0x19c))/0x1*(parseInt(_0x16814d(0x17d))/0x2)+-parseInt(_0x16814d(0x1c1))/0x3+parseInt(_0x16814d(0x1bf))/0x4+parseInt(_0x16814d(0x1af))/0x5+parseInt(_0x16814d(0x183))/0x6+parseInt(_0x16814d(0x198))/0x7+-parseInt(_0x16814d(0x188))/0x8;if(_0xf144e0===_0x25d800)break;else _0x1e7f99['push'](_0x1e7f99['shift']());}catch(_0x46f691){_0x1e7f99['push'](_0x1e7f99['shift']());}}}(a129_0x4a0a,0x3c186));const a129_0x2225fd=function(){let _0x508254=!![];return function(_0x236999,_0xf7fac9){const _0x306a0e=_0x508254?function(){const _0x4184ca=a129_0x3110;if(_0xf7fac9){const _0x56d2df=_0xf7fac9[_0x4184ca(0x1b5)](_0x236999,arguments);return _0xf7fac9=null,_0x56d2df;}}:function(){};return _0x508254=![],_0x306a0e;};}(),a129_0x199140=a129_0x2225fd(this,function(){const _0x467be1=a129_0x3110;return a129_0x199140[_0x467be1(0x1ac)]()[_0x467be1(0x181)](_0x467be1(0x18d))['toString']()['constructor'](a129_0x199140)[_0x467be1(0x181)]('(((.+)+)+)+$');});a129_0x199140();'use strict';var __decorate=this&&this[a129_0x2c3155(0x1be)]||function(_0x23828e,_0x33c193,_0x48cfe7,_0x8945ad){const _0x1e7f77=a129_0x2c3155;var _0x2ea11a=arguments['length'],_0x3e7522=_0x2ea11a<0x3?_0x33c193:_0x8945ad===null?_0x8945ad=Object[_0x1e7f77(0x1c2)](_0x33c193,_0x48cfe7):_0x8945ad,_0x415d5d;if(typeof Reflect===_0x1e7f77(0x1b3)&&typeof Reflect[_0x1e7f77(0x19e)]===_0x1e7f77(0x1a0))_0x3e7522=Reflect[_0x1e7f77(0x19e)](_0x23828e,_0x33c193,_0x48cfe7,_0x8945ad);else{for(var _0x3ce21c=_0x23828e[_0x1e7f77(0x1b8)]-0x1;_0x3ce21c>=0x0;_0x3ce21c--)if(_0x415d5d=_0x23828e[_0x3ce21c])_0x3e7522=(_0x2ea11a<0x3?_0x415d5d(_0x3e7522):_0x2ea11a>0x3?_0x415d5d(_0x33c193,_0x48cfe7,_0x3e7522):_0x415d5d(_0x33c193,_0x48cfe7))||_0x3e7522;}return _0x2ea11a>0x3&&_0x3e7522&&Object[_0x1e7f77(0x1ae)](_0x33c193,_0x48cfe7,_0x3e7522),_0x3e7522;},__metadata=this&&this[a129_0x2c3155(0x1a8)]||function(_0x4de0dc,_0x4adc87){const _0xc578c=a129_0x2c3155;if(typeof Reflect==='object'&&typeof Reflect[_0xc578c(0x1a6)]===_0xc578c(0x1a0))return Reflect[_0xc578c(0x1a6)](_0x4de0dc,_0x4adc87);};function a129_0x3110(_0xc3f0ac,_0x927f85){const _0x5053e5=a129_0x4a0a();return a129_0x3110=function(_0x199140,_0x2225fd){_0x199140=_0x199140-0x177;let _0x4a0ab4=_0x5053e5[_0x199140];return _0x4a0ab4;},a129_0x3110(_0xc3f0ac,_0x927f85);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a129_0x2c3155(0x197)]=void 0x0;function a129_0x4a0a(){const _0x1a20f1=['55832zUEdax','./salesforce-rest.service','decorate','\x22\x20not\x20found\x20in\x20flosum.','function','restService','splice','post','Branch\x20\x22','fetchBranchComponentsByFilenames','metadata','Repository__c','__metadata','push','fetchBranchComponents','Name','toString','Repository\x20\x22','defineProperty','2153360UMBIFc','NotFoundError','%branchId%','MAX_QUERY_ARRAY_ITEMS','object','substr','apply','GET_BRANCH_BY_NAME_QUERY','Completed','length','design:paramtypes','Is_From_Agent__c','%name%','GET_BRANCH_COMPONENTS_QUERY','extractFieldsFromRecord','__decorate','362528jefYDp','Component_Name__c','807279gBtqbE','getOwnPropertyDescriptor','getBranchIdByName','CRC32__c','%fileNames%','fetchRepositoryComponents','join','GET_REPOSITORY_BY_NAME_QUERY','12jROIHP','SalesforceQueryService','getComponentRecordTypes','Version__c','search','GET_REPOSITORY_COMPONENTS_BY_FILENAMES_QUERY','852126GPwxJG','%componentIds%','../../../constants','FLOSUM_GIT_NAMESPACE','map','634792auswYT','./salesforce-query.service','query','replace','GET_REPOSITORY_COMPONENTS_QUERY','(((.+)+)+)+$','extractComponentMetadataFromRecord','../queries','SalesforceRestService','../utils/flosum-naming.utils','GET_COMMIT_MANIFESTS_BY_COMPONENT_IDS','Component_Type__c','fetchCommitManifestsByComponentIds','queryService','GET_BRANCH_COMPONENTS_BY_FILENAMES_QUERY','SalesforceGitSyncService','1863813BZBNwy','FLOSUM_NAMESPACE','File_Name__c','FLOSUM_COMMIT'];a129_0x4a0a=function(){return _0x1a20f1;};return a129_0x4a0a();}const not_found_error_1=require('../../../core/errors/not-found.error'),typedi_1=require('typedi'),constants_1=require(a129_0x2c3155(0x185)),queries_1=require(a129_0x2c3155(0x18f)),flosum_naming_utils_1=require(a129_0x2c3155(0x191)),salesforce_query_service_1=require(a129_0x2c3155(0x189)),salesforce_rest_service_1=require(a129_0x2c3155(0x19d));let SalesforceGitSyncService=class SalesforceGitSyncService{constructor(_0x2479e8,_0x1073f2){const _0x481403=a129_0x2c3155;this['queryService']=_0x2479e8,this[_0x481403(0x1a1)]=_0x1073f2,this[_0x481403(0x1b2)]=0xc8;}[a129_0x2c3155(0x18e)](_0x18df24){const _0x197f93=a129_0x2c3155,_0x5a3886=flosum_naming_utils_1[_0x197f93(0x1bd)](_0x18df24,[_0x197f93(0x1c0),'Component_Type__c',_0x197f93(0x178),_0x197f93(0x19a),'Version__c','Id']);return{'id':_0x5a3886['Id'],'name':_0x5a3886[_0x197f93(0x1c0)],'type':_0x5a3886[_0x197f93(0x193)],'fileName':_0x5a3886[_0x197f93(0x19a)],'crc32':_0x5a3886['CRC32__c'],'version':+_0x5a3886[_0x197f93(0x180)]};}async['getRepositoryIdByName'](_0x40a891){const _0x549d0b=a129_0x2c3155,[_0xf369ac]=await this[_0x549d0b(0x195)][_0x549d0b(0x18a)](queries_1[_0x549d0b(0x17c)][_0x549d0b(0x18b)](_0x549d0b(0x1bb),_0x40a891));if(!_0xf369ac)throw new not_found_error_1[(_0x549d0b(0x1b0))](_0x549d0b(0x1ad)+_0x40a891+_0x549d0b(0x19f));return _0xf369ac['Id'];}async[a129_0x2c3155(0x177)](_0x1951cf){const _0x23983e=a129_0x2c3155,[_0x53f7ca]=await this['queryService'][_0x23983e(0x18a)](queries_1[_0x23983e(0x1b6)][_0x23983e(0x18b)]('%name%',_0x1951cf));if(!_0x53f7ca)throw new not_found_error_1[(_0x23983e(0x1b0))](_0x23983e(0x1a4)+_0x1951cf+_0x23983e(0x19f));return _0x53f7ca['Id'];}async[a129_0x2c3155(0x17f)](){const _0x3512dc=a129_0x2c3155,_0x17180d=await this['queryService'][_0x3512dc(0x18a)](queries_1['GET_COMPONENT_RECORD_TYPES_QUERY']);return _0x17180d['map'](_0x7ad65a=>flosum_naming_utils_1[_0x3512dc(0x1bd)](_0x7ad65a,['Id','Name']))[_0x3512dc(0x187)](_0x1f16c3=>({'id':_0x1f16c3['Id'],'name':_0x1f16c3[_0x3512dc(0x1ab)]}));}async['fetchRepositoryComponentsByFilenames'](_0x1fe965,_0x32361b){const _0x1400ae=a129_0x2c3155,_0x13f265=[];while(_0x1fe965['length']){const _0x16be6c=queries_1[_0x1400ae(0x182)]['replace'](_0x1400ae(0x179),_0x1fe965[_0x1400ae(0x1a2)](0x0,this[_0x1400ae(0x1b2)])[_0x1400ae(0x187)](_0xc1fb5a=>'\x27'+_0xc1fb5a+'\x27')[_0x1400ae(0x17b)](','))[_0x1400ae(0x18b)]('%repositoryId%',_0x32361b),_0xa4968e=await this[_0x1400ae(0x195)][_0x1400ae(0x18a)](_0x16be6c);_0x13f265[_0x1400ae(0x1a9)](..._0xa4968e);}return _0x13f265[_0x1400ae(0x187)](_0x9b55c8=>this['extractComponentMetadataFromRecord'](_0x9b55c8));}async[a129_0x2c3155(0x1a5)](_0x10b2fb,_0x4cc532){const _0x5e1fc6=a129_0x2c3155,_0x982320=[];while(_0x10b2fb['length']){const _0x50ad12=queries_1[_0x5e1fc6(0x196)][_0x5e1fc6(0x18b)]('%fileNames%',_0x10b2fb[_0x5e1fc6(0x1a2)](0x0,this[_0x5e1fc6(0x1b2)])[_0x5e1fc6(0x187)](_0x2d3fae=>'\x27'+_0x2d3fae+'\x27')[_0x5e1fc6(0x17b)](','))['replace'](_0x5e1fc6(0x1b1),_0x4cc532),_0x464cb2=await this['queryService'][_0x5e1fc6(0x18a)](_0x50ad12);_0x982320[_0x5e1fc6(0x1a9)](..._0x464cb2);}return _0x982320[_0x5e1fc6(0x187)](_0x5817bf=>this[_0x5e1fc6(0x18e)](_0x5817bf));}async[a129_0x2c3155(0x17a)](_0x55e340){const _0x32bfbc=a129_0x2c3155,_0x1c794e=[],_0x411272=queries_1[_0x32bfbc(0x18c)][_0x32bfbc(0x18b)]('%repositoryId%',_0x55e340),_0x2b3653=await this[_0x32bfbc(0x195)][_0x32bfbc(0x18a)](_0x411272);return _0x1c794e['push'](..._0x2b3653),_0x1c794e[_0x32bfbc(0x187)](_0x5cc6cd=>this[_0x32bfbc(0x18e)](_0x5cc6cd));}async[a129_0x2c3155(0x1aa)](_0x1e98a0){const _0x4a8cfe=a129_0x2c3155,_0xc04dab=[],_0x226cab=queries_1[_0x4a8cfe(0x1bc)]['replace']('%branchId%',_0x1e98a0),_0x578624=await this['queryService'][_0x4a8cfe(0x18a)](_0x226cab);return _0xc04dab['push'](..._0x578624),_0xc04dab[_0x4a8cfe(0x187)](_0x47b3c0=>this[_0x4a8cfe(0x18e)](_0x47b3c0));}async[a129_0x2c3155(0x194)](_0x4c4b0b){const _0x2c292a=a129_0x2c3155,_0x7c41d3=[..._0x4c4b0b],_0x1422ae=[];while(_0x7c41d3[_0x2c292a(0x1b8)]){const _0x18e224=queries_1[_0x2c292a(0x192)][_0x2c292a(0x18b)](_0x2c292a(0x184),_0x7c41d3['splice'](0x0,this[_0x2c292a(0x1b2)])[_0x2c292a(0x187)](_0xb92783=>'\x27'+_0xb92783+'\x27')['join'](',')),_0x2ffb13=await this[_0x2c292a(0x195)]['query'](_0x18e224);_0x1422ae[_0x2c292a(0x1a9)](..._0x2ffb13[_0x2c292a(0x187)](_0x52f18a=>_0x52f18a['Id']));}return _0x1422ae;}async['createCommit'](_0x5655f6,_0x42f889){const _0x242eee=a129_0x2c3155;return this[_0x242eee(0x1a1)][_0x242eee(0x1a3)](constants_1[_0x242eee(0x19b)],{[constants_1[_0x242eee(0x199)]+_0x242eee(0x1a7)]:_0x42f889,[constants_1[_0x242eee(0x199)]+'Commit_Name__c']:_0x5655f6[_0x242eee(0x1b4)](0x0,0xff),[constants_1[_0x242eee(0x199)]+'Status__c']:_0x242eee(0x1b7),[constants_1[_0x242eee(0x186)]+_0x242eee(0x1ba)]:!![]});}};SalesforceGitSyncService=__decorate([typedi_1['Service'](),__metadata(a129_0x2c3155(0x1b9),[salesforce_query_service_1[a129_0x2c3155(0x17e)],salesforce_rest_service_1[a129_0x2c3155(0x190)]])],SalesforceGitSyncService),exports['SalesforceGitSyncService']=SalesforceGitSyncService;