const a129_0x28592d=a129_0x27ec;(function(_0x2081d1,_0x4268eb){const _0x67dbd8=a129_0x27ec,_0x213cce=_0x2081d1();while(!![]){try{const _0x3124e8=parseInt(_0x67dbd8(0xc5))/0x1*(parseInt(_0x67dbd8(0xfd))/0x2)+-parseInt(_0x67dbd8(0xfe))/0x3+parseInt(_0x67dbd8(0xf2))/0x4+-parseInt(_0x67dbd8(0xd9))/0x5+parseInt(_0x67dbd8(0x103))/0x6*(-parseInt(_0x67dbd8(0xcf))/0x7)+parseInt(_0x67dbd8(0xde))/0x8*(-parseInt(_0x67dbd8(0xe4))/0x9)+parseInt(_0x67dbd8(0xf6))/0xa;if(_0x3124e8===_0x4268eb)break;else _0x213cce['push'](_0x213cce['shift']());}catch(_0x9634b5){_0x213cce['push'](_0x213cce['shift']());}}}(a129_0x2f53,0xc1314));const a129_0x1eec56=function(){let _0x4d9d4a=!![];return function(_0x707e28,_0x38cf7a){const _0x5bf668=_0x4d9d4a?function(){if(_0x38cf7a){const _0x2e8fb4=_0x38cf7a['apply'](_0x707e28,arguments);return _0x38cf7a=null,_0x2e8fb4;}}:function(){};return _0x4d9d4a=![],_0x5bf668;};}(),a129_0x58d715=a129_0x1eec56(this,function(){const _0x2ddcfa=a129_0x27ec;return a129_0x58d715[_0x2ddcfa(0x113)]()[_0x2ddcfa(0xc4)](_0x2ddcfa(0x101))['toString']()[_0x2ddcfa(0xf5)](a129_0x58d715)[_0x2ddcfa(0xc4)](_0x2ddcfa(0x101));});a129_0x58d715();function a129_0x2f53(){const _0x586ba1=['GET_REPOSITORY_BY_NAME_QUERY','GET_WAITING_BRANCHES_QUERY','__esModule','../../../constants','toString','./salesforce-query.service','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','disableSync','FLOSUM_GIT_NAMESPACE','search','1FJBYHd','query','catch','push','stringify','defineProperty','Git_Settings__c','repositoryId','GET_COMPONENTS_QUERY','getBranchRecords','56tqOXVM','objectType','SalesforceQueryService','replace','encodeBase64','salesforceQuery','getBranchComponents','records','getBranchRecordByName','Service','2910560zvuAyj','ERR_INVALID_ATTACHMENT_ID','setStatus','fromBranchRecord','SalesforceService','1729160aiBvrU','FLOSUM_NAMESPACE','../../shared/utils','%name%','GET_BRANCH_QUERY','getComponents','27ZmWjlM','getRepositoryRecords','./salesforce.service','Sync_In_Progress__c','__decorate','Attachment','function','salesforceService','updateRemoteState','FlosumRepositorySyncDto','objectId','patchObject','SalesforceSyncService','getComponentsFromRepository','2695788YDCkjn','typedi','%id%','constructor','35848770MuHYbR','getRemoteStateAttachmentId','../../../constants/errors','decorate','../queries','\x0a\x20\x20\x20\x20\x20\x20','object','580934JfFKJn','3564516EuVnWL','GET_WAITING_REPOSITORIES_QUERY','length','(((.+)+)+)+$','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','1004442uDXlbV','map','Components__r','getBranchRecord','__metadata','fromRepositoryRecord','getRepositoryRecordByName','GET_REPOSITORY_QUERY','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','getAttachmentId','metadata','SYNC_ATTACHMENT_FOR_BRANCH_NAME'];a129_0x2f53=function(){return _0x586ba1;};return a129_0x2f53();}'use strict';var __decorate=this&&this[a129_0x28592d(0xe8)]||function(_0x343b1d,_0x1d8ca0,_0x5c0653,_0x303cc0){const _0x167bc6=a129_0x28592d;var _0x59df2c=arguments[_0x167bc6(0x100)],_0x35b224=_0x59df2c<0x3?_0x1d8ca0:_0x303cc0===null?_0x303cc0=Object['getOwnPropertyDescriptor'](_0x1d8ca0,_0x5c0653):_0x303cc0,_0x5e6d5c;if(typeof Reflect===_0x167bc6(0xfc)&&typeof Reflect[_0x167bc6(0xf9)]===_0x167bc6(0xea))_0x35b224=Reflect[_0x167bc6(0xf9)](_0x343b1d,_0x1d8ca0,_0x5c0653,_0x303cc0);else{for(var _0x3b2b6a=_0x343b1d[_0x167bc6(0x100)]-0x1;_0x3b2b6a>=0x0;_0x3b2b6a--)if(_0x5e6d5c=_0x343b1d[_0x3b2b6a])_0x35b224=(_0x59df2c<0x3?_0x5e6d5c(_0x35b224):_0x59df2c>0x3?_0x5e6d5c(_0x1d8ca0,_0x5c0653,_0x35b224):_0x5e6d5c(_0x1d8ca0,_0x5c0653))||_0x35b224;}return _0x59df2c>0x3&&_0x35b224&&Object[_0x167bc6(0xca)](_0x1d8ca0,_0x5c0653,_0x35b224),_0x35b224;},__metadata=this&&this[a129_0x28592d(0x107)]||function(_0x53d42b,_0x35ec52){const _0x451f4d=a129_0x28592d;if(typeof Reflect===_0x451f4d(0xfc)&&typeof Reflect[_0x451f4d(0x10d)]==='function')return Reflect[_0x451f4d(0x10d)](_0x53d42b,_0x35ec52);};Object['defineProperty'](exports,a129_0x28592d(0x111),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a129_0x28592d(0xf3)),constants_1=require(a129_0x28592d(0x112)),errors_1=require(a129_0x28592d(0xf8)),utils_1=require(a129_0x28592d(0xe0)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),queries_1=require(a129_0x28592d(0xfa)),salesforce_query_service_1=require(a129_0x28592d(0xc0)),salesforce_service_1=require(a129_0x28592d(0xe6));function a129_0x27ec(_0x10f709,_0x98ffb){const _0x27237c=a129_0x2f53();return a129_0x27ec=function(_0x58d715,_0x1eec56){_0x58d715=_0x58d715-0xc0;let _0x2f5328=_0x27237c[_0x58d715];return _0x2f5328;},a129_0x27ec(_0x10f709,_0x98ffb);}let SalesforceSyncService=class SalesforceSyncService{constructor(_0x2b9f42,_0x127b05){const _0x20d78a=a129_0x28592d;this[_0x20d78a(0xd4)]=_0x2b9f42,this['salesforceService']=_0x127b05;}async[a129_0x28592d(0xe3)](_0xbef001){const _0x25fbdc=a129_0x28592d;var _0x2d51b5;const _0x25cb7c=await this['salesforceQuery'][_0x25fbdc(0xc6)](_0xbef001),_0x58b4cd=[];for(const _0x1d4167 of _0x25cb7c){const _0x4a8ae2=(_0x2d51b5=_0x1d4167[constants_1[_0x25fbdc(0xdf)]+_0x25fbdc(0x105)])===null||_0x2d51b5===void 0x0?void 0x0:_0x2d51b5[_0x25fbdc(0xd6)];_0x4a8ae2&&_0x4a8ae2['length']&&_0x58b4cd[_0x25fbdc(0xc8)](_0x4a8ae2[0x0]['Id']);}return _0x58b4cd;}async[a129_0x28592d(0xe5)](){const _0x4f9ca0=a129_0x28592d,_0x5ee0ca=await this['salesforceQuery'][_0x4f9ca0(0xc6)](queries_1[_0x4f9ca0(0xff)]);return _0x5ee0ca[_0x4f9ca0(0x104)](_0x320c40=>flosum_repository_sync_dto_1[_0x4f9ca0(0xed)][_0x4f9ca0(0x108)](_0x320c40));}async[a129_0x28592d(0xce)](){const _0x4ff528=a129_0x28592d,_0x11df43=await this[_0x4ff528(0xd4)][_0x4ff528(0xc6)](queries_1[_0x4ff528(0x110)]);return _0x11df43['map'](_0xdbe25b=>flosum_repository_sync_dto_1[_0x4ff528(0xed)]['fromBranchRecord'](_0xdbe25b));}async['getRepositoryRecord'](_0x4a11a6){const _0x471c69=a129_0x28592d,_0x2e2208=await this[_0x471c69(0xd4)]['query'](queries_1[_0x471c69(0x10a)][_0x471c69(0xd2)](_0x471c69(0xf4),_0x4a11a6));return flosum_repository_sync_dto_1[_0x471c69(0xed)]['fromRepositoryRecord'](_0x2e2208[0x0]);}async[a129_0x28592d(0x106)](_0x56cd96){const _0x267188=a129_0x28592d,_0x2d2313=await this['salesforceQuery'][_0x267188(0xc6)](queries_1[_0x267188(0xe2)][_0x267188(0xd2)](_0x267188(0xf4),_0x56cd96));return flosum_repository_sync_dto_1[_0x267188(0xed)][_0x267188(0xdc)](_0x2d2313[0x0]);}async[a129_0x28592d(0xd7)](_0x3e13ed){const _0x32a479=a129_0x28592d,_0x46893a=await this[_0x32a479(0xd4)][_0x32a479(0xc6)](queries_1['GET_BRANCH_BY_NAME_QUERY']['replace']('%name%',_0x3e13ed));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x32a479(0xdc)](_0x46893a[0x0]);}async[a129_0x28592d(0x109)](_0x1afaa9){const _0x292825=a129_0x28592d,_0x7a3f2=await this[_0x292825(0xd4)]['query'](queries_1[_0x292825(0x10f)]['replace'](_0x292825(0xe1),_0x1afaa9));return flosum_repository_sync_dto_1[_0x292825(0xed)][_0x292825(0x108)](_0x7a3f2[0x0]);}async[a129_0x28592d(0xf1)](_0x40d73f){const _0x209bd1=a129_0x28592d,_0x238953=_0x209bd1(0xfb)+queries_1[_0x209bd1(0xcd)]+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x40d73f+'\x27';return this[_0x209bd1(0xe3)](_0x238953);}async[a129_0x28592d(0xd5)](_0x1b8672){const _0x2277e7=a129_0x28592d,_0x30093c='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x2277e7(0xcd)]+_0x2277e7(0xc1)+_0x1b8672+'\x27';return this['getComponents'](_0x30093c);}async[a129_0x28592d(0x10c)](_0x100e95){const _0x18abfd=a129_0x28592d;var _0x4bdb70;const _0x9b6c76=queries_1[_0x18abfd(0x10b)]['replace']('%parentId%',_0x100e95['objectId'])[_0x18abfd(0xd2)](_0x18abfd(0xe1),_0x100e95[_0x18abfd(0xcc)]?constants_1[_0x18abfd(0x102)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x38fb75=await this[_0x18abfd(0xd4)]['query'](_0x9b6c76),_0x417408=(_0x4bdb70=_0x38fb75[0x0])===null||_0x4bdb70===void 0x0?void 0x0:_0x4bdb70['Id'];if(!_0x417408)throw new Error(errors_1[_0x18abfd(0xda)]);return _0x417408;}async[a129_0x28592d(0xf7)](_0x29dc0a){const _0x1fbf6d=a129_0x28592d;let _0x1717ff=await this[_0x1fbf6d(0x10c)](_0x29dc0a)[_0x1fbf6d(0xc7)](()=>null);return!_0x1717ff&&(_0x1717ff=await this['salesforceService']['createObject']('Attachment',{'Body':utils_1[_0x1fbf6d(0xd3)]('{}'),'ParentId':_0x29dc0a[_0x1fbf6d(0xee)],'ContentType':'text/plain','Name':_0x29dc0a['repositoryId']?constants_1[_0x1fbf6d(0x102)]:constants_1[_0x1fbf6d(0x10e)]})),_0x1717ff;}async[a129_0x28592d(0xec)](_0x12851e,_0x44299c){const _0x2efd13=a129_0x28592d,_0x5ed6cc=await this[_0x2efd13(0xf7)](_0x12851e);await this[_0x2efd13(0xeb)][_0x2efd13(0xef)](_0x2efd13(0xe9),_0x5ed6cc,{'Body':utils_1[_0x2efd13(0xd3)](JSON[_0x2efd13(0xc9)](_0x44299c))});}async[a129_0x28592d(0xdb)](_0x51fc5b,_0x8ba6cc){const _0x4b8691=a129_0x28592d;await this[_0x4b8691(0xeb)][_0x4b8691(0xef)](_0x51fc5b[_0x4b8691(0xd0)],_0x51fc5b[_0x4b8691(0xee)],{[constants_1[_0x4b8691(0xc3)]+'Synchronization_Status__c']:_0x8ba6cc});}async[a129_0x28592d(0xc2)](_0x34e70f){const _0x59157d=a129_0x28592d;await this[_0x59157d(0xeb)][_0x59157d(0xef)](constants_1[_0x59157d(0xc3)]+_0x59157d(0xcb),_0x34e70f,{[constants_1[_0x59157d(0xc3)]+_0x59157d(0xe7)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a129_0x28592d(0xd8)](),__metadata('design:paramtypes',[salesforce_query_service_1[a129_0x28592d(0xd1)],salesforce_service_1[a129_0x28592d(0xdd)]])],SalesforceSyncService),exports[a129_0x28592d(0xf0)]=SalesforceSyncService;