const a130_0x591335=a130_0x1414;(function(_0xd0fe69,_0x3b84ac){const _0x52f8d2=a130_0x1414,_0x288bd8=_0xd0fe69();while(!![]){try{const _0x663d51=parseInt(_0x52f8d2(0x189))/0x1+parseInt(_0x52f8d2(0x1a0))/0x2*(-parseInt(_0x52f8d2(0x1cc))/0x3)+-parseInt(_0x52f8d2(0x1b2))/0x4+parseInt(_0x52f8d2(0x188))/0x5*(-parseInt(_0x52f8d2(0x1ae))/0x6)+-parseInt(_0x52f8d2(0x1a4))/0x7*(parseInt(_0x52f8d2(0x1a2))/0x8)+parseInt(_0x52f8d2(0x1b5))/0x9+parseInt(_0x52f8d2(0x18b))/0xa*(parseInt(_0x52f8d2(0x1cf))/0xb);if(_0x663d51===_0x3b84ac)break;else _0x288bd8['push'](_0x288bd8['shift']());}catch(_0x5773eb){_0x288bd8['push'](_0x288bd8['shift']());}}}(a130_0x1b84,0x4780b));function a130_0x1414(_0x5324fa,_0x20fd7e){const _0x4f5b84=a130_0x1b84();return a130_0x1414=function(_0x28fc4b,_0x47d690){_0x28fc4b=_0x28fc4b-0x184;let _0x1b8466=_0x4f5b84[_0x28fc4b];return _0x1b8466;},a130_0x1414(_0x5324fa,_0x20fd7e);}const a130_0x47d690=function(){let _0x3dd014=!![];return function(_0x143ffd,_0x47504d){const _0x3a8b33=_0x3dd014?function(){if(_0x47504d){const _0x4f3736=_0x47504d['apply'](_0x143ffd,arguments);return _0x47504d=null,_0x4f3736;}}:function(){};return _0x3dd014=![],_0x3a8b33;};}(),a130_0x28fc4b=a130_0x47d690(this,function(){const _0x51edc4=a130_0x1414;return a130_0x28fc4b['toString']()[_0x51edc4(0x1bb)](_0x51edc4(0x1b3))['toString']()[_0x51edc4(0x1c6)](a130_0x28fc4b)['search'](_0x51edc4(0x1b3));});a130_0x28fc4b();function a130_0x1b84(){const _0x59803a=['getRepositoryRecords','salesforceService','../queries','9owhwwJ','%id%','FlosumRepositorySyncDto','594bUszTI','salesforceQuery','records','getRepositoryRecord','./salesforce.service','push','502755YICOCt','286731LKpHBW','GET_WAITING_BRANCHES_QUERY','284770lhlQWa','repositoryId','text/plain','GET_BRANCH_QUERY','objectId','patchObject','replace','object','GET_COMPONENTS_QUERY','Git_Settings__c','getAttachmentId','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','../../shared/utils','Attachment','getRemoteStateAttachmentId','getComponents','GET_WAITING_REPOSITORIES_QUERY','disableSync','SalesforceService','SalesforceSyncService','__metadata','375398ICxYmu','SalesforceQueryService','48DqwqYJ','query','607579ToFWdq','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','SYNC_ATTACHMENT_FOR_BRANCH_NAME','\x0a\x20\x20\x20\x20\x20\x20','encodeBase64','getBranchComponents','__decorate','../dto/flosum-repository-sync.dto','fromBranchRecord','metadata','12fDwRve','typedi','function','__esModule','2159780InItKT','(((.+)+)+)+$','%parentId%','2639808hyypPH','FLOSUM_GIT_NAMESPACE','getBranchRecords','Service','length','design:paramtypes','search','stringify','getBranchRecord','fromRepositoryRecord','objectType','setStatus','map','decorate','Sync_In_Progress__c','ERR_INVALID_ATTACHMENT_ID','getComponentsFromRepository','constructor','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','FLOSUM_NAMESPACE'];a130_0x1b84=function(){return _0x59803a;};return a130_0x1b84();}'use strict';var __decorate=this&&this[a130_0x591335(0x1aa)]||function(_0x2b07cc,_0x588e4e,_0x1115fb,_0x14a23d){const _0x3d239a=a130_0x591335;var _0x3d5c8c=arguments[_0x3d239a(0x1b9)],_0x22eecc=_0x3d5c8c<0x3?_0x588e4e:_0x14a23d===null?_0x14a23d=Object['getOwnPropertyDescriptor'](_0x588e4e,_0x1115fb):_0x14a23d,_0x1316a1;if(typeof Reflect===_0x3d239a(0x192)&&typeof Reflect[_0x3d239a(0x1c2)]===_0x3d239a(0x1b0))_0x22eecc=Reflect[_0x3d239a(0x1c2)](_0x2b07cc,_0x588e4e,_0x1115fb,_0x14a23d);else{for(var _0x8b0cbb=_0x2b07cc[_0x3d239a(0x1b9)]-0x1;_0x8b0cbb>=0x0;_0x8b0cbb--)if(_0x1316a1=_0x2b07cc[_0x8b0cbb])_0x22eecc=(_0x3d5c8c<0x3?_0x1316a1(_0x22eecc):_0x3d5c8c>0x3?_0x1316a1(_0x588e4e,_0x1115fb,_0x22eecc):_0x1316a1(_0x588e4e,_0x1115fb))||_0x22eecc;}return _0x3d5c8c>0x3&&_0x22eecc&&Object['defineProperty'](_0x588e4e,_0x1115fb,_0x22eecc),_0x22eecc;},__metadata=this&&this[a130_0x591335(0x19f)]||function(_0x323959,_0x5260ce){const _0x51dfb8=a130_0x591335;if(typeof Reflect===_0x51dfb8(0x192)&&typeof Reflect['metadata']===_0x51dfb8(0x1b0))return Reflect[_0x51dfb8(0x1ad)](_0x323959,_0x5260ce);};Object['defineProperty'](exports,a130_0x591335(0x1b1),{'value':!![]}),exports[a130_0x591335(0x19e)]=void 0x0;const typedi_1=require(a130_0x591335(0x1af)),constants_1=require('../../../constants'),errors_1=require('../../../constants/errors'),utils_1=require(a130_0x591335(0x197)),flosum_repository_sync_dto_1=require(a130_0x591335(0x1ab)),queries_1=require(a130_0x591335(0x1cb)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a130_0x591335(0x186));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x5b2c66,_0x4a56a8){const _0x8b51d5=a130_0x591335;this['salesforceQuery']=_0x5b2c66,this[_0x8b51d5(0x1ca)]=_0x4a56a8;}async[a130_0x591335(0x19a)](_0x3564e){const _0x235085=a130_0x591335;var _0x3242cc;const _0x2c4af9=await this[_0x235085(0x1d0)]['query'](_0x3564e),_0x54cc8e=[];for(const _0x271a8d of _0x2c4af9){const _0x236d6f=(_0x3242cc=_0x271a8d[constants_1[_0x235085(0x1c8)]+'Components__r'])===null||_0x3242cc===void 0x0?void 0x0:_0x3242cc[_0x235085(0x184)];_0x236d6f&&_0x236d6f[_0x235085(0x1b9)]&&_0x54cc8e[_0x235085(0x187)](_0x236d6f[0x0]['Id']);}return _0x54cc8e;}async[a130_0x591335(0x1c9)](){const _0x52dde0=a130_0x591335,_0x3e3fa7=await this[_0x52dde0(0x1d0)][_0x52dde0(0x1a3)](queries_1[_0x52dde0(0x19b)]);return _0x3e3fa7[_0x52dde0(0x1c1)](_0x3858d9=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromRepositoryRecord'](_0x3858d9));}async[a130_0x591335(0x1b7)](){const _0x4607e5=a130_0x591335,_0x130058=await this[_0x4607e5(0x1d0)][_0x4607e5(0x1a3)](queries_1[_0x4607e5(0x18a)]);return _0x130058['map'](_0x105142=>flosum_repository_sync_dto_1[_0x4607e5(0x1ce)][_0x4607e5(0x1ac)](_0x105142));}async[a130_0x591335(0x185)](_0x4f8394){const _0x3b261a=a130_0x591335,_0x26f26c=await this[_0x3b261a(0x1d0)]['query'](queries_1['GET_REPOSITORY_QUERY']['replace'](_0x3b261a(0x1cd),_0x4f8394));return flosum_repository_sync_dto_1[_0x3b261a(0x1ce)][_0x3b261a(0x1be)](_0x26f26c[0x0]);}async[a130_0x591335(0x1bd)](_0x441bfe){const _0x3ddf7c=a130_0x591335,_0x338755=await this[_0x3ddf7c(0x1d0)][_0x3ddf7c(0x1a3)](queries_1[_0x3ddf7c(0x18e)]['replace']('%id%',_0x441bfe));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x3ddf7c(0x1ac)](_0x338755[0x0]);}async[a130_0x591335(0x1c5)](_0x1ac535){const _0x12888e=a130_0x591335,_0xed45bf=_0x12888e(0x1a7)+queries_1['GET_COMPONENTS_QUERY']+_0x12888e(0x1a5)+_0x1ac535+'\x27';return this['getComponents'](_0xed45bf);}async[a130_0x591335(0x1a9)](_0x3733e5){const _0x501271=a130_0x591335,_0x185df9='\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+queries_1[_0x501271(0x193)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27'+_0x3733e5+'\x27';return this[_0x501271(0x19a)](_0x185df9);}async[a130_0x591335(0x195)](_0x59ca07){const _0x4a1b2a=a130_0x591335;var _0x3d1d45;const _0xa1e87b=queries_1[_0x4a1b2a(0x196)]['replace'](_0x4a1b2a(0x1b4),_0x59ca07[_0x4a1b2a(0x18f)])[_0x4a1b2a(0x191)]('%name%',_0x59ca07[_0x4a1b2a(0x18c)]?constants_1[_0x4a1b2a(0x1c7)]:constants_1[_0x4a1b2a(0x1a6)]),_0x1e9e20=await this[_0x4a1b2a(0x1d0)][_0x4a1b2a(0x1a3)](_0xa1e87b),_0x28c9da=(_0x3d1d45=_0x1e9e20[0x0])===null||_0x3d1d45===void 0x0?void 0x0:_0x3d1d45['Id'];if(!_0x28c9da)throw new Error(errors_1[_0x4a1b2a(0x1c4)]);return _0x28c9da;}async[a130_0x591335(0x199)](_0x18c05b){const _0x2e64f3=a130_0x591335;let _0x43ed03=await this[_0x2e64f3(0x195)](_0x18c05b)['catch'](()=>null);return!_0x43ed03&&(_0x43ed03=await this[_0x2e64f3(0x1ca)]['createObject'](_0x2e64f3(0x198),{'Body':utils_1['encodeBase64']('{}'),'ParentId':_0x18c05b[_0x2e64f3(0x18f)],'ContentType':_0x2e64f3(0x18d),'Name':_0x18c05b['repositoryId']?constants_1[_0x2e64f3(0x1c7)]:constants_1[_0x2e64f3(0x1a6)]})),_0x43ed03;}async['updateRemoteState'](_0x11824e,_0x17f24f){const _0x2e16f7=a130_0x591335,_0x29049c=await this[_0x2e16f7(0x199)](_0x11824e);await this[_0x2e16f7(0x1ca)][_0x2e16f7(0x190)](_0x2e16f7(0x198),_0x29049c,{'Body':utils_1[_0x2e16f7(0x1a8)](JSON[_0x2e16f7(0x1bc)](_0x17f24f))});}async[a130_0x591335(0x1c0)](_0x4c750f,_0x5c48ec){const _0x3033e6=a130_0x591335;await this[_0x3033e6(0x1ca)][_0x3033e6(0x190)](_0x4c750f[_0x3033e6(0x1bf)],_0x4c750f[_0x3033e6(0x18f)],{[constants_1[_0x3033e6(0x1b6)]+'Synchronization_Status__c']:_0x5c48ec});}async[a130_0x591335(0x19c)](_0x5b03fe){const _0x5ac060=a130_0x591335;await this[_0x5ac060(0x1ca)][_0x5ac060(0x190)](constants_1[_0x5ac060(0x1b6)]+_0x5ac060(0x194),_0x5b03fe,{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x5ac060(0x1c3)]:![]});}};SalesforceSyncService=__decorate([typedi_1[a130_0x591335(0x1b8)](),__metadata(a130_0x591335(0x1ba),[salesforce_query_service_1[a130_0x591335(0x1a1)],salesforce_service_1[a130_0x591335(0x19d)]])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;