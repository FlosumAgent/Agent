const a112_0x200985=a112_0x152f;(function(_0x11a557,_0x533c8d){const _0x39953a=a112_0x152f,_0x4a25c2=_0x11a557();while(!![]){try{const _0x8dcc77=parseInt(_0x39953a(0xbc))/0x1+parseInt(_0x39953a(0x9b))/0x2*(-parseInt(_0x39953a(0xb7))/0x3)+-parseInt(_0x39953a(0xb3))/0x4+parseInt(_0x39953a(0xa6))/0x5+parseInt(_0x39953a(0xbf))/0x6+parseInt(_0x39953a(0xae))/0x7+-parseInt(_0x39953a(0x8f))/0x8;if(_0x8dcc77===_0x533c8d)break;else _0x4a25c2['push'](_0x4a25c2['shift']());}catch(_0x4673d8){_0x4a25c2['push'](_0x4a25c2['shift']());}}}(a112_0x5641,0x75ca2));function a112_0x152f(_0x2b3c6a,_0x2735a9){const _0x11b5b3=a112_0x5641();return a112_0x152f=function(_0xb3d195,_0x2319b7){_0xb3d195=_0xb3d195-0x77;let _0x564133=_0x11b5b3[_0xb3d195];return _0x564133;},a112_0x152f(_0x2b3c6a,_0x2735a9);}const a112_0x2319b7=function(){let _0xe27136=!![];return function(_0x47e1a8,_0x472558){const _0xcafffe=_0xe27136?function(){if(_0x472558){const _0x131b06=_0x472558['apply'](_0x47e1a8,arguments);return _0x472558=null,_0x131b06;}}:function(){};return _0xe27136=![],_0xcafffe;};}(),a112_0xb3d195=a112_0x2319b7(this,function(){const _0x125f65=a112_0x152f;return a112_0xb3d195[_0x125f65(0x84)]()['search'](_0x125f65(0xb0))[_0x125f65(0x84)]()[_0x125f65(0xab)](a112_0xb3d195)['search'](_0x125f65(0xb0));});a112_0xb3d195();'use strict';var __decorate=this&&this[a112_0x200985(0x7a)]||function(_0x19c9c7,_0xd1ab66,_0xb9c1d6,_0x386cd5){const _0x399e1b=a112_0x200985;var _0x23ee67=arguments[_0x399e1b(0x7e)],_0x18206e=_0x23ee67<0x3?_0xd1ab66:_0x386cd5===null?_0x386cd5=Object[_0x399e1b(0xa7)](_0xd1ab66,_0xb9c1d6):_0x386cd5,_0x5ba6ec;if(typeof Reflect===_0x399e1b(0x8e)&&typeof Reflect[_0x399e1b(0xc0)]===_0x399e1b(0x91))_0x18206e=Reflect[_0x399e1b(0xc0)](_0x19c9c7,_0xd1ab66,_0xb9c1d6,_0x386cd5);else{for(var _0x2fb529=_0x19c9c7[_0x399e1b(0x7e)]-0x1;_0x2fb529>=0x0;_0x2fb529--)if(_0x5ba6ec=_0x19c9c7[_0x2fb529])_0x18206e=(_0x23ee67<0x3?_0x5ba6ec(_0x18206e):_0x23ee67>0x3?_0x5ba6ec(_0xd1ab66,_0xb9c1d6,_0x18206e):_0x5ba6ec(_0xd1ab66,_0xb9c1d6))||_0x18206e;}return _0x23ee67>0x3&&_0x18206e&&Object[_0x399e1b(0x77)](_0xd1ab66,_0xb9c1d6,_0x18206e),_0x18206e;},__metadata=this&&this[a112_0x200985(0xba)]||function(_0x43ce3a,_0x3ea7a2){const _0x1c937e=a112_0x200985;if(typeof Reflect===_0x1c937e(0x8e)&&typeof Reflect[_0x1c937e(0xb1)]===_0x1c937e(0x91))return Reflect[_0x1c937e(0xb1)](_0x43ce3a,_0x3ea7a2);};Object[a112_0x200985(0x77)](exports,'__esModule',{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a112_0x200985(0xa0)),constants_1=require(a112_0x200985(0x8d)),errors_1=require(a112_0x200985(0x7d)),utils_1=require(a112_0x200985(0x9d)),flosum_repository_sync_dto_1=require(a112_0x200985(0xb5)),queries_1=require('../queries'),salesforce_query_service_1=require(a112_0x200985(0xb6)),salesforce_service_1=require('./salesforce.service');let SalesforceSyncService=class SalesforceSyncService{constructor(_0x3c703e,_0x555539){const _0x384af1=a112_0x200985;this['salesforceQuery']=_0x3c703e,this[_0x384af1(0x78)]=_0x555539;}async[a112_0x200985(0xa9)](_0x264bc2){const _0x481ef3=a112_0x200985;var _0x1fc590;const _0x224e0d=await this[_0x481ef3(0xbe)][_0x481ef3(0xbb)](_0x264bc2),_0x55d9fe=[];for(const _0x2c514b of _0x224e0d){const _0x4eac5c=(_0x1fc590=_0x2c514b[constants_1[_0x481ef3(0xbd)]+_0x481ef3(0x79)])===null||_0x1fc590===void 0x0?void 0x0:_0x1fc590[_0x481ef3(0x99)];_0x4eac5c&&_0x4eac5c[_0x481ef3(0x7e)]&&_0x55d9fe['push'](_0x4eac5c[0x0]['Id']);}return _0x55d9fe;}async[a112_0x200985(0xac)](){const _0xd8d125=a112_0x200985,_0x3c88fc=await this[_0xd8d125(0xbe)][_0xd8d125(0xbb)](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x3c88fc[_0xd8d125(0x90)](_0x28fdfe=>flosum_repository_sync_dto_1[_0xd8d125(0x9f)][_0xd8d125(0x92)](_0x28fdfe));}async['getBranchRecords'](){const _0x1a8a8d=a112_0x200985,_0x2edbf3=await this[_0x1a8a8d(0xbe)][_0x1a8a8d(0xbb)](queries_1[_0x1a8a8d(0x8c)]);return _0x2edbf3[_0x1a8a8d(0x90)](_0x55f13c=>flosum_repository_sync_dto_1[_0x1a8a8d(0x9f)][_0x1a8a8d(0x96)](_0x55f13c));}async[a112_0x200985(0xa2)](_0x3227fb){const _0x395e20=a112_0x200985,_0xbe12a8=await this[_0x395e20(0xbe)]['query'](queries_1[_0x395e20(0x97)][_0x395e20(0x80)](_0x395e20(0xad),_0x3227fb));return flosum_repository_sync_dto_1[_0x395e20(0x9f)][_0x395e20(0x92)](_0xbe12a8[0x0]);}async['getBranchRecord'](_0x3d3ef9){const _0x5a367f=a112_0x200985,_0x347c86=await this[_0x5a367f(0xbe)]['query'](queries_1[_0x5a367f(0xa3)]['replace'](_0x5a367f(0xad),_0x3d3ef9));return flosum_repository_sync_dto_1[_0x5a367f(0x9f)][_0x5a367f(0x96)](_0x347c86[0x0]);}async[a112_0x200985(0x7c)](_0x1ec20e){const _0x1d0449=a112_0x200985,_0x33a4ce=_0x1d0449(0x8a)+queries_1[_0x1d0449(0x7b)]+'\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27'+_0x1ec20e+'\x27';return this[_0x1d0449(0xa9)](_0x33a4ce);}async[a112_0x200985(0xaa)](_0x5388d4){const _0x93911b=a112_0x200985,_0x25a0d9=_0x93911b(0x81)+queries_1['GET_COMPONENTS_QUERY']+_0x93911b(0xa5)+_0x5388d4+'\x27';return this[_0x93911b(0xa9)](_0x25a0d9);}async[a112_0x200985(0x87)](_0x39af11){const _0x886827=a112_0x200985;var _0x46fd67;const _0x23e156=queries_1[_0x886827(0x95)][_0x886827(0x80)](_0x886827(0xb8),_0x39af11[_0x886827(0xb9)])[_0x886827(0x80)]('%name%',_0x39af11[_0x886827(0xaf)]?constants_1[_0x886827(0xa4)]:constants_1[_0x886827(0x88)]),_0x30c24d=await this[_0x886827(0xbe)][_0x886827(0xbb)](_0x23e156),_0x5635a9=(_0x46fd67=_0x30c24d[0x0])===null||_0x46fd67===void 0x0?void 0x0:_0x46fd67['Id'];if(!_0x5635a9)throw new Error(errors_1[_0x886827(0x98)]);return _0x5635a9;}async[a112_0x200985(0x9a)](_0x4b0509){const _0xf4d9c4=a112_0x200985;let _0x4e6beb=await this[_0xf4d9c4(0x87)](_0x4b0509)[_0xf4d9c4(0x9c)](()=>null);return!_0x4e6beb&&(_0x4e6beb=await this[_0xf4d9c4(0x78)]['createObject']('Attachment',{'Body':(0x0,utils_1[_0xf4d9c4(0x82)])('{}'),'ParentId':_0x4b0509[_0xf4d9c4(0xb9)],'ContentType':'text/plain','Name':_0x4b0509['repositoryId']?constants_1[_0xf4d9c4(0xa4)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x4e6beb;}async[a112_0x200985(0x86)](_0xea3e8,_0x2fdd4c){const _0x29e69a=a112_0x200985,_0x20c8fc=await this[_0x29e69a(0x9a)](_0xea3e8);await this['salesforceService'][_0x29e69a(0xa8)](_0x29e69a(0x7f),_0x20c8fc,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x29e69a(0x9e)](_0x2fdd4c))});}async[a112_0x200985(0x94)](_0x4809f5,_0x87780e){const _0xc66c86=a112_0x200985;await this[_0xc66c86(0x78)][_0xc66c86(0xa8)](_0x4809f5['objectType'],_0x4809f5['objectId'],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0xc66c86(0xa1)]:_0x87780e});}async[a112_0x200985(0x89)](_0x6411e2){const _0x1da440=a112_0x200985;await this[_0x1da440(0x78)][_0x1da440(0xa8)](constants_1[_0x1da440(0x93)]+_0x1da440(0xb2),_0x6411e2,{[constants_1['FLOSUM_GIT_NAMESPACE']+'Sync_In_Progress__c']:![]});}};function a112_0x5641(){const _0x40d798=['object','11520512kULZTg','map','function','fromRepositoryRecord','FLOSUM_GIT_NAMESPACE','setStatus','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','fromBranchRecord','GET_REPOSITORY_QUERY','ERR_INVALID_ATTACHMENT_ID','records','getRemoteStateAttachmentId','75694AKXoHr','catch','../../shared/utils','stringify','FlosumRepositorySyncDto','typedi','Synchronization_Status__c','getRepositoryRecord','GET_BRANCH_QUERY','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','4710680vMSLxF','getOwnPropertyDescriptor','patchObject','getComponents','getBranchComponents','constructor','getRepositoryRecords','%id%','4483857HyROeI','repositoryId','(((.+)+)+)+$','metadata','Git_Settings__c','3834096IzMUNv','SalesforceSyncService','../dto/flosum-repository-sync.dto','./salesforce-query.service','15qepHEM','%parentId%','objectId','__metadata','query','849255MXosPU','FLOSUM_NAMESPACE','salesforceQuery','3830082eAPBoo','decorate','defineProperty','salesforceService','Components__r','__decorate','GET_COMPONENTS_QUERY','getComponentsFromRepository','../../../constants/errors','length','Attachment','replace','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','encodeBase64','SalesforceQueryService','toString','design:paramtypes','updateRemoteState','getAttachmentId','SYNC_ATTACHMENT_FOR_BRANCH_NAME','disableSync','\x0a\x20\x20\x20\x20\x20\x20','SalesforceService','GET_WAITING_BRANCHES_QUERY','../../../constants'];a112_0x5641=function(){return _0x40d798;};return a112_0x5641();}SalesforceSyncService=__decorate([(0x0,typedi_1['Service'])(),__metadata(a112_0x200985(0x85),[salesforce_query_service_1[a112_0x200985(0x83)],salesforce_service_1[a112_0x200985(0x8b)]])],SalesforceSyncService),exports[a112_0x200985(0xb4)]=SalesforceSyncService;