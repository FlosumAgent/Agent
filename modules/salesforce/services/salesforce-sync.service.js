const a129_0x3abd4d=a129_0x3d81;(function(_0x44f9af,_0x3af500){const _0x257f1a=a129_0x3d81,_0x13a7b3=_0x44f9af();while(!![]){try{const _0x457744=-parseInt(_0x257f1a(0x1ac))/0x1*(-parseInt(_0x257f1a(0x1ae))/0x2)+-parseInt(_0x257f1a(0x1b2))/0x3*(parseInt(_0x257f1a(0x1a1))/0x4)+parseInt(_0x257f1a(0x17c))/0x5+-parseInt(_0x257f1a(0x175))/0x6+parseInt(_0x257f1a(0x1b6))/0x7+parseInt(_0x257f1a(0x19a))/0x8+-parseInt(_0x257f1a(0x180))/0x9*(parseInt(_0x257f1a(0x1ab))/0xa);if(_0x457744===_0x3af500)break;else _0x13a7b3['push'](_0x13a7b3['shift']());}catch(_0x1220c4){_0x13a7b3['push'](_0x13a7b3['shift']());}}}(a129_0x50ef,0x3372c));const a129_0x3065e6=function(){let _0x3eb8d0=!![];return function(_0x19c6ce,_0x27f1cb){const _0xa66f9b=_0x3eb8d0?function(){if(_0x27f1cb){const _0x191d17=_0x27f1cb['apply'](_0x19c6ce,arguments);return _0x27f1cb=null,_0x191d17;}}:function(){};return _0x3eb8d0=![],_0xa66f9b;};}(),a129_0x45e3ed=a129_0x3065e6(this,function(){const _0x28f462=a129_0x3d81;return a129_0x45e3ed[_0x28f462(0x181)]()[_0x28f462(0x186)](_0x28f462(0x18d))[_0x28f462(0x181)]()[_0x28f462(0x16d)](a129_0x45e3ed)['search'](_0x28f462(0x18d));});a129_0x45e3ed();'use strict';var __decorate=this&&this[a129_0x3abd4d(0x17d)]||function(_0x2fcbc9,_0x252d01,_0x82043,_0x363077){const _0x52a1dd=a129_0x3abd4d;var _0x151878=arguments[_0x52a1dd(0x1b0)],_0x4e0bb6=_0x151878<0x3?_0x252d01:_0x363077===null?_0x363077=Object[_0x52a1dd(0x191)](_0x252d01,_0x82043):_0x363077,_0x2bac34;if(typeof Reflect===_0x52a1dd(0x1a3)&&typeof Reflect[_0x52a1dd(0x1a2)]===_0x52a1dd(0x1af))_0x4e0bb6=Reflect[_0x52a1dd(0x1a2)](_0x2fcbc9,_0x252d01,_0x82043,_0x363077);else{for(var _0x785478=_0x2fcbc9['length']-0x1;_0x785478>=0x0;_0x785478--)if(_0x2bac34=_0x2fcbc9[_0x785478])_0x4e0bb6=(_0x151878<0x3?_0x2bac34(_0x4e0bb6):_0x151878>0x3?_0x2bac34(_0x252d01,_0x82043,_0x4e0bb6):_0x2bac34(_0x252d01,_0x82043))||_0x4e0bb6;}return _0x151878>0x3&&_0x4e0bb6&&Object[_0x52a1dd(0x19f)](_0x252d01,_0x82043,_0x4e0bb6),_0x4e0bb6;},__metadata=this&&this[a129_0x3abd4d(0x1b3)]||function(_0x168949,_0x2c0819){const _0x3108fe=a129_0x3abd4d;if(typeof Reflect==='object'&&typeof Reflect[_0x3108fe(0x170)]===_0x3108fe(0x1af))return Reflect[_0x3108fe(0x170)](_0x168949,_0x2c0819);};function a129_0x3d81(_0x352759,_0x3cfaa5){const _0x4e4dc1=a129_0x50ef();return a129_0x3d81=function(_0x45e3ed,_0x3065e6){_0x45e3ed=_0x45e3ed-0x16d;let _0x50efdf=_0x4e4dc1[_0x45e3ed];return _0x50efdf;},a129_0x3d81(_0x352759,_0x3cfaa5);}Object[a129_0x3abd4d(0x19f)](exports,a129_0x3abd4d(0x185),{'value':!![]}),exports['SalesforceSyncService']=void 0x0;const typedi_1=require(a129_0x3abd4d(0x184)),constants_1=require(a129_0x3abd4d(0x1ad)),errors_1=require(a129_0x3abd4d(0x1bf)),utils_1=require(a129_0x3abd4d(0x1a5)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),queries_1=require(a129_0x3abd4d(0x1a7)),salesforce_query_service_1=require('./salesforce-query.service'),salesforce_service_1=require(a129_0x3abd4d(0x182));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x3bc9a6,_0x960404){const _0x294ff2=a129_0x3abd4d;this[_0x294ff2(0x195)]=_0x3bc9a6,this['salesforceService']=_0x960404;}async['getComponents'](_0x15b1d4){const _0x319a94=a129_0x3abd4d;var _0x4b3ade;const _0x400675=await this['salesforceQuery'][_0x319a94(0x18a)](_0x15b1d4),_0x3b8f51=[];for(const _0x4dc774 of _0x400675){const _0x30f172=(_0x4b3ade=_0x4dc774[constants_1[_0x319a94(0x189)]+'Components__r'])===null||_0x4b3ade===void 0x0?void 0x0:_0x4b3ade[_0x319a94(0x1a9)];_0x30f172&&_0x30f172[_0x319a94(0x1b0)]&&_0x3b8f51[_0x319a94(0x179)](_0x30f172[0x0]['Id']);}return _0x3b8f51;}async[a129_0x3abd4d(0x198)](){const _0x191e0e=a129_0x3abd4d,_0x40bca6=await this['salesforceQuery'][_0x191e0e(0x18a)](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x40bca6['map'](_0x54acbe=>flosum_repository_sync_dto_1[_0x191e0e(0x16f)][_0x191e0e(0x196)](_0x54acbe));}async[a129_0x3abd4d(0x173)](){const _0x259e4f=a129_0x3abd4d,_0x2d41ca=await this[_0x259e4f(0x195)][_0x259e4f(0x18a)](queries_1[_0x259e4f(0x17a)]);return _0x2d41ca[_0x259e4f(0x18c)](_0x310273=>flosum_repository_sync_dto_1[_0x259e4f(0x16f)][_0x259e4f(0x1be)](_0x310273));}async[a129_0x3abd4d(0x19b)](_0x1cca13){const _0xc1c135=a129_0x3abd4d,_0xfb67b8=await this[_0xc1c135(0x195)][_0xc1c135(0x18a)](queries_1['GET_REPOSITORY_QUERY'][_0xc1c135(0x172)]('%id%',_0x1cca13));return flosum_repository_sync_dto_1[_0xc1c135(0x16f)][_0xc1c135(0x196)](_0xfb67b8[0x0]);}async[a129_0x3abd4d(0x188)](_0x42af25){const _0x510e3a=a129_0x3abd4d,_0x2ac180=await this['salesforceQuery'][_0x510e3a(0x18a)](queries_1[_0x510e3a(0x178)][_0x510e3a(0x172)](_0x510e3a(0x1b9),_0x42af25));return flosum_repository_sync_dto_1[_0x510e3a(0x16f)][_0x510e3a(0x1be)](_0x2ac180[0x0]);}async[a129_0x3abd4d(0x183)](_0xd9078){const _0x125887=a129_0x3abd4d,_0x4e8f64=await this[_0x125887(0x195)][_0x125887(0x18a)](queries_1[_0x125887(0x18b)]['replace'](_0x125887(0x17e),_0xd9078));return flosum_repository_sync_dto_1[_0x125887(0x16f)][_0x125887(0x1be)](_0x4e8f64[0x0]);}async[a129_0x3abd4d(0x1bb)](_0x57baea){const _0x5d3169=a129_0x3abd4d,_0x1788f7=await this[_0x5d3169(0x195)][_0x5d3169(0x18a)](queries_1[_0x5d3169(0x1b5)]['replace'](_0x5d3169(0x17e),_0x57baea));return flosum_repository_sync_dto_1[_0x5d3169(0x16f)]['fromRepositoryRecord'](_0x1788f7[0x0]);}async[a129_0x3abd4d(0x1a4)](_0x878803){const _0x52ac03=a129_0x3abd4d,_0x151d7a=_0x52ac03(0x18e)+queries_1[_0x52ac03(0x1b1)]+_0x52ac03(0x1b4)+_0x878803+'\x27';return this['getComponents'](_0x151d7a);}async[a129_0x3abd4d(0x19d)](_0x4a4dd2){const _0x1bb590=a129_0x3abd4d,_0x2f28ef=_0x1bb590(0x171)+queries_1[_0x1bb590(0x1b1)]+_0x1bb590(0x177)+_0x4a4dd2+'\x27';return this['getComponents'](_0x2f28ef);}async[a129_0x3abd4d(0x1ba)](_0x42dcb9){const _0x4ed1f2=a129_0x3abd4d;var _0x7b6502;const _0x1dea79=queries_1[_0x4ed1f2(0x19e)][_0x4ed1f2(0x172)](_0x4ed1f2(0x17f),_0x42dcb9[_0x4ed1f2(0x1aa)])[_0x4ed1f2(0x172)](_0x4ed1f2(0x17e),_0x42dcb9['repositoryId']?constants_1[_0x4ed1f2(0x187)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x2df708=await this[_0x4ed1f2(0x195)]['query'](_0x1dea79),_0x146457=(_0x7b6502=_0x2df708[0x0])===null||_0x7b6502===void 0x0?void 0x0:_0x7b6502['Id'];if(!_0x146457)throw new Error(errors_1[_0x4ed1f2(0x1bc)]);return _0x146457;}async[a129_0x3abd4d(0x17b)](_0x5e63c6){const _0x23e804=a129_0x3abd4d;let _0x4ec105=await this['getAttachmentId'](_0x5e63c6)[_0x23e804(0x194)](()=>null);return!_0x4ec105&&(_0x4ec105=await this[_0x23e804(0x1bd)]['createObject'](_0x23e804(0x174),{'Body':utils_1[_0x23e804(0x19c)]('{}'),'ParentId':_0x5e63c6[_0x23e804(0x1aa)],'ContentType':_0x23e804(0x1a0),'Name':_0x5e63c6[_0x23e804(0x18f)]?constants_1[_0x23e804(0x187)]:constants_1[_0x23e804(0x176)]})),_0x4ec105;}async[a129_0x3abd4d(0x1a8)](_0x2e3dd1,_0x369af1){const _0x586b69=a129_0x3abd4d,_0x23026f=await this[_0x586b69(0x17b)](_0x2e3dd1);await this[_0x586b69(0x1bd)]['patchObject'](_0x586b69(0x174),_0x23026f,{'Body':utils_1[_0x586b69(0x19c)](JSON[_0x586b69(0x1b8)](_0x369af1))});}async[a129_0x3abd4d(0x199)](_0x2112aa,_0x447479){const _0x3bef1d=a129_0x3abd4d;await this[_0x3bef1d(0x1bd)]['patchObject'](_0x2112aa['objectType'],_0x2112aa[_0x3bef1d(0x1aa)],{[constants_1['FLOSUM_GIT_NAMESPACE']+_0x3bef1d(0x190)]:_0x447479});}async[a129_0x3abd4d(0x1b7)](_0x49f90b){const _0x4ebc90=a129_0x3abd4d;await this['salesforceService'][_0x4ebc90(0x197)](constants_1['FLOSUM_GIT_NAMESPACE']+_0x4ebc90(0x192),_0x49f90b,{[constants_1[_0x4ebc90(0x16e)]+_0x4ebc90(0x193)]:![]});}};function a129_0x50ef(){const _0x5f3546=['%name%','%parentId%','27oyNQrz','toString','./salesforce.service','getBranchRecordByName','typedi','__esModule','search','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','getBranchRecord','FLOSUM_NAMESPACE','query','GET_BRANCH_BY_NAME_QUERY','map','(((.+)+)+)+$','\x0a\x20\x20\x20\x20\x20\x20','repositoryId','Synchronization_Status__c','getOwnPropertyDescriptor','Git_Settings__c','Sync_In_Progress__c','catch','salesforceQuery','fromRepositoryRecord','patchObject','getRepositoryRecords','setStatus','2563720JtfAMD','getRepositoryRecord','encodeBase64','getBranchComponents','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','defineProperty','text/plain','120aPSFbH','decorate','object','getComponentsFromRepository','../../shared/utils','SalesforceQueryService','../queries','updateRemoteState','records','objectId','2151910psSeUb','121899rSztLh','../../../constants','2IQtLIr','function','length','GET_COMPONENTS_QUERY','6978HtzGFv','__metadata','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','GET_REPOSITORY_BY_NAME_QUERY','2760016YlQFNs','disableSync','stringify','%id%','getAttachmentId','getRepositoryRecordByName','ERR_INVALID_ATTACHMENT_ID','salesforceService','fromBranchRecord','../../../constants/errors','constructor','FLOSUM_GIT_NAMESPACE','FlosumRepositorySyncDto','metadata','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','replace','getBranchRecords','Attachment','1582752orXvFi','SYNC_ATTACHMENT_FOR_BRANCH_NAME','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','GET_BRANCH_QUERY','push','GET_WAITING_BRANCHES_QUERY','getRemoteStateAttachmentId','1766125zAlStR','__decorate'];a129_0x50ef=function(){return _0x5f3546;};return a129_0x50ef();}SalesforceSyncService=__decorate([typedi_1['Service'](),__metadata('design:paramtypes',[salesforce_query_service_1[a129_0x3abd4d(0x1a6)],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;