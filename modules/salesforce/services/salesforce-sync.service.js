function a135_0x3cee(_0x3259c8,_0x4a7485){const _0x27a9cc=a135_0x38ad();return a135_0x3cee=function(_0x4bb281,_0x22704d){_0x4bb281=_0x4bb281-0x1d2;let _0x38ada1=_0x27a9cc[_0x4bb281];return _0x38ada1;},a135_0x3cee(_0x3259c8,_0x4a7485);}const a135_0x3e26ec=a135_0x3cee;(function(_0x285668,_0x1d6e66){const _0x5db8b8=a135_0x3cee,_0x1ecba2=_0x285668();while(!![]){try{const _0x26f048=-parseInt(_0x5db8b8(0x20f))/0x1+-parseInt(_0x5db8b8(0x209))/0x2*(parseInt(_0x5db8b8(0x1e4))/0x3)+-parseInt(_0x5db8b8(0x1ff))/0x4*(parseInt(_0x5db8b8(0x1e1))/0x5)+-parseInt(_0x5db8b8(0x21b))/0x6+parseInt(_0x5db8b8(0x1f5))/0x7+-parseInt(_0x5db8b8(0x1fd))/0x8*(parseInt(_0x5db8b8(0x1f7))/0x9)+parseInt(_0x5db8b8(0x1f6))/0xa;if(_0x26f048===_0x1d6e66)break;else _0x1ecba2['push'](_0x1ecba2['shift']());}catch(_0x1747f1){_0x1ecba2['push'](_0x1ecba2['shift']());}}}(a135_0x38ad,0xdea29));function a135_0x38ad(){const _0x364b05=['155702vLbUTx','fromRepositoryRecord','stringify','getRemoteStateAttachmentId','replace','FLOSUM_GIT_NAMESPACE','1019367SHINRi','salesforceService','getComponents','GET_WAITING_REPOSITORIES_QUERY','patchObject','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','length','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','FLOSUM_NAMESPACE','catch','1229814zKOAMg','\x0a\x20\x20\x20\x20\x20\x20','GET_REPOSITORY_BY_NAME_QUERY','fromBranchRecord','Attachment','function','objectId','../../shared/utils','../dto/flosum-repository-sync.dto','SalesforceNotFoundError','__esModule','Branch\x20with\x20Id\x20','Git_Settings__c','salesforceQuery','constructor','./salesforce.service','getOwnPropertyDescriptor','search','%id%','../../../constants','GET_BRANCH_QUERY','disableSync','getRepositoryRecordByName','setStatus','SalesforceService','../../../constants/errors','query','records','../errors/not-found.error','../queries','2718640FAhZWf','repositoryId','getAttachmentId','6QsUHAD','Branch\x20','__metadata','./salesforce-query.service','ERR_INVALID_ATTACHMENT_ID','text/plain','\x20not\x20found\x20on\x20salesforce','GET_REPOSITORY_QUERY','object','getBranchRecord','SalesforceSyncService','GET_WAITING_BRANCHES_QUERY','defineProperty','typedi','Service','GET_COMPONENTS_QUERY','decorate','7241017YHHbIx','37006530iLeqHE','9FcyoHI','getRepositoryRecord','getComponentsFromRepository','GET_BRANCH_BY_NAME_QUERY','objectType','FlosumRepositorySyncDto','6495592DXfPFg','getRepositoryRecords','12veCIBy','getBranchComponents','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','%name%','encodeBase64','(((.+)+)+)+$','map','__decorate','Repository\x20','createObject'];a135_0x38ad=function(){return _0x364b05;};return a135_0x38ad();}const a135_0x22704d=function(){let _0x23c30b=!![];return function(_0x26120f,_0x563f10){const _0x214732=_0x23c30b?function(){if(_0x563f10){const _0x3dd3b8=_0x563f10['apply'](_0x26120f,arguments);return _0x563f10=null,_0x3dd3b8;}}:function(){};return _0x23c30b=![],_0x214732;};}(),a135_0x4bb281=a135_0x22704d(this,function(){const _0x2ccc94=a135_0x3cee;return a135_0x4bb281['toString']()[_0x2ccc94(0x1d4)](_0x2ccc94(0x204))['toString']()[_0x2ccc94(0x229)](a135_0x4bb281)[_0x2ccc94(0x1d4)]('(((.+)+)+)+$');});a135_0x4bb281();'use strict';var __decorate=this&&this[a135_0x3e26ec(0x206)]||function(_0x3acdee,_0x15cd92,_0xc2b116,_0x41cba4){const _0x25514a=a135_0x3e26ec;var _0x378602=arguments[_0x25514a(0x215)],_0x1d9dc0=_0x378602<0x3?_0x15cd92:_0x41cba4===null?_0x41cba4=Object[_0x25514a(0x1d3)](_0x15cd92,_0xc2b116):_0x41cba4,_0x46c5f9;if(typeof Reflect===_0x25514a(0x1ec)&&typeof Reflect['decorate']===_0x25514a(0x220))_0x1d9dc0=Reflect[_0x25514a(0x1f4)](_0x3acdee,_0x15cd92,_0xc2b116,_0x41cba4);else{for(var _0x3750f4=_0x3acdee[_0x25514a(0x215)]-0x1;_0x3750f4>=0x0;_0x3750f4--)if(_0x46c5f9=_0x3acdee[_0x3750f4])_0x1d9dc0=(_0x378602<0x3?_0x46c5f9(_0x1d9dc0):_0x378602>0x3?_0x46c5f9(_0x15cd92,_0xc2b116,_0x1d9dc0):_0x46c5f9(_0x15cd92,_0xc2b116))||_0x1d9dc0;}return _0x378602>0x3&&_0x1d9dc0&&Object[_0x25514a(0x1f0)](_0x15cd92,_0xc2b116,_0x1d9dc0),_0x1d9dc0;},__metadata=this&&this[a135_0x3e26ec(0x1e6)]||function(_0x289894,_0x110995){const _0x58be61=a135_0x3e26ec;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x58be61(0x220))return Reflect['metadata'](_0x289894,_0x110995);};Object[a135_0x3e26ec(0x1f0)](exports,a135_0x3e26ec(0x225),{'value':!![]}),exports[a135_0x3e26ec(0x1ee)]=void 0x0;const typedi_1=require(a135_0x3e26ec(0x1f1)),constants_1=require(a135_0x3e26ec(0x1d6)),errors_1=require(a135_0x3e26ec(0x1dc)),utils_1=require(a135_0x3e26ec(0x222)),flosum_repository_sync_dto_1=require(a135_0x3e26ec(0x223)),not_found_error_1=require(a135_0x3e26ec(0x1df)),queries_1=require(a135_0x3e26ec(0x1e0)),salesforce_query_service_1=require(a135_0x3e26ec(0x1e7)),salesforce_service_1=require(a135_0x3e26ec(0x1d2));let SalesforceSyncService=class SalesforceSyncService{constructor(_0x992f2,_0x7b5053){this['salesforceQuery']=_0x992f2,this['salesforceService']=_0x7b5053;}async[a135_0x3e26ec(0x211)](_0x5658d8){const _0x28c541=a135_0x3e26ec;var _0x14b761;const _0x237ec2=await this[_0x28c541(0x228)]['query'](_0x5658d8),_0x56c82a=[];for(const _0x48b122 of _0x237ec2){const _0x374396=(_0x14b761=_0x48b122[constants_1[_0x28c541(0x219)]+'Components__r'])===null||_0x14b761===void 0x0?void 0x0:_0x14b761[_0x28c541(0x1de)];_0x374396&&_0x374396[_0x28c541(0x215)]&&_0x56c82a['push'](_0x374396[0x0]['Id']);}return _0x56c82a;}async[a135_0x3e26ec(0x1fe)](){const _0x5731bc=a135_0x3e26ec,_0x148b9b=await this[_0x5731bc(0x228)][_0x5731bc(0x1dd)](queries_1[_0x5731bc(0x212)]);return _0x148b9b[_0x5731bc(0x205)](_0x400692=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x5731bc(0x20a)](_0x400692));}async['getBranchRecords'](){const _0x228d38=a135_0x3e26ec,_0x4fb785=await this['salesforceQuery'][_0x228d38(0x1dd)](queries_1[_0x228d38(0x1ef)]);return _0x4fb785[_0x228d38(0x205)](_0x4a887d=>flosum_repository_sync_dto_1['FlosumRepositorySyncDto']['fromBranchRecord'](_0x4a887d));}async[a135_0x3e26ec(0x1f8)](_0x2508f3){const _0x59b73b=a135_0x3e26ec,_0x5aaed2=await this[_0x59b73b(0x228)][_0x59b73b(0x1dd)](queries_1[_0x59b73b(0x1eb)][_0x59b73b(0x20d)](_0x59b73b(0x1d5),_0x2508f3));if(_0x5aaed2[_0x59b73b(0x215)]===0x0)throw new not_found_error_1[(_0x59b73b(0x224))]('Repository\x20with\x20Id\x20'+_0x2508f3+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x59b73b(0x1fc)]['fromRepositoryRecord'](_0x5aaed2[0x0]);}async[a135_0x3e26ec(0x1ed)](_0xa76463){const _0x32822d=a135_0x3e26ec,_0x1510cc=await this[_0x32822d(0x228)]['query'](queries_1[_0x32822d(0x1d7)][_0x32822d(0x20d)]('%id%',_0xa76463));if(_0x1510cc[_0x32822d(0x215)]===0x0)throw new not_found_error_1[(_0x32822d(0x224))](_0x32822d(0x226)+_0xa76463+_0x32822d(0x1ea));return flosum_repository_sync_dto_1[_0x32822d(0x1fc)][_0x32822d(0x21e)](_0x1510cc[0x0]);}async['getBranchRecordByName'](_0x12b16a){const _0x3eed91=a135_0x3e26ec,_0x52bbbc=await this['salesforceQuery']['query'](queries_1[_0x3eed91(0x1fa)]['replace']('%name%',_0x12b16a));if(_0x52bbbc['length']===0x0)throw new not_found_error_1['SalesforceNotFoundError'](_0x3eed91(0x1e5)+_0x12b16a+'\x20not\x20found\x20on\x20salesforce');return flosum_repository_sync_dto_1[_0x3eed91(0x1fc)][_0x3eed91(0x21e)](_0x52bbbc[0x0]);}async[a135_0x3e26ec(0x1d9)](_0x11de3b){const _0x2e9d87=a135_0x3e26ec,_0x3d8349=await this['salesforceQuery'][_0x2e9d87(0x1dd)](queries_1[_0x2e9d87(0x21d)][_0x2e9d87(0x20d)](_0x2e9d87(0x202),_0x11de3b));if(_0x3d8349[_0x2e9d87(0x215)]===0x0)throw new not_found_error_1[(_0x2e9d87(0x224))](_0x2e9d87(0x207)+_0x11de3b+_0x2e9d87(0x1ea));return flosum_repository_sync_dto_1[_0x2e9d87(0x1fc)][_0x2e9d87(0x20a)](_0x3d8349[0x0]);}async[a135_0x3e26ec(0x1f9)](_0x8f579a){const _0x509659=a135_0x3e26ec,_0x20b50b=_0x509659(0x21c)+queries_1[_0x509659(0x1f3)]+_0x509659(0x216)+_0x8f579a+'\x27';return this[_0x509659(0x211)](_0x20b50b);}async[a135_0x3e26ec(0x200)](_0x496a4c){const _0x56c9c9=a135_0x3e26ec,_0x36eae8=_0x56c9c9(0x218)+queries_1['GET_COMPONENTS_QUERY']+_0x56c9c9(0x214)+_0x496a4c+'\x27';return this['getComponents'](_0x36eae8);}async['getAttachmentId'](_0x42b156){const _0x767439=a135_0x3e26ec;var _0x1e2933;const _0x1665ad=queries_1[_0x767439(0x217)][_0x767439(0x20d)]('%parentId%',_0x42b156[_0x767439(0x221)])[_0x767439(0x20d)](_0x767439(0x202),_0x42b156[_0x767439(0x1e2)]?constants_1[_0x767439(0x201)]:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']),_0x1b5930=await this[_0x767439(0x228)][_0x767439(0x1dd)](_0x1665ad),_0x14371c=(_0x1e2933=_0x1b5930[0x0])===null||_0x1e2933===void 0x0?void 0x0:_0x1e2933['Id'];if(!_0x14371c)throw new Error(errors_1[_0x767439(0x1e8)]);return _0x14371c;}async['getRemoteStateAttachmentId'](_0x3ad501){const _0x4f63c0=a135_0x3e26ec;let _0x447a14=await this[_0x4f63c0(0x1e3)](_0x3ad501)[_0x4f63c0(0x21a)](()=>null);return!_0x447a14&&(_0x447a14=await this[_0x4f63c0(0x210)][_0x4f63c0(0x208)]('Attachment',{'Body':utils_1['encodeBase64']('{}'),'ParentId':_0x3ad501[_0x4f63c0(0x221)],'ContentType':_0x4f63c0(0x1e9),'Name':_0x3ad501[_0x4f63c0(0x1e2)]?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1['SYNC_ATTACHMENT_FOR_BRANCH_NAME']})),_0x447a14;}async['updateRemoteState'](_0x1c8249,_0x2ab473){const _0x4908ce=a135_0x3e26ec,_0x49f1fc=await this[_0x4908ce(0x20c)](_0x1c8249);await this[_0x4908ce(0x210)][_0x4908ce(0x213)](_0x4908ce(0x21f),_0x49f1fc,{'Body':utils_1[_0x4908ce(0x203)](JSON[_0x4908ce(0x20b)](_0x2ab473))});}async[a135_0x3e26ec(0x1da)](_0x1d2416,_0xd1c663){const _0x7d1266=a135_0x3e26ec;await this[_0x7d1266(0x210)][_0x7d1266(0x213)](_0x1d2416[_0x7d1266(0x1fb)],_0x1d2416['objectId'],{[constants_1[_0x7d1266(0x20e)]+'Synchronization_Status__c']:_0xd1c663});}async[a135_0x3e26ec(0x1d8)](_0x273a0c){const _0x3afbf8=a135_0x3e26ec;await this['salesforceService'][_0x3afbf8(0x213)](constants_1[_0x3afbf8(0x20e)]+_0x3afbf8(0x227),_0x273a0c,{[constants_1[_0x3afbf8(0x20e)]+'Sync_In_Progress__c']:![]});}};SalesforceSyncService=__decorate([typedi_1[a135_0x3e26ec(0x1f2)](),__metadata('design:paramtypes',[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1[a135_0x3e26ec(0x1db)]])],SalesforceSyncService),exports[a135_0x3e26ec(0x1ee)]=SalesforceSyncService;