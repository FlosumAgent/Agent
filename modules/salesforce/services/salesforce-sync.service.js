const a112_0x3fba62=a112_0xb4a9;(function(_0xeb359c,_0x217110){const _0x3f58a6=a112_0xb4a9,_0x60c287=_0xeb359c();while(!![]){try{const _0x16100a=parseInt(_0x3f58a6(0x1aa))/0x1+-parseInt(_0x3f58a6(0x199))/0x2*(-parseInt(_0x3f58a6(0x17c))/0x3)+-parseInt(_0x3f58a6(0x1b1))/0x4+-parseInt(_0x3f58a6(0x185))/0x5+parseInt(_0x3f58a6(0x1a1))/0x6*(-parseInt(_0x3f58a6(0x1ab))/0x7)+-parseInt(_0x3f58a6(0x193))/0x8*(parseInt(_0x3f58a6(0x19e))/0x9)+-parseInt(_0x3f58a6(0x198))/0xa*(-parseInt(_0x3f58a6(0x177))/0xb);if(_0x16100a===_0x217110)break;else _0x60c287['push'](_0x60c287['shift']());}catch(_0x523a73){_0x60c287['push'](_0x60c287['shift']());}}}(a112_0x5320,0xb6a45));const a112_0x732a9c=function(){let _0x396763=!![];return function(_0x588769,_0xbf17f9){const _0x44a4e1=_0x396763?function(){if(_0xbf17f9){const _0x2b8950=_0xbf17f9['apply'](_0x588769,arguments);return _0xbf17f9=null,_0x2b8950;}}:function(){};return _0x396763=![],_0x44a4e1;};}(),a112_0x2321ea=a112_0x732a9c(this,function(){const _0x254f53=a112_0xb4a9;return a112_0x2321ea[_0x254f53(0x17b)]()[_0x254f53(0x1a3)](_0x254f53(0x1a5))['toString']()[_0x254f53(0x192)](a112_0x2321ea)['search'](_0x254f53(0x1a5));});a112_0x2321ea();'use strict';var __decorate=this&&this[a112_0x3fba62(0x1c0)]||function(_0x4e53c5,_0x390fc8,_0x1fc87b,_0x1eab93){const _0x5593cc=a112_0x3fba62;var _0x24cc21=arguments[_0x5593cc(0x1ba)],_0x104d06=_0x24cc21<0x3?_0x390fc8:_0x1eab93===null?_0x1eab93=Object[_0x5593cc(0x19d)](_0x390fc8,_0x1fc87b):_0x1eab93,_0x290c0d;if(typeof Reflect===_0x5593cc(0x17e)&&typeof Reflect[_0x5593cc(0x179)]==='function')_0x104d06=Reflect[_0x5593cc(0x179)](_0x4e53c5,_0x390fc8,_0x1fc87b,_0x1eab93);else{for(var _0x134236=_0x4e53c5[_0x5593cc(0x1ba)]-0x1;_0x134236>=0x0;_0x134236--)if(_0x290c0d=_0x4e53c5[_0x134236])_0x104d06=(_0x24cc21<0x3?_0x290c0d(_0x104d06):_0x24cc21>0x3?_0x290c0d(_0x390fc8,_0x1fc87b,_0x104d06):_0x290c0d(_0x390fc8,_0x1fc87b))||_0x104d06;}return _0x24cc21>0x3&&_0x104d06&&Object[_0x5593cc(0x182)](_0x390fc8,_0x1fc87b,_0x104d06),_0x104d06;},__metadata=this&&this['__metadata']||function(_0x11660f,_0x3aab2c){const _0x5f2708=a112_0x3fba62;if(typeof Reflect===_0x5f2708(0x17e)&&typeof Reflect[_0x5f2708(0x187)]===_0x5f2708(0x1ac))return Reflect[_0x5f2708(0x187)](_0x11660f,_0x3aab2c);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SalesforceSyncService']=void 0x0;function a112_0xb4a9(_0x35c7cd,_0x17775f){const _0xb4fcba=a112_0x5320();return a112_0xb4a9=function(_0x2321ea,_0x732a9c){_0x2321ea=_0x2321ea-0x176;let _0x5320a8=_0xb4fcba[_0x2321ea];return _0x5320a8;},a112_0xb4a9(_0x35c7cd,_0x17775f);}const typedi_1=require(a112_0x3fba62(0x1b3)),constants_1=require('../../../constants'),errors_1=require('../../../constants/errors'),utils_1=require(a112_0x3fba62(0x183)),flosum_repository_sync_dto_1=require('../dto/flosum-repository-sync.dto'),queries_1=require(a112_0x3fba62(0x186)),salesforce_query_service_1=require(a112_0x3fba62(0x195)),salesforce_service_1=require(a112_0x3fba62(0x19a));function a112_0x5320(){const _0x4a688e=['1490431KdUdxO','48958zHPouc','function','objectId','GET_ATTACHMENT_BY_PARENT_ID_AND_NAME_QUERY','SYNC_ATTACHMENT_FOR_REPOSITORY_NAME','fromBranchRecord','1244856RdviqT','catch','typedi','replace','Attachment','getRepositoryRecord','getComponentsFromRepository','GET_WAITING_BRANCHES_QUERY','query','length','%id%','Components__r','\x0a\x20\x20\x20\x20\x20\x20\x20\x20','GET_COMPONENTS_QUERY','fromRepositoryRecord','__decorate','setStatus','GET_REPOSITORY_QUERY','66SFhkVp','records','decorate','FLOSUM_NAMESPACE','toString','3VwfNHa','push','object','text/plain','\x0a\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Repository__c\x20=\x27','getComponents','defineProperty','../../shared/utils','salesforceQuery','3057895OZPczp','../queries','metadata','SYNC_ATTACHMENT_FOR_BRANCH_NAME','getBranchComponents','patchObject','getRemoteStateAttachmentId','FlosumRepositorySyncDto','Service','repositoryId','GET_BRANCH_QUERY','getAttachmentId','design:paramtypes','constructor','1342392FZxSoL','\x0a\x20\x20\x20\x20\x20\x20','./salesforce-query.service','salesforceService','FLOSUM_GIT_NAMESPACE','3751880ohvjgO','82134iQteaB','./salesforce.service','%name%','Sync_In_Progress__c','getOwnPropertyDescriptor','72bSDKLy','stringify','map','660HyBFfW','updateRemoteState','search','Synchronization_Status__c','(((.+)+)+)+$','\x0a\x20\x20\x20\x20\x20\x20\x20\x20WHERE\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20%flosum_namespace%Branch__c\x20=\x20\x27','objectType','Git_Settings__c','disableSync'];a112_0x5320=function(){return _0x4a688e;};return a112_0x5320();}let SalesforceSyncService=class SalesforceSyncService{constructor(_0xc8d272,_0xf79268){const _0x3acc54=a112_0x3fba62;this[_0x3acc54(0x184)]=_0xc8d272,this['salesforceService']=_0xf79268;}async[a112_0x3fba62(0x181)](_0x243df0){const _0x1a7e3f=a112_0x3fba62,_0x223429=await this['salesforceQuery']['query'](_0x243df0),_0x35d5b9=[];for(const _0x2b810f of _0x223429){const _0x5ef6b0=_0x2b810f[constants_1[_0x1a7e3f(0x17a)]+_0x1a7e3f(0x1bc)][_0x1a7e3f(0x178)][0x0];_0x35d5b9[_0x1a7e3f(0x17d)](_0x5ef6b0['Id']);}return _0x35d5b9;}async['getRepositoryRecords'](){const _0x3e9589=a112_0x3fba62,_0x9fb69b=await this['salesforceQuery'][_0x3e9589(0x1b9)](queries_1['GET_WAITING_REPOSITORIES_QUERY']);return _0x9fb69b[_0x3e9589(0x1a0)](_0x425f3e=>flosum_repository_sync_dto_1[_0x3e9589(0x18c)][_0x3e9589(0x1bf)](_0x425f3e));}async['getBranchRecords'](){const _0x454ff8=a112_0x3fba62,_0x80881a=await this['salesforceQuery'][_0x454ff8(0x1b9)](queries_1[_0x454ff8(0x1b8)]);return _0x80881a[_0x454ff8(0x1a0)](_0x30b069=>flosum_repository_sync_dto_1[_0x454ff8(0x18c)][_0x454ff8(0x1b0)](_0x30b069));}async[a112_0x3fba62(0x1b6)](_0x5a716d){const _0x182502=a112_0x3fba62,_0x2c4302=await this[_0x182502(0x184)][_0x182502(0x1b9)](queries_1[_0x182502(0x176)][_0x182502(0x1b4)](_0x182502(0x1bb),_0x5a716d));return flosum_repository_sync_dto_1[_0x182502(0x18c)][_0x182502(0x1bf)](_0x2c4302[0x0]);}async['getBranchRecord'](_0x72684f){const _0x47cefb=a112_0x3fba62,_0x585b97=await this['salesforceQuery'][_0x47cefb(0x1b9)](queries_1[_0x47cefb(0x18f)][_0x47cefb(0x1b4)](_0x47cefb(0x1bb),_0x72684f));return flosum_repository_sync_dto_1['FlosumRepositorySyncDto'][_0x47cefb(0x1b0)](_0x585b97[0x0]);}async[a112_0x3fba62(0x1b7)](_0x5c5b9c){const _0x5119be=a112_0x3fba62,_0x121906=_0x5119be(0x194)+queries_1[_0x5119be(0x1be)]+_0x5119be(0x180)+_0x5c5b9c+'\x27';return this[_0x5119be(0x181)](_0x121906);}async[a112_0x3fba62(0x189)](_0x465f01){const _0x423f04=a112_0x3fba62,_0x548d7b=_0x423f04(0x1bd)+queries_1[_0x423f04(0x1be)]+_0x423f04(0x1a6)+_0x465f01+'\x27';return this[_0x423f04(0x181)](_0x548d7b);}async[a112_0x3fba62(0x190)](_0x1c9d78){const _0x5ac8fc=a112_0x3fba62;var _0x4bab0a;const _0x4c66bf=queries_1[_0x5ac8fc(0x1ae)][_0x5ac8fc(0x1b4)]('%parentId%',_0x1c9d78[_0x5ac8fc(0x1ad)])[_0x5ac8fc(0x1b4)](_0x5ac8fc(0x19b),_0x1c9d78['repositoryId']?constants_1['SYNC_ATTACHMENT_FOR_REPOSITORY_NAME']:constants_1[_0x5ac8fc(0x188)]),_0x3259b7=await this['salesforceQuery'][_0x5ac8fc(0x1b9)](_0x4c66bf),_0x53110e=(_0x4bab0a=_0x3259b7[0x0])===null||_0x4bab0a===void 0x0?void 0x0:_0x4bab0a['Id'];if(!_0x53110e)throw new Error(errors_1['ERR_INVALID_ATTACHMENT_ID']);return _0x53110e;}async['getRemoteStateAttachmentId'](_0x4268c5){const _0x2a84aa=a112_0x3fba62;let _0x1f4067=await this[_0x2a84aa(0x190)](_0x4268c5)[_0x2a84aa(0x1b2)](()=>null);return!_0x1f4067&&(_0x1f4067=await this['salesforceService']['createObject']('Attachment',{'Body':(0x0,utils_1['encodeBase64'])('{}'),'ParentId':_0x4268c5[_0x2a84aa(0x1ad)],'ContentType':_0x2a84aa(0x17f),'Name':_0x4268c5[_0x2a84aa(0x18e)]?constants_1[_0x2a84aa(0x1af)]:constants_1[_0x2a84aa(0x188)]})),_0x1f4067;}async[a112_0x3fba62(0x1a2)](_0x45d741,_0x5f384b){const _0x5e1c2d=a112_0x3fba62,_0x51ce0e=await this[_0x5e1c2d(0x18b)](_0x45d741);await this[_0x5e1c2d(0x196)]['patchObject'](_0x5e1c2d(0x1b5),_0x51ce0e,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x5e1c2d(0x19f)](_0x5f384b))});}async[a112_0x3fba62(0x1c1)](_0xdfe463,_0x5d61ec){const _0x405f1a=a112_0x3fba62;await this[_0x405f1a(0x196)][_0x405f1a(0x18a)](_0xdfe463[_0x405f1a(0x1a7)],_0xdfe463[_0x405f1a(0x1ad)],{[constants_1[_0x405f1a(0x197)]+_0x405f1a(0x1a4)]:_0x5d61ec});}async[a112_0x3fba62(0x1a9)](_0x2a1bbc){const _0x44740c=a112_0x3fba62;await this[_0x44740c(0x196)][_0x44740c(0x18a)](constants_1['FLOSUM_GIT_NAMESPACE']+_0x44740c(0x1a8),_0x2a1bbc,{[constants_1[_0x44740c(0x197)]+_0x44740c(0x19c)]:![]});}};SalesforceSyncService=__decorate([(0x0,typedi_1[a112_0x3fba62(0x18d)])(),__metadata(a112_0x3fba62(0x191),[salesforce_query_service_1['SalesforceQueryService'],salesforce_service_1['SalesforceService']])],SalesforceSyncService),exports['SalesforceSyncService']=SalesforceSyncService;