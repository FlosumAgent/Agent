const a109_0x1cda=['GET_COMPONENT_HISTORIES_BY_IDS','logger','name','COMPONENTS_PER_REQUEST','length','splice','1489594vzbnsB','filename','../queries','constructor','components','fileName','SalesforceQueryService','281FWWQrS','all','run','166763GIQsla','2551EmBVwq','retrieveAttachment','ids','retrieveComponentIdsFromHistoryIds','1245961uTYznt','ParentId','%ids%','base64','SalesforceRetrieverService','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','query','retrieveComponents','then','manually\x20retrieved\x20%d/%d\x20components','../../../core','join','test','info','%parent_ids%','map','9zpSZUh','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','799jOIRMJ','__esModule','attachmentId','FlosumComponentHistoryDto','retrieveLastComponents','replace','52oENbZp','./salesforce-query.service','log','87272ROFrQe','toString','COMPONENTS_PER_QUERY','fromSalesforce','find','1234eXVJGv','return\x20/\x22\x20+\x20this\x20+\x20\x22/','114369xbNQLK','__importDefault','typedi','salesforceService','apply','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','Name','push','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','defineProperty'];const a109_0x19e050=a109_0x3a1e;(function(_0x3b9772,_0x13e334){const _0x2f5221=a109_0x3a1e;while(!![]){try{const _0x2da4d5=-parseInt(_0x2f5221(0x118))+parseInt(_0x2f5221(0x10e))+parseInt(_0x2f5221(0x115))*parseInt(_0x2f5221(0x119))+parseInt(_0x2f5221(0x11d))+parseInt(_0x2f5221(0xfe))*parseInt(_0x2f5221(0xec))+parseInt(_0x2f5221(0xee))*parseInt(_0x2f5221(0xfc))+-parseInt(_0x2f5221(0xf4))*parseInt(_0x2f5221(0xf7));if(_0x2da4d5===_0x13e334)break;else _0x3b9772['push'](_0x3b9772['shift']());}catch(_0x5b7c2d){_0x3b9772['push'](_0x3b9772['shift']());}}}(a109_0x1cda,0xba38e));const a109_0x594d1a=function(){let _0x17d6c2=!![];return function(_0x342b04,_0x49dde7){const _0x84097c=_0x17d6c2?function(){const _0x23a5cc=a109_0x3a1e;if(_0x49dde7){const _0x3acc11=_0x49dde7[_0x23a5cc(0x102)](_0x342b04,arguments);return _0x49dde7=null,_0x3acc11;}}:function(){};return _0x17d6c2=![],_0x84097c;};}(),a109_0x4e0bdb=a109_0x594d1a(this,function(){const _0x39fc4d=function(){const _0x992c7c=a109_0x3a1e,_0x284b6a=_0x39fc4d[_0x992c7c(0x111)](_0x992c7c(0xfd))()[_0x992c7c(0x111)](_0x992c7c(0x122));return!_0x284b6a[_0x992c7c(0x129)](a109_0x4e0bdb);};return _0x39fc4d();});a109_0x4e0bdb();'use strict';var __importDefault=this&&this[a109_0x19e050(0xff)]||function(_0x4e26c0){const _0x24960a=a109_0x19e050;return _0x4e26c0&&_0x4e26c0[_0x24960a(0xef)]?_0x4e26c0:{'default':_0x4e26c0};};Object[a109_0x19e050(0x107)](exports,a109_0x19e050(0xef),{'value':!![]}),exports[a109_0x19e050(0x121)]=void 0x0;const core_1=require(a109_0x19e050(0x127)),typedi_1=__importDefault(require(a109_0x19e050(0x100))),salesforce_query_service_1=require(a109_0x19e050(0xf5)),queries_1=require(a109_0x19e050(0x110)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x228f9d){const _0x342df0=a109_0x19e050;this['salesforceService']=_0x228f9d,this[_0x342df0(0x109)]=new core_1['Logger'](SalesforceRetrieverService[_0x342df0(0x10a)]),this[_0x342df0(0x10b)]=0xbb8,this[_0x342df0(0xf9)]=0x1f4;}async[a109_0x19e050(0x11c)](_0x56503d){const _0x54843f=a109_0x19e050;this[_0x54843f(0x109)][_0x54843f(0x12a)](_0x54843f(0xed),_0x56503d[_0x54843f(0x10c)]);const _0x57a210=typedi_1['default']['get'](salesforce_query_service_1[_0x54843f(0x114)]),_0x42b7e9=_0x56503d[_0x54843f(0xeb)](_0x5de938=>'\x27'+_0x5de938+'\x27'),_0x9c0d98=[];while(_0x42b7e9[_0x54843f(0x10c)]){const _0x452017=_0x42b7e9[_0x54843f(0x10d)](0x0,this[_0x54843f(0xf9)]),_0x1fbb9b=_0x57a210[_0x54843f(0x123)](queries_1[_0x54843f(0x106)][_0x54843f(0xf3)](_0x54843f(0x12b),_0x452017['join']())),_0x7beb73=_0x57a210[_0x54843f(0x123)](queries_1[_0x54843f(0x108)]['replace'](_0x54843f(0x11f),_0x452017[_0x54843f(0x128)]()))[_0x54843f(0x125)](_0x31a5a5=>_0x31a5a5[_0x54843f(0xeb)](_0x97c1fd=>flosum_component_history_dto_1[_0x54843f(0xf1)][_0x54843f(0xfa)](_0x97c1fd))),[_0x31e26e,_0xd5ac1a]=await Promise[_0x54843f(0x116)]([_0x1fbb9b,_0x7beb73]);for(const _0x2c763c of _0xd5ac1a){const _0x51e953=_0x31e26e[_0x54843f(0xfb)](_0x4d8205=>_0x4d8205[_0x54843f(0x11e)]===_0x2c763c['id']);_0x9c0d98[_0x54843f(0x105)]({'fileType':_0x51e953[_0x54843f(0x104)],'fileName':_0x2c763c[_0x54843f(0x10f)],'attachmentId':_0x51e953['Id']});}}return _0x9c0d98;}async[a109_0x19e050(0xf2)](_0xc2352c){const _0x291f98=a109_0x19e050,_0x4f5379=await this['retrieveComponentIdsFromHistoryIds'](_0xc2352c);this[_0x291f98(0x109)][_0x291f98(0x12a)]('manually\x20retrieving\x20components\x20from\x20salesforce');const _0x58d500=[];for(const _0x2387d8 of _0x4f5379){const _0x1190be=await this[_0x291f98(0x101)][_0x291f98(0x11a)](_0x2387d8[_0x291f98(0xf0)],!![]);_0x58d500[_0x291f98(0x105)]({'body':_0x1190be[_0x291f98(0xf8)](_0x291f98(0x120)),'fileName':_0x2387d8[_0x291f98(0x113)],'fileType':_0x2387d8['fileType']}),this[_0x291f98(0x109)][_0x291f98(0x12a)](_0x291f98(0x126),_0x58d500['length'],_0xc2352c[_0x291f98(0x10c)]);}return _0x58d500;}async[a109_0x19e050(0x117)](_0x44f43){const _0x826cfb=a109_0x19e050,_0x1c11aa=[..._0x44f43],_0x4e5be0=[],_0x3f6c7c=[];while(_0x1c11aa[_0x826cfb(0x10c)]){const _0x3a0d74=_0x1c11aa[_0x826cfb(0x10d)](0x0,this['COMPONENTS_PER_REQUEST']),_0x57f7cd=await this[_0x826cfb(0x101)][_0x826cfb(0x124)](_0x3a0d74);_0x3a0d74[_0x826cfb(0x10c)]!==_0x57f7cd[_0x826cfb(0x11b)][_0x826cfb(0x10c)]?(_0x1c11aa[_0x826cfb(0x105)](..._0x57f7cd['ids']),_0x4e5be0[_0x826cfb(0x105)](..._0x57f7cd[_0x826cfb(0x112)])):_0x3f6c7c[_0x826cfb(0x105)](..._0x3a0d74),this[_0x826cfb(0x109)][_0x826cfb(0xf6)](_0x826cfb(0x103),_0x44f43[_0x826cfb(0x10c)]-_0x1c11aa['length'],_0x44f43[_0x826cfb(0x10c)]);}if(_0x3f6c7c[_0x826cfb(0x10c)]){const _0xe91917=await this[_0x826cfb(0xf2)](_0x3f6c7c);_0x4e5be0[_0x826cfb(0x105)](..._0xe91917);}return _0x4e5be0;}}function a109_0x3a1e(_0x36fe20,_0x2ac211){return a109_0x3a1e=function(_0x2e933a,_0x4e0bdb){_0x2e933a=_0x2e933a-0xeb;let _0x594d1a=a109_0x1cda[_0x2e933a];return _0x594d1a;},a109_0x3a1e(_0x36fe20,_0x2ac211);}exports[a109_0x19e050(0x121)]=SalesforceRetrieverService;