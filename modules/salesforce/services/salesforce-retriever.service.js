function a134_0x14ef(){const _0xd1bcbf=['fileName','GET_COMPONENT_HISTORIES_BY_IDS','110MpVNWI','3771110dISJDo','toString','ids','join','get','search','retrieveComponentIdsFromHistoryIds','retrieveComponents','manually\x20retrieving\x20components\x20from\x20salesforce','retrieveAttachment','all','apply','../dto/flosum-component-history.dto','log','salesforceService','153RsFKHr','%parent_ids%','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','name','18IMAUVn','info','__importDefault','fromSalesforce','COMPONENTS_PER_QUERY','SalesforceQueryService','307030AUhIMb','find','splice','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','8imfKsG','64935MOMWXJ','base64','__esModule','(((.+)+)+)+$','2807900qJhDfW','map','attachmentId','672252neMIhP','retrieveLastComponents','./salesforce-query.service','Logger','push','690695EANMAp','typedi','../queries','query','FlosumComponentHistoryDto','Name','replace','SalesforceRetrieverService','length','125804HwZEKA','fileType','%ids%','logger','6qRiVVK','filename','default'];a134_0x14ef=function(){return _0xd1bcbf;};return a134_0x14ef();}const a134_0x1004e3=a134_0x4964;(function(_0x2c2d0e,_0x51857e){const _0x5f5b91=a134_0x4964,_0x18b532=_0x2c2d0e();while(!![]){try{const _0x307d3f=-parseInt(_0x5f5b91(0x170))/0x1+parseInt(_0x5f5b91(0x18d))/0x2*(parseInt(_0x5f5b91(0x198))/0x3)+parseInt(_0x5f5b91(0x15f))/0x4+-parseInt(_0x5f5b91(0x167))/0x5*(-parseInt(_0x5f5b91(0x174))/0x6)+parseInt(_0x5f5b91(0x17a))/0x7*(parseInt(_0x5f5b91(0x197))/0x8)+-parseInt(_0x5f5b91(0x189))/0x9*(parseInt(_0x5f5b91(0x193))/0xa)+parseInt(_0x5f5b91(0x179))/0xb*(-parseInt(_0x5f5b91(0x162))/0xc);if(_0x307d3f===_0x51857e)break;else _0x18b532['push'](_0x18b532['shift']());}catch(_0x4d8647){_0x18b532['push'](_0x18b532['shift']());}}}(a134_0x14ef,0x59474));const a134_0x3047fa=function(){let _0x86b6be=!![];return function(_0x50b58b,_0x3e19d8){const _0x55be07=_0x86b6be?function(){const _0x651dac=a134_0x4964;if(_0x3e19d8){const _0x3bb68d=_0x3e19d8[_0x651dac(0x185)](_0x50b58b,arguments);return _0x3e19d8=null,_0x3bb68d;}}:function(){};return _0x86b6be=![],_0x55be07;};}(),a134_0x38a428=a134_0x3047fa(this,function(){const _0x129858=a134_0x4964;return a134_0x38a428[_0x129858(0x17b)]()[_0x129858(0x17f)](_0x129858(0x15e))['toString']()['constructor'](a134_0x38a428)[_0x129858(0x17f)]('(((.+)+)+)+$');});a134_0x38a428();'use strict';var __importDefault=this&&this[a134_0x1004e3(0x18f)]||function(_0x9cfe4e){const _0x5a65d8=a134_0x1004e3;return _0x9cfe4e&&_0x9cfe4e[_0x5a65d8(0x15d)]?_0x9cfe4e:{'default':_0x9cfe4e};};Object['defineProperty'](exports,a134_0x1004e3(0x15d),{'value':!![]}),exports[a134_0x1004e3(0x16e)]=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require(a134_0x1004e3(0x168))),salesforce_query_service_1=require(a134_0x1004e3(0x164)),queries_1=require(a134_0x1004e3(0x169)),flosum_component_history_dto_1=require(a134_0x1004e3(0x186));function a134_0x4964(_0x9bff4e,_0x577a73){const _0x2318b9=a134_0x14ef();return a134_0x4964=function(_0x38a428,_0x3047fa){_0x38a428=_0x38a428-0x15d;let _0x14ef20=_0x2318b9[_0x38a428];return _0x14ef20;},a134_0x4964(_0x9bff4e,_0x577a73);}class SalesforceRetrieverService{constructor(_0x20024d){const _0x41b08e=a134_0x1004e3;this['salesforceService']=_0x20024d,this[_0x41b08e(0x173)]=new core_1[(_0x41b08e(0x165))](SalesforceRetrieverService[_0x41b08e(0x18c)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x41b08e(0x191)]=0x1f4;}async[a134_0x1004e3(0x180)](_0x2af0e1){const _0x1108dd=a134_0x1004e3;this['logger'][_0x1108dd(0x18e)](_0x1108dd(0x196),_0x2af0e1[_0x1108dd(0x16f)]);const _0x66f52b=typedi_1[_0x1108dd(0x176)][_0x1108dd(0x17e)](salesforce_query_service_1[_0x1108dd(0x192)]),_0x1a2704=_0x2af0e1[_0x1108dd(0x160)](_0x2f6522=>'\x27'+_0x2f6522+'\x27'),_0x463834=[];while(_0x1a2704['length']){const _0x41a34b=_0x1a2704[_0x1108dd(0x195)](0x0,this[_0x1108dd(0x191)]),_0x55a542=_0x66f52b[_0x1108dd(0x16a)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x1108dd(0x16d)](_0x1108dd(0x18a),_0x41a34b['join']())),_0x52fd51=_0x66f52b[_0x1108dd(0x16a)](queries_1[_0x1108dd(0x178)][_0x1108dd(0x16d)](_0x1108dd(0x172),_0x41a34b[_0x1108dd(0x17d)]()))['then'](_0x36bc43=>_0x36bc43[_0x1108dd(0x160)](_0x2f77d7=>flosum_component_history_dto_1[_0x1108dd(0x16b)][_0x1108dd(0x190)](_0x2f77d7))),[_0x396872,_0x4bd119]=await Promise[_0x1108dd(0x184)]([_0x55a542,_0x52fd51]);for(const _0x18d170 of _0x4bd119){const _0x40a7d0=_0x396872[_0x1108dd(0x194)](_0x6edf80=>_0x6edf80['ParentId']===_0x18d170['id']);_0x40a7d0&&_0x463834[_0x1108dd(0x166)]({'fileType':_0x40a7d0[_0x1108dd(0x16c)],'fileName':_0x18d170[_0x1108dd(0x175)],'attachmentId':_0x40a7d0['Id']});}}return _0x463834;}async[a134_0x1004e3(0x163)](_0x41e1c2){const _0x14effb=a134_0x1004e3,_0xe80918=await this[_0x14effb(0x180)](_0x41e1c2);this['logger'][_0x14effb(0x18e)](_0x14effb(0x182));const _0x76bc8e=[];for(const _0xe33ad2 of _0xe80918){const _0x43c31d=await this[_0x14effb(0x188)][_0x14effb(0x183)](_0xe33ad2[_0x14effb(0x161)],!![]);_0x76bc8e['push']({'body':_0x43c31d[_0x14effb(0x17b)](_0x14effb(0x199)),'fileName':_0xe33ad2[_0x14effb(0x177)],'fileType':_0xe33ad2[_0x14effb(0x171)]}),this['logger'][_0x14effb(0x18e)]('manually\x20retrieved\x20%d/%d\x20components',_0x76bc8e[_0x14effb(0x16f)],_0x41e1c2[_0x14effb(0x16f)]);}return _0x76bc8e;}async['run'](_0x2cc438){const _0x3afa8a=a134_0x1004e3,_0x1decfe=[..._0x2cc438],_0x3526bf=[],_0x447c96=[];while(_0x1decfe['length']){const _0x47cc7d=_0x1decfe[_0x3afa8a(0x195)](0x0,this['COMPONENTS_PER_REQUEST']),_0x497bf0=await this[_0x3afa8a(0x188)][_0x3afa8a(0x181)](_0x47cc7d);_0x47cc7d['length']!==_0x497bf0[_0x3afa8a(0x17c)][_0x3afa8a(0x16f)]?(_0x1decfe[_0x3afa8a(0x166)](..._0x497bf0[_0x3afa8a(0x17c)]),_0x3526bf['push'](..._0x497bf0['components'])):_0x447c96['push'](..._0x47cc7d),this[_0x3afa8a(0x173)][_0x3afa8a(0x187)](_0x3afa8a(0x18b),_0x2cc438['length']-_0x1decfe[_0x3afa8a(0x16f)],_0x2cc438[_0x3afa8a(0x16f)]);}if(_0x447c96[_0x3afa8a(0x16f)]){const _0x5894e6=await this[_0x3afa8a(0x163)](_0x447c96);_0x3526bf['push'](..._0x5894e6);}return _0x3526bf;}}exports[a134_0x1004e3(0x16e)]=SalesforceRetrieverService;