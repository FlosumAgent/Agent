const a111_0x5dd4ef=a111_0x5b42;(function(_0x5166d8,_0x2e2ea0){const _0x292368=a111_0x5b42,_0x28d682=_0x5166d8();while(!![]){try{const _0x44f16e=-parseInt(_0x292368(0xb9))/0x1+parseInt(_0x292368(0xb3))/0x2+parseInt(_0x292368(0xa7))/0x3+-parseInt(_0x292368(0x94))/0x4*(parseInt(_0x292368(0xc6))/0x5)+parseInt(_0x292368(0xb5))/0x6+parseInt(_0x292368(0xc2))/0x7*(-parseInt(_0x292368(0xc5))/0x8)+parseInt(_0x292368(0xcc))/0x9;if(_0x44f16e===_0x2e2ea0)break;else _0x28d682['push'](_0x28d682['shift']());}catch(_0x56487a){_0x28d682['push'](_0x28d682['shift']());}}}(a111_0x422c,0xe9551));function a111_0x422c(){const _0x442b4b=['1102203tuOGIm','FlosumComponentHistoryDto','run','splice','find','search','ids','%ids%','log','5154583kueVyT','defineProperty','../../../core','16xSqPgT','4685CuZWhN','then','manually\x20retrieving\x20components\x20from\x20salesforce','constructor','Logger','ParentId','25519779hTawat','logger','retrieveComponents','7244ltGUYO','COMPONENTS_PER_REQUEST','fileType','replace','fileName','query','retrieveComponentIdsFromHistoryIds','join','filename','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','__esModule','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','../dto/flosum-component-history.dto','push','get','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','SalesforceQueryService','__importDefault','retrieveLastComponents','3149805wquMZm','map','base64','COMPONENTS_PER_QUERY','fromSalesforce','manually\x20retrieved\x20%d/%d\x20components','SalesforceRetrieverService','toString','info','apply','length','name','343642ykRFYg','%parent_ids%','7021740wrilVz','all','typedi','salesforceService'];a111_0x422c=function(){return _0x442b4b;};return a111_0x422c();}const a111_0xf248e9=function(){let _0x202a12=!![];return function(_0x399d05,_0x2b7ab8){const _0x790e3c=_0x202a12?function(){const _0x3dce9c=a111_0x5b42;if(_0x2b7ab8){const _0x37128d=_0x2b7ab8[_0x3dce9c(0xb0)](_0x399d05,arguments);return _0x2b7ab8=null,_0x37128d;}}:function(){};return _0x202a12=![],_0x790e3c;};}(),a111_0x5bf9e0=a111_0xf248e9(this,function(){const _0x5f042c=a111_0x5b42;return a111_0x5bf9e0[_0x5f042c(0xae)]()[_0x5f042c(0xbe)]('(((.+)+)+)+$')[_0x5f042c(0xae)]()[_0x5f042c(0xc9)](a111_0x5bf9e0)[_0x5f042c(0xbe)]('(((.+)+)+)+$');});a111_0x5bf9e0();'use strict';var __importDefault=this&&this[a111_0x5dd4ef(0xa5)]||function(_0x194732){const _0x71f8c0=a111_0x5dd4ef;return _0x194732&&_0x194732[_0x71f8c0(0x9e)]?_0x194732:{'default':_0x194732};};Object[a111_0x5dd4ef(0xc3)](exports,a111_0x5dd4ef(0x9e),{'value':!![]}),exports[a111_0x5dd4ef(0xad)]=void 0x0;const core_1=require(a111_0x5dd4ef(0xc4)),typedi_1=__importDefault(require(a111_0x5dd4ef(0xb7))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require('../queries'),flosum_component_history_dto_1=require(a111_0x5dd4ef(0xa0));class SalesforceRetrieverService{constructor(_0x260f39){const _0x4a37a3=a111_0x5dd4ef;this[_0x4a37a3(0xb8)]=_0x260f39,this[_0x4a37a3(0xcd)]=new core_1[(_0x4a37a3(0xca))](SalesforceRetrieverService[_0x4a37a3(0xb2)]),this[_0x4a37a3(0x95)]=0xbb8,this[_0x4a37a3(0xaa)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x484515){const _0x328841=a111_0x5dd4ef;this['logger'][_0x328841(0xaf)](_0x328841(0x9d),_0x484515[_0x328841(0xb1)]);const _0x3d9876=typedi_1['default'][_0x328841(0xa2)](salesforce_query_service_1[_0x328841(0xa4)]),_0x2083cb=_0x484515[_0x328841(0xa8)](_0x314a48=>'\x27'+_0x314a48+'\x27'),_0x3b3e05=[];while(_0x2083cb['length']){const _0x55899b=_0x2083cb[_0x328841(0xbc)](0x0,this[_0x328841(0xaa)]),_0x302a08=_0x3d9876[_0x328841(0x99)](queries_1[_0x328841(0xa3)][_0x328841(0x97)](_0x328841(0xb4),_0x55899b[_0x328841(0x9b)]())),_0x3b8238=_0x3d9876[_0x328841(0x99)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS']['replace'](_0x328841(0xc0),_0x55899b['join']()))[_0x328841(0xc7)](_0x46054d=>_0x46054d[_0x328841(0xa8)](_0x2f187b=>flosum_component_history_dto_1[_0x328841(0xba)][_0x328841(0xab)](_0x2f187b))),[_0x38e386,_0x1eee74]=await Promise[_0x328841(0xb6)]([_0x302a08,_0x3b8238]);for(const _0x139a3d of _0x1eee74){const _0x45d84a=_0x38e386[_0x328841(0xbd)](_0x23e1cb=>_0x23e1cb[_0x328841(0xcb)]===_0x139a3d['id']);_0x3b3e05['push']({'fileType':_0x45d84a['Name'],'fileName':_0x139a3d[_0x328841(0x9c)],'attachmentId':_0x45d84a['Id']});}}return _0x3b3e05;}async[a111_0x5dd4ef(0xa6)](_0x2a80c3){const _0x34ed40=a111_0x5dd4ef,_0x126f29=await this[_0x34ed40(0x9a)](_0x2a80c3);this[_0x34ed40(0xcd)][_0x34ed40(0xaf)](_0x34ed40(0xc8));const _0x1ee97d=[];for(const _0xacde57 of _0x126f29){const _0x47d91f=await this[_0x34ed40(0xb8)]['retrieveAttachment'](_0xacde57['attachmentId'],!![]);_0x1ee97d[_0x34ed40(0xa1)]({'body':_0x47d91f[_0x34ed40(0xae)](_0x34ed40(0xa9)),'fileName':_0xacde57[_0x34ed40(0x98)],'fileType':_0xacde57[_0x34ed40(0x96)]}),this['logger'][_0x34ed40(0xaf)](_0x34ed40(0xac),_0x1ee97d[_0x34ed40(0xb1)],_0x2a80c3[_0x34ed40(0xb1)]);}return _0x1ee97d;}async[a111_0x5dd4ef(0xbb)](_0x3f267f){const _0xb2a0f7=a111_0x5dd4ef,_0x17ceb1=[..._0x3f267f],_0x48d91e=[],_0x222776=[];while(_0x17ceb1[_0xb2a0f7(0xb1)]){const _0x1e48a4=_0x17ceb1['splice'](0x0,this[_0xb2a0f7(0x95)]),_0x26d247=await this[_0xb2a0f7(0xb8)][_0xb2a0f7(0xce)](_0x1e48a4);_0x1e48a4[_0xb2a0f7(0xb1)]!==_0x26d247[_0xb2a0f7(0xbf)][_0xb2a0f7(0xb1)]?(_0x17ceb1[_0xb2a0f7(0xa1)](..._0x26d247[_0xb2a0f7(0xbf)]),_0x48d91e[_0xb2a0f7(0xa1)](..._0x26d247['components'])):_0x222776[_0xb2a0f7(0xa1)](..._0x1e48a4),this[_0xb2a0f7(0xcd)][_0xb2a0f7(0xc1)](_0xb2a0f7(0x9f),_0x3f267f[_0xb2a0f7(0xb1)]-_0x17ceb1[_0xb2a0f7(0xb1)],_0x3f267f[_0xb2a0f7(0xb1)]);}if(_0x222776[_0xb2a0f7(0xb1)]){const _0x139419=await this[_0xb2a0f7(0xa6)](_0x222776);_0x48d91e[_0xb2a0f7(0xa1)](..._0x139419);}return _0x48d91e;}}function a111_0x5b42(_0x46db4c,_0x32e0a9){const _0x3c58ab=a111_0x422c();return a111_0x5b42=function(_0x5bf9e0,_0xf248e9){_0x5bf9e0=_0x5bf9e0-0x94;let _0x422cd2=_0x3c58ab[_0x5bf9e0];return _0x422cd2;},a111_0x5b42(_0x46db4c,_0x32e0a9);}exports[a111_0x5dd4ef(0xad)]=SalesforceRetrieverService;