function a111_0x5dbf(){const _0x4b92dc=['%ids%','197trbHEy','length','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','toString','retrieveLastComponents','replace','attachmentId','100MEIAcy','components','join','ids','salesforceService','typedi','COMPONENTS_PER_QUERY','fileName','SalesforceRetrieverService','manually\x20retrieving\x20components\x20from\x20salesforce','default','GET_COMPONENT_HISTORIES_BY_IDS','filename','../../../core','run','fileType','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','push','Name','FlosumComponentHistoryDto','8UPtAmE','get','apply','ParentId','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','3264079twtQya','logger','2390292oRBOWT','name','34985SAADgR','log','502nThJZR','Logger','__esModule','1755980oXIOIK','search','../dto/flosum-component-history.dto','SalesforceQueryService','query','2407383aSfvUQ','1134573jCRYir','info','find','./salesforce-query.service','map','66zmlWDE','COMPONENTS_PER_REQUEST','all'];a111_0x5dbf=function(){return _0x4b92dc;};return a111_0x5dbf();}const a111_0xaabf2f=a111_0x4fdd;(function(_0x3b0cc7,_0x2316eb){const _0x546b5a=a111_0x4fdd,_0x387dff=_0x3b0cc7();while(!![]){try{const _0x94dc82=-parseInt(_0x546b5a(0x92))/0x1*(parseInt(_0x546b5a(0x80))/0x2)+-parseInt(_0x546b5a(0x89))/0x3+parseInt(_0x546b5a(0x99))/0x4*(-parseInt(_0x546b5a(0x7e))/0x5)+-parseInt(_0x546b5a(0x7c))/0x6+-parseInt(_0x546b5a(0x7a))/0x7*(-parseInt(_0x546b5a(0x75))/0x8)+-parseInt(_0x546b5a(0x88))/0x9+-parseInt(_0x546b5a(0x83))/0xa*(-parseInt(_0x546b5a(0x8e))/0xb);if(_0x94dc82===_0x2316eb)break;else _0x387dff['push'](_0x387dff['shift']());}catch(_0x5117de){_0x387dff['push'](_0x387dff['shift']());}}}(a111_0x5dbf,0x3d63d));const a111_0x119347=function(){let _0x58c030=!![];return function(_0x5ee65b,_0x42c697){const _0x27c09c=_0x58c030?function(){const _0x2c2f64=a111_0x4fdd;if(_0x42c697){const _0x15d5b4=_0x42c697[_0x2c2f64(0x77)](_0x5ee65b,arguments);return _0x42c697=null,_0x15d5b4;}}:function(){};return _0x58c030=![],_0x27c09c;};}(),a111_0x3a8cef=a111_0x119347(this,function(){const _0x1dd3b2=a111_0x4fdd;return a111_0x3a8cef[_0x1dd3b2(0x95)]()[_0x1dd3b2(0x84)]('(((.+)+)+)+$')[_0x1dd3b2(0x95)]()['constructor'](a111_0x3a8cef)[_0x1dd3b2(0x84)]('(((.+)+)+)+$');});a111_0x3a8cef();function a111_0x4fdd(_0x26f4c4,_0x9d4d18){const _0x4690ef=a111_0x5dbf();return a111_0x4fdd=function(_0x3a8cef,_0x119347){_0x3a8cef=_0x3a8cef-0x6e;let _0x5dbf58=_0x4690ef[_0x3a8cef];return _0x5dbf58;},a111_0x4fdd(_0x26f4c4,_0x9d4d18);}'use strict';var __importDefault=this&&this['__importDefault']||function(_0x5b67f2){return _0x5b67f2&&_0x5b67f2['__esModule']?_0x5b67f2:{'default':_0x5b67f2};};Object['defineProperty'](exports,a111_0xaabf2f(0x82),{'value':!![]}),exports[a111_0xaabf2f(0xa1)]=void 0x0;const core_1=require(a111_0xaabf2f(0x6e)),typedi_1=__importDefault(require(a111_0xaabf2f(0x9e))),salesforce_query_service_1=require(a111_0xaabf2f(0x8c)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a111_0xaabf2f(0x85));class SalesforceRetrieverService{constructor(_0x10a79f){const _0x286ff6=a111_0xaabf2f;this[_0x286ff6(0x9d)]=_0x10a79f,this[_0x286ff6(0x7b)]=new core_1[(_0x286ff6(0x81))](SalesforceRetrieverService[_0x286ff6(0x7d)]),this[_0x286ff6(0x8f)]=0xbb8,this[_0x286ff6(0x9f)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x50db0e){const _0x2e2a8=a111_0xaabf2f;this[_0x2e2a8(0x7b)]['info'](_0x2e2a8(0x79),_0x50db0e['length']);const _0x4a97a3=typedi_1[_0x2e2a8(0xa3)][_0x2e2a8(0x76)](salesforce_query_service_1[_0x2e2a8(0x86)]),_0x3ca4d4=_0x50db0e['map'](_0x3b3c09=>'\x27'+_0x3b3c09+'\x27'),_0x5da8a4=[];while(_0x3ca4d4[_0x2e2a8(0x93)]){const _0x17946f=_0x3ca4d4['splice'](0x0,this[_0x2e2a8(0x9f)]),_0x368b73=_0x4a97a3['query'](queries_1[_0x2e2a8(0x94)][_0x2e2a8(0x97)]('%parent_ids%',_0x17946f[_0x2e2a8(0x9b)]())),_0x3a65=_0x4a97a3[_0x2e2a8(0x87)](queries_1[_0x2e2a8(0xa4)][_0x2e2a8(0x97)](_0x2e2a8(0x91),_0x17946f[_0x2e2a8(0x9b)]()))['then'](_0x349224=>_0x349224[_0x2e2a8(0x8d)](_0x288871=>flosum_component_history_dto_1[_0x2e2a8(0x74)]['fromSalesforce'](_0x288871))),[_0x5ef8a6,_0x28b361]=await Promise[_0x2e2a8(0x90)]([_0x368b73,_0x3a65]);for(const _0x6ab0fc of _0x28b361){const _0x925eaa=_0x5ef8a6[_0x2e2a8(0x8b)](_0x81ba3d=>_0x81ba3d[_0x2e2a8(0x78)]===_0x6ab0fc['id']);_0x5da8a4[_0x2e2a8(0x72)]({'fileType':_0x925eaa[_0x2e2a8(0x73)],'fileName':_0x6ab0fc[_0x2e2a8(0xa5)],'attachmentId':_0x925eaa['Id']});}}return _0x5da8a4;}async[a111_0xaabf2f(0x96)](_0x58b67a){const _0x281435=a111_0xaabf2f,_0x3bd686=await this['retrieveComponentIdsFromHistoryIds'](_0x58b67a);this[_0x281435(0x7b)][_0x281435(0x8a)](_0x281435(0xa2));const _0x1f72c2=[];for(const _0x4e7dee of _0x3bd686){const _0x457c17=await this[_0x281435(0x9d)]['retrieveAttachment'](_0x4e7dee[_0x281435(0x98)],!![]);_0x1f72c2[_0x281435(0x72)]({'body':_0x457c17[_0x281435(0x95)]('base64'),'fileName':_0x4e7dee[_0x281435(0xa0)],'fileType':_0x4e7dee[_0x281435(0x70)]}),this['logger'][_0x281435(0x8a)]('manually\x20retrieved\x20%d/%d\x20components',_0x1f72c2['length'],_0x58b67a[_0x281435(0x93)]);}return _0x1f72c2;}async[a111_0xaabf2f(0x6f)](_0x5499db){const _0x4d0b54=a111_0xaabf2f,_0x4fac15=[..._0x5499db],_0x16a647=[],_0x1aadc8=[];while(_0x4fac15[_0x4d0b54(0x93)]){const _0x5dba2c=_0x4fac15['splice'](0x0,this[_0x4d0b54(0x8f)]),_0x202229=await this[_0x4d0b54(0x9d)]['retrieveComponents'](_0x5dba2c);_0x5dba2c[_0x4d0b54(0x93)]!==_0x202229[_0x4d0b54(0x9c)]['length']?(_0x4fac15['push'](..._0x202229[_0x4d0b54(0x9c)]),_0x16a647[_0x4d0b54(0x72)](..._0x202229[_0x4d0b54(0x9a)])):_0x1aadc8[_0x4d0b54(0x72)](..._0x5dba2c),this[_0x4d0b54(0x7b)][_0x4d0b54(0x7f)](_0x4d0b54(0x71),_0x5499db[_0x4d0b54(0x93)]-_0x4fac15[_0x4d0b54(0x93)],_0x5499db['length']);}if(_0x1aadc8[_0x4d0b54(0x93)]){const _0xc821be=await this['retrieveLastComponents'](_0x1aadc8);_0x16a647[_0x4d0b54(0x72)](..._0xc821be);}return _0x16a647;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;