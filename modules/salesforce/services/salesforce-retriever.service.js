const a109_0x9c63=['115711lxgjEX','attachmentId','Logger','length','test','info','1342631jfImBb','ParentId','join','__esModule','manually\x20retrieving\x20components\x20from\x20salesforce','1LLnSNQ','FlosumComponentHistoryDto','query','replace','all','get','default','15SIfwMf','1359PXsdCn','toString','__importDefault','return\x20/\x22\x20+\x20this\x20+\x20\x22/','1136543lZwGph','filename','name','../queries','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','GET_COMPONENT_HISTORIES_BY_IDS','constructor','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','343011mVgbwL','../../../core','map','COMPONENTS_PER_QUERY','fromSalesforce','4HVLbGJ','retrieveAttachment','SalesforceQueryService','fileType','splice','COMPONENTS_PER_REQUEST','push','%parent_ids%','salesforceService','2855AiqToS','fileName','509rGMSDw','run','./salesforce-query.service','retrieveLastComponents','1JGCkSe','retrieveComponentIdsFromHistoryIds','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','277mYFqAP','ids','%ids%','Name','153177GJtJnv','base64','logger','typedi'];const a109_0x25f882=a109_0x2783;(function(_0x346a9c,_0x58497d){const _0x2eca61=a109_0x2783;while(!![]){try{const _0x4b951b=parseInt(_0x2eca61(0x84))*-parseInt(_0x2eca61(0xa6))+-parseInt(_0x2eca61(0x99))*parseInt(_0x2eca61(0x88))+parseInt(_0x2eca61(0x8b))*parseInt(_0x2eca61(0x82))+parseInt(_0x2eca61(0x8f))*parseInt(_0x2eca61(0x9e))+-parseInt(_0x2eca61(0xb2))*-parseInt(_0x2eca61(0x79))+-parseInt(_0x2eca61(0xaa))+parseInt(_0x2eca61(0xa5))*parseInt(_0x2eca61(0x93));if(_0x4b951b===_0x58497d)break;else _0x346a9c['push'](_0x346a9c['shift']());}catch(_0x1a57a3){_0x346a9c['push'](_0x346a9c['shift']());}}}(a109_0x9c63,0xd70b0));const a109_0x511978=function(){let _0x1a2251=!![];return function(_0x1d4186,_0x188ebd){const _0xb47327=_0x1a2251?function(){if(_0x188ebd){const _0x47472d=_0x188ebd['apply'](_0x1d4186,arguments);return _0x188ebd=null,_0x47472d;}}:function(){};return _0x1a2251=![],_0xb47327;};}(),a109_0x58815d=a109_0x511978(this,function(){const _0x203238=function(){const _0x31de8f=a109_0x2783,_0x2604c9=_0x203238[_0x31de8f(0xb0)](_0x31de8f(0xa9))()[_0x31de8f(0xb0)]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x2604c9[_0x31de8f(0x97)](a109_0x58815d);};return _0x203238();});a109_0x58815d();'use strict';var __importDefault=this&&this[a109_0x25f882(0xa8)]||function(_0x101c22){const _0x5dc2b9=a109_0x25f882;return _0x101c22&&_0x101c22[_0x5dc2b9(0x9c)]?_0x101c22:{'default':_0x101c22};};Object['defineProperty'](exports,a109_0x25f882(0x9c),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a109_0x25f882(0xb3)),typedi_1=__importDefault(require(a109_0x25f882(0x92))),salesforce_query_service_1=require(a109_0x25f882(0x86)),queries_1=require(a109_0x25f882(0xad)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x592797){const _0x805aff=a109_0x25f882;this[_0x805aff(0x81)]=_0x592797,this['logger']=new core_1[(_0x805aff(0x95))](SalesforceRetrieverService[_0x805aff(0xac)]),this['COMPONENTS_PER_REQUEST']=0xbb8,this[_0x805aff(0x77)]=0x1f4;}async[a109_0x25f882(0x89)](_0x2a2a45){const _0x210722=a109_0x25f882;this[_0x210722(0x91)][_0x210722(0x98)](_0x210722(0xae),_0x2a2a45[_0x210722(0x96)]);const _0x30d37f=typedi_1[_0x210722(0xa4)][_0x210722(0xa3)](salesforce_query_service_1[_0x210722(0x7b)]),_0x15da73=_0x2a2a45[_0x210722(0xb4)](_0x2124fd=>'\x27'+_0x2124fd+'\x27'),_0x282862=[];while(_0x15da73['length']){const _0x598ba6=_0x15da73['splice'](0x0,this['COMPONENTS_PER_QUERY']),_0x1d6ea3=_0x30d37f[_0x210722(0xa0)](queries_1[_0x210722(0x8a)][_0x210722(0xa1)](_0x210722(0x80),_0x598ba6[_0x210722(0x9b)]())),_0x3efdbe=_0x30d37f[_0x210722(0xa0)](queries_1[_0x210722(0xaf)][_0x210722(0xa1)](_0x210722(0x8d),_0x598ba6[_0x210722(0x9b)]()))['then'](_0x238734=>_0x238734[_0x210722(0xb4)](_0x17b29a=>flosum_component_history_dto_1[_0x210722(0x9f)][_0x210722(0x78)](_0x17b29a))),[_0x44f795,_0x32f3b3]=await Promise[_0x210722(0xa2)]([_0x1d6ea3,_0x3efdbe]);for(const _0x302571 of _0x32f3b3){const _0x330af5=_0x44f795['find'](_0x30ca9c=>_0x30ca9c[_0x210722(0x9a)]===_0x302571['id']);_0x282862[_0x210722(0x7f)]({'fileType':_0x330af5[_0x210722(0x8e)],'fileName':_0x302571[_0x210722(0xab)],'attachmentId':_0x330af5['Id']});}}return _0x282862;}async[a109_0x25f882(0x87)](_0xa17286){const _0x393303=a109_0x25f882,_0x5a1fdc=await this[_0x393303(0x89)](_0xa17286);this[_0x393303(0x91)][_0x393303(0x98)](_0x393303(0x9d));const _0x4da60e=[];for(const _0x5e559b of _0x5a1fdc){const _0xc00826=await this['salesforceService'][_0x393303(0x7a)](_0x5e559b[_0x393303(0x94)],!![]);_0x4da60e[_0x393303(0x7f)]({'body':_0xc00826[_0x393303(0xa7)](_0x393303(0x90)),'fileName':_0x5e559b[_0x393303(0x83)],'fileType':_0x5e559b[_0x393303(0x7c)]}),this[_0x393303(0x91)][_0x393303(0x98)]('manually\x20retrieved\x20%d/%d\x20components',_0x4da60e[_0x393303(0x96)],_0xa17286[_0x393303(0x96)]);}return _0x4da60e;}async[a109_0x25f882(0x85)](_0x1c0327){const _0x829451=a109_0x25f882,_0x15af0e=[..._0x1c0327],_0x5e6259=[],_0x1de61c=[];while(_0x15af0e[_0x829451(0x96)]){const _0x5ac6d5=_0x15af0e[_0x829451(0x7d)](0x0,this[_0x829451(0x7e)]),_0x411327=await this[_0x829451(0x81)]['retrieveComponents'](_0x5ac6d5);_0x5ac6d5[_0x829451(0x96)]!==_0x411327[_0x829451(0x8c)]['length']?(_0x15af0e[_0x829451(0x7f)](..._0x411327[_0x829451(0x8c)]),_0x5e6259[_0x829451(0x7f)](..._0x411327['components'])):_0x1de61c[_0x829451(0x7f)](..._0x5ac6d5),this[_0x829451(0x91)]['log'](_0x829451(0xb1),_0x1c0327[_0x829451(0x96)]-_0x15af0e[_0x829451(0x96)],_0x1c0327['length']);}if(_0x1de61c['length']){const _0x3cbebb=await this[_0x829451(0x87)](_0x1de61c);_0x5e6259['push'](..._0x3cbebb);}return _0x5e6259;}}function a109_0x2783(_0x4e82a5,_0x34f649){return a109_0x2783=function(_0x4e7b79,_0x58815d){_0x4e7b79=_0x4e7b79-0x77;let _0x511978=a109_0x9c63[_0x4e7b79];return _0x511978;},a109_0x2783(_0x4e82a5,_0x34f649);}exports['SalesforceRetrieverService']=SalesforceRetrieverService;