const a109_0x5b25=['length','toString','default','13158vQKyND','constructor','694759wUulEb','Logger','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','run','SalesforceRetrieverService','__esModule','../dto/flosum-component-history.dto','SalesforceQueryService','then','__importDefault','test','query','13186UBrtrJ','%ids%','1545tOibEj','get','COMPONENTS_PER_QUERY','salesforceService','manually\x20retrieved\x20%d/%d\x20components','push','all','ids','manually\x20retrieving\x20components\x20from\x20salesforce','../../../core','replace','filename','splice','Name','23igWjkE','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','../queries','383PmfHdq','retrieveLastComponents','name','info','ParentId','COMPONENTS_PER_REQUEST','retrieveAttachment','3757Mooapg','GET_COMPONENT_HISTORIES_BY_IDS','apply','fromSalesforce','logger','retrieveComponents','fileType','33856srwDFR','find','1156936pReZpX','69miZqhN','21cyWRQJ','retrieveComponentIdsFromHistoryIds','fileName','log','components','typedi'];const a109_0x38c7f9=a109_0x5ab4;(function(_0x5c2bd7,_0xd5b656){const _0x32ae7f=a109_0x5ab4;while(!![]){try{const _0x47f73c=parseInt(_0x32ae7f(0x22b))+-parseInt(_0x32ae7f(0x217))*parseInt(_0x32ae7f(0x1f9))+parseInt(_0x32ae7f(0x229))*parseInt(_0x32ae7f(0x1f0))+parseInt(_0x32ae7f(0x21b))*-parseInt(_0x32ae7f(0x222))+-parseInt(_0x32ae7f(0x209))*parseInt(_0x32ae7f(0x1ef))+parseInt(_0x32ae7f(0x207))+parseInt(_0x32ae7f(0x1fb));if(_0x47f73c===_0xd5b656)break;else _0x5c2bd7['push'](_0x5c2bd7['shift']());}catch(_0x1978e1){_0x5c2bd7['push'](_0x5c2bd7['shift']());}}}(a109_0x5b25,0xb1a87));const a109_0x11bfeb=function(){let _0x773c4a=!![];return function(_0x4f930f,_0x3abe11){const _0x437102=_0x773c4a?function(){const _0x156738=a109_0x5ab4;if(_0x3abe11){const _0x5dce5c=_0x3abe11[_0x156738(0x224)](_0x4f930f,arguments);return _0x3abe11=null,_0x5dce5c;}}:function(){};return _0x773c4a=![],_0x437102;};}(),a109_0x26f855=a109_0x11bfeb(this,function(){const _0x5295d9=function(){const _0x3d7796=a109_0x5ab4,_0x4b35bc=_0x5295d9['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x3d7796(0x1fa)]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x4b35bc[_0x3d7796(0x205)](a109_0x26f855);};return _0x5295d9();});a109_0x26f855();'use strict';var __importDefault=this&&this[a109_0x38c7f9(0x204)]||function(_0x308fbd){const _0x3d18cb=a109_0x38c7f9;return _0x308fbd&&_0x308fbd[_0x3d18cb(0x200)]?_0x308fbd:{'default':_0x308fbd};};Object['defineProperty'](exports,a109_0x38c7f9(0x200),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require(a109_0x38c7f9(0x212)),typedi_1=__importDefault(require(a109_0x38c7f9(0x1f5))),salesforce_query_service_1=require('./salesforce-query.service'),queries_1=require(a109_0x38c7f9(0x21a)),flosum_component_history_dto_1=require(a109_0x38c7f9(0x201));function a109_0x5ab4(_0x23db74,_0x4520f2){return a109_0x5ab4=function(_0xcf0cbf,_0x26f855){_0xcf0cbf=_0xcf0cbf-0x1ef;let _0x11bfeb=a109_0x5b25[_0xcf0cbf];return _0x11bfeb;},a109_0x5ab4(_0x23db74,_0x4520f2);}class SalesforceRetrieverService{constructor(_0x28a55e){const _0x38fc6c=a109_0x38c7f9;this['salesforceService']=_0x28a55e,this[_0x38fc6c(0x226)]=new core_1[(_0x38fc6c(0x1fc))](SalesforceRetrieverService[_0x38fc6c(0x21d)]),this[_0x38fc6c(0x220)]=0xbb8,this[_0x38fc6c(0x20b)]=0x1f4;}async[a109_0x38c7f9(0x1f1)](_0x4f5c0f){const _0xd9e728=a109_0x38c7f9;this[_0xd9e728(0x226)][_0xd9e728(0x21e)](_0xd9e728(0x1fd),_0x4f5c0f[_0xd9e728(0x1f6)]);const _0x8e5d83=typedi_1[_0xd9e728(0x1f8)][_0xd9e728(0x20a)](salesforce_query_service_1[_0xd9e728(0x202)]),_0x5e5320=_0x4f5c0f['map'](_0x5bbbdc=>'\x27'+_0x5bbbdc+'\x27'),_0x42f380=[];while(_0x5e5320['length']){const _0x196c47=_0x5e5320['splice'](0x0,this[_0xd9e728(0x20b)]),_0x27112e=_0x8e5d83['query'](queries_1[_0xd9e728(0x218)][_0xd9e728(0x213)]('%parent_ids%',_0x196c47['join']())),_0x345737=_0x8e5d83[_0xd9e728(0x206)](queries_1[_0xd9e728(0x223)][_0xd9e728(0x213)](_0xd9e728(0x208),_0x196c47['join']()))[_0xd9e728(0x203)](_0x49b4dc=>_0x49b4dc['map'](_0x5a80d1=>flosum_component_history_dto_1['FlosumComponentHistoryDto'][_0xd9e728(0x225)](_0x5a80d1))),[_0x569160,_0x3ddced]=await Promise[_0xd9e728(0x20f)]([_0x27112e,_0x345737]);for(const _0x29046c of _0x3ddced){const _0x20cfcd=_0x569160[_0xd9e728(0x22a)](_0x3c4523=>_0x3c4523[_0xd9e728(0x21f)]===_0x29046c['id']);_0x42f380[_0xd9e728(0x20e)]({'fileType':_0x20cfcd[_0xd9e728(0x216)],'fileName':_0x29046c[_0xd9e728(0x214)],'attachmentId':_0x20cfcd['Id']});}}return _0x42f380;}async['retrieveLastComponents'](_0x5e3859){const _0x640e2a=a109_0x38c7f9,_0x4f17a6=await this['retrieveComponentIdsFromHistoryIds'](_0x5e3859);this[_0x640e2a(0x226)]['info'](_0x640e2a(0x211));const _0x2ca1b7=[];for(const _0x2c4591 of _0x4f17a6){const _0x2fd7b0=await this[_0x640e2a(0x20c)][_0x640e2a(0x221)](_0x2c4591['attachmentId'],!![]);_0x2ca1b7[_0x640e2a(0x20e)]({'body':_0x2fd7b0[_0x640e2a(0x1f7)]('base64'),'fileName':_0x2c4591[_0x640e2a(0x1f2)],'fileType':_0x2c4591[_0x640e2a(0x228)]}),this[_0x640e2a(0x226)][_0x640e2a(0x21e)](_0x640e2a(0x20d),_0x2ca1b7[_0x640e2a(0x1f6)],_0x5e3859['length']);}return _0x2ca1b7;}async[a109_0x38c7f9(0x1fe)](_0x1b5d05){const _0xc248a7=a109_0x38c7f9,_0x3630c9=[..._0x1b5d05],_0x5947c7=[],_0x9e1322=[];while(_0x3630c9['length']){const _0x16f149=_0x3630c9[_0xc248a7(0x215)](0x0,this[_0xc248a7(0x220)]),_0x7f97f7=await this['salesforceService'][_0xc248a7(0x227)](_0x16f149);_0x16f149[_0xc248a7(0x1f6)]!==_0x7f97f7[_0xc248a7(0x210)][_0xc248a7(0x1f6)]?(_0x3630c9['push'](..._0x7f97f7['ids']),_0x5947c7[_0xc248a7(0x20e)](..._0x7f97f7[_0xc248a7(0x1f4)])):_0x9e1322[_0xc248a7(0x20e)](..._0x16f149),this['logger'][_0xc248a7(0x1f3)](_0xc248a7(0x219),_0x1b5d05[_0xc248a7(0x1f6)]-_0x3630c9[_0xc248a7(0x1f6)],_0x1b5d05['length']);}if(_0x9e1322[_0xc248a7(0x1f6)]){const _0x4c6fcc=await this[_0xc248a7(0x21c)](_0x9e1322);_0x5947c7[_0xc248a7(0x20e)](..._0x4c6fcc);}return _0x5947c7;}}exports[a109_0x38c7f9(0x1ff)]=SalesforceRetrieverService;