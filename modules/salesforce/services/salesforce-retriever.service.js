const a111_0x318034=a111_0x46c0;(function(_0x20208a,_0x2a613d){const _0x142d5c=a111_0x46c0,_0x24be90=_0x20208a();while(!![]){try{const _0x5e80db=-parseInt(_0x142d5c(0x182))/0x1+-parseInt(_0x142d5c(0x163))/0x2*(-parseInt(_0x142d5c(0x162))/0x3)+-parseInt(_0x142d5c(0x17f))/0x4+parseInt(_0x142d5c(0x15c))/0x5+-parseInt(_0x142d5c(0x186))/0x6*(parseInt(_0x142d5c(0x16e))/0x7)+parseInt(_0x142d5c(0x18c))/0x8*(-parseInt(_0x142d5c(0x175))/0x9)+parseInt(_0x142d5c(0x195))/0xa;if(_0x5e80db===_0x2a613d)break;else _0x24be90['push'](_0x24be90['shift']());}catch(_0x3321a2){_0x24be90['push'](_0x24be90['shift']());}}}(a111_0x2d2e,0x45fec));const a111_0x16ced0=function(){let _0x5d1969=!![];return function(_0x5b6113,_0x1f80ae){const _0x1378bb=_0x5d1969?function(){const _0x2453c8=a111_0x46c0;if(_0x1f80ae){const _0xa6e502=_0x1f80ae[_0x2453c8(0x18f)](_0x5b6113,arguments);return _0x1f80ae=null,_0xa6e502;}}:function(){};return _0x5d1969=![],_0x1378bb;};}(),a111_0x168ece=a111_0x16ced0(this,function(){const _0x4e0f1d=a111_0x46c0;return a111_0x168ece[_0x4e0f1d(0x18e)]()[_0x4e0f1d(0x192)](_0x4e0f1d(0x15e))['toString']()[_0x4e0f1d(0x178)](a111_0x168ece)[_0x4e0f1d(0x192)]('(((.+)+)+)+$');});a111_0x168ece();'use strict';var __importDefault=this&&this[a111_0x318034(0x17e)]||function(_0x4e3717){const _0x1d4253=a111_0x318034;return _0x4e3717&&_0x4e3717[_0x1d4253(0x176)]?_0x4e3717:{'default':_0x4e3717};};Object[a111_0x318034(0x184)](exports,a111_0x318034(0x176),{'value':!![]}),exports[a111_0x318034(0x161)]=void 0x0;const core_1=require(a111_0x318034(0x15f)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a111_0x318034(0x171)),queries_1=require(a111_0x318034(0x193)),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x30effb){const _0x349162=a111_0x318034;this[_0x349162(0x17a)]=_0x30effb,this[_0x349162(0x16f)]=new core_1[(_0x349162(0x188))](SalesforceRetrieverService[_0x349162(0x194)]),this[_0x349162(0x16c)]=0xbb8,this[_0x349162(0x16b)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x41b550){const _0x18567c=a111_0x318034;this['logger'][_0x18567c(0x15d)](_0x18567c(0x160),_0x41b550['length']);const _0x19c3ec=typedi_1[_0x18567c(0x183)][_0x18567c(0x167)](salesforce_query_service_1[_0x18567c(0x164)]),_0x4ee1b5=_0x41b550['map'](_0x3b4a3e=>'\x27'+_0x3b4a3e+'\x27'),_0x5d509a=[];while(_0x4ee1b5[_0x18567c(0x180)]){const _0x521905=_0x4ee1b5[_0x18567c(0x165)](0x0,this[_0x18567c(0x16b)]),_0x21443f=_0x19c3ec[_0x18567c(0x170)](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x18567c(0x17d)]('%parent_ids%',_0x521905[_0x18567c(0x17c)]())),_0x22dc07=_0x19c3ec[_0x18567c(0x170)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x18567c(0x17d)](_0x18567c(0x189),_0x521905[_0x18567c(0x17c)]()))[_0x18567c(0x18d)](_0x34c0dc=>_0x34c0dc[_0x18567c(0x173)](_0x7ddc62=>flosum_component_history_dto_1[_0x18567c(0x166)][_0x18567c(0x169)](_0x7ddc62))),[_0x183251,_0x3f6fe3]=await Promise[_0x18567c(0x16d)]([_0x21443f,_0x22dc07]);for(const _0x33ad7d of _0x3f6fe3){const _0x17e0ec=_0x183251[_0x18567c(0x196)](_0x3394f6=>_0x3394f6[_0x18567c(0x16a)]===_0x33ad7d['id']);_0x5d509a['push']({'fileType':_0x17e0ec[_0x18567c(0x179)],'fileName':_0x33ad7d[_0x18567c(0x177)],'attachmentId':_0x17e0ec['Id']});}}return _0x5d509a;}async['retrieveLastComponents'](_0x22be07){const _0x55dc31=a111_0x318034,_0x505145=await this[_0x55dc31(0x185)](_0x22be07);this['logger'][_0x55dc31(0x15d)]('manually\x20retrieving\x20components\x20from\x20salesforce');const _0xeb994b=[];for(const _0x532216 of _0x505145){const _0x12244b=await this['salesforceService']['retrieveAttachment'](_0x532216[_0x55dc31(0x18a)],!![]);_0xeb994b[_0x55dc31(0x172)]({'body':_0x12244b['toString'](_0x55dc31(0x190)),'fileName':_0x532216[_0x55dc31(0x187)],'fileType':_0x532216['fileType']}),this[_0x55dc31(0x16f)][_0x55dc31(0x15d)](_0x55dc31(0x18b),_0xeb994b['length'],_0x22be07['length']);}return _0xeb994b;}async[a111_0x318034(0x191)](_0x12d1eb){const _0x4a116c=a111_0x318034,_0x3c8473=[..._0x12d1eb],_0x44ace5=[],_0x38e72e=[];while(_0x3c8473[_0x4a116c(0x180)]){const _0x480802=_0x3c8473[_0x4a116c(0x165)](0x0,this['COMPONENTS_PER_REQUEST']),_0x48c321=await this[_0x4a116c(0x17a)]['retrieveComponents'](_0x480802);_0x480802[_0x4a116c(0x180)]!==_0x48c321['ids'][_0x4a116c(0x180)]?(_0x3c8473[_0x4a116c(0x172)](..._0x48c321[_0x4a116c(0x17b)]),_0x44ace5[_0x4a116c(0x172)](..._0x48c321[_0x4a116c(0x168)])):_0x38e72e[_0x4a116c(0x172)](..._0x480802),this[_0x4a116c(0x16f)]['log'](_0x4a116c(0x181),_0x12d1eb[_0x4a116c(0x180)]-_0x3c8473[_0x4a116c(0x180)],_0x12d1eb[_0x4a116c(0x180)]);}if(_0x38e72e[_0x4a116c(0x180)]){const _0x126ad3=await this[_0x4a116c(0x174)](_0x38e72e);_0x44ace5[_0x4a116c(0x172)](..._0x126ad3);}return _0x44ace5;}}function a111_0x46c0(_0x205607,_0x24a639){const _0x4900ad=a111_0x2d2e();return a111_0x46c0=function(_0x168ece,_0x16ced0){_0x168ece=_0x168ece-0x15c;let _0x2d2e94=_0x4900ad[_0x168ece];return _0x2d2e94;},a111_0x46c0(_0x205607,_0x24a639);}exports[a111_0x318034(0x161)]=SalesforceRetrieverService;function a111_0x2d2e(){const _0x2f68e0=['query','./salesforce-query.service','push','map','retrieveLastComponents','16479hYmBTh','__esModule','filename','constructor','Name','salesforceService','ids','join','replace','__importDefault','569272PjMpIr','length','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','85284FFDGGe','default','defineProperty','retrieveComponentIdsFromHistoryIds','596886PRbrLF','fileName','Logger','%ids%','attachmentId','manually\x20retrieved\x20%d/%d\x20components','1480VThiyO','then','toString','apply','base64','run','search','../queries','name','1971620IjPvkf','find','2658670qeJlLW','info','(((.+)+)+)+$','../../../core','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','SalesforceRetrieverService','21zoHlQm','63892putlsP','SalesforceQueryService','splice','FlosumComponentHistoryDto','get','components','fromSalesforce','ParentId','COMPONENTS_PER_QUERY','COMPONENTS_PER_REQUEST','all','7WpcOoJ','logger'];a111_0x2d2e=function(){return _0x2f68e0;};return a111_0x2d2e();}