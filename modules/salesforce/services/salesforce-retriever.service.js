const a111_0x3962d3=a111_0x312f;(function(_0x413aba,_0x1394e9){const _0x40c921=a111_0x312f,_0x766225=_0x413aba();while(!![]){try{const _0x44c620=parseInt(_0x40c921(0x148))/0x1+-parseInt(_0x40c921(0x132))/0x2+parseInt(_0x40c921(0x122))/0x3*(-parseInt(_0x40c921(0x144))/0x4)+parseInt(_0x40c921(0x127))/0x5+parseInt(_0x40c921(0x11b))/0x6*(-parseInt(_0x40c921(0x13c))/0x7)+-parseInt(_0x40c921(0x150))/0x8*(parseInt(_0x40c921(0x117))/0x9)+parseInt(_0x40c921(0x14f))/0xa*(parseInt(_0x40c921(0x13e))/0xb);if(_0x44c620===_0x1394e9)break;else _0x766225['push'](_0x766225['shift']());}catch(_0x1260f2){_0x766225['push'](_0x766225['shift']());}}}(a111_0x136d,0x53233));const a111_0x369529=function(){let _0x3a7822=!![];return function(_0xd2229a,_0x1fc2a7){const _0x49560a=_0x3a7822?function(){if(_0x1fc2a7){const _0x6ff556=_0x1fc2a7['apply'](_0xd2229a,arguments);return _0x1fc2a7=null,_0x6ff556;}}:function(){};return _0x3a7822=![],_0x49560a;};}(),a111_0x342727=a111_0x369529(this,function(){const _0x250cae=a111_0x312f;return a111_0x342727[_0x250cae(0x137)]()[_0x250cae(0x131)](_0x250cae(0x141))[_0x250cae(0x137)]()[_0x250cae(0x12a)](a111_0x342727)[_0x250cae(0x131)](_0x250cae(0x141));});a111_0x342727();'use strict';var __importDefault=this&&this[a111_0x3962d3(0x136)]||function(_0x5642e3){return _0x5642e3&&_0x5642e3['__esModule']?_0x5642e3:{'default':_0x5642e3};};function a111_0x312f(_0x4b3b2,_0x289f51){const _0x48561e=a111_0x136d();return a111_0x312f=function(_0x342727,_0x369529){_0x342727=_0x342727-0x117;let _0x136d46=_0x48561e[_0x342727];return _0x136d46;},a111_0x312f(_0x4b3b2,_0x289f51);}Object['defineProperty'](exports,a111_0x3962d3(0x129),{'value':!![]}),exports[a111_0x3962d3(0x123)]=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require(a111_0x3962d3(0x128))),salesforce_query_service_1=require(a111_0x3962d3(0x126)),queries_1=require(a111_0x3962d3(0x119)),flosum_component_history_dto_1=require(a111_0x3962d3(0x149));class SalesforceRetrieverService{constructor(_0x150e93){const _0x5ec43c=a111_0x3962d3;this[_0x5ec43c(0x14b)]=_0x150e93,this[_0x5ec43c(0x145)]=new core_1[(_0x5ec43c(0x124))](SalesforceRetrieverService[_0x5ec43c(0x143)]),this[_0x5ec43c(0x125)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async[a111_0x3962d3(0x138)](_0x138ce5){const _0x7b8697=a111_0x3962d3;this['logger'][_0x7b8697(0x134)](_0x7b8697(0x147),_0x138ce5['length']);const _0x346386=typedi_1[_0x7b8697(0x146)]['get'](salesforce_query_service_1[_0x7b8697(0x140)]),_0x1afe68=_0x138ce5[_0x7b8697(0x11e)](_0x28e298=>'\x27'+_0x28e298+'\x27'),_0x5a6c74=[];while(_0x1afe68['length']){const _0x3f3673=_0x1afe68[_0x7b8697(0x152)](0x0,this[_0x7b8697(0x12e)]),_0x49582d=_0x346386['query'](queries_1['GET_ATTACHMENT_BY_PARENT_IDS_QUERY'][_0x7b8697(0x120)](_0x7b8697(0x133),_0x3f3673[_0x7b8697(0x153)]())),_0x581fa8=_0x346386[_0x7b8697(0x155)](queries_1[_0x7b8697(0x11f)]['replace'](_0x7b8697(0x13f),_0x3f3673[_0x7b8697(0x153)]()))[_0x7b8697(0x11c)](_0x3668a4=>_0x3668a4[_0x7b8697(0x11e)](_0x812d63=>flosum_component_history_dto_1[_0x7b8697(0x12d)][_0x7b8697(0x13b)](_0x812d63))),[_0x49adda,_0x495f23]=await Promise[_0x7b8697(0x14a)]([_0x49582d,_0x581fa8]);for(const _0x5b6187 of _0x495f23){const _0x298245=_0x49adda[_0x7b8697(0x11d)](_0x3b2128=>_0x3b2128[_0x7b8697(0x14e)]===_0x5b6187['id']);_0x298245&&_0x5a6c74[_0x7b8697(0x14d)]({'fileType':_0x298245[_0x7b8697(0x139)],'fileName':_0x5b6187[_0x7b8697(0x151)],'attachmentId':_0x298245['Id']});}}return _0x5a6c74;}async[a111_0x3962d3(0x135)](_0x12db34){const _0x3a6682=a111_0x3962d3,_0x5aed3d=await this[_0x3a6682(0x138)](_0x12db34);this[_0x3a6682(0x145)][_0x3a6682(0x134)](_0x3a6682(0x121));const _0xbe6632=[];for(const _0x3d519c of _0x5aed3d){const _0x7c103a=await this[_0x3a6682(0x14b)][_0x3a6682(0x12b)](_0x3d519c['attachmentId'],!![]);_0xbe6632[_0x3a6682(0x14d)]({'body':_0x7c103a[_0x3a6682(0x137)]('base64'),'fileName':_0x3d519c[_0x3a6682(0x118)],'fileType':_0x3d519c[_0x3a6682(0x13a)]}),this[_0x3a6682(0x145)][_0x3a6682(0x134)](_0x3a6682(0x13d),_0xbe6632[_0x3a6682(0x142)],_0x12db34[_0x3a6682(0x142)]);}return _0xbe6632;}async[a111_0x3962d3(0x11a)](_0x52fa99){const _0x4d4b64=a111_0x3962d3,_0x1ebb25=[..._0x52fa99],_0x34ca75=[],_0x9ab8e=[];while(_0x1ebb25[_0x4d4b64(0x142)]){const _0x15d26e=_0x1ebb25[_0x4d4b64(0x152)](0x0,this[_0x4d4b64(0x125)]),_0x292b90=await this['salesforceService'][_0x4d4b64(0x130)](_0x15d26e);_0x15d26e[_0x4d4b64(0x142)]!==_0x292b90[_0x4d4b64(0x154)]['length']?(_0x1ebb25[_0x4d4b64(0x14d)](..._0x292b90[_0x4d4b64(0x154)]),_0x34ca75[_0x4d4b64(0x14d)](..._0x292b90[_0x4d4b64(0x14c)])):_0x9ab8e[_0x4d4b64(0x14d)](..._0x15d26e),this[_0x4d4b64(0x145)][_0x4d4b64(0x12f)](_0x4d4b64(0x12c),_0x52fa99['length']-_0x1ebb25[_0x4d4b64(0x142)],_0x52fa99[_0x4d4b64(0x142)]);}if(_0x9ab8e['length']){const _0xafe4d7=await this[_0x4d4b64(0x135)](_0x9ab8e);_0x34ca75[_0x4d4b64(0x14d)](..._0xafe4d7);}return _0x34ca75;}}function a111_0x136d(){const _0x4cca83=['run','174TzyhGJ','then','find','map','GET_COMPONENT_HISTORIES_BY_IDS','replace','manually\x20retrieving\x20components\x20from\x20salesforce','489DVGoGk','SalesforceRetrieverService','Logger','COMPONENTS_PER_REQUEST','./salesforce-query.service','2301190CGPfwH','typedi','__esModule','constructor','retrieveAttachment','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','FlosumComponentHistoryDto','COMPONENTS_PER_QUERY','log','retrieveComponents','search','1125246AERbAS','%parent_ids%','info','retrieveLastComponents','__importDefault','toString','retrieveComponentIdsFromHistoryIds','Name','fileType','fromSalesforce','159117CwixxA','manually\x20retrieved\x20%d/%d\x20components','21989baIAej','%ids%','SalesforceQueryService','(((.+)+)+)+$','length','name','2796GxJYMA','logger','default','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','565088wtUHiv','../dto/flosum-component-history.dto','all','salesforceService','components','push','ParentId','5750OzOmeg','3987688BmVuRs','filename','splice','join','ids','query','9FcIhpJ','fileName','../queries'];a111_0x136d=function(){return _0x4cca83;};return a111_0x136d();}exports['SalesforceRetrieverService']=SalesforceRetrieverService;