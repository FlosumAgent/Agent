const a111_0x26a2a7=a111_0xcda3;(function(_0x4879de,_0x37ed98){const _0x6ca562=a111_0xcda3,_0x2735ed=_0x4879de();while(!![]){try{const _0x43f83f=-parseInt(_0x6ca562(0x1cd))/0x1+parseInt(_0x6ca562(0x1fa))/0x2*(parseInt(_0x6ca562(0x1dc))/0x3)+-parseInt(_0x6ca562(0x1fd))/0x4+-parseInt(_0x6ca562(0x1ed))/0x5+-parseInt(_0x6ca562(0x1e3))/0x6*(-parseInt(_0x6ca562(0x1e9))/0x7)+-parseInt(_0x6ca562(0x1f7))/0x8+-parseInt(_0x6ca562(0x1cc))/0x9*(-parseInt(_0x6ca562(0x200))/0xa);if(_0x43f83f===_0x37ed98)break;else _0x2735ed['push'](_0x2735ed['shift']());}catch(_0x4c7c08){_0x2735ed['push'](_0x2735ed['shift']());}}}(a111_0x44a5,0xe2586));const a111_0x33a5a9=function(){let _0x197ae9=!![];return function(_0x4922a1,_0x210009){const _0x55766e=_0x197ae9?function(){const _0x2e49c1=a111_0xcda3;if(_0x210009){const _0xccee90=_0x210009[_0x2e49c1(0x202)](_0x4922a1,arguments);return _0x210009=null,_0xccee90;}}:function(){};return _0x197ae9=![],_0x55766e;};}(),a111_0x75f188=a111_0x33a5a9(this,function(){const _0x3da657=a111_0xcda3;return a111_0x75f188['toString']()[_0x3da657(0x1ff)]('(((.+)+)+)+$')[_0x3da657(0x1d6)]()[_0x3da657(0x1e2)](a111_0x75f188)[_0x3da657(0x1ff)]('(((.+)+)+)+$');});a111_0x75f188();'use strict';function a111_0x44a5(){const _0x2e9060=['default','Name','manually\x20retrieved\x20%d/%d\x20components','fromSalesforce','join','manually\x20retrieving\x20components\x20from\x20salesforce','find','query','length','2967648lyYvsN','retrieveComponents','%ids%','538RAPDSG','retrieveAttachment','defineProperty','1444684ErTbCt','retrieveLastComponents','search','680IHHJRM','ParentId','apply','__importDefault','SalesforceRetrieverService','push','COMPONENTS_PER_QUERY','all','124938UnLrqU','1017429iUswBB','log','logger','attachmentId','splice','typedi','replace','__esModule','%parent_ids%','toString','COMPONENTS_PER_REQUEST','../dto/flosum-component-history.dto','get','ids','fileName','20100pSzOJU','fileType','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','components','GET_COMPONENT_HISTORIES_BY_IDS','constructor','10926TlTGMx','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','base64','retrieveComponentIdsFromHistoryIds','FlosumComponentHistoryDto','../../../core','2030dtqcVM','info','./salesforce-query.service','../queries','2988500JqZsYg'];a111_0x44a5=function(){return _0x2e9060;};return a111_0x44a5();}var __importDefault=this&&this[a111_0x26a2a7(0x203)]||function(_0x4eea0f){const _0x5cc1e0=a111_0x26a2a7;return _0x4eea0f&&_0x4eea0f[_0x5cc1e0(0x1d4)]?_0x4eea0f:{'default':_0x4eea0f};};Object[a111_0x26a2a7(0x1fc)](exports,a111_0x26a2a7(0x1d4),{'value':!![]}),exports[a111_0x26a2a7(0x204)]=void 0x0;function a111_0xcda3(_0x401890,_0x8573a6){const _0x2f1664=a111_0x44a5();return a111_0xcda3=function(_0x75f188,_0x33a5a9){_0x75f188=_0x75f188-0x1cc;let _0x44a57a=_0x2f1664[_0x75f188];return _0x44a57a;},a111_0xcda3(_0x401890,_0x8573a6);}const core_1=require(a111_0x26a2a7(0x1e8)),typedi_1=__importDefault(require(a111_0x26a2a7(0x1d2))),salesforce_query_service_1=require(a111_0x26a2a7(0x1eb)),queries_1=require(a111_0x26a2a7(0x1ec)),flosum_component_history_dto_1=require(a111_0x26a2a7(0x1d8));class SalesforceRetrieverService{constructor(_0x3fc200){const _0x53e162=a111_0x26a2a7;this['salesforceService']=_0x3fc200,this['logger']=new core_1['Logger'](SalesforceRetrieverService['name']),this[_0x53e162(0x1d7)]=0xbb8,this[_0x53e162(0x206)]=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x302111){const _0x4df372=a111_0x26a2a7;this['logger']['info'](_0x4df372(0x1e4),_0x302111[_0x4df372(0x1f6)]);const _0x310edb=typedi_1[_0x4df372(0x1ee)][_0x4df372(0x1d9)](salesforce_query_service_1['SalesforceQueryService']),_0x5a85c9=_0x302111['map'](_0x314c9a=>'\x27'+_0x314c9a+'\x27'),_0xb513d7=[];while(_0x5a85c9[_0x4df372(0x1f6)]){const _0x25bb5d=_0x5a85c9[_0x4df372(0x1d1)](0x0,this[_0x4df372(0x206)]),_0x19582d=_0x310edb[_0x4df372(0x1f5)](queries_1[_0x4df372(0x1df)][_0x4df372(0x1d3)](_0x4df372(0x1d5),_0x25bb5d[_0x4df372(0x1f2)]())),_0x4a0603=_0x310edb[_0x4df372(0x1f5)](queries_1[_0x4df372(0x1e1)][_0x4df372(0x1d3)](_0x4df372(0x1f9),_0x25bb5d[_0x4df372(0x1f2)]()))['then'](_0x5bb8fb=>_0x5bb8fb['map'](_0x3b8cca=>flosum_component_history_dto_1[_0x4df372(0x1e7)][_0x4df372(0x1f1)](_0x3b8cca))),[_0x1f4577,_0xd260c8]=await Promise[_0x4df372(0x207)]([_0x19582d,_0x4a0603]);for(const _0x3793ee of _0xd260c8){const _0x475a85=_0x1f4577[_0x4df372(0x1f4)](_0x4232cc=>_0x4232cc[_0x4df372(0x201)]===_0x3793ee['id']);_0xb513d7[_0x4df372(0x205)]({'fileType':_0x475a85[_0x4df372(0x1ef)],'fileName':_0x3793ee['filename'],'attachmentId':_0x475a85['Id']});}}return _0xb513d7;}async[a111_0x26a2a7(0x1fe)](_0x23f33b){const _0x1f4fb0=a111_0x26a2a7,_0x2a9537=await this[_0x1f4fb0(0x1e6)](_0x23f33b);this[_0x1f4fb0(0x1cf)][_0x1f4fb0(0x1ea)](_0x1f4fb0(0x1f3));const _0x4426c0=[];for(const _0x39aad9 of _0x2a9537){const _0x754902=await this['salesforceService'][_0x1f4fb0(0x1fb)](_0x39aad9[_0x1f4fb0(0x1d0)],!![]);_0x4426c0[_0x1f4fb0(0x205)]({'body':_0x754902[_0x1f4fb0(0x1d6)](_0x1f4fb0(0x1e5)),'fileName':_0x39aad9[_0x1f4fb0(0x1db)],'fileType':_0x39aad9[_0x1f4fb0(0x1dd)]}),this[_0x1f4fb0(0x1cf)][_0x1f4fb0(0x1ea)](_0x1f4fb0(0x1f0),_0x4426c0[_0x1f4fb0(0x1f6)],_0x23f33b[_0x1f4fb0(0x1f6)]);}return _0x4426c0;}async['run'](_0x5771b2){const _0x1fe51c=a111_0x26a2a7,_0x28768d=[..._0x5771b2],_0x38e29c=[],_0x46d29f=[];while(_0x28768d[_0x1fe51c(0x1f6)]){const _0x34a6e5=_0x28768d[_0x1fe51c(0x1d1)](0x0,this[_0x1fe51c(0x1d7)]),_0x282efd=await this['salesforceService'][_0x1fe51c(0x1f8)](_0x34a6e5);_0x34a6e5[_0x1fe51c(0x1f6)]!==_0x282efd['ids']['length']?(_0x28768d[_0x1fe51c(0x205)](..._0x282efd[_0x1fe51c(0x1da)]),_0x38e29c['push'](..._0x282efd[_0x1fe51c(0x1e0)])):_0x46d29f[_0x1fe51c(0x205)](..._0x34a6e5),this[_0x1fe51c(0x1cf)][_0x1fe51c(0x1ce)](_0x1fe51c(0x1de),_0x5771b2[_0x1fe51c(0x1f6)]-_0x28768d['length'],_0x5771b2[_0x1fe51c(0x1f6)]);}if(_0x46d29f[_0x1fe51c(0x1f6)]){const _0x3ff7aa=await this['retrieveLastComponents'](_0x46d29f);_0x38e29c[_0x1fe51c(0x205)](..._0x3ff7aa);}return _0x38e29c;}}exports[a111_0x26a2a7(0x204)]=SalesforceRetrieverService;