const a111_0x4a5bc4=a111_0x4bcb;(function(_0x6044db,_0x4004e3){const _0x2090eb=a111_0x4bcb,_0x5c9283=_0x6044db();while(!![]){try{const _0x478db6=-parseInt(_0x2090eb(0x17d))/0x1+parseInt(_0x2090eb(0x194))/0x2+-parseInt(_0x2090eb(0x1a7))/0x3+-parseInt(_0x2090eb(0x1a0))/0x4*(parseInt(_0x2090eb(0x181))/0x5)+-parseInt(_0x2090eb(0x19b))/0x6+parseInt(_0x2090eb(0x1a1))/0x7+parseInt(_0x2090eb(0x170))/0x8;if(_0x478db6===_0x4004e3)break;else _0x5c9283['push'](_0x5c9283['shift']());}catch(_0x178aa6){_0x5c9283['push'](_0x5c9283['shift']());}}}(a111_0x3833,0xaf6d1));const a111_0x55940e=function(){let _0x2b279=!![];return function(_0x536978,_0xbf61a8){const _0x571965=_0x2b279?function(){const _0x1fe2c3=a111_0x4bcb;if(_0xbf61a8){const _0x14d271=_0xbf61a8[_0x1fe2c3(0x198)](_0x536978,arguments);return _0xbf61a8=null,_0x14d271;}}:function(){};return _0x2b279=![],_0x571965;};}(),a111_0x451804=a111_0x55940e(this,function(){const _0x351197=a111_0x4bcb;return a111_0x451804[_0x351197(0x195)]()[_0x351197(0x177)](_0x351197(0x18f))['toString']()[_0x351197(0x190)](a111_0x451804)[_0x351197(0x177)](_0x351197(0x18f));});a111_0x451804();function a111_0x4bcb(_0x21fa01,_0x47e542){const _0x433fca=a111_0x3833();return a111_0x4bcb=function(_0x451804,_0x55940e){_0x451804=_0x451804-0x170;let _0x383379=_0x433fca[_0x451804];return _0x383379;},a111_0x4bcb(_0x21fa01,_0x47e542);}'use strict';var __importDefault=this&&this[a111_0x4a5bc4(0x17f)]||function(_0x4d2105){const _0x212f05=a111_0x4a5bc4;return _0x4d2105&&_0x4d2105[_0x212f05(0x197)]?_0x4d2105:{'default':_0x4d2105};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a111_0x4a5bc4(0x193)]=void 0x0;const core_1=require(a111_0x4a5bc4(0x188)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a111_0x4a5bc4(0x191)),queries_1=require(a111_0x4a5bc4(0x17b)),flosum_component_history_dto_1=require(a111_0x4a5bc4(0x17c));function a111_0x3833(){const _0x45052c=['splice','name','../../../core','then','salesforceService','log','retrieveLastComponents','logger','find','(((.+)+)+)+$','constructor','./salesforce-query.service','fileType','SalesforceRetrieverService','745580YvCTLc','toString','default','__esModule','apply','%parent_ids%','fromSalesforce','2656188nqGStW','push','attachmentId','Name','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','44648gGQVGC','2235639EBzJSn','query','retrieveComponentIdsFromHistoryIds','join','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','SalesforceQueryService','3486462BlxJjn','COMPONENTS_PER_REQUEST','27804936OSOIWM','retrieveComponents','%ids%','ids','replace','retrieveAttachment','fileName','search','info','ParentId','COMPONENTS_PER_QUERY','../queries','../dto/flosum-component-history.dto','605405FIlFpr','FlosumComponentHistoryDto','__importDefault','manually\x20retrieving\x20components\x20from\x20salesforce','555zTIlXb','map','get','length','Logger'];a111_0x3833=function(){return _0x45052c;};return a111_0x3833();}class SalesforceRetrieverService{constructor(_0x1fc825){const _0x1da850=a111_0x4a5bc4;this[_0x1da850(0x18a)]=_0x1fc825,this[_0x1da850(0x18d)]=new core_1[(_0x1da850(0x185))](SalesforceRetrieverService[_0x1da850(0x187)]),this[_0x1da850(0x1a8)]=0xbb8,this[_0x1da850(0x17a)]=0x1f4;}async[a111_0x4a5bc4(0x1a3)](_0x75cfc){const _0x69e74e=a111_0x4a5bc4;this['logger'][_0x69e74e(0x178)]('manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0x75cfc[_0x69e74e(0x184)]);const _0x100c43=typedi_1[_0x69e74e(0x196)][_0x69e74e(0x183)](salesforce_query_service_1[_0x69e74e(0x1a6)]),_0x2c0651=_0x75cfc[_0x69e74e(0x182)](_0x561aee=>'\x27'+_0x561aee+'\x27'),_0x1098e6=[];while(_0x2c0651[_0x69e74e(0x184)]){const _0x5bcd31=_0x2c0651[_0x69e74e(0x186)](0x0,this['COMPONENTS_PER_QUERY']),_0x3d18f2=_0x100c43[_0x69e74e(0x1a2)](queries_1[_0x69e74e(0x1a5)][_0x69e74e(0x174)](_0x69e74e(0x199),_0x5bcd31[_0x69e74e(0x1a4)]())),_0x2ba36e=_0x100c43[_0x69e74e(0x1a2)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS']['replace'](_0x69e74e(0x172),_0x5bcd31['join']()))[_0x69e74e(0x189)](_0x136fdb=>_0x136fdb['map'](_0x444111=>flosum_component_history_dto_1[_0x69e74e(0x17e)][_0x69e74e(0x19a)](_0x444111))),[_0x34b46e,_0x3d8a38]=await Promise['all']([_0x3d18f2,_0x2ba36e]);for(const _0x106c75 of _0x3d8a38){const _0x4347d1=_0x34b46e[_0x69e74e(0x18e)](_0x452c6c=>_0x452c6c[_0x69e74e(0x179)]===_0x106c75['id']);_0x1098e6['push']({'fileType':_0x4347d1[_0x69e74e(0x19e)],'fileName':_0x106c75['filename'],'attachmentId':_0x4347d1['Id']});}}return _0x1098e6;}async[a111_0x4a5bc4(0x18c)](_0x5ad9de){const _0x4879f2=a111_0x4a5bc4,_0x562f8c=await this[_0x4879f2(0x1a3)](_0x5ad9de);this[_0x4879f2(0x18d)][_0x4879f2(0x178)](_0x4879f2(0x180));const _0x112713=[];for(const _0x3c18a7 of _0x562f8c){const _0x44ea4f=await this[_0x4879f2(0x18a)][_0x4879f2(0x175)](_0x3c18a7[_0x4879f2(0x19d)],!![]);_0x112713[_0x4879f2(0x19c)]({'body':_0x44ea4f['toString']('base64'),'fileName':_0x3c18a7[_0x4879f2(0x176)],'fileType':_0x3c18a7[_0x4879f2(0x192)]}),this['logger'][_0x4879f2(0x178)]('manually\x20retrieved\x20%d/%d\x20components',_0x112713[_0x4879f2(0x184)],_0x5ad9de['length']);}return _0x112713;}async['run'](_0x3cf540){const _0x378f39=a111_0x4a5bc4,_0x26f65b=[..._0x3cf540],_0x1130fb=[],_0xf3c9c0=[];while(_0x26f65b[_0x378f39(0x184)]){const _0x39b929=_0x26f65b[_0x378f39(0x186)](0x0,this[_0x378f39(0x1a8)]),_0x57a2fb=await this[_0x378f39(0x18a)][_0x378f39(0x171)](_0x39b929);_0x39b929['length']!==_0x57a2fb[_0x378f39(0x173)]['length']?(_0x26f65b[_0x378f39(0x19c)](..._0x57a2fb['ids']),_0x1130fb[_0x378f39(0x19c)](..._0x57a2fb['components'])):_0xf3c9c0[_0x378f39(0x19c)](..._0x39b929),this['logger'][_0x378f39(0x18b)](_0x378f39(0x19f),_0x3cf540['length']-_0x26f65b[_0x378f39(0x184)],_0x3cf540[_0x378f39(0x184)]);}if(_0xf3c9c0[_0x378f39(0x184)]){const _0xdeef3a=await this[_0x378f39(0x18c)](_0xf3c9c0);_0x1130fb[_0x378f39(0x19c)](..._0xdeef3a);}return _0x1130fb;}}exports[a111_0x4a5bc4(0x193)]=SalesforceRetrieverService;