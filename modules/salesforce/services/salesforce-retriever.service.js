function a129_0x1325(_0x39690a,_0x53ffeb){const _0x5815cf=a129_0xe97a();return a129_0x1325=function(_0x2db097,_0x44dc57){_0x2db097=_0x2db097-0x9c;let _0xe97a1e=_0x5815cf[_0x2db097];return _0xe97a1e;},a129_0x1325(_0x39690a,_0x53ffeb);}const a129_0x52de5d=a129_0x1325;(function(_0x4f7a9d,_0x2c3096){const _0x531b62=a129_0x1325,_0xf4597=_0x4f7a9d();while(!![]){try{const _0x3f9b8e=parseInt(_0x531b62(0xb9))/0x1*(-parseInt(_0x531b62(0xa4))/0x2)+parseInt(_0x531b62(0xc9))/0x3+parseInt(_0x531b62(0xb3))/0x4*(parseInt(_0x531b62(0xc8))/0x5)+parseInt(_0x531b62(0xad))/0x6+-parseInt(_0x531b62(0xc5))/0x7+parseInt(_0x531b62(0xcf))/0x8+-parseInt(_0x531b62(0xb8))/0x9;if(_0x3f9b8e===_0x2c3096)break;else _0xf4597['push'](_0xf4597['shift']());}catch(_0xb51811){_0xf4597['push'](_0xf4597['shift']());}}}(a129_0xe97a,0x5cb52));const a129_0x44dc57=function(){let _0x59d30e=!![];return function(_0x4fda89,_0x2f6af8){const _0x4aa3eb=_0x59d30e?function(){if(_0x2f6af8){const _0x13a10f=_0x2f6af8['apply'](_0x4fda89,arguments);return _0x2f6af8=null,_0x13a10f;}}:function(){};return _0x59d30e=![],_0x4aa3eb;};}(),a129_0x2db097=a129_0x44dc57(this,function(){const _0x16473d=a129_0x1325;return a129_0x2db097['toString']()[_0x16473d(0xcb)](_0x16473d(0xb0))[_0x16473d(0xa9)]()[_0x16473d(0xa8)](a129_0x2db097)[_0x16473d(0xcb)]('(((.+)+)+)+$');});a129_0x2db097();'use strict';var __importDefault=this&&this[a129_0x52de5d(0xab)]||function(_0x408941){const _0xa02895=a129_0x52de5d;return _0x408941&&_0x408941[_0xa02895(0xb7)]?_0x408941:{'default':_0x408941};};Object['defineProperty'](exports,a129_0x52de5d(0xb7),{'value':!![]}),exports[a129_0x52de5d(0xaf)]=void 0x0;const core_1=require(a129_0x52de5d(0xb1)),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a129_0x52de5d(0xc6)),queries_1=require('../queries'),flosum_component_history_dto_1=require('../dto/flosum-component-history.dto');class SalesforceRetrieverService{constructor(_0x1ef87d){const _0x1d6723=a129_0x52de5d;this['salesforceService']=_0x1ef87d,this[_0x1d6723(0xb2)]=new core_1[(_0x1d6723(0x9c))](SalesforceRetrieverService['name']),this[_0x1d6723(0xa0)]=0xbb8,this['COMPONENTS_PER_QUERY']=0x1f4;}async['retrieveComponentIdsFromHistoryIds'](_0x5a5b38){const _0x3bab32=a129_0x52de5d;this['logger'][_0x3bab32(0xaa)](_0x3bab32(0xa6),_0x5a5b38[_0x3bab32(0xb6)]);const _0x38cb96=typedi_1[_0x3bab32(0xc0)]['get'](salesforce_query_service_1[_0x3bab32(0xbe)]),_0x36e2a8=_0x5a5b38['map'](_0x5895da=>'\x27'+_0x5895da+'\x27'),_0x357fe3=[];while(_0x36e2a8[_0x3bab32(0xb6)]){const _0x54bc28=_0x36e2a8['splice'](0x0,this[_0x3bab32(0xc1)]),_0x2d5ea5=_0x38cb96[_0x3bab32(0xbd)](queries_1[_0x3bab32(0xba)]['replace']('%parent_ids%',_0x54bc28['join']())),_0x20055a=_0x38cb96[_0x3bab32(0xbd)](queries_1[_0x3bab32(0xa7)][_0x3bab32(0xc4)](_0x3bab32(0xae),_0x54bc28[_0x3bab32(0xbf)]()))[_0x3bab32(0xbb)](_0x513308=>_0x513308[_0x3bab32(0xa1)](_0x33cfef=>flosum_component_history_dto_1[_0x3bab32(0xc2)][_0x3bab32(0xce)](_0x33cfef))),[_0x5e80b7,_0x5225c1]=await Promise['all']([_0x2d5ea5,_0x20055a]);for(const _0x488bcb of _0x5225c1){const _0x4d4140=_0x5e80b7[_0x3bab32(0x9f)](_0x47ade0=>_0x47ade0[_0x3bab32(0xbc)]===_0x488bcb['id']);_0x4d4140&&_0x357fe3[_0x3bab32(0x9d)]({'fileType':_0x4d4140['Name'],'fileName':_0x488bcb[_0x3bab32(0x9e)],'attachmentId':_0x4d4140['Id']});}}return _0x357fe3;}async[a129_0x52de5d(0xd0)](_0xf95459){const _0x5abaf5=a129_0x52de5d,_0x102638=await this['retrieveComponentIdsFromHistoryIds'](_0xf95459);this['logger'][_0x5abaf5(0xaa)](_0x5abaf5(0xa2));const _0xa29413=[];for(const _0x482c17 of _0x102638){const _0x2cc46=await this['salesforceService'][_0x5abaf5(0xc7)](_0x482c17[_0x5abaf5(0xb5)],!![]);_0xa29413['push']({'body':_0x2cc46[_0x5abaf5(0xa9)](_0x5abaf5(0xa3)),'fileName':_0x482c17['fileName'],'fileType':_0x482c17[_0x5abaf5(0xca)]}),this['logger'][_0x5abaf5(0xaa)](_0x5abaf5(0xc3),_0xa29413[_0x5abaf5(0xb6)],_0xf95459[_0x5abaf5(0xb6)]);}return _0xa29413;}async[a129_0x52de5d(0xcd)](_0x1bf88a){const _0x5141d7=a129_0x52de5d,_0x1fce6f=[..._0x1bf88a],_0x5bf1ca=[],_0x2236ee=[];while(_0x1fce6f[_0x5141d7(0xb6)]){const _0x1e94e9=_0x1fce6f[_0x5141d7(0xa5)](0x0,this[_0x5141d7(0xa0)]),_0x2a7de1=await this[_0x5141d7(0xac)]['retrieveComponents'](_0x1e94e9);_0x1e94e9[_0x5141d7(0xb6)]!==_0x2a7de1[_0x5141d7(0xcc)][_0x5141d7(0xb6)]?(_0x1fce6f[_0x5141d7(0x9d)](..._0x2a7de1['ids']),_0x5bf1ca[_0x5141d7(0x9d)](..._0x2a7de1[_0x5141d7(0xb4)])):_0x2236ee['push'](..._0x1e94e9),this['logger']['log']('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x1bf88a['length']-_0x1fce6f['length'],_0x1bf88a['length']);}if(_0x2236ee[_0x5141d7(0xb6)]){const _0x4b2d7e=await this[_0x5141d7(0xd0)](_0x2236ee);_0x5bf1ca[_0x5141d7(0x9d)](..._0x4b2d7e);}return _0x5bf1ca;}}exports['SalesforceRetrieverService']=SalesforceRetrieverService;function a129_0xe97a(){const _0x1fba81=['GET_ATTACHMENT_BY_PARENT_IDS_QUERY','then','ParentId','query','SalesforceQueryService','join','default','COMPONENTS_PER_QUERY','FlosumComponentHistoryDto','manually\x20retrieved\x20%d/%d\x20components','replace','2843344fAPafj','./salesforce-query.service','retrieveAttachment','5GuDNtz','914355kKuqRZ','fileType','search','ids','run','fromSalesforce','4432056WBMaKx','retrieveLastComponents','Logger','push','filename','find','COMPONENTS_PER_REQUEST','map','manually\x20retrieving\x20components\x20from\x20salesforce','base64','2054mjpORk','splice','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','GET_COMPONENT_HISTORIES_BY_IDS','constructor','toString','info','__importDefault','salesforceService','3920838SnoiUg','%ids%','SalesforceRetrieverService','(((.+)+)+)+$','../../../core','logger','40536WeUMOd','components','attachmentId','length','__esModule','19548WDKWry','715iknkIt'];a129_0xe97a=function(){return _0x1fba81;};return a129_0xe97a();}