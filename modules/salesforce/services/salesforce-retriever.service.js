const a111_0x713367=a111_0x2e60;(function(_0x11e55e,_0x4a0d7e){const _0x16af6a=a111_0x2e60,_0x197fd3=_0x11e55e();while(!![]){try{const _0x2b27c6=-parseInt(_0x16af6a(0xa8))/0x1*(parseInt(_0x16af6a(0x74))/0x2)+-parseInt(_0x16af6a(0x93))/0x3*(-parseInt(_0x16af6a(0x99))/0x4)+-parseInt(_0x16af6a(0xab))/0x5*(parseInt(_0x16af6a(0xad))/0x6)+parseInt(_0x16af6a(0x9d))/0x7+parseInt(_0x16af6a(0xa9))/0x8*(parseInt(_0x16af6a(0xa3))/0x9)+-parseInt(_0x16af6a(0x9c))/0xa*(-parseInt(_0x16af6a(0x83))/0xb)+-parseInt(_0x16af6a(0x9a))/0xc;if(_0x2b27c6===_0x4a0d7e)break;else _0x197fd3['push'](_0x197fd3['shift']());}catch(_0x1dd6c1){_0x197fd3['push'](_0x197fd3['shift']());}}}(a111_0x1658,0xa69f8));const a111_0x437013=function(){let _0x3fa299=!![];return function(_0x24e166,_0x5de1b2){const _0x2b1dd9=_0x3fa299?function(){const _0x1f0090=a111_0x2e60;if(_0x5de1b2){const _0x53f35d=_0x5de1b2[_0x1f0090(0x88)](_0x24e166,arguments);return _0x5de1b2=null,_0x53f35d;}}:function(){};return _0x3fa299=![],_0x2b1dd9;};}(),a111_0x2e1b35=a111_0x437013(this,function(){const _0x2a6598=a111_0x2e60;return a111_0x2e1b35[_0x2a6598(0x89)]()['search'](_0x2a6598(0x84))[_0x2a6598(0x89)]()[_0x2a6598(0xa1)](a111_0x2e1b35)[_0x2a6598(0x94)](_0x2a6598(0x84));});a111_0x2e1b35();'use strict';var __importDefault=this&&this[a111_0x713367(0x75)]||function(_0x365782){return _0x365782&&_0x365782['__esModule']?_0x365782:{'default':_0x365782};};function a111_0x1658(){const _0x3965a7=['map','%ids%','push','manually\x20retrieving\x20components\x20from\x20salesforce','retrieveLastComponents','splice','__esModule','SalesforceQueryService','fileType','2547446Ggexqh','(((.+)+)+)+$','attachmentId','length','get','apply','toString','all','retrieveComponentIdsFromHistoryIds','log','SalesforceRetrieverService','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','join','Name','name','then','165efyiFD','search','salesforceService','GET_COMPONENT_HISTORIES_BY_IDS','base64','FlosumComponentHistoryDto','58828BmgnSy','3241584cjzDTF','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','30gvYvSy','1473773SuwywX','fromSalesforce','logger','fileName','constructor','COMPONENTS_PER_REQUEST','54ISvWWO','manually\x20retrieved\x20%d/%d\x20components','replace','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','query','859007DaOXlV','1105048WAyKMI','info','2785CDLfLV','../dto/flosum-component-history.dto','7878GIzjsL','ids','find','./salesforce-query.service','COMPONENTS_PER_QUERY','2XLWEgi','__importDefault','../queries','default','%parent_ids%','ParentId'];a111_0x1658=function(){return _0x3965a7;};return a111_0x1658();}Object['defineProperty'](exports,a111_0x713367(0x80),{'value':!![]}),exports['SalesforceRetrieverService']=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require('typedi')),salesforce_query_service_1=require(a111_0x713367(0xb0)),queries_1=require(a111_0x713367(0x76)),flosum_component_history_dto_1=require(a111_0x713367(0xac));class SalesforceRetrieverService{constructor(_0x42a75b){const _0x582c61=a111_0x713367;this['salesforceService']=_0x42a75b,this[_0x582c61(0x9f)]=new core_1['Logger'](SalesforceRetrieverService[_0x582c61(0x91)]),this[_0x582c61(0xa2)]=0xbb8,this[_0x582c61(0x73)]=0x1f4;}async[a111_0x713367(0x8b)](_0x4e39d5){const _0x381192=a111_0x713367;this['logger'][_0x381192(0xaa)](_0x381192(0xa6),_0x4e39d5[_0x381192(0x86)]);const _0x48803f=typedi_1[_0x381192(0x77)][_0x381192(0x87)](salesforce_query_service_1[_0x381192(0x81)]),_0x6c2ff5=_0x4e39d5[_0x381192(0x7a)](_0x2d6a2b=>'\x27'+_0x2d6a2b+'\x27'),_0x3729e4=[];while(_0x6c2ff5[_0x381192(0x86)]){const _0xca42c0=_0x6c2ff5[_0x381192(0x7f)](0x0,this[_0x381192(0x73)]),_0x2d438b=_0x48803f[_0x381192(0xa7)](queries_1[_0x381192(0x8e)]['replace'](_0x381192(0x78),_0xca42c0[_0x381192(0x8f)]())),_0x52c6ee=_0x48803f[_0x381192(0xa7)](queries_1[_0x381192(0x96)][_0x381192(0xa5)](_0x381192(0x7b),_0xca42c0['join']()))[_0x381192(0x92)](_0x434788=>_0x434788['map'](_0x26587a=>flosum_component_history_dto_1[_0x381192(0x98)][_0x381192(0x9e)](_0x26587a))),[_0xb8a2e2,_0x34f5de]=await Promise[_0x381192(0x8a)]([_0x2d438b,_0x52c6ee]);for(const _0x30b252 of _0x34f5de){const _0x27f15f=_0xb8a2e2[_0x381192(0xaf)](_0x2afe4d=>_0x2afe4d[_0x381192(0x79)]===_0x30b252['id']);_0x3729e4[_0x381192(0x7c)]({'fileType':_0x27f15f[_0x381192(0x90)],'fileName':_0x30b252['filename'],'attachmentId':_0x27f15f['Id']});}}return _0x3729e4;}async[a111_0x713367(0x7e)](_0x5a993e){const _0x2657a9=a111_0x713367,_0xeb513e=await this[_0x2657a9(0x8b)](_0x5a993e);this[_0x2657a9(0x9f)][_0x2657a9(0xaa)](_0x2657a9(0x7d));const _0x3289fd=[];for(const _0x4df3af of _0xeb513e){const _0x55f0cb=await this[_0x2657a9(0x95)]['retrieveAttachment'](_0x4df3af[_0x2657a9(0x85)],!![]);_0x3289fd[_0x2657a9(0x7c)]({'body':_0x55f0cb[_0x2657a9(0x89)](_0x2657a9(0x97)),'fileName':_0x4df3af[_0x2657a9(0xa0)],'fileType':_0x4df3af[_0x2657a9(0x82)]}),this[_0x2657a9(0x9f)][_0x2657a9(0xaa)](_0x2657a9(0xa4),_0x3289fd[_0x2657a9(0x86)],_0x5a993e[_0x2657a9(0x86)]);}return _0x3289fd;}async['run'](_0x470fde){const _0x2525f7=a111_0x713367,_0xe2531a=[..._0x470fde],_0x36e193=[],_0x2cd088=[];while(_0xe2531a['length']){const _0x3e5b66=_0xe2531a['splice'](0x0,this[_0x2525f7(0xa2)]),_0x25ba7d=await this[_0x2525f7(0x95)]['retrieveComponents'](_0x3e5b66);_0x3e5b66[_0x2525f7(0x86)]!==_0x25ba7d[_0x2525f7(0xae)][_0x2525f7(0x86)]?(_0xe2531a[_0x2525f7(0x7c)](..._0x25ba7d[_0x2525f7(0xae)]),_0x36e193['push'](..._0x25ba7d['components'])):_0x2cd088['push'](..._0x3e5b66),this[_0x2525f7(0x9f)][_0x2525f7(0x8c)](_0x2525f7(0x9b),_0x470fde['length']-_0xe2531a[_0x2525f7(0x86)],_0x470fde[_0x2525f7(0x86)]);}if(_0x2cd088['length']){const _0x1f3cf0=await this[_0x2525f7(0x7e)](_0x2cd088);_0x36e193[_0x2525f7(0x7c)](..._0x1f3cf0);}return _0x36e193;}}function a111_0x2e60(_0x2a0dab,_0x521174){const _0x229a65=a111_0x1658();return a111_0x2e60=function(_0x2e1b35,_0x437013){_0x2e1b35=_0x2e1b35-0x73;let _0x165863=_0x229a65[_0x2e1b35];return _0x165863;},a111_0x2e60(_0x2a0dab,_0x521174);}exports[a111_0x713367(0x8d)]=SalesforceRetrieverService;