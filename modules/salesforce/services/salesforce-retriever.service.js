const a110_0x1f7087=a110_0x26fd;(function(_0x1e6327,_0x44a461){const _0x5805f6=a110_0x26fd,_0x4eeca9=_0x1e6327();while(!![]){try{const _0x30fbb8=parseInt(_0x5805f6(0x202))/0x1+-parseInt(_0x5805f6(0x1ec))/0x2*(-parseInt(_0x5805f6(0x1dd))/0x3)+-parseInt(_0x5805f6(0x1f1))/0x4+-parseInt(_0x5805f6(0x1f0))/0x5*(parseInt(_0x5805f6(0x1f8))/0x6)+parseInt(_0x5805f6(0x208))/0x7+parseInt(_0x5805f6(0x1f3))/0x8+-parseInt(_0x5805f6(0x20f))/0x9*(parseInt(_0x5805f6(0x1ef))/0xa);if(_0x30fbb8===_0x44a461)break;else _0x4eeca9['push'](_0x4eeca9['shift']());}catch(_0xe9f9da){_0x4eeca9['push'](_0x4eeca9['shift']());}}}(a110_0x2e53,0x2df12));const a110_0x3917ee=function(){let _0x354905=!![];return function(_0x484c54,_0x28080d){const _0x13a562=_0x354905?function(){const _0x4898fa=a110_0x26fd;if(_0x28080d){const _0x5f0dbd=_0x28080d[_0x4898fa(0x20e)](_0x484c54,arguments);return _0x28080d=null,_0x5f0dbd;}}:function(){};return _0x354905=![],_0x13a562;};}(),a110_0x4e2587=a110_0x3917ee(this,function(){const _0x342b93=a110_0x26fd;return a110_0x4e2587[_0x342b93(0x1e1)]()[_0x342b93(0x20c)](_0x342b93(0x1e8))['toString']()['constructor'](a110_0x4e2587)[_0x342b93(0x20c)](_0x342b93(0x1e8));});a110_0x4e2587();function a110_0x26fd(_0x48892d,_0xa28c43){const _0xaca711=a110_0x2e53();return a110_0x26fd=function(_0x4e2587,_0x3917ee){_0x4e2587=_0x4e2587-0x1dd;let _0x2e537d=_0xaca711[_0x4e2587];return _0x2e537d;},a110_0x26fd(_0x48892d,_0xa28c43);}'use strict';var __importDefault=this&&this[a110_0x1f7087(0x213)]||function(_0x55c356){const _0x2a6bc0=a110_0x1f7087;return _0x55c356&&_0x55c356[_0x2a6bc0(0x1eb)]?_0x55c356:{'default':_0x55c356};};Object[a110_0x1f7087(0x206)](exports,a110_0x1f7087(0x1eb),{'value':!![]}),exports[a110_0x1f7087(0x1e4)]=void 0x0;function a110_0x2e53(){const _0x9f5526=['push','components','retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest','length','retrieveAttachment','retrieveLastComponents','ids','find','351784VYekPT','query','../../../core','GET_COMPONENT_HISTORIES_BY_IDS','defineProperty','Name','755874nJwODj','retrieveComponentIdsFromHistoryIds','%parent_ids%','name','search','salesforceService','apply','101610hDaelX','COMPONENTS_PER_REQUEST','get','run','__importDefault','Logger','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','manually\x20retrieving\x20components\x20from\x20salesforce','splice','../dto/flosum-component-history.dto','530895XnXQEE','fromSalesforce','info','attachmentId','toString','SalesforceQueryService','map','SalesforceRetrieverService','retrieveComponents','fileName','FlosumComponentHistoryDto','(((.+)+)+)+$','replace','%ids%','__esModule','2GFEmlI','./salesforce-query.service','typedi','170HMbzKz','1013885aSFazw','816964cfaOrl','log','1203160WtNxyc','COMPONENTS_PER_QUERY','default','logger','../queries','6UAzpVS','ParentId'];a110_0x2e53=function(){return _0x9f5526;};return a110_0x2e53();}const core_1=require(a110_0x1f7087(0x204)),typedi_1=__importDefault(require(a110_0x1f7087(0x1ee))),salesforce_query_service_1=require(a110_0x1f7087(0x1ed)),queries_1=require(a110_0x1f7087(0x1f7)),flosum_component_history_dto_1=require(a110_0x1f7087(0x218));class SalesforceRetrieverService{constructor(_0x267942){const _0x24d7e7=a110_0x1f7087;this[_0x24d7e7(0x20d)]=_0x267942,this[_0x24d7e7(0x1f6)]=new core_1[(_0x24d7e7(0x214))](SalesforceRetrieverService[_0x24d7e7(0x20b)]),this[_0x24d7e7(0x210)]=0xbb8,this[_0x24d7e7(0x1f4)]=0x1f4;}async[a110_0x1f7087(0x209)](_0x557f8e){const _0x5b8128=a110_0x1f7087;this[_0x5b8128(0x1f6)][_0x5b8128(0x1df)]('manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)',_0x557f8e['length']);const _0x3a6865=typedi_1[_0x5b8128(0x1f5)][_0x5b8128(0x211)](salesforce_query_service_1[_0x5b8128(0x1e2)]),_0x45ae18=_0x557f8e[_0x5b8128(0x1e3)](_0x75dd6b=>'\x27'+_0x75dd6b+'\x27'),_0x4ba57f=[];while(_0x45ae18[_0x5b8128(0x1fd)]){const _0x1b7e3b=_0x45ae18[_0x5b8128(0x217)](0x0,this['COMPONENTS_PER_QUERY']),_0x416b36=_0x3a6865[_0x5b8128(0x203)](queries_1[_0x5b8128(0x215)][_0x5b8128(0x1e9)](_0x5b8128(0x20a),_0x1b7e3b['join']())),_0x4eb5ef=_0x3a6865[_0x5b8128(0x203)](queries_1[_0x5b8128(0x205)]['replace'](_0x5b8128(0x1ea),_0x1b7e3b['join']()))['then'](_0x388b10=>_0x388b10['map'](_0x345120=>flosum_component_history_dto_1[_0x5b8128(0x1e7)][_0x5b8128(0x1de)](_0x345120))),[_0x3296f9,_0x303915]=await Promise['all']([_0x416b36,_0x4eb5ef]);for(const _0x4b9c53 of _0x303915){const _0x10f6ca=_0x3296f9[_0x5b8128(0x201)](_0x20eb17=>_0x20eb17[_0x5b8128(0x1f9)]===_0x4b9c53['id']);_0x4ba57f['push']({'fileType':_0x10f6ca[_0x5b8128(0x207)],'fileName':_0x4b9c53['filename'],'attachmentId':_0x10f6ca['Id']});}}return _0x4ba57f;}async['retrieveLastComponents'](_0x4cbedd){const _0x5d398c=a110_0x1f7087,_0x7cbe63=await this[_0x5d398c(0x209)](_0x4cbedd);this['logger'][_0x5d398c(0x1df)](_0x5d398c(0x216));const _0x394742=[];for(const _0x1ec71a of _0x7cbe63){const _0x3b329d=await this[_0x5d398c(0x20d)][_0x5d398c(0x1fe)](_0x1ec71a[_0x5d398c(0x1e0)],!![]);_0x394742[_0x5d398c(0x1fa)]({'body':_0x3b329d[_0x5d398c(0x1e1)]('base64'),'fileName':_0x1ec71a[_0x5d398c(0x1e6)],'fileType':_0x1ec71a['fileType']}),this[_0x5d398c(0x1f6)]['info']('manually\x20retrieved\x20%d/%d\x20components',_0x394742['length'],_0x4cbedd[_0x5d398c(0x1fd)]);}return _0x394742;}async[a110_0x1f7087(0x212)](_0x4b934a){const _0x1377f1=a110_0x1f7087,_0x4e4725=[..._0x4b934a],_0x5cc460=[],_0x3ff563=[];while(_0x4e4725[_0x1377f1(0x1fd)]){const _0x5e3666=_0x4e4725[_0x1377f1(0x217)](0x0,this[_0x1377f1(0x210)]),_0x5ee4b3=await this[_0x1377f1(0x20d)][_0x1377f1(0x1e5)](_0x5e3666);_0x5e3666[_0x1377f1(0x1fd)]!==_0x5ee4b3[_0x1377f1(0x200)]['length']?(_0x4e4725[_0x1377f1(0x1fa)](..._0x5ee4b3[_0x1377f1(0x200)]),_0x5cc460[_0x1377f1(0x1fa)](..._0x5ee4b3[_0x1377f1(0x1fb)])):_0x3ff563[_0x1377f1(0x1fa)](..._0x5e3666),this[_0x1377f1(0x1f6)][_0x1377f1(0x1f2)](_0x1377f1(0x1fc),_0x4b934a[_0x1377f1(0x1fd)]-_0x4e4725[_0x1377f1(0x1fd)],_0x4b934a['length']);}if(_0x3ff563[_0x1377f1(0x1fd)]){const _0x46165d=await this[_0x1377f1(0x1ff)](_0x3ff563);_0x5cc460[_0x1377f1(0x1fa)](..._0x46165d);}return _0x5cc460;}}exports[a110_0x1f7087(0x1e4)]=SalesforceRetrieverService;