const a128_0x1a8294=a128_0x5ef1;(function(_0x448e9f,_0x87c4e2){const _0x5e1ba8=a128_0x5ef1,_0x1be874=_0x448e9f();while(!![]){try{const _0x52cd82=parseInt(_0x5e1ba8(0x126))/0x1*(-parseInt(_0x5e1ba8(0x120))/0x2)+-parseInt(_0x5e1ba8(0x12a))/0x3+-parseInt(_0x5e1ba8(0x139))/0x4+parseInt(_0x5e1ba8(0x13a))/0x5*(parseInt(_0x5e1ba8(0x136))/0x6)+-parseInt(_0x5e1ba8(0x134))/0x7*(parseInt(_0x5e1ba8(0x11d))/0x8)+parseInt(_0x5e1ba8(0x117))/0x9*(-parseInt(_0x5e1ba8(0x143))/0xa)+parseInt(_0x5e1ba8(0x142))/0xb;if(_0x52cd82===_0x87c4e2)break;else _0x1be874['push'](_0x1be874['shift']());}catch(_0x270fc6){_0x1be874['push'](_0x1be874['shift']());}}}(a128_0x2fc5,0x9bf0b));const a128_0x5c04d6=function(){let _0xc7b0a6=!![];return function(_0x4c4304,_0x50d978){const _0x380f62=_0xc7b0a6?function(){const _0x573097=a128_0x5ef1;if(_0x50d978){const _0x4901a7=_0x50d978[_0x573097(0x11b)](_0x4c4304,arguments);return _0x50d978=null,_0x4901a7;}}:function(){};return _0xc7b0a6=![],_0x380f62;};}(),a128_0xfdc072=a128_0x5c04d6(this,function(){const _0x4fc3ba=a128_0x5ef1;return a128_0xfdc072[_0x4fc3ba(0x111)]()[_0x4fc3ba(0x135)](_0x4fc3ba(0x12d))[_0x4fc3ba(0x111)]()['constructor'](a128_0xfdc072)[_0x4fc3ba(0x135)](_0x4fc3ba(0x12d));});a128_0xfdc072();function a128_0x2fc5(){const _0x2a7106=['components','ids','push','filename','query','30365665rYAAXt','37010eAeLVu','SalesforceRetrieverService','join','FlosumComponentHistoryDto','splice','salesforceService','toString','COMPONENTS_PER_QUERY','get','retrieveAttachment','retrieveComponents','then','504RZCVij','GET_ATTACHMENT_BY_PARENT_IDS_QUERY','length','manually\x20retrieved\x20%d/%d\x20components','apply','./salesforce-query.service','112bBUUqk','name','__importDefault','2aPZfWo','../dto/flosum-component-history.dto','find','COMPONENTS_PER_REQUEST','fileType','map','770898VpncfT','run','attachmentId','replace','1471212bmTtlo','info','logger','(((.+)+)+)+$','typedi','manually\x20retrieving\x20component\x20ids\x20from\x20history\x20ids\x20(%d)','fileName','%parent_ids%','Name','fromSalesforce','331051zKhLku','search','63714rqpDqj','ParentId','retrieveLastComponents','474208JvFDlP','60MSuwXr','../../../core','retrieveComponentIdsFromHistoryIds'];a128_0x2fc5=function(){return _0x2a7106;};return a128_0x2fc5();}'use strict';var __importDefault=this&&this[a128_0x1a8294(0x11f)]||function(_0x29cb3b){return _0x29cb3b&&_0x29cb3b['__esModule']?_0x29cb3b:{'default':_0x29cb3b};};function a128_0x5ef1(_0x24f262,_0x47d143){const _0x4ff643=a128_0x2fc5();return a128_0x5ef1=function(_0xfdc072,_0x5c04d6){_0xfdc072=_0xfdc072-0x111;let _0x2fc54b=_0x4ff643[_0xfdc072];return _0x2fc54b;},a128_0x5ef1(_0x24f262,_0x47d143);}Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a128_0x1a8294(0x144)]=void 0x0;const core_1=require(a128_0x1a8294(0x13b)),typedi_1=__importDefault(require(a128_0x1a8294(0x12e))),salesforce_query_service_1=require(a128_0x1a8294(0x11c)),queries_1=require('../queries'),flosum_component_history_dto_1=require(a128_0x1a8294(0x121));class SalesforceRetrieverService{constructor(_0x51880e){const _0x2a8995=a128_0x1a8294;this[_0x2a8995(0x148)]=_0x51880e,this[_0x2a8995(0x12c)]=new core_1['Logger'](SalesforceRetrieverService[_0x2a8995(0x11e)]),this[_0x2a8995(0x123)]=0xbb8,this[_0x2a8995(0x112)]=0x1f4;}async[a128_0x1a8294(0x13c)](_0x2e7877){const _0x4da4e6=a128_0x1a8294;this['logger']['info'](_0x4da4e6(0x12f),_0x2e7877[_0x4da4e6(0x119)]);const _0x586a54=typedi_1['default'][_0x4da4e6(0x113)](salesforce_query_service_1['SalesforceQueryService']),_0x2e79ad=_0x2e7877['map'](_0x20aa8d=>'\x27'+_0x20aa8d+'\x27'),_0x576c01=[];while(_0x2e79ad[_0x4da4e6(0x119)]){const _0x3bed5f=_0x2e79ad[_0x4da4e6(0x147)](0x0,this[_0x4da4e6(0x112)]),_0x492cc6=_0x586a54[_0x4da4e6(0x141)](queries_1[_0x4da4e6(0x118)][_0x4da4e6(0x129)](_0x4da4e6(0x131),_0x3bed5f[_0x4da4e6(0x145)]())),_0x386ed5=_0x586a54[_0x4da4e6(0x141)](queries_1['GET_COMPONENT_HISTORIES_BY_IDS'][_0x4da4e6(0x129)]('%ids%',_0x3bed5f['join']()))[_0x4da4e6(0x116)](_0x594028=>_0x594028[_0x4da4e6(0x125)](_0x52a13e=>flosum_component_history_dto_1[_0x4da4e6(0x146)][_0x4da4e6(0x133)](_0x52a13e))),[_0x30bb8d,_0x461ff7]=await Promise['all']([_0x492cc6,_0x386ed5]);for(const _0x52b80c of _0x461ff7){const _0x538b57=_0x30bb8d[_0x4da4e6(0x122)](_0x1dcc57=>_0x1dcc57[_0x4da4e6(0x137)]===_0x52b80c['id']);_0x538b57&&_0x576c01['push']({'fileType':_0x538b57[_0x4da4e6(0x132)],'fileName':_0x52b80c[_0x4da4e6(0x140)],'attachmentId':_0x538b57['Id']});}}return _0x576c01;}async[a128_0x1a8294(0x138)](_0x8c91){const _0x5a219a=a128_0x1a8294,_0x1cd5ed=await this[_0x5a219a(0x13c)](_0x8c91);this['logger']['info']('manually\x20retrieving\x20components\x20from\x20salesforce');const _0x1addb4=[];for(const _0x596abb of _0x1cd5ed){const _0x504ca3=await this['salesforceService'][_0x5a219a(0x114)](_0x596abb[_0x5a219a(0x128)],!![]);_0x1addb4['push']({'body':_0x504ca3[_0x5a219a(0x111)]('base64'),'fileName':_0x596abb[_0x5a219a(0x130)],'fileType':_0x596abb[_0x5a219a(0x124)]}),this[_0x5a219a(0x12c)][_0x5a219a(0x12b)](_0x5a219a(0x11a),_0x1addb4[_0x5a219a(0x119)],_0x8c91[_0x5a219a(0x119)]);}return _0x1addb4;}async[a128_0x1a8294(0x127)](_0x3c59c9){const _0x354a8e=a128_0x1a8294,_0x413ab5=[..._0x3c59c9],_0x511829=[],_0x244585=[];while(_0x413ab5['length']){const _0x3907c3=_0x413ab5['splice'](0x0,this[_0x354a8e(0x123)]),_0x352212=await this[_0x354a8e(0x148)][_0x354a8e(0x115)](_0x3907c3);_0x3907c3[_0x354a8e(0x119)]!==_0x352212[_0x354a8e(0x13e)]['length']?(_0x413ab5[_0x354a8e(0x13f)](..._0x352212['ids']),_0x511829[_0x354a8e(0x13f)](..._0x352212[_0x354a8e(0x13d)])):_0x244585[_0x354a8e(0x13f)](..._0x3907c3),this[_0x354a8e(0x12c)]['log']('retrieved\x20%d/%d\x20components\x20from\x20salesforce\x20rest',_0x3c59c9[_0x354a8e(0x119)]-_0x413ab5[_0x354a8e(0x119)],_0x3c59c9['length']);}if(_0x244585['length']){const _0x2a5ba6=await this[_0x354a8e(0x138)](_0x244585);_0x511829['push'](..._0x2a5ba6);}return _0x511829;}}exports[a128_0x1a8294(0x144)]=SalesforceRetrieverService;