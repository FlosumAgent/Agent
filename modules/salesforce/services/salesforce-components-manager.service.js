const a121_0x18ef5a=a121_0x4101;(function(_0x5bc40e,_0x4d20c3){const _0x47f02f=a121_0x4101,_0x3374a7=_0x5bc40e();while(!![]){try{const _0x31d96a=parseInt(_0x47f02f(0x1ea))/0x1*(-parseInt(_0x47f02f(0x1d9))/0x2)+-parseInt(_0x47f02f(0x201))/0x3*(parseInt(_0x47f02f(0x20c))/0x4)+-parseInt(_0x47f02f(0x211))/0x5*(-parseInt(_0x47f02f(0x219))/0x6)+-parseInt(_0x47f02f(0x204))/0x7*(parseInt(_0x47f02f(0x1dc))/0x8)+-parseInt(_0x47f02f(0x224))/0x9*(parseInt(_0x47f02f(0x218))/0xa)+parseInt(_0x47f02f(0x1e6))/0xb+-parseInt(_0x47f02f(0x1da))/0xc*(-parseInt(_0x47f02f(0x1ca))/0xd);if(_0x31d96a===_0x4d20c3)break;else _0x3374a7['push'](_0x3374a7['shift']());}catch(_0x545c2c){_0x3374a7['push'](_0x3374a7['shift']());}}}(a121_0x3e3e,0xe1219));const a121_0x276d6b=function(){let _0x2a49f9=!![];return function(_0x351255,_0x16b65b){const _0x577468=_0x2a49f9?function(){if(_0x16b65b){const _0x3d8a16=_0x16b65b['apply'](_0x351255,arguments);return _0x16b65b=null,_0x3d8a16;}}:function(){};return _0x2a49f9=![],_0x577468;};}(),a121_0x1666f9=a121_0x276d6b(this,function(){const _0x16aa87=a121_0x4101;return a121_0x1666f9[_0x16aa87(0x20b)]()[_0x16aa87(0x1e5)](_0x16aa87(0x20a))[_0x16aa87(0x20b)]()[_0x16aa87(0x226)](a121_0x1666f9)[_0x16aa87(0x1e5)](_0x16aa87(0x20a));});a121_0x1666f9();function a121_0x3e3e(){const _0xa658c8=['createPostRequest','(((.+)+)+)+$','toString','84HooMLv','fetchCommitManifestsByComponentIds','.id}','componentType','proceedComponentMeta','25uNTnVw','proceededComponentsMeta','Branch','Is_From_Agent__c','FLOSUM_ATTACHMENT','SalesforceComponentsManager','delete','1123380AFDzlr','461082paTEmD','FLOSUM_COMMIT_MANIFEST','recordTypes','type','push','../utils/composite.utils','FLOSUM_COMPONENT','../../../constants','Could\x20not\x20find\x20meta\x20data\x20for\x20','ParentId','Last_Modified_Date__c','9yJZknT','File_Name__c','constructor','prepareComponentAttachmentRecord','prepareComponentRecord','createDeleteRequest','default','keys','body','generateAsync','Committed_On__c','ContentType','typedi','Name','781833RlaULY','Changed_By__c','crc','FLOSUM_NAMESPACE','Component_Type__c','./salesforce-git-sync.service','repositoryId','toISOString','componentName','Body','Description','Could\x20not\x20proceed\x20component\x20','SalesforceGitSyncService','files','version','44452NvfznH','564dBBDQL','Version__c','60408tHtbSX','base64','Component__c',']\x20-\x20meta\x20not\x20found','Changed_On__c','branchId','prepareComponentHistoryRecord','FLOSUM_COMPONENT_HISTORY','defineProperty','search','5477835smkKMc','update','Last_Updated_By__c','Branch__c','71QFiCQg','../../parsers/utils/zip','Repository','DEFLATE','prepareCommitManifest','RecordTypeId','file','../errors/salesforce.error','createPatchRequest','componentId','map','name','insert','get','application/zip','username','__esModule','gitSync','__importDefault','request','reference','createZip','FLOSUM_GIT_NAMESPACE','141516zjSeTi','CRC32__c','getProceededComponentsMeta','98xSYTst','Component_Name__c','Last_Modified_By__c','Source__c','find'];a121_0x3e3e=function(){return _0xa658c8;};return a121_0x3e3e();}'use strict';var __importDefault=this&&this[a121_0x18ef5a(0x1fc)]||function(_0x504145){return _0x504145&&_0x504145['__esModule']?_0x504145:{'default':_0x504145};};Object[a121_0x18ef5a(0x1e4)](exports,a121_0x18ef5a(0x1fa),{'value':!![]}),exports[a121_0x18ef5a(0x216)]=void 0x0;function a121_0x4101(_0x6e71f7,_0x188d71){const _0x4b410e=a121_0x3e3e();return a121_0x4101=function(_0x1666f9,_0x276d6b){_0x1666f9=_0x1666f9-0x1c5;let _0x3e3edd=_0x4b410e[_0x1666f9];return _0x3e3edd;},a121_0x4101(_0x6e71f7,_0x188d71);}const constants_1=require(a121_0x18ef5a(0x220)),core_1=require('../../../core'),zip_1=require(a121_0x18ef5a(0x1eb)),typedi_1=__importDefault(require(a121_0x18ef5a(0x1c8))),salesforce_error_1=require(a121_0x18ef5a(0x1f1)),composite_utils_1=require(a121_0x18ef5a(0x21e)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a121_0x18ef5a(0x1cf));class SalesforceComponentsManager{constructor(_0x8a31a9,_0x5a22f7,_0x24b6af,_0x571751,_0x5f3507){const _0x577cb=a121_0x18ef5a;this[_0x577cb(0x1d0)]=_0x8a31a9,this[_0x577cb(0x1e1)]=_0x5a22f7,this['username']=_0x24b6af,this[_0x577cb(0x21b)]=_0x571751,this['proceededComponentsMeta']=_0x5f3507,this['logger']=new core_1['Logger'](SalesforceComponentsManager[_0x577cb(0x1f5)]),this['gitSync']=typedi_1[_0x577cb(0x22a)][_0x577cb(0x1f7)](salesforce_git_sync_service_1[_0x577cb(0x1d6)]);}[a121_0x18ef5a(0x210)](_0x29d1a9,_0x5955ad){const _0x577e8d=a121_0x18ef5a,_0x522c0e=flosum_naming_utils_1['extractFieldsFromRecord'](_0x29d1a9,[_0x577e8d(0x1ce),'Component_Name__c',_0x577e8d(0x1db)]);this[_0x577e8d(0x212)][_0x577e8d(0x21d)]({'componentId':'','reference':_0x5955ad,'version':_0x522c0e[_0x577e8d(0x1db)],'componentName':_0x522c0e[_0x577e8d(0x205)],'componentType':_0x522c0e[_0x577e8d(0x1ce)]});}['prepareCommitManifest'](_0x5af7e1,_0x2867fc){const _0x58bb4b=a121_0x18ef5a,{request:_0x3333e9}=composite_utils_1['createPostRequest'](constants_1[_0x58bb4b(0x21a)],{[constants_1[_0x58bb4b(0x1cd)]+'Commit__c']:_0x5af7e1,[constants_1[_0x58bb4b(0x1cd)]+'Component_History__c']:_0x2867fc,[constants_1[_0x58bb4b(0x200)]+_0x58bb4b(0x214)]:!![]});return _0x3333e9;}async[a121_0x18ef5a(0x227)](_0x24a957,_0x111664){const _0x1ca65e=a121_0x18ef5a,_0x4e5849={},_0x79f9a2=zip_1['Zip'][_0x1ca65e(0x1ff)]();for(const _0x1f6510 of Object[_0x1ca65e(0x22b)](_0x24a957[_0x1ca65e(0x1d7)])){_0x79f9a2[_0x1ca65e(0x1f0)](_0x1f6510,_0x24a957[_0x1ca65e(0x1d7)][_0x1f6510]);}return _0x4e5849[_0x1ca65e(0x1c7)]=_0x1ca65e(0x1f8),_0x4e5849[_0x1ca65e(0x1c9)]=_0x24a957[_0x1ca65e(0x21c)],_0x4e5849[_0x1ca65e(0x1d4)]=_0x24a957['type'],_0x4e5849[_0x1ca65e(0x222)]=_0x111664,_0x4e5849[_0x1ca65e(0x1d3)]=await _0x79f9a2[_0x1ca65e(0x1c5)]({'type':_0x1ca65e(0x1dd),'compression':_0x1ca65e(0x1ed),'compressionOptions':{'level':0x6}}),_0x4e5849;}[a121_0x18ef5a(0x1e2)](_0x342d9f,_0x393cca,_0x4a6517){const _0x5da217=a121_0x18ef5a,_0x31f037=new Date()[_0x5da217(0x1d1)](),_0x219798={};return _0x219798[constants_1['FLOSUM_NAMESPACE']+_0x5da217(0x1de)]=_0x393cca,_0x219798[constants_1['FLOSUM_NAMESPACE']+_0x5da217(0x202)]=_0x342d9f[_0x5da217(0x1cc)],_0x219798[constants_1['FLOSUM_NAMESPACE']+_0x5da217(0x1e0)]=_0x31f037,_0x219798[constants_1[_0x5da217(0x1cd)]+_0x5da217(0x1cb)]=this[_0x5da217(0x1f9)],_0x219798[constants_1['FLOSUM_NAMESPACE']+_0x5da217(0x1db)]=_0x4a6517?_0x4a6517+0x1:0x1,_0x219798[constants_1[_0x5da217(0x200)]+_0x5da217(0x214)]=!![],_0x219798;}['prepareComponentRecord'](_0x41c35d,_0x3fcf5c){const _0x10218f=a121_0x18ef5a;var _0x5cd0ba,_0x54d886;const _0x2fec84=new Date()[_0x10218f(0x1d1)](),_0x587adc={};return!_0x3fcf5c?(this[_0x10218f(0x1e1)]?(_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x1e9)]=this['branchId'],_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x207)]=_0x10218f(0x213),_0x587adc[_0x10218f(0x1ef)]=(_0x5cd0ba=this[_0x10218f(0x21b)][_0x10218f(0x208)](_0x33b949=>_0x33b949[_0x10218f(0x1f5)]===_0x10218f(0x213)))===null||_0x5cd0ba===void 0x0?void 0x0:_0x5cd0ba['id']):(_0x587adc[constants_1['FLOSUM_NAMESPACE']+'Repository__c']=this[_0x10218f(0x1d0)],_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x207)]=_0x10218f(0x1ec),_0x587adc['RecordTypeId']=(_0x54d886=this[_0x10218f(0x21b)][_0x10218f(0x208)](_0x500536=>_0x500536[_0x10218f(0x1f5)]===_0x10218f(0x1ec)))===null||_0x54d886===void 0x0?void 0x0:_0x54d886['id']),_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x1db)]=0x1):_0x587adc[constants_1['FLOSUM_NAMESPACE']+_0x10218f(0x1db)]=_0x3fcf5c['version']+0x1,_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x1ce)]=_0x41c35d[_0x10218f(0x21c)],_0x587adc[constants_1['FLOSUM_NAMESPACE']+_0x10218f(0x205)]=_0x41c35d[_0x10218f(0x1f5)],_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x225)]=_0x41c35d['filePath'],_0x587adc[constants_1['FLOSUM_NAMESPACE']+_0x10218f(0x1e8)]=this[_0x10218f(0x1f9)],_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x206)]=this[_0x10218f(0x1f9)],_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x223)]=_0x2fec84,_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x1c6)]=_0x2fec84,_0x587adc[constants_1[_0x10218f(0x1cd)]+_0x10218f(0x202)]=_0x41c35d[_0x10218f(0x1cc)],_0x587adc;}[a121_0x18ef5a(0x203)](){return this['proceededComponentsMeta'];}async[a121_0x18ef5a(0x1f6)](_0x204319,_0x192320=''){const _0x586bc8=a121_0x18ef5a,_0x5e4a86=[];for(const _0x1eb3de of _0x204319){const _0x5f4633=composite_utils_1['createPostRequest'](constants_1[_0x586bc8(0x21f)],this[_0x586bc8(0x228)](_0x1eb3de)),_0x4af954=composite_utils_1[_0x586bc8(0x209)](constants_1['FLOSUM_COMPONENT_HISTORY'],this[_0x586bc8(0x1e2)](_0x1eb3de,'@{'+_0x5f4633[_0x586bc8(0x1fe)]+_0x586bc8(0x20e))),_0x6165f7=composite_utils_1[_0x586bc8(0x209)](constants_1['FLOSUM_ATTACHMENT'],await this[_0x586bc8(0x227)](_0x1eb3de,'@{'+_0x4af954['reference']+_0x586bc8(0x20e)));this[_0x586bc8(0x210)](_0x5f4633[_0x586bc8(0x1fd)][_0x586bc8(0x22c)],_0x5f4633['reference']),_0x5e4a86[_0x586bc8(0x21d)](_0x5f4633[_0x586bc8(0x1fd)],_0x4af954[_0x586bc8(0x1fd)],_0x6165f7['request']),_0x192320&&_0x5e4a86[_0x586bc8(0x21d)](this[_0x586bc8(0x1ee)](_0x192320,'@{'+_0x4af954['reference']+'.id}'));}return _0x5e4a86;}async[a121_0x18ef5a(0x1e7)](_0x4c798c,_0x5dd6a3=''){const _0x54a71a=a121_0x18ef5a,_0xfd3a24=[];for(const {component:_0x2d6e76,meta:_0x26f0ba}of _0x4c798c){if(!_0x26f0ba['id']){const _0x4e6def=this['proceededComponentsMeta'][_0x54a71a(0x208)](_0x25342b=>_0x25342b[_0x54a71a(0x1d2)]===_0x2d6e76[_0x54a71a(0x1f5)]&&_0x25342b[_0x54a71a(0x20f)]===_0x2d6e76[_0x54a71a(0x21c)]);if(!_0x4e6def)throw new salesforce_error_1['SalesforceError'](new Error(_0x54a71a(0x1d5)+_0x2d6e76[_0x54a71a(0x1f5)]+'\x20['+_0x2d6e76[_0x54a71a(0x21c)]+_0x54a71a(0x1df)));_0x26f0ba['id']=_0x4e6def[_0x54a71a(0x1f3)];}const _0x47ed5b=composite_utils_1[_0x54a71a(0x1f2)](constants_1[_0x54a71a(0x21f)],_0x26f0ba['id'],this['prepareComponentRecord'](_0x2d6e76,_0x26f0ba)),_0x16cb42=composite_utils_1['createPostRequest'](constants_1[_0x54a71a(0x1e3)],this[_0x54a71a(0x1e2)](_0x2d6e76,_0x26f0ba['id'],_0x26f0ba[_0x54a71a(0x1d8)])),_0x1d85f3=composite_utils_1[_0x54a71a(0x209)](constants_1[_0x54a71a(0x215)],await this[_0x54a71a(0x227)](_0x2d6e76,'@{'+_0x16cb42[_0x54a71a(0x1fe)]+_0x54a71a(0x20e)));this[_0x54a71a(0x210)](_0x47ed5b[_0x54a71a(0x1fd)][_0x54a71a(0x22c)],_0x47ed5b[_0x54a71a(0x1fe)]),_0xfd3a24[_0x54a71a(0x21d)](_0x47ed5b[_0x54a71a(0x1fd)],_0x16cb42[_0x54a71a(0x1fd)],_0x1d85f3['request']),_0x5dd6a3&&_0xfd3a24[_0x54a71a(0x21d)](this['prepareCommitManifest'](_0x5dd6a3,'@{'+_0x16cb42['reference']+_0x54a71a(0x20e)));}return _0xfd3a24;}async[a121_0x18ef5a(0x217)](_0x4b159e,_0x39e9f1=![]){const _0x362a66=a121_0x18ef5a,_0x1d03f9=[],_0x3f65bd=[];for(const _0x504418 of _0x4b159e){if(_0x504418[_0x362a66(0x1f3)])_0x3f65bd[_0x362a66(0x21d)](_0x504418[_0x362a66(0x1f3)]);else{const _0x118e99=this[_0x362a66(0x212)][_0x362a66(0x208)](_0x3d6e84=>_0x3d6e84[_0x362a66(0x1d2)]===_0x504418[_0x362a66(0x1d2)]&&_0x3d6e84['componentType']===_0x504418[_0x362a66(0x20f)]);if(!_0x118e99||!_0x118e99[_0x362a66(0x1f3)])throw new salesforce_error_1['SalesforceError'](new Error(_0x362a66(0x221)+_0x504418[_0x362a66(0x1d2)]+'\x20['+_0x504418[_0x362a66(0x20f)]+']'));_0x3f65bd[_0x362a66(0x21d)](_0x118e99[_0x362a66(0x1f3)]);}}if(_0x39e9f1){const _0x4b9250=await this[_0x362a66(0x1fb)][_0x362a66(0x20d)](_0x3f65bd);_0x1d03f9[_0x362a66(0x21d)](..._0x4b9250[_0x362a66(0x1f4)](_0xb8662c=>composite_utils_1['createDeleteRequest'](constants_1[_0x362a66(0x21a)],_0xb8662c)[_0x362a66(0x1fd)]));}return _0x1d03f9[_0x362a66(0x21d)](..._0x3f65bd[_0x362a66(0x1f4)](_0xc686b6=>composite_utils_1[_0x362a66(0x229)](constants_1[_0x362a66(0x21f)],_0xc686b6)[_0x362a66(0x1fd)])),_0x1d03f9;}}exports[a121_0x18ef5a(0x216)]=SalesforceComponentsManager;