const a122_0x1d5b13=a122_0x37ad;(function(_0x55c14f,_0x248c83){const _0xe52a9e=a122_0x37ad,_0x1b4c37=_0x55c14f();while(!![]){try{const _0x30a8fc=parseInt(_0xe52a9e(0x1e4))/0x1+-parseInt(_0xe52a9e(0x201))/0x2+parseInt(_0xe52a9e(0x215))/0x3*(parseInt(_0xe52a9e(0x1ed))/0x4)+parseInt(_0xe52a9e(0x23b))/0x5+parseInt(_0xe52a9e(0x235))/0x6*(parseInt(_0xe52a9e(0x224))/0x7)+parseInt(_0xe52a9e(0x20f))/0x8*(-parseInt(_0xe52a9e(0x20b))/0x9)+parseInt(_0xe52a9e(0x1ec))/0xa;if(_0x30a8fc===_0x248c83)break;else _0x1b4c37['push'](_0x1b4c37['shift']());}catch(_0x407f01){_0x1b4c37['push'](_0x1b4c37['shift']());}}}(a122_0x502a,0x8dbd7));function a122_0x502a(){const _0x5c8ad6=['FLOSUM_COMMIT_MANIFEST','FLOSUM_NAMESPACE','36OrbyGX','keys','recordTypes','username','proceedComponentMeta','Could\x20not\x20proceed\x20component\x20','.id}','map','toISOString','componentName','prepareComponentHistoryRecord','file','Source__c','FLOSUM_GIT_NAMESPACE','CRC32__c','14pQVidE','push','generateAsync','crc','Last_Modified_Date__c','Is_From_Agent__c','reference','../../parsers/utils/zip','get','files','application/zip','proceededComponentsMeta','gitSync','FLOSUM_COMPONENT_HISTORY','SalesforceError','prepareComponentAttachmentRecord','FLOSUM_COMPONENT','299778yLpFyM','name','Commit__c','search','Branch__c','Body','4823180qtETwC',']\x20-\x20meta\x20not\x20found','Committed_On__c','Name','createPatchRequest','../utils/composite.utils','241958gWbDdz','typedi','ContentType','Repository__c','filePath','(((.+)+)+)+$','Repository','componentId','395440cMgspa','274788JSGMWA','createDeleteRequest','Last_Modified_By__c','Logger','branchId','DEFLATE','Changed_On__c','logger','prepareCommitManifest','extractFieldsFromRecord','ParentId','Version__c','Description','Component__c','createPostRequest','prepareComponentRecord','componentType','FLOSUM_ATTACHMENT','Zip','find','1550376zgQhpg','SalesforceComponentsManager','version','type','request','Could\x20not\x20find\x20meta\x20data\x20for\x20','Component_Type__c','Branch','update','body','46701TrJqdY','Component_Name__c','toString','File_Name__c','1256XcGgdt','Last_Updated_By__c','RecordTypeId','./salesforce-git-sync.service'];a122_0x502a=function(){return _0x5c8ad6;};return a122_0x502a();}const a122_0x4f22ce=function(){let _0x252862=!![];return function(_0x4ef35c,_0x492ff3){const _0x4b717d=_0x252862?function(){if(_0x492ff3){const _0x367220=_0x492ff3['apply'](_0x4ef35c,arguments);return _0x492ff3=null,_0x367220;}}:function(){};return _0x252862=![],_0x4b717d;};}(),a122_0xd5235f=a122_0x4f22ce(this,function(){const _0x49824d=a122_0x37ad;return a122_0xd5235f[_0x49824d(0x20d)]()[_0x49824d(0x238)](_0x49824d(0x1e9))[_0x49824d(0x20d)]()['constructor'](a122_0xd5235f)[_0x49824d(0x238)](_0x49824d(0x1e9));});a122_0xd5235f();'use strict';function a122_0x37ad(_0x2d078a,_0x4d3b70){const _0x25a875=a122_0x502a();return a122_0x37ad=function(_0xd5235f,_0x4f22ce){_0xd5235f=_0xd5235f-0x1e3;let _0x502add=_0x25a875[_0xd5235f];return _0x502add;},a122_0x37ad(_0x2d078a,_0x4d3b70);}var __importDefault=this&&this['__importDefault']||function(_0x25d03e){return _0x25d03e&&_0x25d03e['__esModule']?_0x25d03e:{'default':_0x25d03e};};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a122_0x1d5b13(0x202)]=void 0x0;const constants_1=require('../../../constants'),core_1=require('../../../core'),zip_1=require(a122_0x1d5b13(0x22b)),typedi_1=__importDefault(require(a122_0x1d5b13(0x1e5))),salesforce_error_1=require('../errors/salesforce.error'),composite_utils_1=require(a122_0x1d5b13(0x1e3)),flosum_naming_utils_1=require('../utils/flosum-naming.utils'),salesforce_git_sync_service_1=require(a122_0x1d5b13(0x212));class SalesforceComponentsManager{constructor(_0x4389c5,_0x1f8c00,_0x43ae0e,_0x3624a6,_0x2f9d1d){const _0x12a3c0=a122_0x1d5b13;this['repositoryId']=_0x4389c5,this[_0x12a3c0(0x1f1)]=_0x1f8c00,this[_0x12a3c0(0x218)]=_0x43ae0e,this['recordTypes']=_0x3624a6,this[_0x12a3c0(0x22f)]=_0x2f9d1d,this[_0x12a3c0(0x1f4)]=new core_1[(_0x12a3c0(0x1f0))](SalesforceComponentsManager['name']),this['gitSync']=typedi_1['default'][_0x12a3c0(0x22c)](salesforce_git_sync_service_1['SalesforceGitSyncService']);}['proceedComponentMeta'](_0x483d86,_0x509463){const _0x2bc647=a122_0x1d5b13,_0x201d06=flosum_naming_utils_1[_0x2bc647(0x1f6)](_0x483d86,[_0x2bc647(0x207),_0x2bc647(0x20c),_0x2bc647(0x1f8)]);this[_0x2bc647(0x22f)]['push']({'componentId':'','reference':_0x509463,'version':_0x201d06[_0x2bc647(0x1f8)],'componentName':_0x201d06[_0x2bc647(0x20c)],'componentType':_0x201d06[_0x2bc647(0x207)]});}[a122_0x1d5b13(0x1f5)](_0xa072e1,_0x52a39e){const _0x399503=a122_0x1d5b13,{request:_0x22a382}=composite_utils_1[_0x399503(0x1fb)](constants_1[_0x399503(0x213)],{[constants_1[_0x399503(0x214)]+_0x399503(0x237)]:_0xa072e1,[constants_1['FLOSUM_NAMESPACE']+'Component_History__c']:_0x52a39e,[constants_1[_0x399503(0x222)]+_0x399503(0x229)]:!![]});return _0x22a382;}async[a122_0x1d5b13(0x233)](_0x799845,_0xfd0ab7){const _0x12f623=a122_0x1d5b13,_0x4732cf={},_0x449649=zip_1[_0x12f623(0x1ff)]['createZip']();for(const _0x15fb7e of Object[_0x12f623(0x216)](_0x799845[_0x12f623(0x22d)])){_0x449649[_0x12f623(0x220)](_0x15fb7e,_0x799845[_0x12f623(0x22d)][_0x15fb7e]);}return _0x4732cf[_0x12f623(0x1e6)]=_0x12f623(0x22e),_0x4732cf[_0x12f623(0x23e)]=_0x799845[_0x12f623(0x204)],_0x4732cf[_0x12f623(0x1f9)]=_0x799845['type'],_0x4732cf[_0x12f623(0x1f7)]=_0xfd0ab7,_0x4732cf[_0x12f623(0x23a)]=await _0x449649[_0x12f623(0x226)]({'type':'base64','compression':_0x12f623(0x1f2),'compressionOptions':{'level':0x6}}),_0x4732cf;}[a122_0x1d5b13(0x21f)](_0x1bc920,_0x10ed9d,_0x564b0b){const _0x2a5a01=a122_0x1d5b13,_0x28dcf6=new Date()['toISOString'](),_0x1b8b22={};return _0x1b8b22[constants_1[_0x2a5a01(0x214)]+_0x2a5a01(0x1fa)]=_0x10ed9d,_0x1b8b22[constants_1[_0x2a5a01(0x214)]+_0x2a5a01(0x223)]=_0x1bc920[_0x2a5a01(0x227)],_0x1b8b22[constants_1[_0x2a5a01(0x214)]+_0x2a5a01(0x1f3)]=_0x28dcf6,_0x1b8b22[constants_1[_0x2a5a01(0x214)]+'Changed_By__c']=this[_0x2a5a01(0x218)],_0x1b8b22[constants_1[_0x2a5a01(0x214)]+_0x2a5a01(0x1f8)]=_0x564b0b?_0x564b0b+0x1:0x1,_0x1b8b22[constants_1[_0x2a5a01(0x222)]+_0x2a5a01(0x229)]=!![],_0x1b8b22;}[a122_0x1d5b13(0x1fc)](_0x51b34d,_0x5bf990){const _0x364fb6=a122_0x1d5b13;var _0xb8c6e7,_0x3de444;const _0x2d07d8=new Date()[_0x364fb6(0x21d)](),_0x3e338f={};return!_0x5bf990?(this[_0x364fb6(0x1f1)]?(_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x239)]=this[_0x364fb6(0x1f1)],_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x221)]=_0x364fb6(0x208),_0x3e338f[_0x364fb6(0x211)]=(_0xb8c6e7=this[_0x364fb6(0x217)][_0x364fb6(0x200)](_0x18ff46=>_0x18ff46['name']==='Branch'))===null||_0xb8c6e7===void 0x0?void 0x0:_0xb8c6e7['id']):(_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x1e7)]=this['repositoryId'],_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x221)]=_0x364fb6(0x1ea),_0x3e338f[_0x364fb6(0x211)]=(_0x3de444=this[_0x364fb6(0x217)][_0x364fb6(0x200)](_0x5d4477=>_0x5d4477['name']==='Repository'))===null||_0x3de444===void 0x0?void 0x0:_0x3de444['id']),_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x1f8)]=0x1):_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x1f8)]=_0x5bf990[_0x364fb6(0x203)]+0x1,_0x3e338f[constants_1['FLOSUM_NAMESPACE']+_0x364fb6(0x207)]=_0x51b34d[_0x364fb6(0x204)],_0x3e338f[constants_1[_0x364fb6(0x214)]+'Component_Name__c']=_0x51b34d['name'],_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x20e)]=_0x51b34d[_0x364fb6(0x1e8)],_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x210)]=this[_0x364fb6(0x218)],_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x1ef)]=this[_0x364fb6(0x218)],_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x228)]=_0x2d07d8,_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x23d)]=_0x2d07d8,_0x3e338f[constants_1[_0x364fb6(0x214)]+_0x364fb6(0x223)]=_0x51b34d[_0x364fb6(0x227)],_0x3e338f;}['getProceededComponentsMeta'](){const _0x4c2b30=a122_0x1d5b13;return this[_0x4c2b30(0x22f)];}async['insert'](_0x1090aa,_0x2afcda=''){const _0x895890=a122_0x1d5b13,_0x3c2dbc=[];for(const _0x2695d1 of _0x1090aa){const _0x4ae2aa=composite_utils_1['createPostRequest'](constants_1['FLOSUM_COMPONENT'],this[_0x895890(0x1fc)](_0x2695d1)),_0xd6b55a=composite_utils_1[_0x895890(0x1fb)](constants_1['FLOSUM_COMPONENT_HISTORY'],this['prepareComponentHistoryRecord'](_0x2695d1,'@{'+_0x4ae2aa[_0x895890(0x22a)]+_0x895890(0x21b))),_0x58f631=composite_utils_1[_0x895890(0x1fb)](constants_1[_0x895890(0x1fe)],await this['prepareComponentAttachmentRecord'](_0x2695d1,'@{'+_0xd6b55a[_0x895890(0x22a)]+_0x895890(0x21b)));this[_0x895890(0x219)](_0x4ae2aa[_0x895890(0x205)][_0x895890(0x20a)],_0x4ae2aa['reference']),_0x3c2dbc[_0x895890(0x225)](_0x4ae2aa['request'],_0xd6b55a[_0x895890(0x205)],_0x58f631[_0x895890(0x205)]),_0x2afcda&&_0x3c2dbc[_0x895890(0x225)](this['prepareCommitManifest'](_0x2afcda,'@{'+_0xd6b55a[_0x895890(0x22a)]+_0x895890(0x21b)));}return _0x3c2dbc;}async[a122_0x1d5b13(0x209)](_0x7c9b6d,_0x1482f5=''){const _0x3e5ef7=a122_0x1d5b13,_0x2cd4cc=[];for(const {component:_0x31a8f1,meta:_0x434494}of _0x7c9b6d){if(!_0x434494['id']){const _0x40b15d=this[_0x3e5ef7(0x22f)]['find'](_0x2cd346=>_0x2cd346[_0x3e5ef7(0x21e)]===_0x31a8f1[_0x3e5ef7(0x236)]&&_0x2cd346[_0x3e5ef7(0x1fd)]===_0x31a8f1[_0x3e5ef7(0x204)]);if(!_0x40b15d)throw new salesforce_error_1['SalesforceError'](new Error(_0x3e5ef7(0x21a)+_0x31a8f1[_0x3e5ef7(0x236)]+'\x20['+_0x31a8f1[_0x3e5ef7(0x204)]+_0x3e5ef7(0x23c)));_0x434494['id']=_0x40b15d['componentId'];}const _0x447c81=composite_utils_1[_0x3e5ef7(0x23f)](constants_1[_0x3e5ef7(0x234)],_0x434494['id'],this[_0x3e5ef7(0x1fc)](_0x31a8f1,_0x434494)),_0x1a0ea5=composite_utils_1['createPostRequest'](constants_1[_0x3e5ef7(0x231)],this[_0x3e5ef7(0x21f)](_0x31a8f1,_0x434494['id'],_0x434494[_0x3e5ef7(0x203)])),_0x309067=composite_utils_1['createPostRequest'](constants_1[_0x3e5ef7(0x1fe)],await this[_0x3e5ef7(0x233)](_0x31a8f1,'@{'+_0x1a0ea5[_0x3e5ef7(0x22a)]+_0x3e5ef7(0x21b)));this[_0x3e5ef7(0x219)](_0x447c81['request'][_0x3e5ef7(0x20a)],_0x447c81[_0x3e5ef7(0x22a)]),_0x2cd4cc[_0x3e5ef7(0x225)](_0x447c81[_0x3e5ef7(0x205)],_0x1a0ea5[_0x3e5ef7(0x205)],_0x309067[_0x3e5ef7(0x205)]),_0x1482f5&&_0x2cd4cc[_0x3e5ef7(0x225)](this[_0x3e5ef7(0x1f5)](_0x1482f5,'@{'+_0x1a0ea5[_0x3e5ef7(0x22a)]+'.id}'));}return _0x2cd4cc;}async['delete'](_0xefc989,_0x2ba81c=![]){const _0xed2c95=a122_0x1d5b13,_0x4805c5=[],_0x4a5f90=[];for(const _0x3aa50a of _0xefc989){if(_0x3aa50a[_0xed2c95(0x1eb)])_0x4a5f90[_0xed2c95(0x225)](_0x3aa50a[_0xed2c95(0x1eb)]);else{const _0x1563eb=this[_0xed2c95(0x22f)][_0xed2c95(0x200)](_0x16b602=>_0x16b602[_0xed2c95(0x21e)]===_0x3aa50a[_0xed2c95(0x21e)]&&_0x16b602[_0xed2c95(0x1fd)]===_0x3aa50a[_0xed2c95(0x1fd)]);if(!_0x1563eb||!_0x1563eb[_0xed2c95(0x1eb)])throw new salesforce_error_1[(_0xed2c95(0x232))](new Error(_0xed2c95(0x206)+_0x3aa50a[_0xed2c95(0x21e)]+'\x20['+_0x3aa50a['componentType']+']'));_0x4a5f90['push'](_0x1563eb[_0xed2c95(0x1eb)]);}}if(_0x2ba81c){const _0x45f934=await this[_0xed2c95(0x230)]['fetchCommitManifestsByComponentIds'](_0x4a5f90);_0x4805c5[_0xed2c95(0x225)](..._0x45f934[_0xed2c95(0x21c)](_0x537b72=>composite_utils_1[_0xed2c95(0x1ee)](constants_1[_0xed2c95(0x213)],_0x537b72)[_0xed2c95(0x205)]));}return _0x4805c5[_0xed2c95(0x225)](..._0x4a5f90['map'](_0x2196ba=>composite_utils_1[_0xed2c95(0x1ee)](constants_1[_0xed2c95(0x234)],_0x2196ba)[_0xed2c95(0x205)])),_0x4805c5;}}exports[a122_0x1d5b13(0x202)]=SalesforceComponentsManager;