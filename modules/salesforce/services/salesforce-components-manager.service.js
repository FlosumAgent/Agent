const a121_0x475e54=a121_0x3821;(function(_0x446019,_0x1f6165){const _0x4802d6=a121_0x3821,_0x24594f=_0x446019();while(!![]){try{const _0x43e6c8=-parseInt(_0x4802d6(0x10f))/0x1+parseInt(_0x4802d6(0x117))/0x2*(parseInt(_0x4802d6(0x131))/0x3)+parseInt(_0x4802d6(0x12f))/0x4*(parseInt(_0x4802d6(0x14c))/0x5)+parseInt(_0x4802d6(0x11a))/0x6*(-parseInt(_0x4802d6(0x125))/0x7)+parseInt(_0x4802d6(0x12a))/0x8+-parseInt(_0x4802d6(0x14a))/0x9*(parseInt(_0x4802d6(0x15c))/0xa)+-parseInt(_0x4802d6(0x103))/0xb*(parseInt(_0x4802d6(0x128))/0xc);if(_0x43e6c8===_0x1f6165)break;else _0x24594f['push'](_0x24594f['shift']());}catch(_0x5b3f74){_0x24594f['push'](_0x24594f['shift']());}}}(a121_0x1a85,0xc93f7));const a121_0x36873d=function(){let _0x1d875a=!![];return function(_0x3e0d5a,_0x27f88b){const _0x1b47a3=_0x1d875a?function(){const _0x3e9ba0=a121_0x3821;if(_0x27f88b){const _0x4bbc22=_0x27f88b[_0x3e9ba0(0x15a)](_0x3e0d5a,arguments);return _0x27f88b=null,_0x4bbc22;}}:function(){};return _0x1d875a=![],_0x1b47a3;};}(),a121_0x534808=a121_0x36873d(this,function(){const _0x5c44de=a121_0x3821;return a121_0x534808[_0x5c44de(0x147)]()[_0x5c44de(0x10a)](_0x5c44de(0x108))[_0x5c44de(0x147)]()['constructor'](a121_0x534808)[_0x5c44de(0x10a)](_0x5c44de(0x108));});function a121_0x1a85(){const _0x578341=['reference','87918HyPmgF','Branch','prepareComponentRecord','18RzVWPW','Body',']\x20-\x20meta\x20not\x20found','proceededComponentsMeta','componentId','keys','recordTypes','../../../constants','body','__importDefault','Last_Modified_Date__c','2000530XWCsQB','../../parsers/utils/zip','Could\x20not\x20find\x20meta\x20data\x20for\x20','624492UfRxBC','type','11342232lYzKeC','Component__c','Committed_On__c','find','Changed_By__c','52msNtec','RecordTypeId','105TfPwBR','branchId','defineProperty','Version__c','Component_Type__c','crc','proceedComponentMeta','extractFieldsFromRecord','ParentId','Name','username','../utils/composite.utils','Component_Name__c','FLOSUM_COMPONENT_HISTORY','ContentType','FLOSUM_NAMESPACE','createPatchRequest','createDeleteRequest','base64','createZip','CRC32__c','./salesforce-git-sync.service','toString','componentType','SalesforceError','9567837KgkRrh','Branch__c','531225DvwTyu','prepareCommitManifest','name','prepareComponentAttachmentRecord','Last_Updated_By__c','../../../core','.id}','createPostRequest','SalesforceGitSyncService','Component_History__c','FLOSUM_ATTACHMENT','request','file','default','apply','FLOSUM_COMMIT_MANIFEST','10uZqeRF','Is_From_Agent__c','get','Last_Modified_By__c','fetchCommitManifestsByComponentIds','Repository','../utils/flosum-naming.utils','Description','componentName','132miJkbC','prepareComponentHistoryRecord','version','files','map','(((.+)+)+)+$','FLOSUM_COMPONENT','search','__esModule','File_Name__c','push','../errors/salesforce.error','968263CcWaZM','Commit__c','Changed_On__c','generateAsync','insert','FLOSUM_GIT_NAMESPACE','delete'];a121_0x1a85=function(){return _0x578341;};return a121_0x1a85();}a121_0x534808();'use strict';var __importDefault=this&&this[a121_0x475e54(0x123)]||function(_0x529dd2){const _0x27371b=a121_0x475e54;return _0x529dd2&&_0x529dd2[_0x27371b(0x10b)]?_0x529dd2:{'default':_0x529dd2};};Object[a121_0x475e54(0x133)](exports,a121_0x475e54(0x10b),{'value':!![]}),exports['SalesforceComponentsManager']=void 0x0;function a121_0x3821(_0x351fb1,_0x411000){const _0x87e8e4=a121_0x1a85();return a121_0x3821=function(_0x534808,_0x36873d){_0x534808=_0x534808-0xfd;let _0x1a85de=_0x87e8e4[_0x534808];return _0x1a85de;},a121_0x3821(_0x351fb1,_0x411000);}const constants_1=require(a121_0x475e54(0x121)),core_1=require(a121_0x475e54(0x151)),zip_1=require(a121_0x475e54(0x126)),typedi_1=__importDefault(require('typedi')),salesforce_error_1=require(a121_0x475e54(0x10e)),composite_utils_1=require(a121_0x475e54(0x13c)),flosum_naming_utils_1=require(a121_0x475e54(0x100)),salesforce_git_sync_service_1=require(a121_0x475e54(0x146));class SalesforceComponentsManager{constructor(_0x34da0e,_0x318cff,_0x2c602e,_0x314777,_0x5de44c){const _0x4c3625=a121_0x475e54;this['repositoryId']=_0x34da0e,this[_0x4c3625(0x132)]=_0x318cff,this['username']=_0x2c602e,this['recordTypes']=_0x314777,this[_0x4c3625(0x11d)]=_0x5de44c,this['logger']=new core_1['Logger'](SalesforceComponentsManager['name']),this['gitSync']=typedi_1[_0x4c3625(0x159)][_0x4c3625(0x15e)](salesforce_git_sync_service_1[_0x4c3625(0x154)]);}[a121_0x475e54(0x137)](_0x34b997,_0x230c1b){const _0x571d0b=a121_0x475e54,_0x548e61=flosum_naming_utils_1[_0x571d0b(0x138)](_0x34b997,[_0x571d0b(0x135),_0x571d0b(0x13d),_0x571d0b(0x134)]);this[_0x571d0b(0x11d)][_0x571d0b(0x10d)]({'componentId':'','reference':_0x230c1b,'version':_0x548e61[_0x571d0b(0x134)],'componentName':_0x548e61[_0x571d0b(0x13d)],'componentType':_0x548e61['Component_Type__c']});}['prepareCommitManifest'](_0x130de7,_0x4d977e){const _0x417e0b=a121_0x475e54,{request:_0x187409}=composite_utils_1[_0x417e0b(0x153)](constants_1[_0x417e0b(0x15b)],{[constants_1['FLOSUM_NAMESPACE']+_0x417e0b(0x110)]:_0x130de7,[constants_1[_0x417e0b(0x140)]+_0x417e0b(0x155)]:_0x4d977e});return _0x187409;}async[a121_0x475e54(0x14f)](_0x462df8,_0x4d141){const _0x55a24f=a121_0x475e54,_0x1abace={},_0x29819f=zip_1['Zip'][_0x55a24f(0x144)]();for(const _0xdb8927 of Object[_0x55a24f(0x11f)](_0x462df8[_0x55a24f(0x106)])){_0x29819f[_0x55a24f(0x158)](_0xdb8927,_0x462df8[_0x55a24f(0x106)][_0xdb8927]);}return _0x1abace[_0x55a24f(0x13f)]='application/zip',_0x1abace[_0x55a24f(0x13a)]=_0x462df8[_0x55a24f(0x129)],_0x1abace[_0x55a24f(0x101)]=_0x462df8['type'],_0x1abace[_0x55a24f(0x139)]=_0x4d141,_0x1abace[_0x55a24f(0x11b)]=await _0x29819f[_0x55a24f(0x112)]({'type':_0x55a24f(0x143),'compression':'DEFLATE','compressionOptions':{'level':0x6}}),_0x1abace;}[a121_0x475e54(0x104)](_0x230cf4,_0x5cca7d,_0x422a3e){const _0x5d15b0=a121_0x475e54,_0x3c138a=new Date()['toISOString'](),_0x10d270={};return _0x10d270[constants_1[_0x5d15b0(0x140)]+_0x5d15b0(0x12b)]=_0x5cca7d,_0x10d270[constants_1[_0x5d15b0(0x140)]+_0x5d15b0(0x145)]=_0x230cf4[_0x5d15b0(0x136)],_0x10d270[constants_1[_0x5d15b0(0x140)]+_0x5d15b0(0x111)]=_0x3c138a,_0x10d270[constants_1[_0x5d15b0(0x140)]+_0x5d15b0(0x12e)]=this['username'],_0x10d270[constants_1[_0x5d15b0(0x140)]+_0x5d15b0(0x134)]=_0x422a3e?_0x422a3e+0x1:0x1,_0x10d270[constants_1[_0x5d15b0(0x114)]+_0x5d15b0(0x15d)]=!![],_0x10d270;}[a121_0x475e54(0x119)](_0x18e83e,_0x10e03a){const _0x871ef5=a121_0x475e54;var _0x16775e,_0x194bdd;const _0x204f2a=new Date()['toISOString'](),_0x32d606={};return!_0x10e03a?(this[_0x871ef5(0x132)]?(_0x32d606[constants_1['FLOSUM_NAMESPACE']+_0x871ef5(0x14b)]=this['branchId'],_0x32d606[constants_1[_0x871ef5(0x140)]+'Source__c']=_0x871ef5(0x118),_0x32d606[_0x871ef5(0x130)]=(_0x16775e=this[_0x871ef5(0x120)][_0x871ef5(0x12d)](_0xb97d42=>_0xb97d42[_0x871ef5(0x14e)]===_0x871ef5(0x118)))===null||_0x16775e===void 0x0?void 0x0:_0x16775e['id']):(_0x32d606[constants_1['FLOSUM_NAMESPACE']+'Repository__c']=this['repositoryId'],_0x32d606[constants_1[_0x871ef5(0x140)]+'Source__c']=_0x871ef5(0xff),_0x32d606['RecordTypeId']=(_0x194bdd=this['recordTypes']['find'](_0x50dbfd=>_0x50dbfd[_0x871ef5(0x14e)]===_0x871ef5(0xff)))===null||_0x194bdd===void 0x0?void 0x0:_0x194bdd['id']),_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x134)]=0x1):_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x134)]=_0x10e03a[_0x871ef5(0x105)]+0x1,_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x135)]=_0x18e83e[_0x871ef5(0x129)],_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x13d)]=_0x18e83e[_0x871ef5(0x14e)],_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x10c)]=_0x18e83e['filePath'],_0x32d606[constants_1['FLOSUM_NAMESPACE']+_0x871ef5(0x150)]=this[_0x871ef5(0x13b)],_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0xfd)]=this[_0x871ef5(0x13b)],_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x124)]=_0x204f2a,_0x32d606[constants_1[_0x871ef5(0x140)]+_0x871ef5(0x12c)]=_0x204f2a,_0x32d606[constants_1[_0x871ef5(0x140)]+'CRC32__c']=_0x18e83e[_0x871ef5(0x136)],_0x32d606;}['getProceededComponentsMeta'](){const _0x40e72a=a121_0x475e54;return this[_0x40e72a(0x11d)];}async[a121_0x475e54(0x113)](_0x1ab102,_0x22035d=''){const _0x283762=a121_0x475e54,_0x3fdbef=[];for(const _0x127ab9 of _0x1ab102){const _0x177e86=composite_utils_1[_0x283762(0x153)](constants_1[_0x283762(0x109)],this[_0x283762(0x119)](_0x127ab9)),_0x393d60=composite_utils_1[_0x283762(0x153)](constants_1[_0x283762(0x13e)],this[_0x283762(0x104)](_0x127ab9,'@{'+_0x177e86[_0x283762(0x116)]+_0x283762(0x152))),_0x1adc13=composite_utils_1[_0x283762(0x153)](constants_1[_0x283762(0x156)],await this[_0x283762(0x14f)](_0x127ab9,'@{'+_0x393d60['reference']+_0x283762(0x152)));this['proceedComponentMeta'](_0x177e86[_0x283762(0x157)][_0x283762(0x122)],_0x177e86[_0x283762(0x116)]),_0x3fdbef[_0x283762(0x10d)](_0x177e86[_0x283762(0x157)],_0x393d60['request'],_0x1adc13[_0x283762(0x157)]),_0x22035d&&_0x3fdbef[_0x283762(0x10d)](this[_0x283762(0x14d)](_0x22035d,'@{'+_0x393d60[_0x283762(0x116)]+_0x283762(0x152)));}return _0x3fdbef;}async['update'](_0x51774d,_0x78c5b1=''){const _0x4441fd=a121_0x475e54,_0x8dcbe0=[];for(const {component:_0xf47de3,meta:_0x486556}of _0x51774d){if(!_0x486556['id']){const _0x4f2cda=this[_0x4441fd(0x11d)][_0x4441fd(0x12d)](_0x5846b9=>_0x5846b9[_0x4441fd(0x102)]===_0xf47de3[_0x4441fd(0x14e)]&&_0x5846b9[_0x4441fd(0x148)]===_0xf47de3[_0x4441fd(0x129)]);if(!_0x4f2cda)throw new salesforce_error_1[(_0x4441fd(0x149))](new Error('Could\x20not\x20proceed\x20component\x20'+_0xf47de3['name']+'\x20['+_0xf47de3[_0x4441fd(0x129)]+_0x4441fd(0x11c)));_0x486556['id']=_0x4f2cda[_0x4441fd(0x11e)];}const _0x26bf2a=composite_utils_1[_0x4441fd(0x141)](constants_1[_0x4441fd(0x109)],_0x486556['id'],this[_0x4441fd(0x119)](_0xf47de3,_0x486556)),_0x5a37ab=composite_utils_1[_0x4441fd(0x153)](constants_1['FLOSUM_COMPONENT_HISTORY'],this['prepareComponentHistoryRecord'](_0xf47de3,_0x486556['id'],_0x486556[_0x4441fd(0x105)])),_0x4f77a8=composite_utils_1[_0x4441fd(0x153)](constants_1[_0x4441fd(0x156)],await this[_0x4441fd(0x14f)](_0xf47de3,'@{'+_0x5a37ab['reference']+_0x4441fd(0x152)));this[_0x4441fd(0x137)](_0x26bf2a[_0x4441fd(0x157)][_0x4441fd(0x122)],_0x26bf2a[_0x4441fd(0x116)]),_0x8dcbe0[_0x4441fd(0x10d)](_0x26bf2a['request'],_0x5a37ab[_0x4441fd(0x157)],_0x4f77a8[_0x4441fd(0x157)]),_0x78c5b1&&_0x8dcbe0[_0x4441fd(0x10d)](this[_0x4441fd(0x14d)](_0x78c5b1,'@{'+_0x5a37ab[_0x4441fd(0x116)]+_0x4441fd(0x152)));}return _0x8dcbe0;}async[a121_0x475e54(0x115)](_0x4dfac2,_0x45c32e=![]){const _0x3b712c=a121_0x475e54,_0x28c42c=[],_0x1a99dd=[];for(const _0x18a65a of _0x4dfac2){if(_0x18a65a[_0x3b712c(0x11e)])_0x1a99dd[_0x3b712c(0x10d)](_0x18a65a['componentId']);else{const _0x52d2fc=this[_0x3b712c(0x11d)][_0x3b712c(0x12d)](_0x2f37c9=>_0x2f37c9['componentName']===_0x18a65a['componentName']&&_0x2f37c9[_0x3b712c(0x148)]===_0x18a65a[_0x3b712c(0x148)]);if(!_0x52d2fc||!_0x52d2fc[_0x3b712c(0x11e)])throw new salesforce_error_1[(_0x3b712c(0x149))](new Error(_0x3b712c(0x127)+_0x18a65a['componentName']+'\x20['+_0x18a65a[_0x3b712c(0x148)]+']'));_0x1a99dd['push'](_0x52d2fc[_0x3b712c(0x11e)]);}}if(_0x45c32e){const _0x53da5a=await this['gitSync'][_0x3b712c(0xfe)](_0x1a99dd);_0x28c42c['push'](..._0x53da5a[_0x3b712c(0x107)](_0x289bee=>composite_utils_1[_0x3b712c(0x142)](constants_1[_0x3b712c(0x15b)],_0x289bee)[_0x3b712c(0x157)]));}return _0x28c42c[_0x3b712c(0x10d)](..._0x1a99dd[_0x3b712c(0x107)](_0x1a9f96=>composite_utils_1[_0x3b712c(0x142)](constants_1['FLOSUM_COMPONENT'],_0x1a9f96)[_0x3b712c(0x157)])),_0x28c42c;}}exports['SalesforceComponentsManager']=SalesforceComponentsManager;