const a126_0x475279=a126_0x52e0;(function(_0x3898b5,_0x12405c){const _0x3e5cc5=a126_0x52e0,_0x3e1fb5=_0x3898b5();while(!![]){try{const _0x27cc74=-parseInt(_0x3e5cc5(0x1a6))/0x1+parseInt(_0x3e5cc5(0x197))/0x2*(parseInt(_0x3e5cc5(0x1a2))/0x3)+parseInt(_0x3e5cc5(0x192))/0x4+-parseInt(_0x3e5cc5(0x1b9))/0x5*(-parseInt(_0x3e5cc5(0x1d7))/0x6)+-parseInt(_0x3e5cc5(0x1cd))/0x7*(-parseInt(_0x3e5cc5(0x193))/0x8)+-parseInt(_0x3e5cc5(0x1b8))/0x9+parseInt(_0x3e5cc5(0x1ad))/0xa*(-parseInt(_0x3e5cc5(0x1bf))/0xb);if(_0x27cc74===_0x12405c)break;else _0x3e1fb5['push'](_0x3e1fb5['shift']());}catch(_0x16ba2f){_0x3e1fb5['push'](_0x3e1fb5['shift']());}}}(a126_0x18d4,0x21dbe));function a126_0x52e0(_0x2f56c0,_0x3844da){const _0x3bdb9b=a126_0x18d4();return a126_0x52e0=function(_0x180dba,_0x97600e){_0x180dba=_0x180dba-0x191;let _0x18d41a=_0x3bdb9b[_0x180dba];return _0x18d41a;},a126_0x52e0(_0x2f56c0,_0x3844da);}const a126_0x97600e=function(){let _0x571050=!![];return function(_0x30874d,_0x5dd10a){const _0x3b7ef=_0x571050?function(){const _0xb9d266=a126_0x52e0;if(_0x5dd10a){const _0x23d37a=_0x5dd10a[_0xb9d266(0x194)](_0x30874d,arguments);return _0x5dd10a=null,_0x23d37a;}}:function(){};return _0x571050=![],_0x3b7ef;};}(),a126_0x180dba=a126_0x97600e(this,function(){const _0x654b07=a126_0x52e0;return a126_0x180dba['toString']()[_0x654b07(0x1c9)](_0x654b07(0x1a3))[_0x654b07(0x1bb)]()['constructor'](a126_0x180dba)['search']('(((.+)+)+)+$');});a126_0x180dba();'use strict';function a126_0x18d4(){const _0x558c9b=['153034EJcgZh','SalesforceError','SalesforceCommitsManager','typedi','get','reference','SalesforceCompositeService','4390COgoiV','send','__esModule','SalesforceGitSyncService','defineProperty','COMPONENTS_PER_CHUNK','logger','sfLogger','extractComponentIdsFromGraphsResponse','../utils/composite.utils','push','2037789fHxMQA','102210LfLobP','default','toString','../errors/salesforce.error','../../shared/utils','gitSync','5577LnNCAO','manifests','delete','floor','update','componentId','modified','__importDefault','removed','componentsToUpdate','search','componentsToDelete','map','graph','7oOvgEh','chunkArray','composite','branchId','SalesforceComponentsManager','./salesforce-composite.service','toJSON','proceedCommits','./salesforce-git-sync.service','./salesforce-components-manager.service','30RfkBMN','[INFO]\x20Sending\x20','log','proceededComponentsMeta','982476IUTwJe','2212984cRnOQl','apply','repositoryId','author','25836aFXBSZ','proceedCommitsToRepository','inserted','recordTypes','Logger','stringify','\x20requests\x20to\x20composite\x20api.','insert','message','options','reduce','27CFCnGv','(((.+)+)+)+$','length','proceedRequests'];a126_0x18d4=function(){return _0x558c9b;};return a126_0x18d4();}var __importDefault=this&&this[a126_0x475279(0x1c6)]||function(_0x2c3b78){const _0xe2c468=a126_0x475279;return _0x2c3b78&&_0x2c3b78[_0xe2c468(0x1af)]?_0x2c3b78:{'default':_0x2c3b78};};Object[a126_0x475279(0x1b1)](exports,'__esModule',{'value':!![]}),exports[a126_0x475279(0x1a8)]=void 0x0;const core_1=require('../../../core'),typedi_1=__importDefault(require(a126_0x475279(0x1a9))),constants_1=require('../../../constants'),utils_1=require(a126_0x475279(0x1bd)),salesforce_error_1=require(a126_0x475279(0x1bc)),composite_utils_1=require(a126_0x475279(0x1b6)),salesforce_components_manager_service_1=require(a126_0x475279(0x1d6)),salesforce_composite_service_1=require(a126_0x475279(0x1d2)),salesforce_git_sync_service_1=require(a126_0x475279(0x1d5));class SalesforceCommitsManager{constructor(_0x4b7972){const _0x53d597=a126_0x475279;this[_0x53d597(0x1a0)]=_0x4b7972,this[_0x53d597(0x1b2)]=0x3,this[_0x53d597(0x1b3)]=new core_1[(_0x53d597(0x19b))](SalesforceCommitsManager['name']),this[_0x53d597(0x1b4)]=this[_0x53d597(0x1a0)][_0x53d597(0x1b3)],this[_0x53d597(0x1cf)]=typedi_1[_0x53d597(0x1ba)]['get'](salesforce_composite_service_1[_0x53d597(0x1ac)]),this[_0x53d597(0x1be)]=typedi_1[_0x53d597(0x1ba)][_0x53d597(0x1aa)](salesforce_git_sync_service_1[_0x53d597(0x1b0)]),this[_0x53d597(0x191)]=[];}async[a126_0x475279(0x1a5)](_0x2b52e6,_0x1b07ce=![]){const _0x128dd5=a126_0x475279,_0x27a219=(this['COMPONENTS_PER_CHUNK']+ +_0x1b07ce)*0x3,_0x425a89=utils_1[_0x128dd5(0x1ce)](_0x2b52e6,_0x27a219);try{while(_0x425a89['length']){const _0x5ed3dc=_0x425a89['splice'](0x0,Math[_0x128dd5(0x1c2)](constants_1['SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST']/_0x27a219));await this[_0x128dd5(0x1b4)]['log'](_0x128dd5(0x1d8)+_0x5ed3dc['length']*_0x27a219+_0x128dd5(0x19d))[_0x128dd5(0x1ae)]();const _0x445b8e=_0x5ed3dc[_0x128dd5(0x1cb)]((_0x263ff9,_0x1b5923)=>({'graphId':_0x128dd5(0x1cc)+_0x1b5923,'compositeRequest':_0x263ff9})),_0x319c0f=await this[_0x128dd5(0x1cf)]['executeGraphs'](_0x445b8e);if(_0x1b07ce){const _0x2a75d8=composite_utils_1[_0x128dd5(0x1b5)](_0x319c0f);for(const {id:_0x1b6275,ref:_0x42fe59}of _0x2a75d8){const _0x2a313e=this[_0x128dd5(0x191)]['find'](_0x53a76c=>_0x53a76c[_0x128dd5(0x1ab)]===_0x42fe59);_0x2a313e&&(_0x2a313e[_0x128dd5(0x1c4)]=_0x1b6275);}}}}catch(_0x427414){this[_0x128dd5(0x1b3)]['error'](_0x427414 instanceof salesforce_error_1[_0x128dd5(0x1a7)]?JSON[_0x128dd5(0x19c)](_0x427414[_0x128dd5(0x1d3)](),null,0x2):_0x427414),this['sfLogger']['log'](_0x427414 instanceof salesforce_error_1[_0x128dd5(0x1a7)]?JSON[_0x128dd5(0x19c)](_0x427414['toJSON'](),null,0x2):_0x427414[_0x128dd5(0x1bb)]());throw _0x427414;}}async[a126_0x475279(0x198)](_0x105573){const _0x44efab=a126_0x475279;for(const _0x15afc6 of _0x105573){if(!_0x15afc6[_0x44efab(0x199)][_0x44efab(0x1a4)]&&!_0x15afc6[_0x44efab(0x1c5)][_0x44efab(0x1a4)]&&!_0x15afc6[_0x44efab(0x1c7)][_0x44efab(0x1a4)])continue;let _0x115240='';(_0x15afc6[_0x44efab(0x1c5)][_0x44efab(0x1a4)]||_0x15afc6['inserted'][_0x44efab(0x1a4)])&&(_0x115240=await this[_0x44efab(0x1be)]['createCommit'](_0x15afc6[_0x44efab(0x19f)],this['options'][_0x44efab(0x195)]));const _0x5844df=[],_0x48aaaa=[],_0x554337=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x44efab(0x1a0)]['repositoryId'],this['options'][_0x44efab(0x1d0)],_0x15afc6[_0x44efab(0x196)],this[_0x44efab(0x1a0)][_0x44efab(0x19a)],this[_0x44efab(0x191)]);_0x5844df[_0x44efab(0x1b7)](...await _0x554337[_0x44efab(0x19e)](_0x15afc6[_0x44efab(0x199)],_0x115240)),_0x5844df['push'](...await _0x554337[_0x44efab(0x1c3)](_0x15afc6[_0x44efab(0x1c5)],_0x115240)),_0x48aaaa[_0x44efab(0x1b7)](await _0x554337[_0x44efab(0x1c1)](_0x15afc6[_0x44efab(0x1c7)],!![])),this[_0x44efab(0x191)]=_0x554337['getProceededComponentsMeta'](),await this['proceedRequests'](_0x5844df,!![]);for(const _0x4065b9 of _0x48aaaa){_0x4065b9[_0x44efab(0x1c0)][_0x44efab(0x1a4)]&&await this['proceedRequests'](_0x4065b9[_0x44efab(0x1c0)],!![]),_0x4065b9[_0x44efab(0x1c8)][_0x44efab(0x1a4)]&&await this['proceedRequests'](_0x4065b9[_0x44efab(0x1c8)],!![]),_0x4065b9['componentsToDelete'][_0x44efab(0x1a4)]&&await this['proceedRequests'](_0x4065b9[_0x44efab(0x1ca)],!![]);}this[_0x44efab(0x1b3)][_0x44efab(0x1d9)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(repository)',_0x5844df['length']);}}async['proceedCommitsToBranch'](_0x3bdc70){const _0x1fb737=a126_0x475279,_0x31f8d1=[],_0x235896=[];for(const _0x5ace08 of _0x3bdc70){if(!_0x5ace08[_0x1fb737(0x199)]['length']&&!_0x5ace08[_0x1fb737(0x1c5)][_0x1fb737(0x1a4)]&&!_0x5ace08[_0x1fb737(0x1c7)][_0x1fb737(0x1a4)])continue;const _0x405b51=new salesforce_components_manager_service_1[(_0x1fb737(0x1d1))](this[_0x1fb737(0x1a0)][_0x1fb737(0x195)],this[_0x1fb737(0x1a0)]['branchId'],_0x5ace08[_0x1fb737(0x196)],this['options'][_0x1fb737(0x19a)],[]);_0x31f8d1[_0x1fb737(0x1b7)](...await _0x405b51['insert'](_0x5ace08['inserted'])),_0x31f8d1['push'](...await _0x405b51[_0x1fb737(0x1c3)](_0x5ace08['modified'])),_0x235896[_0x1fb737(0x1b7)](await _0x405b51[_0x1fb737(0x1c1)](_0x5ace08[_0x1fb737(0x1c7)]));}this[_0x1fb737(0x1b3)][_0x1fb737(0x1d9)]('have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)',_0x31f8d1[_0x1fb737(0x1a4)]),await this[_0x1fb737(0x1a5)](_0x31f8d1);const _0x2ab1de=_0x235896[_0x1fb737(0x1a1)]((_0x30b3a9,_0x1de763)=>({'manifests':[..._0x30b3a9[_0x1fb737(0x1c0)],..._0x1de763[_0x1fb737(0x1c0)]],'componentsToDelete':[..._0x30b3a9[_0x1fb737(0x1ca)],..._0x1de763['componentsToDelete']],'componentsToUpdate':[..._0x30b3a9[_0x1fb737(0x1c8)],..._0x1de763[_0x1fb737(0x1c8)]]}),{'manifests':[],'componentsToDelete':[],'componentsToUpdate':[]});_0x2ab1de[_0x1fb737(0x1c0)][_0x1fb737(0x1a4)]&&await this[_0x1fb737(0x1a5)](_0x2ab1de[_0x1fb737(0x1c0)],!![]),_0x2ab1de[_0x1fb737(0x1c8)][_0x1fb737(0x1a4)]&&await this['proceedRequests'](_0x2ab1de[_0x1fb737(0x1c8)],!![]),_0x2ab1de[_0x1fb737(0x1ca)][_0x1fb737(0x1a4)]&&await this['proceedRequests'](_0x2ab1de[_0x1fb737(0x1ca)],!![]);}async[a126_0x475279(0x1d4)](_0x33f176){const _0x53e879=a126_0x475279;this['options']['branchId']?await this['proceedCommitsToBranch'](_0x33f176):await this[_0x53e879(0x198)](_0x33f176);}}exports[a126_0x475279(0x1a8)]=SalesforceCommitsManager;