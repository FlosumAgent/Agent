const a121_0x57f569=a121_0x16ba;(function(_0xef326e,_0x23f9bd){const _0x2717e6=a121_0x16ba,_0x45a807=_0xef326e();while(!![]){try{const _0x1c7121=-parseInt(_0x2717e6(0xee))/0x1*(parseInt(_0x2717e6(0x108))/0x2)+-parseInt(_0x2717e6(0x105))/0x3*(-parseInt(_0x2717e6(0xd3))/0x4)+parseInt(_0x2717e6(0xf7))/0x5+-parseInt(_0x2717e6(0x104))/0x6+parseInt(_0x2717e6(0xe2))/0x7*(-parseInt(_0x2717e6(0xd6))/0x8)+parseInt(_0x2717e6(0xed))/0x9*(parseInt(_0x2717e6(0xd8))/0xa)+parseInt(_0x2717e6(0xda))/0xb*(-parseInt(_0x2717e6(0xf6))/0xc);if(_0x1c7121===_0x23f9bd)break;else _0x45a807['push'](_0x45a807['shift']());}catch(_0x190771){_0x45a807['push'](_0x45a807['shift']());}}}(a121_0x43ad,0x5bc02));const a121_0xf34b88=function(){let _0x408beb=!![];return function(_0x4ed9e0,_0x498120){const _0x2e873a=_0x408beb?function(){const _0x11d250=a121_0x16ba;if(_0x498120){const _0x44a664=_0x498120[_0x11d250(0xe6)](_0x4ed9e0,arguments);return _0x498120=null,_0x44a664;}}:function(){};return _0x408beb=![],_0x2e873a;};}(),a121_0x43faea=a121_0xf34b88(this,function(){const _0x2007db=a121_0x16ba;return a121_0x43faea[_0x2007db(0xdf)]()[_0x2007db(0xf3)]('(((.+)+)+)+$')[_0x2007db(0xdf)]()[_0x2007db(0xf9)](a121_0x43faea)[_0x2007db(0xf3)](_0x2007db(0x107));});a121_0x43faea();'use strict';function a121_0x16ba(_0x1314b8,_0x1ff287){const _0x2ec79a=a121_0x43ad();return a121_0x16ba=function(_0x43faea,_0xf34b88){_0x43faea=_0x43faea-0xc1;let _0x43ad34=_0x2ec79a[_0x43faea];return _0x43ad34;},a121_0x16ba(_0x1314b8,_0x1ff287);}var __importDefault=this&&this[a121_0x57f569(0xd1)]||function(_0x16eff2){const _0x3957e3=a121_0x57f569;return _0x16eff2&&_0x16eff2[_0x3957e3(0xd4)]?_0x16eff2:{'default':_0x16eff2};};Object['defineProperty'](exports,a121_0x57f569(0xd4),{'value':!![]}),exports['SalesforceCommitsManager']=void 0x0;function a121_0x43ad(){const _0x440066=['18TJWcmU','options','(((.+)+)+)+$','2YpegKw','../../../core','graph','../errors/salesforce.error','SALESFORCE_MAX_GRAPH_NODES_PER_REQUEST','reference','inserted','delete','get','splice','proceededComponentsMeta','find','../utils/composite.utils','recordTypes','\x20requests\x20to\x20composite\x20api.','[INFO]\x20Sending\x20','Logger','default','message','__importDefault','getProceededComponentsMeta','283984tJaqCV','__esModule','update','104ozFfSN','gitSync','6542570oCDajN','insert','1234453dBhFHS','proceedCommitsToRepository','proceedCommits','composite','./salesforce-components-manager.service','toString','COMPONENTS_PER_CHUNK','length','108346qtjTwc','SalesforceCommitsManager','typedi','./salesforce-composite.service','apply','proceedRequests','logger','chunkArray','createCommit','SalesforceError','log','9uWyFic','48473tqjQTl','floor','map','branchId','have\x20to\x20proceed\x20%d\x20(%d\x20to\x20remove)\x20composite\x20requests\x20(repository)','search','repositoryId','executeGraphs','12CQUDAz','427345oApSFV','sfLogger','constructor','author','modified','removed','error','name','SalesforceCompositeService','SalesforceComponentsManager','have\x20to\x20proceed\x20%d\x20composite\x20requests\x20(branch)','stringify','push','2567892rxRtZt'];a121_0x43ad=function(){return _0x440066;};return a121_0x43ad();}const core_1=require(a121_0x57f569(0x109)),typedi_1=__importDefault(require(a121_0x57f569(0xe4))),constants_1=require('../../../constants'),utils_1=require('../../shared/utils'),salesforce_error_1=require(a121_0x57f569(0xc1)),composite_utils_1=require(a121_0x57f569(0xca)),salesforce_components_manager_service_1=require(a121_0x57f569(0xde)),salesforce_composite_service_1=require(a121_0x57f569(0xe5)),salesforce_git_sync_service_1=require('./salesforce-git-sync.service');class SalesforceCommitsManager{constructor(_0x4e3696){const _0x181100=a121_0x57f569;this['options']=_0x4e3696,this['COMPONENTS_PER_CHUNK']=0x3,this[_0x181100(0xe8)]=new core_1[(_0x181100(0xce))](SalesforceCommitsManager[_0x181100(0xfe)]),this[_0x181100(0xf8)]=this['options'][_0x181100(0xe8)],this[_0x181100(0xdd)]=typedi_1['default'][_0x181100(0xc6)](salesforce_composite_service_1[_0x181100(0xff)]),this[_0x181100(0xd7)]=typedi_1[_0x181100(0xcf)]['get'](salesforce_git_sync_service_1['SalesforceGitSyncService']),this[_0x181100(0xc8)]=[];}async['proceedRequests'](_0xe88668,_0x294fe3=![]){const _0x5576d9=a121_0x57f569,_0x5cdea5=(this[_0x5576d9(0xe0)]+ +_0x294fe3)*0x3,_0x3d6af0=utils_1[_0x5576d9(0xe9)](_0xe88668,_0x5cdea5);try{while(_0x3d6af0['length']){const _0x89960=_0x3d6af0[_0x5576d9(0xc7)](0x0,Math[_0x5576d9(0xef)](constants_1[_0x5576d9(0xc2)]/_0x5cdea5));await this['sfLogger'][_0x5576d9(0xec)](_0x5576d9(0xcd)+_0x89960[_0x5576d9(0xe1)]*_0x5cdea5+_0x5576d9(0xcc))['send']();const _0x58655f=_0x89960[_0x5576d9(0xf0)]((_0x1eb55a,_0x27361d)=>({'graphId':_0x5576d9(0x10a)+_0x27361d,'compositeRequest':_0x1eb55a})),_0x43c21e=await this[_0x5576d9(0xdd)][_0x5576d9(0xf5)](_0x58655f);if(_0x294fe3){const _0x3c2d18=composite_utils_1['extractComponentIdsFromGraphsResponse'](_0x43c21e);for(const {id:_0x555e23,ref:_0x289566}of _0x3c2d18){const _0x24b909=this[_0x5576d9(0xc8)][_0x5576d9(0xc9)](_0x214ebd=>_0x214ebd[_0x5576d9(0xc3)]===_0x289566);_0x24b909&&(_0x24b909['componentId']=_0x555e23);}}}}catch(_0x1ffc8e){this[_0x5576d9(0xe8)][_0x5576d9(0xfd)](_0x1ffc8e instanceof salesforce_error_1['SalesforceError']?JSON[_0x5576d9(0x102)](_0x1ffc8e['toJSON'](),null,0x2):_0x1ffc8e),this[_0x5576d9(0xf8)][_0x5576d9(0xec)](_0x1ffc8e instanceof salesforce_error_1[_0x5576d9(0xeb)]?JSON[_0x5576d9(0x102)](_0x1ffc8e['toJSON'](),null,0x2):_0x1ffc8e['toString']());throw _0x1ffc8e;}}async[a121_0x57f569(0xdb)](_0xde387a){const _0xc48da0=a121_0x57f569;for(const _0x2d41ac of _0xde387a){if(!_0x2d41ac[_0xc48da0(0xc4)][_0xc48da0(0xe1)]&&!_0x2d41ac[_0xc48da0(0xfb)][_0xc48da0(0xe1)]&&!_0x2d41ac[_0xc48da0(0xfc)][_0xc48da0(0xe1)])continue;let _0x4fad74='';(_0x2d41ac['modified'][_0xc48da0(0xe1)]||_0x2d41ac[_0xc48da0(0xc4)][_0xc48da0(0xe1)])&&(_0x4fad74=await this[_0xc48da0(0xd7)][_0xc48da0(0xea)](_0x2d41ac[_0xc48da0(0xd0)],this[_0xc48da0(0x106)]['repositoryId']));const _0x1c089f=[],_0x31dd4c=[],_0x1f4f38=new salesforce_components_manager_service_1[(_0xc48da0(0x100))](this[_0xc48da0(0x106)][_0xc48da0(0xf4)],this[_0xc48da0(0x106)][_0xc48da0(0xf1)],_0x2d41ac['author'],this[_0xc48da0(0x106)][_0xc48da0(0xcb)],this[_0xc48da0(0xc8)]);_0x1c089f['push'](...await _0x1f4f38[_0xc48da0(0xd9)](_0x2d41ac['inserted'],_0x4fad74)),_0x1c089f['push'](...await _0x1f4f38[_0xc48da0(0xd5)](_0x2d41ac[_0xc48da0(0xfb)],_0x4fad74)),_0x31dd4c[_0xc48da0(0x103)](...await _0x1f4f38[_0xc48da0(0xc5)](_0x2d41ac['removed'],!![])),this[_0xc48da0(0xc8)]=_0x1f4f38[_0xc48da0(0xd2)](),await this[_0xc48da0(0xe7)](_0x1c089f,!![]),await this[_0xc48da0(0xe7)](_0x31dd4c),this[_0xc48da0(0xe8)][_0xc48da0(0xec)](_0xc48da0(0xf2),_0x1c089f[_0xc48da0(0xe1)],_0x31dd4c[_0xc48da0(0xe1)]);}}async['proceedCommitsToBranch'](_0x42709d){const _0x48bdff=a121_0x57f569,_0xe79785=[];for(const _0x27f5df of _0x42709d){if(!_0x27f5df['inserted']['length']&&!_0x27f5df[_0x48bdff(0xfb)][_0x48bdff(0xe1)]&&!_0x27f5df[_0x48bdff(0xfc)][_0x48bdff(0xe1)])continue;const _0x2efb84=new salesforce_components_manager_service_1['SalesforceComponentsManager'](this[_0x48bdff(0x106)][_0x48bdff(0xf4)],this['options'][_0x48bdff(0xf1)],_0x27f5df[_0x48bdff(0xfa)],this[_0x48bdff(0x106)][_0x48bdff(0xcb)],[]);_0xe79785[_0x48bdff(0x103)](...await _0x2efb84['insert'](_0x27f5df[_0x48bdff(0xc4)])),_0xe79785['push'](...await _0x2efb84[_0x48bdff(0xd5)](_0x27f5df['modified'])),_0xe79785[_0x48bdff(0x103)](...await _0x2efb84['delete'](_0x27f5df[_0x48bdff(0xfc)]));}this[_0x48bdff(0xe8)][_0x48bdff(0xec)](_0x48bdff(0x101),_0xe79785['length']),await this['proceedRequests'](_0xe79785);}async[a121_0x57f569(0xdc)](_0x2781a6){const _0x412444=a121_0x57f569;this[_0x412444(0x106)][_0x412444(0xf1)]?await this['proceedCommitsToBranch'](_0x2781a6):await this['proceedCommitsToRepository'](_0x2781a6);}}exports[a121_0x57f569(0xe3)]=SalesforceCommitsManager;