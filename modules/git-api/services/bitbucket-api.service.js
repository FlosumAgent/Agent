const a64_0x4ce78d=a64_0x1836;function a64_0x3688(){const _0x5141a5=['Service','28305qfaMNJ','__esModule','getCurrentUser','MAX_REQUEST_PER_HOUR','axios','bitbucket','BitbucketApiService','createRequest','1476YqPqoV','apply','request','interceptors','57040dwfeKZ','length','then','grant_type=client_credentials','metadata','accessToken','use','__metadata','1646400ocLEaT','now','design:paramtypes','apiRequest','Authorization','124340JmSETg','checkAccessToken','112eAefWv','5877buuBfW','constructor','AuthSettingsService','../../shared/services/app-settings.service','defineProperty','(((.+)+)+)+$','refreshToken','replace','accessTokenExpiresAt','headers','search','259uRjuuH','object','function','toString','./git-api.service','decorate','isLoggedIn','10230122UWDolS','authSettings','4561896BOlwsa','__decorate','default','post'];a64_0x3688=function(){return _0x5141a5;};return a64_0x3688();}(function(_0x47dc33,_0x28876f){const _0x44101a=a64_0x1836,_0x51bca5=_0x47dc33();while(!![]){try{const _0x3970d3=parseInt(_0x44101a(0xe0))/0x1*(-parseInt(_0x44101a(0xf6))/0x2)+-parseInt(_0x44101a(0xee))/0x3*(parseInt(_0x44101a(0x109))/0x4)+parseInt(_0x44101a(0x107))/0x5+-parseInt(_0x44101a(0x102))/0x6+-parseInt(_0x44101a(0xe7))/0x7+-parseInt(_0x44101a(0xe9))/0x8+-parseInt(_0x44101a(0x10a))/0x9*(-parseInt(_0x44101a(0xfa))/0xa);if(_0x3970d3===_0x28876f)break;else _0x51bca5['push'](_0x51bca5['shift']());}catch(_0x38073c){_0x51bca5['push'](_0x51bca5['shift']());}}}(a64_0x3688,0xf140f));const a64_0x3e2d92=function(){let _0x8af439=!![];return function(_0x10e122,_0x29bcf8){const _0x3694c7=_0x8af439?function(){const _0x2b147d=a64_0x1836;if(_0x29bcf8){const _0x1202ce=_0x29bcf8[_0x2b147d(0xf7)](_0x10e122,arguments);return _0x29bcf8=null,_0x1202ce;}}:function(){};return _0x8af439=![],_0x3694c7;};}(),a64_0x37beb3=a64_0x3e2d92(this,function(){const _0x39bf5d=a64_0x1836;return a64_0x37beb3[_0x39bf5d(0xe3)]()['search'](_0x39bf5d(0x10f))[_0x39bf5d(0xe3)]()[_0x39bf5d(0x10b)](a64_0x37beb3)[_0x39bf5d(0xdf)](_0x39bf5d(0x10f));});a64_0x37beb3();'use strict';var __decorate=this&&this[a64_0x4ce78d(0xea)]||function(_0x316bff,_0x44394f,_0x1f2d1e,_0x30e0df){const _0x520312=a64_0x4ce78d;var _0x4bd9ca=arguments['length'],_0x204e1f=_0x4bd9ca<0x3?_0x44394f:_0x30e0df===null?_0x30e0df=Object['getOwnPropertyDescriptor'](_0x44394f,_0x1f2d1e):_0x30e0df,_0xa1d5f7;if(typeof Reflect===_0x520312(0xe1)&&typeof Reflect[_0x520312(0xe5)]===_0x520312(0xe2))_0x204e1f=Reflect[_0x520312(0xe5)](_0x316bff,_0x44394f,_0x1f2d1e,_0x30e0df);else{for(var _0x11c938=_0x316bff[_0x520312(0xfb)]-0x1;_0x11c938>=0x0;_0x11c938--)if(_0xa1d5f7=_0x316bff[_0x11c938])_0x204e1f=(_0x4bd9ca<0x3?_0xa1d5f7(_0x204e1f):_0x4bd9ca>0x3?_0xa1d5f7(_0x44394f,_0x1f2d1e,_0x204e1f):_0xa1d5f7(_0x44394f,_0x1f2d1e))||_0x204e1f;}return _0x4bd9ca>0x3&&_0x204e1f&&Object[_0x520312(0x10e)](_0x44394f,_0x1f2d1e,_0x204e1f),_0x204e1f;},__metadata=this&&this[a64_0x4ce78d(0x101)]||function(_0x12cb4a,_0x3f3201){const _0x388ca1=a64_0x4ce78d;if(typeof Reflect==='object'&&typeof Reflect[_0x388ca1(0xfe)]==='function')return Reflect[_0x388ca1(0xfe)](_0x12cb4a,_0x3f3201);},__param=this&&this['__param']||function(_0x2e6a5f,_0x1e3e49){return function(_0x9ee526,_0x49c011){_0x1e3e49(_0x9ee526,_0x49c011,_0x2e6a5f);};},__importDefault=this&&this['__importDefault']||function(_0x26385b){const _0x5a5e6d=a64_0x4ce78d;return _0x26385b&&_0x26385b[_0x5a5e6d(0xef)]?_0x26385b:{'default':_0x26385b};};Object[a64_0x4ce78d(0x10e)](exports,a64_0x4ce78d(0xef),{'value':!![]}),exports[a64_0x4ce78d(0xf4)]=void 0x0;function a64_0x1836(_0x39a09e,_0x478ecc){const _0xcdbdf5=a64_0x3688();return a64_0x1836=function(_0x37beb3,_0x3e2d92){_0x37beb3=_0x37beb3-0xdf;let _0x3688e5=_0xcdbdf5[_0x37beb3];return _0x3688e5;},a64_0x1836(_0x39a09e,_0x478ecc);}const constants_1=require('../../../constants'),app_settings_service_1=require(a64_0x4ce78d(0x10d)),auth_settings_service_1=require('../../shared/services/auth-settings.service'),axios_1=__importDefault(require(a64_0x4ce78d(0xf2))),typedi_1=require('typedi'),git_api_service_1=require(a64_0x4ce78d(0xe4));let BitbucketApiService=class BitbucketApiService extends git_api_service_1['GitApiService']{constructor(_0x267eb2,_0x2e3033){const _0x395eaf=a64_0x4ce78d;super(_0x267eb2),this['authSettings']=_0x2e3033,this[_0x395eaf(0x112)]=-0x1,this[_0x395eaf(0xf1)]=0x3e8,this[_0x395eaf(0xf8)]=this[_0x395eaf(0xf5)]();}get[a64_0x4ce78d(0x105)](){return this['request'];}[a64_0x4ce78d(0xf5)](_0x470164){const _0x13ac98=a64_0x4ce78d,_0x14f3ca=super[_0x13ac98(0xf5)](_0x470164);return _0x14f3ca[_0x13ac98(0xf9)][_0x13ac98(0xf8)][_0x13ac98(0x100)](async _0x5302ce=>{const _0x8dc9e4=_0x13ac98;return await this[_0x8dc9e4(0x108)](),_0x5302ce[_0x8dc9e4(0x113)][_0x8dc9e4(0x106)]='Bearer\x20'+this[_0x8dc9e4(0xff)],_0x5302ce;}),_0x14f3ca;}async[a64_0x4ce78d(0x108)](){const _0x5860a6=a64_0x4ce78d;if(this['accessToken']&&Date[_0x5860a6(0x103)]()<this[_0x5860a6(0x112)])return;await this[_0x5860a6(0x110)]();}async['refreshToken'](){const _0x1c6350=a64_0x4ce78d,{clientToken:_0x109da2}=this[_0x1c6350(0xe8)]['bitbucket'],_0x30a726=await axios_1[_0x1c6350(0xeb)][_0x1c6350(0xec)](constants_1['BITBUCKET_REFRESH_TOKEN_URL'][_0x1c6350(0x111)]('%clientToken%',_0x109da2),_0x1c6350(0xfd))[_0x1c6350(0xfc)](_0x49bcc6=>_0x49bcc6['data']),{expires_in:_0x5c6fec,access_token:_0x7626a6}=_0x30a726;this[_0x1c6350(0xe8)]['update']({'bitbucket':{...this['authSettings'][_0x1c6350(0xf3)],'token':_0x7626a6}}),this[_0x1c6350(0x112)]=Date['now']()+_0x5c6fec*0x3e8,this['accessToken']=_0x7626a6;}['getHeaders'](){return{};}[a64_0x4ce78d(0xf0)](){const _0x132b4c=a64_0x4ce78d;return this[_0x132b4c(0xf8)]['get']('user');}async[a64_0x4ce78d(0xe6)](){const _0x1ade90=a64_0x4ce78d;return await this[_0x1ade90(0xf0)](),!![];}};BitbucketApiService=__decorate([(0x0,typedi_1[a64_0x4ce78d(0xed)])(),__param(0x0,(0x0,typedi_1['Inject'])()),__metadata(a64_0x4ce78d(0x104),[app_settings_service_1['AppSettingsService'],auth_settings_service_1[a64_0x4ce78d(0x10c)]])],BitbucketApiService),exports[a64_0x4ce78d(0xf4)]=BitbucketApiService;