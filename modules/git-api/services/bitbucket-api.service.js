const a63_0x584c=['527336KXzeTY','refreshToken','post','constructor','getHeaders','667456MLhbOO','__metadata','BitbucketApiService','apiRequest','object','defineProperty','997059ssYEwo','length','createRequest','__importDefault','Inject','accessTokenExpiresAt','__param','900021WvyIdc','isLoggedIn','1621HKSnSH','replace','%clientToken%','454HdQHUe','checkAccessToken','getCurrentUser','1XprprW','../../shared/services/auth-settings.service','grant_type=client_credentials','getOwnPropertyDescriptor','__esModule','authSettings','metadata','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','get','now','GitApiService','Authorization','decorate','default','558075bBRjhu','function','then','request','interceptors','typedi','accessToken','2575715nKLztr','BITBUCKET_REFRESH_TOKEN_URL','bitbucket','../../shared/services/app-settings.service','AppSettingsService'];const a63_0x217413=a63_0x52ec;(function(_0x1b1c66,_0x2d78d3){const _0x44ceed=a63_0x52ec;while(!![]){try{const _0x57a6d3=-parseInt(_0x44ceed(0x1e9))+-parseInt(_0x44ceed(0x1c4))*parseInt(_0x44ceed(0x1de))+-parseInt(_0x44ceed(0x1be))*parseInt(_0x44ceed(0x1c1))+parseInt(_0x44ceed(0x1d2))+parseInt(_0x44ceed(0x1e3))+-parseInt(_0x44ceed(0x1bc))+parseInt(_0x44ceed(0x1d9));if(_0x57a6d3===_0x2d78d3)break;else _0x1b1c66['push'](_0x1b1c66['shift']());}catch(_0x3a054e){_0x1b1c66['push'](_0x1b1c66['shift']());}}}(a63_0x584c,0x9c780));const a63_0x413213=function(){let _0x29442a=!![];return function(_0x1d7ce0,_0x3bf9c7){const _0x4e8b8b=_0x29442a?function(){if(_0x3bf9c7){const _0x1f659a=_0x3bf9c7['apply'](_0x1d7ce0,arguments);return _0x3bf9c7=null,_0x1f659a;}}:function(){};return _0x29442a=![],_0x4e8b8b;};}(),a63_0x280e94=a63_0x413213(this,function(){const _0x52d302=function(){const _0x1de0e1=a63_0x52ec,_0x2e4b19=_0x52d302[_0x1de0e1(0x1e1)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](_0x1de0e1(0x1cb));return!_0x2e4b19['test'](a63_0x280e94);};return _0x52d302();});function a63_0x52ec(_0x8b5849,_0x4d9970){return a63_0x52ec=function(_0xe651df,_0x280e94){_0xe651df=_0xe651df-0x1b7;let _0x413213=a63_0x584c[_0xe651df];return _0x413213;},a63_0x52ec(_0x8b5849,_0x4d9970);}a63_0x280e94();'use strict';var __decorate=this&&this['__decorate']||function(_0x3e1a69,_0x20521d,_0x273d49,_0x8ccec0){const _0x23ef64=a63_0x52ec;var _0x40370c=arguments['length'],_0x48ca41=_0x40370c<0x3?_0x20521d:_0x8ccec0===null?_0x8ccec0=Object[_0x23ef64(0x1c7)](_0x20521d,_0x273d49):_0x8ccec0,_0x39df7a;if(typeof Reflect===_0x23ef64(0x1e7)&&typeof Reflect['decorate']===_0x23ef64(0x1d3))_0x48ca41=Reflect[_0x23ef64(0x1d0)](_0x3e1a69,_0x20521d,_0x273d49,_0x8ccec0);else{for(var _0x908489=_0x3e1a69[_0x23ef64(0x1ea)]-0x1;_0x908489>=0x0;_0x908489--)if(_0x39df7a=_0x3e1a69[_0x908489])_0x48ca41=(_0x40370c<0x3?_0x39df7a(_0x48ca41):_0x40370c>0x3?_0x39df7a(_0x20521d,_0x273d49,_0x48ca41):_0x39df7a(_0x20521d,_0x273d49))||_0x48ca41;}return _0x40370c>0x3&&_0x48ca41&&Object[_0x23ef64(0x1e8)](_0x20521d,_0x273d49,_0x48ca41),_0x48ca41;},__metadata=this&&this[a63_0x217413(0x1e4)]||function(_0x3c2a9c,_0x134b9d){const _0x3d3fc5=a63_0x217413;if(typeof Reflect===_0x3d3fc5(0x1e7)&&typeof Reflect[_0x3d3fc5(0x1ca)]==='function')return Reflect[_0x3d3fc5(0x1ca)](_0x3c2a9c,_0x134b9d);},__param=this&&this[a63_0x217413(0x1bb)]||function(_0x551a0f,_0x4b5a5e){return function(_0x352d70,_0x46f529){_0x4b5a5e(_0x352d70,_0x46f529,_0x551a0f);};},__importDefault=this&&this[a63_0x217413(0x1b8)]||function(_0x10c223){const _0x26da5d=a63_0x217413;return _0x10c223&&_0x10c223[_0x26da5d(0x1c8)]?_0x10c223:{'default':_0x10c223};};Object[a63_0x217413(0x1e8)](exports,a63_0x217413(0x1c8),{'value':!![]}),exports[a63_0x217413(0x1e5)]=void 0x0;const constants_1=require('../../../constants'),app_settings_service_1=require(a63_0x217413(0x1dc)),auth_settings_service_1=require(a63_0x217413(0x1c5)),axios_1=__importDefault(require('axios')),typedi_1=require(a63_0x217413(0x1d7)),git_api_service_1=require('./git-api.service');let BitbucketApiService=class BitbucketApiService extends git_api_service_1[a63_0x217413(0x1ce)]{constructor(_0x549767,_0x3a248c){const _0x39a0e0=a63_0x217413;super(_0x549767),this['authSettings']=_0x3a248c,this[_0x39a0e0(0x1ba)]=-0x1,this[_0x39a0e0(0x1d5)]=this[_0x39a0e0(0x1b7)]();}get[a63_0x217413(0x1e6)](){const _0x24632=a63_0x217413;return this[_0x24632(0x1d5)];}['createRequest'](_0x1acbe7){const _0x3be6aa=a63_0x217413,_0x13510e=super['createRequest'](_0x1acbe7);return _0x13510e[_0x3be6aa(0x1d6)][_0x3be6aa(0x1d5)]['use'](async _0x180526=>{const _0x4740b4=_0x3be6aa;return await this['checkAccessToken'](),_0x180526['headers'][_0x4740b4(0x1cf)]='Bearer\x20'+this[_0x4740b4(0x1d8)],_0x180526;}),_0x13510e;}async[a63_0x217413(0x1c2)](){const _0x5f53b8=a63_0x217413;if(this[_0x5f53b8(0x1d8)]&&Date['now']()<this[_0x5f53b8(0x1ba)])return;await this[_0x5f53b8(0x1df)]();}async['refreshToken'](){const _0x395a3f=a63_0x217413,{clientToken:_0x1cef84}=this[_0x395a3f(0x1c9)]['bitbucket'],_0x15d8f8=await axios_1[_0x395a3f(0x1d1)][_0x395a3f(0x1e0)](constants_1[_0x395a3f(0x1da)][_0x395a3f(0x1bf)](_0x395a3f(0x1c0),_0x1cef84),_0x395a3f(0x1c6))[_0x395a3f(0x1d4)](_0x13891b=>_0x13891b['data']),{expires_in:_0x3ebdcc,access_token:_0x6a2705}=_0x15d8f8;this['authSettings']['update']({'bitbucket':{...this['authSettings'][_0x395a3f(0x1db)],'token':_0x6a2705}}),this[_0x395a3f(0x1ba)]=Date[_0x395a3f(0x1cd)]()+_0x3ebdcc*0x3e8,this[_0x395a3f(0x1d8)]=_0x6a2705;}[a63_0x217413(0x1e2)](){return{};}[a63_0x217413(0x1c3)](){const _0x2e9b9c=a63_0x217413;return this[_0x2e9b9c(0x1d5)][_0x2e9b9c(0x1cc)]('user');}async[a63_0x217413(0x1bd)](){const _0xf12325=a63_0x217413;try{return await this[_0xf12325(0x1c3)](),!![];}catch(_0x143dc7){return![];}}};BitbucketApiService=__decorate([typedi_1['Service'](),__param(0x0,typedi_1[a63_0x217413(0x1b9)]()),__metadata('design:paramtypes',[app_settings_service_1[a63_0x217413(0x1dd)],auth_settings_service_1['AuthSettingsService']])],BitbucketApiService),exports[a63_0x217413(0x1e5)]=BitbucketApiService;