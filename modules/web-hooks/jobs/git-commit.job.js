const a182_0x4884f4=a182_0xac7b;(function(_0x3c0fe3,_0x3b4d92){const _0x1721ab=a182_0xac7b,_0xb3b46f=_0x3c0fe3();while(!![]){try{const _0x25ad09=-parseInt(_0x1721ab(0x1b7))/0x1*(parseInt(_0x1721ab(0x1d7))/0x2)+-parseInt(_0x1721ab(0x181))/0x3*(-parseInt(_0x1721ab(0x1a5))/0x4)+parseInt(_0x1721ab(0x17d))/0x5*(parseInt(_0x1721ab(0x15e))/0x6)+parseInt(_0x1721ab(0x1c9))/0x7+parseInt(_0x1721ab(0x1c7))/0x8*(parseInt(_0x1721ab(0x179))/0x9)+-parseInt(_0x1721ab(0x196))/0xa*(-parseInt(_0x1721ab(0x1b3))/0xb)+parseInt(_0x1721ab(0x186))/0xc*(-parseInt(_0x1721ab(0x164))/0xd);if(_0x25ad09===_0x3b4d92)break;else _0xb3b46f['push'](_0xb3b46f['shift']());}catch(_0x5e4cbd){_0xb3b46f['push'](_0xb3b46f['shift']());}}}(a182_0x1807,0x589e8));const a182_0x3c3597=function(){let _0x1ec42d=!![];return function(_0x13a311,_0xb7b089){const _0x4cebf4=_0x1ec42d?function(){if(_0xb7b089){const _0x9a9837=_0xb7b089['apply'](_0x13a311,arguments);return _0xb7b089=null,_0x9a9837;}}:function(){};return _0x1ec42d=![],_0x4cebf4;};}(),a182_0x586af2=a182_0x3c3597(this,function(){const _0x510a05=a182_0xac7b;return a182_0x586af2[_0x510a05(0x1d2)]()['search'](_0x510a05(0x165))[_0x510a05(0x1d2)]()[_0x510a05(0x177)](a182_0x586af2)['search'](_0x510a05(0x165));});a182_0x586af2();function a182_0x1807(){const _0x44913c=['SalesforceError','force','isLoggedIn','logger','sync\x20components','defineProperty','AuthSettingsService','removeDir','gitCommitData','fileNames','../../git-api/services/bitbucket-api.service','GitCommitJob','provider','319WCTait','function','catch','email','1mLAjPw','updateRemoteState','branch','../../salesforce/services/salesforce-commits-manager.service','__setModuleDefault','\x20before\x20sync.','DEFAULT_GIT_USER_EMAIL','mdapiUtils','../errors/flosum-commit.error','default','Logger','authSettings','gitUtils','proceed\x20git\x20commits\x20to\x20flosum','getBranchId','In\x20Progress','8FdPdcW','getRepositoryId','364091SpSbkk','metadata','getAccessToken','../utils/mdapi.utils','fetching\x20git\x20commits','checkoutTo','updateStatus','../../salesforce/services/salesforce-logger-v2.service','typedi','toString','FlosumCommitError','dir','repositoryGit','__esModule','417106owtTWS','[INFO]\x20Fetch\x20changes\x20files\x20from\x20git\x20commits.','proceedCommits','getProtocol','fetchCommits','create','log','length','decorate','SalesforceCommitsManager','Completed','message','flat','commits','[INFO]\x20Force\x20commit.\x20Have\x20to\x20parse\x20','bitbucket','fetch\x20components\x20metadata','../../../core','24RgYFqh','relative','__decorate','[ERROR]\x20Error\x20was\x20occured\x20when\x20commit\x20from\x20git\x20to\x20flosum\x20-\x20','getCredentialsFor','push','26819NpIyfb','(((.+)+)+)+$','get','../utils/git.utils','[INFO]\x20Branch\x20synchronized.\x20Skip','start\x20force\x20commit\x20job\x20to\x20sync\x20repository','replace','GitCommitService','[INFO]\x20Job\x20done.','DEFAULT_GIT_USER_NAME','[INFO]\x20Download\x20components\x20metadata\x20from\x20flosum.','GitUtils','files','error','readDir','path','__importStar','cleanUp','clone','constructor','name','3157821pjrveF','SalesforceNotFoundError','[INFO]\x20Start\x20proceeding\x20git\x20commits.','://','784505zliKck','../../salesforce/errors/not-found.error','../../shared/services/auth-settings.service','../../../constants','2105328pPxMON','../../../core/errors/api.error','design:paramtypes','send','describeCommit','10092acRcnA','MDApiUtils','shift','getRemote','getLoggerId','../../internal/fs.internal','repository','removeLogger','Error','sfLogger','prepare\x20mdapi\x20to\x20parse','../services/git-commit.service','call','author','../../salesforce/errors/salesforce.error','map','198020CJFLDw','gitCommit','getRecordTypes','__createBinding','Service','../../shared/utils','[INFO]\x20Proceeded\x20','setCommitDto','[INFO]\x20Clone\x20git\x20repository.','fetch\x20repository/branch\x20data','git\x20commit\x20job\x20done\x20(´･ω･`)','lastCommitHash','values','clone\x20repository\x20from\x20%s','prepareGitChangedPaths','4YmnjLt'];a182_0x1807=function(){return _0x44913c;};return a182_0x1807();}'use strict';var __createBinding=this&&this[a182_0x4884f4(0x199)]||(Object[a182_0x4884f4(0x1dc)]?function(_0xb918a8,_0x313f8f,_0x3953ca,_0x59ea74){const _0x479fae=a182_0x4884f4;if(_0x59ea74===undefined)_0x59ea74=_0x3953ca;Object[_0x479fae(0x1ab)](_0xb918a8,_0x59ea74,{'enumerable':!![],'get':function(){return _0x313f8f[_0x3953ca];}});}:function(_0x36eede,_0x1df8c9,_0x4bc0d4,_0x38b032){if(_0x38b032===undefined)_0x38b032=_0x4bc0d4;_0x36eede[_0x38b032]=_0x1df8c9[_0x4bc0d4];}),__setModuleDefault=this&&this[a182_0x4884f4(0x1bb)]||(Object[a182_0x4884f4(0x1dc)]?function(_0x2d7633,_0x20b535){const _0x43596=a182_0x4884f4;Object['defineProperty'](_0x2d7633,_0x43596(0x1c0),{'enumerable':!![],'value':_0x20b535});}:function(_0x80c4d9,_0x5c2dc5){const _0x16f4b4=a182_0x4884f4;_0x80c4d9[_0x16f4b4(0x1c0)]=_0x5c2dc5;}),__decorate=this&&this[a182_0x4884f4(0x160)]||function(_0x3662f0,_0x3e3136,_0x528629,_0x2fbe15){const _0x14add2=a182_0x4884f4;var _0x2545b1=arguments[_0x14add2(0x153)],_0x48bc05=_0x2545b1<0x3?_0x3e3136:_0x2fbe15===null?_0x2fbe15=Object['getOwnPropertyDescriptor'](_0x3e3136,_0x528629):_0x2fbe15,_0x5cc82e;if(typeof Reflect==='object'&&typeof Reflect[_0x14add2(0x154)]===_0x14add2(0x1b4))_0x48bc05=Reflect['decorate'](_0x3662f0,_0x3e3136,_0x528629,_0x2fbe15);else{for(var _0x194945=_0x3662f0[_0x14add2(0x153)]-0x1;_0x194945>=0x0;_0x194945--)if(_0x5cc82e=_0x3662f0[_0x194945])_0x48bc05=(_0x2545b1<0x3?_0x5cc82e(_0x48bc05):_0x2545b1>0x3?_0x5cc82e(_0x3e3136,_0x528629,_0x48bc05):_0x5cc82e(_0x3e3136,_0x528629))||_0x48bc05;}return _0x2545b1>0x3&&_0x48bc05&&Object[_0x14add2(0x1ab)](_0x3e3136,_0x528629,_0x48bc05),_0x48bc05;},__importStar=this&&this[a182_0x4884f4(0x174)]||function(_0x5f39e6){const _0xaa979c=a182_0x4884f4;if(_0x5f39e6&&_0x5f39e6['__esModule'])return _0x5f39e6;var _0x130a0f={};if(_0x5f39e6!=null){for(var _0x2df2e8 in _0x5f39e6)if(_0x2df2e8!==_0xaa979c(0x1c0)&&Object['prototype']['hasOwnProperty'][_0xaa979c(0x192)](_0x5f39e6,_0x2df2e8))__createBinding(_0x130a0f,_0x5f39e6,_0x2df2e8);}return __setModuleDefault(_0x130a0f,_0x5f39e6),_0x130a0f;},__metadata=this&&this['__metadata']||function(_0x485fe0,_0x3a4a31){const _0x4734bb=a182_0x4884f4;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x4734bb(0x1b4))return Reflect[_0x4734bb(0x1ca)](_0x485fe0,_0x3a4a31);},GitCommitJob_1;Object[a182_0x4884f4(0x1ab)](exports,a182_0x4884f4(0x1d6),{'value':!![]}),exports[a182_0x4884f4(0x1b1)]=void 0x0;const core_1=require(a182_0x4884f4(0x15d)),fs_internal_1=require(a182_0x4884f4(0x18b)),salesforce_logger_v2_service_1=require(a182_0x4884f4(0x1d0)),auth_settings_service_1=require(a182_0x4884f4(0x17f)),utils_1=require(a182_0x4884f4(0x19b)),path_1=require(a182_0x4884f4(0x173)),typedi_1=__importStar(require(a182_0x4884f4(0x1d1))),constants_1=require(a182_0x4884f4(0x180)),salesforce_commits_manager_service_1=require(a182_0x4884f4(0x1ba)),git_commit_utils_1=require('../utils/git-commit.utils'),git_utils_1=require(a182_0x4884f4(0x167)),mdapi_utils_1=require(a182_0x4884f4(0x1cc)),api_error_1=require(a182_0x4884f4(0x182)),salesforce_error_1=require(a182_0x4884f4(0x194)),git_commit_service_1=require(a182_0x4884f4(0x191)),flosum_commit_error_1=require(a182_0x4884f4(0x1bf)),not_found_error_1=require(a182_0x4884f4(0x17e)),bitbucket_api_service_1=require(a182_0x4884f4(0x1b0));let GitCommitJob=GitCommitJob_1=class GitCommitJob{constructor(_0x568654,_0x583c71){const _0x5c9f14=a182_0x4884f4;this['authSettings']=_0x568654,this[_0x5c9f14(0x197)]=_0x583c71,this[_0x5c9f14(0x1a9)]=new core_1[(_0x5c9f14(0x1c1))](GitCommitJob_1[_0x5c9f14(0x178)]);}async[a182_0x4884f4(0x189)](){const _0x178c45=a182_0x4884f4,{repositoryGit:_0x36e124}=this['gitCommitData'];let _0xbbf854=this[_0x178c45(0x1c2)][_0x178c45(0x162)](this[_0x178c45(0x1ae)][_0x178c45(0x1b2)]);if(this[_0x178c45(0x1ae)][_0x178c45(0x1b2)]===_0x178c45(0x15b)){const _0x1e492e=typedi_1['default'][_0x178c45(0x166)](bitbucket_api_service_1['BitbucketApiService']);await _0x1e492e[_0x178c45(0x1a8)](),_0xbbf854+=encodeURIComponent(_0x1e492e[_0x178c45(0x1cb)]());}return _0x36e124[_0x178c45(0x16a)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x178c45(0x1da)](_0x36e124)+_0x178c45(0x17c)+_0xbbf854+'@');}async[a182_0x4884f4(0x1db)](){const _0x28d493=a182_0x4884f4;if(this[_0x28d493(0x1ae)]['force'])return;const _0x42b6b0=[];for(const _0x54c21c of this[_0x28d493(0x1ae)][_0x28d493(0x159)]){const _0x11c7ba=await this[_0x28d493(0x1c3)][_0x28d493(0x185)](_0x54c21c['id']);_0x54c21c['username']=_0x11c7ba[_0x28d493(0x193)],_0x54c21c[_0x28d493(0x157)]=_0x11c7ba['message'],_0x54c21c[_0x28d493(0x170)]=_0x11c7ba['changes'],_0x54c21c[_0x28d493(0x1b6)]=_0x11c7ba['email'];if(_0x54c21c[_0x28d493(0x1b6)]===constants_1[_0x28d493(0x1bd)])throw new flosum_commit_error_1[(_0x28d493(0x1d3))]();_0x42b6b0[_0x28d493(0x163)](...Object[_0x28d493(0x1a2)](_0x54c21c[_0x28d493(0x170)])[_0x28d493(0x158)]());}this[_0x28d493(0x1ae)][_0x28d493(0x1af)]=git_commit_utils_1[_0x28d493(0x1a4)]([...new Set(_0x42b6b0)]);}async['proceedCommits'](){const _0x5c2b55=a182_0x4884f4,_0x4b2ea9=[...this[_0x5c2b55(0x1ae)][_0x5c2b55(0x159)]],_0x1ebc64=_0x4b2ea9[_0x5c2b55(0x153)],_0x223677=[];while(_0x4b2ea9['length']){const _0x54bf80=_0x4b2ea9[_0x5c2b55(0x188)]();!this[_0x5c2b55(0x1ae)][_0x5c2b55(0x1a7)]&&(this[_0x5c2b55(0x197)]['getRepositoryId']()?await this[_0x5c2b55(0x1c3)][_0x5c2b55(0x1ce)](_0x54bf80['id']):await this[_0x5c2b55(0x1c3)][_0x5c2b55(0x1ce)](this['lastCommitHash'])),_0x223677[_0x5c2b55(0x163)](await this['gitCommit']['proceedGitCommit'](_0x54bf80,this[_0x5c2b55(0x1be)][_0x5c2b55(0x1d4)])),await this[_0x5c2b55(0x18f)][_0x5c2b55(0x1dd)](_0x5c2b55(0x19c)+_0x223677[_0x5c2b55(0x153)]+'/'+_0x1ebc64);}const _0x545556=new salesforce_commits_manager_service_1[(_0x5c2b55(0x155))]({'recordTypes':this[_0x5c2b55(0x197)][_0x5c2b55(0x198)](),'branchId':this['gitCommit'][_0x5c2b55(0x1c5)](),'repositoryId':this[_0x5c2b55(0x197)][_0x5c2b55(0x1c8)](),'logger':this[_0x5c2b55(0x18f)]});await _0x545556[_0x5c2b55(0x1d9)](_0x223677);}async[a182_0x4884f4(0x175)](){const _0x343056=a182_0x4884f4;this[_0x343056(0x1c3)]&&await this[_0x343056(0x1c3)][_0x343056(0x1ad)]()['catch'](()=>void 0x0),this[_0x343056(0x1be)]&&await this[_0x343056(0x1be)][_0x343056(0x1ad)]()[_0x343056(0x1b5)](()=>void 0x0);}async['run'](_0x287f1e,_0x461670){const _0x2c52ea=a182_0x4884f4;this[_0x2c52ea(0x1ae)]=_0x287f1e,this[_0x2c52ea(0x197)][_0x2c52ea(0x19d)](this['gitCommitData']),this[_0x2c52ea(0x18f)]=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x461670[_0x2c52ea(0x18a)](),(_0x461670['getPrefix']()||'[GIT\x20->\x20FLOSUM]\x20[Repository:\x20'+_0x287f1e[_0x2c52ea(0x18c)]+']\x20[Branch:\x20'+_0x287f1e[_0x2c52ea(0x1b9)]+']')+'\x20['+GitCommitJob_1[_0x2c52ea(0x178)]+']'),this[_0x2c52ea(0x1c3)]=new git_utils_1[(_0x2c52ea(0x16f))](await this[_0x2c52ea(0x189)]()),this['mdapiUtils']=new mdapi_utils_1[(_0x2c52ea(0x187))](this['gitCommitData'][_0x2c52ea(0x18c)],this[_0x2c52ea(0x1ae)][_0x2c52ea(0x1b9)]);try{this[_0x2c52ea(0x1a9)]['log'](_0x2c52ea(0x19f)),this[_0x2c52ea(0x18f)][_0x2c52ea(0x1dd)]('[INFO]\x20Fetch\x20salesforce\x20data.'),await this[_0x2c52ea(0x197)]['fetchRepositoryOrBranchData'](),this[_0x2c52ea(0x1a9)][_0x2c52ea(0x1dd)](_0x2c52ea(0x1a3),this['gitCommitData'][_0x2c52ea(0x1d5)]),this[_0x2c52ea(0x18f)][_0x2c52ea(0x1dd)](_0x2c52ea(0x19e)),await this[_0x2c52ea(0x1c3)][_0x2c52ea(0x176)](this['gitCommitData'][_0x2c52ea(0x1b9)],this[_0x2c52ea(0x1ae)][_0x2c52ea(0x18c)]),this['logger'][_0x2c52ea(0x1dd)](_0x2c52ea(0x1cd)),await this[_0x2c52ea(0x18f)][_0x2c52ea(0x1dd)](_0x2c52ea(0x1d8))['send'](),await this['fetchCommits'](),await this[_0x2c52ea(0x197)]['updateStatus'](_0x2c52ea(0x1c6)),this['logger'][_0x2c52ea(0x1dd)](_0x2c52ea(0x190)),await this[_0x2c52ea(0x1be)]['prepareMdapi'](this[_0x2c52ea(0x1c3)][_0x2c52ea(0x1d4)]);if(_0x287f1e[_0x2c52ea(0x1a7)]){this[_0x2c52ea(0x1a9)][_0x2c52ea(0x1dd)](_0x2c52ea(0x169));const _0x3e82ce=(await fs_internal_1['FS'][_0x2c52ea(0x172)](this['mdapiUtils']['dir'],!![]))[_0x2c52ea(0x195)](_0x52ef7a=>path_1[_0x2c52ea(0x15f)](this[_0x2c52ea(0x1be)]['dir'],_0x52ef7a));this['sfLogger'][_0x2c52ea(0x1dd)](_0x2c52ea(0x15a)+_0x3e82ce[_0x2c52ea(0x153)]+_0x2c52ea(0x1bc)),this['gitCommitData']['fileNames']=[],this[_0x2c52ea(0x1ae)][_0x2c52ea(0x159)]=[{'files':{'modified':_0x3e82ce,'added':[],'removed':[]},'id':await this[_0x2c52ea(0x1c3)]['getCurrentHash'](),'message':_0x2c52ea(0x1aa),'username':constants_1[_0x2c52ea(0x16d)]}];}this[_0x2c52ea(0x1a1)]=this[_0x2c52ea(0x1ae)][_0x2c52ea(0x159)][this['gitCommitData'][_0x2c52ea(0x159)][_0x2c52ea(0x153)]-0x1]['id'];const _0x52b283=await this[_0x2c52ea(0x197)]['checkSyncStatus'](this['lastCommitHash']);if(_0x52b283){await this[_0x2c52ea(0x18f)][_0x2c52ea(0x1dd)](_0x2c52ea(0x168))[_0x2c52ea(0x184)](),await this[_0x2c52ea(0x197)][_0x2c52ea(0x1cf)](_0x2c52ea(0x156));return;}this[_0x2c52ea(0x1a9)]['log'](_0x2c52ea(0x15c)),await this['sfLogger']['log'](_0x2c52ea(0x16e)),await this[_0x2c52ea(0x197)]['fetchComponentsMetadata'](),await this[_0x2c52ea(0x197)][_0x2c52ea(0x1b8)]({[this[_0x2c52ea(0x1ae)]['repositoryGit']]:{'lastCommit':this['lastCommitHash']}}),this[_0x2c52ea(0x1a9)][_0x2c52ea(0x1dd)](_0x2c52ea(0x1c4)),this['sfLogger'][_0x2c52ea(0x1dd)](_0x2c52ea(0x17b)),await this[_0x2c52ea(0x1d9)](),this[_0x2c52ea(0x1a9)][_0x2c52ea(0x1dd)](_0x2c52ea(0x1a0)),await this['sfLogger'][_0x2c52ea(0x1dd)](_0x2c52ea(0x16c)),await this[_0x2c52ea(0x197)][_0x2c52ea(0x1cf)](_0x2c52ea(0x156));}catch(_0xc5335){await this[_0x2c52ea(0x175)](),this[_0x2c52ea(0x1a9)][_0x2c52ea(0x171)](_0xc5335);if(_0xc5335 instanceof not_found_error_1[_0x2c52ea(0x17a)]){await this[_0x2c52ea(0x18f)]['removeLogger']();return;}if(_0xc5335 instanceof flosum_commit_error_1[_0x2c52ea(0x1d3)]){await this[_0x2c52ea(0x18f)][_0x2c52ea(0x18d)]();return;}this['sfLogger']['log'](_0x2c52ea(0x161)+(_0xc5335 instanceof api_error_1['ApiError']||_0xc5335 instanceof salesforce_error_1[_0x2c52ea(0x1a6)]?_0xc5335[_0x2c52ea(0x1d2)]():_0xc5335)),await this['gitCommit'][_0x2c52ea(0x1b8)]({}),await this[_0x2c52ea(0x197)][_0x2c52ea(0x1cf)](_0x2c52ea(0x18e))[_0x2c52ea(0x1b5)](()=>void 0x0);throw _0xc5335;}finally{await this['cleanUp'](),this[_0x2c52ea(0x18f)][_0x2c52ea(0x184)]()[_0x2c52ea(0x1b5)](()=>void 0x0);}}};function a182_0xac7b(_0x4b9fca,_0x4ba8a9){const _0x2db98e=a182_0x1807();return a182_0xac7b=function(_0x586af2,_0x3c3597){_0x586af2=_0x586af2-0x153;let _0x1807a6=_0x2db98e[_0x586af2];return _0x1807a6;},a182_0xac7b(_0x4b9fca,_0x4ba8a9);}GitCommitJob=GitCommitJob_1=__decorate([typedi_1[a182_0x4884f4(0x19a)]({'transient':!![]}),__metadata(a182_0x4884f4(0x183),[auth_settings_service_1[a182_0x4884f4(0x1ac)],git_commit_service_1[a182_0x4884f4(0x16b)]])],GitCommitJob),exports[a182_0x4884f4(0x1b1)]=GitCommitJob;