const a176_0x587629=a176_0x4082;function a176_0x4082(_0x2e225e,_0xb8e693){const _0x6495a2=a176_0x1541();return a176_0x4082=function(_0x24df3c,_0x4dd2d5){_0x24df3c=_0x24df3c-0x10f;let _0x15411b=_0x6495a2[_0x24df3c];return _0x15411b;},a176_0x4082(_0x2e225e,_0xb8e693);}(function(_0x34beae,_0x383a3b){const _0x5515d5=a176_0x4082,_0x897a32=_0x34beae();while(!![]){try{const _0x1b2505=-parseInt(_0x5515d5(0x15c))/0x1+parseInt(_0x5515d5(0x111))/0x2*(-parseInt(_0x5515d5(0x177))/0x3)+-parseInt(_0x5515d5(0x13e))/0x4+parseInt(_0x5515d5(0x12b))/0x5+-parseInt(_0x5515d5(0x12a))/0x6+-parseInt(_0x5515d5(0x183))/0x7*(-parseInt(_0x5515d5(0x17e))/0x8)+-parseInt(_0x5515d5(0x13c))/0x9;if(_0x1b2505===_0x383a3b)break;else _0x897a32['push'](_0x897a32['shift']());}catch(_0x118bbd){_0x897a32['push'](_0x897a32['shift']());}}}(a176_0x1541,0xce68e));const a176_0x4dd2d5=function(){let _0x2d6300=!![];return function(_0x3f3091,_0xcc3ddc){const _0x585006=_0x2d6300?function(){if(_0xcc3ddc){const _0x313dc6=_0xcc3ddc['apply'](_0x3f3091,arguments);return _0xcc3ddc=null,_0x313dc6;}}:function(){};return _0x2d6300=![],_0x585006;};}(),a176_0x24df3c=a176_0x4dd2d5(this,function(){const _0x15ef72=a176_0x4082;return a176_0x24df3c[_0x15ef72(0x16d)]()[_0x15ef72(0x148)](_0x15ef72(0x117))[_0x15ef72(0x16d)]()[_0x15ef72(0x14d)](a176_0x24df3c)[_0x15ef72(0x148)]('(((.+)+)+)+$');});function a176_0x1541(){const _0x47368e=['setCommitDto','getCurrentHash','prepare\x20mdapi\x20to\x20parse','message','prepareMdapi','gitCommit','toString','repositoryGit','[INFO]\x20Fetch\x20salesforce\x20data.','getRepositoryId','defineProperty','map','fetchRepositoryOrBranchData','[INFO]\x20Proceeded\x20','gitCommitData','remote','225033SuGhMJ','Logger','object','[GIT\x20->\x20FLOSUM]\x20[Repository:\x20','catch','clone','MDApiUtils','10184848cnolIH','GitCommitJob','repository','push','gitUtils','7GlKSEJ','updateRemoteState','../../shared/utils','2oFAcBy','GitCommitService','lastCommitHash','__metadata','files','removeLogger','(((.+)+)+)+$','://','clone\x20repository\x20from\x20%s','branch','SalesforceCommitsManager','SalesforceError','getPrefix','../../../constants','removeDir','replace','[INFO]\x20Clone\x20git\x20repository.','fetching\x20git\x20commits','ApiError','../utils/mdapi.utils','username','start\x20force\x20commit\x20job\x20to\x20sync\x20repository','cleanUp','__decorate','getCredentialsFor','3196980KIvaFS','3487035UBLArp','../../../core/errors/api.error','name','__esModule','commits','flat','\x20[COMMIT]','AuthSettingsService','dir','path','values','length','../../internal/fs.internal','[ERROR]\x20Error\x20was\x20occured\x20when\x20commit\x20from\x20git\x20to\x20flosum\x20-\x20','prepareGitChangedPaths','function','getRecordTypes','1092258mYTpUS','DEFAULT_GIT_USER_NAME','1568804IpJlEF','fileNames','sync\x20components','author','mdapiUtils','../../salesforce/services/salesforce-commits-manager.service','error','../utils/git.utils','../services/git-commit.service','decorate','search','describeCommit','GitUtils','typedi','updateStatus','constructor','Completed','../utils/git-commit.utils','Error','log','FlosumCommitError','design:paramtypes','relative','logger','send','fetchComponentsMetadata','[INFO]\x20Fetch\x20changes\x20files\x20from\x20git\x20commits.','../../../core','readDir','\x20before\x20sync.','3655WjhxWD','../../shared/services/auth-settings.service','force','Service','sfLogger','authSettings','checkoutTo','proceedCommits','getBranchId','[INFO]\x20Download\x20components\x20metadata\x20from\x20flosum.','metadata'];a176_0x1541=function(){return _0x47368e;};return a176_0x1541();}a176_0x24df3c();'use strict';var __decorate=this&&this[a176_0x587629(0x128)]||function(_0x3e7426,_0x1bc323,_0x31836c,_0x34a296){const _0x359c27=a176_0x587629;var _0x415a88=arguments[_0x359c27(0x136)],_0x4c0f0e=_0x415a88<0x3?_0x1bc323:_0x34a296===null?_0x34a296=Object['getOwnPropertyDescriptor'](_0x1bc323,_0x31836c):_0x34a296,_0x2f1fcb;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x4c0f0e=Reflect[_0x359c27(0x147)](_0x3e7426,_0x1bc323,_0x31836c,_0x34a296);else{for(var _0x18f336=_0x3e7426[_0x359c27(0x136)]-0x1;_0x18f336>=0x0;_0x18f336--)if(_0x2f1fcb=_0x3e7426[_0x18f336])_0x4c0f0e=(_0x415a88<0x3?_0x2f1fcb(_0x4c0f0e):_0x415a88>0x3?_0x2f1fcb(_0x1bc323,_0x31836c,_0x4c0f0e):_0x2f1fcb(_0x1bc323,_0x31836c))||_0x4c0f0e;}return _0x415a88>0x3&&_0x4c0f0e&&Object['defineProperty'](_0x1bc323,_0x31836c,_0x4c0f0e),_0x4c0f0e;},__metadata=this&&this[a176_0x587629(0x114)]||function(_0x34c0b2,_0x202d8a){const _0x243929=a176_0x587629;if(typeof Reflect===_0x243929(0x179)&&typeof Reflect[_0x243929(0x166)]===_0x243929(0x13a))return Reflect[_0x243929(0x166)](_0x34c0b2,_0x202d8a);},GitCommitJob_1;Object[a176_0x587629(0x171)](exports,a176_0x587629(0x12e),{'value':!![]}),exports[a176_0x587629(0x17f)]=void 0x0;const core_1=require(a176_0x587629(0x159)),fs_internal_1=require(a176_0x587629(0x137)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),auth_settings_service_1=require(a176_0x587629(0x15d)),utils_1=require(a176_0x587629(0x110)),path_1=require(a176_0x587629(0x134)),typedi_1=require(a176_0x587629(0x14b)),constants_1=require(a176_0x587629(0x11e)),salesforce_commits_manager_service_1=require(a176_0x587629(0x143)),git_commit_utils_1=require(a176_0x587629(0x14f)),git_utils_1=require(a176_0x587629(0x145)),mdapi_utils_1=require(a176_0x587629(0x124)),api_error_1=require(a176_0x587629(0x12c)),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),git_commit_service_1=require(a176_0x587629(0x146)),flosum_commit_error_1=require('../errors/flosum-commit.error');let GitCommitJob=GitCommitJob_1=class GitCommitJob{constructor(_0x458a6c,_0x2bbdae){const _0x5e322b=a176_0x587629;this[_0x5e322b(0x161)]=_0x458a6c,this[_0x5e322b(0x16c)]=_0x2bbdae,this[_0x5e322b(0x155)]=new core_1[(_0x5e322b(0x178))](GitCommitJob_1[_0x5e322b(0x12d)]);}get[a176_0x587629(0x176)](){const _0x3574bf=a176_0x587629,{repositoryGit:_0x3874e7}=this[_0x3574bf(0x175)],_0x1b9fba=this['authSettings'][_0x3574bf(0x129)](this[_0x3574bf(0x175)]['provider']);return _0x3874e7[_0x3574bf(0x120)](/http(s)?\:\/\/(.+@)?/,utils_1['getProtocol'](_0x3874e7)+_0x3574bf(0x118)+_0x1b9fba+'@');}async['fetchCommits'](){const _0x8148bd=a176_0x587629;if(this[_0x8148bd(0x175)]['force'])return;const _0x1d4c60=[];for(const _0x1a7501 of this['gitCommitData']['commits']){const _0x15835a=await this[_0x8148bd(0x182)][_0x8148bd(0x149)](_0x1a7501['id']);_0x1a7501[_0x8148bd(0x125)]=_0x15835a[_0x8148bd(0x141)],_0x1a7501[_0x8148bd(0x16a)]=_0x15835a[_0x8148bd(0x16a)],_0x1a7501['files']=_0x15835a['changes'];if(_0x1a7501[_0x8148bd(0x125)]===constants_1[_0x8148bd(0x13d)])throw new flosum_commit_error_1[(_0x8148bd(0x152))]();_0x1d4c60[_0x8148bd(0x181)](...Object[_0x8148bd(0x135)](_0x1a7501[_0x8148bd(0x115)])[_0x8148bd(0x130)]());}this[_0x8148bd(0x175)][_0x8148bd(0x13f)]=git_commit_utils_1[_0x8148bd(0x139)]([...new Set(_0x1d4c60)]);}async[a176_0x587629(0x163)](){const _0x11a417=a176_0x587629,_0x26be97=[...this['gitCommitData'][_0x11a417(0x12f)]],_0x97d6de=_0x26be97[_0x11a417(0x136)],_0x32e8ee=[];while(_0x26be97['length']){const _0x264859=_0x26be97['shift']();!this[_0x11a417(0x175)]['force']&&(this[_0x11a417(0x16c)][_0x11a417(0x170)]()?await this[_0x11a417(0x182)][_0x11a417(0x162)](_0x264859['id']):await this[_0x11a417(0x182)][_0x11a417(0x162)](this[_0x11a417(0x113)])),_0x32e8ee['push'](await this[_0x11a417(0x16c)]['proceedGitCommit'](_0x264859,this[_0x11a417(0x142)][_0x11a417(0x133)])),await this[_0x11a417(0x160)][_0x11a417(0x151)](_0x11a417(0x174)+_0x32e8ee[_0x11a417(0x136)]+'/'+_0x97d6de);}const _0x37504b=new salesforce_commits_manager_service_1[(_0x11a417(0x11b))]({'recordTypes':this[_0x11a417(0x16c)][_0x11a417(0x13b)](),'branchId':this[_0x11a417(0x16c)][_0x11a417(0x164)](),'repositoryId':this['gitCommit'][_0x11a417(0x170)](),'logger':this[_0x11a417(0x160)]});await _0x37504b['proceedCommits'](_0x32e8ee);}async[a176_0x587629(0x127)](){const _0x4c7c1d=a176_0x587629;this[_0x4c7c1d(0x182)]&&await this[_0x4c7c1d(0x182)]['removeDir']()[_0x4c7c1d(0x17b)](()=>void 0x0),this[_0x4c7c1d(0x142)]&&await this['mdapiUtils'][_0x4c7c1d(0x11f)]()[_0x4c7c1d(0x17b)](()=>void 0x0);}async['run'](_0x1dbf6b,_0x583db7){const _0x60d760=a176_0x587629;this[_0x60d760(0x175)]=_0x1dbf6b,this[_0x60d760(0x16c)][_0x60d760(0x167)](this[_0x60d760(0x175)]),this['sfLogger']=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x583db7['getLoggerId'](),(_0x583db7[_0x60d760(0x11d)]()||_0x60d760(0x17a)+_0x1dbf6b[_0x60d760(0x180)]+']\x20[Branch:\x20'+_0x1dbf6b[_0x60d760(0x11a)]+']')+_0x60d760(0x131)),this[_0x60d760(0x182)]=new git_utils_1[(_0x60d760(0x14a))](this[_0x60d760(0x176)]),this[_0x60d760(0x142)]=new mdapi_utils_1[(_0x60d760(0x17d))](this[_0x60d760(0x175)]['repository'],this[_0x60d760(0x175)][_0x60d760(0x11a)]);try{this[_0x60d760(0x155)][_0x60d760(0x151)]('fetch\x20repository/branch\x20data'),this['sfLogger'][_0x60d760(0x151)](_0x60d760(0x16f)),await this[_0x60d760(0x16c)][_0x60d760(0x173)](),await this[_0x60d760(0x16c)][_0x60d760(0x14c)]('In\x20Progress'),this['logger']['log'](_0x60d760(0x119),this['gitCommitData'][_0x60d760(0x16e)]),this[_0x60d760(0x160)][_0x60d760(0x151)](_0x60d760(0x121)),await this['gitUtils'][_0x60d760(0x17c)](this[_0x60d760(0x175)][_0x60d760(0x11a)],this[_0x60d760(0x175)][_0x60d760(0x180)]),this[_0x60d760(0x155)][_0x60d760(0x151)](_0x60d760(0x169)),await this['mdapiUtils'][_0x60d760(0x16b)](this[_0x60d760(0x182)][_0x60d760(0x133)]);if(_0x1dbf6b[_0x60d760(0x15e)]){this[_0x60d760(0x155)][_0x60d760(0x151)](_0x60d760(0x126));const _0x394907=(await fs_internal_1['FS'][_0x60d760(0x15a)](this[_0x60d760(0x142)]['dir'],!![]))[_0x60d760(0x172)](_0x3235de=>path_1[_0x60d760(0x154)](this[_0x60d760(0x142)]['dir'],_0x3235de));this[_0x60d760(0x160)][_0x60d760(0x151)]('[INFO]\x20Force\x20commit.\x20Have\x20to\x20parse\x20'+_0x394907[_0x60d760(0x136)]+_0x60d760(0x15b)),this[_0x60d760(0x175)][_0x60d760(0x13f)]=[],this[_0x60d760(0x175)][_0x60d760(0x12f)]=[{'files':{'modified':_0x394907,'added':[],'removed':[]},'id':await this['gitUtils'][_0x60d760(0x168)](),'message':_0x60d760(0x140),'username':constants_1[_0x60d760(0x13d)]}];}this[_0x60d760(0x113)]=this['gitCommitData']['commits'][this[_0x60d760(0x175)]['commits']['length']-0x1]['id'],this[_0x60d760(0x155)][_0x60d760(0x151)](_0x60d760(0x122)),await this[_0x60d760(0x160)]['log'](_0x60d760(0x158))[_0x60d760(0x156)](),await this['fetchCommits'](),this[_0x60d760(0x155)]['log']('fetch\x20components\x20metadata'),await this[_0x60d760(0x160)]['log'](_0x60d760(0x165)),await this[_0x60d760(0x16c)][_0x60d760(0x157)](),this[_0x60d760(0x155)][_0x60d760(0x151)]('proceed\x20git\x20commits\x20to\x20flosum'),this[_0x60d760(0x160)][_0x60d760(0x151)]('[INFO]\x20Start\x20proceeding\x20git\x20commits.'),await this[_0x60d760(0x163)](),this[_0x60d760(0x155)]['log']('git\x20commit\x20job\x20done\x20(´･ω･`)'),await this['sfLogger'][_0x60d760(0x151)]('[INFO]\x20Job\x20done.'),await this[_0x60d760(0x16c)]['updateStatus'](_0x60d760(0x14e)),await this[_0x60d760(0x16c)][_0x60d760(0x10f)]({[this[_0x60d760(0x175)]['repositoryGit']]:{'lastCommit':this[_0x60d760(0x113)]}});}catch(_0x3c2c1a){await this[_0x60d760(0x127)](),this['logger'][_0x60d760(0x144)](_0x3c2c1a);if(_0x3c2c1a instanceof flosum_commit_error_1[_0x60d760(0x152)]){await this[_0x60d760(0x160)][_0x60d760(0x116)]();return;}this[_0x60d760(0x160)][_0x60d760(0x151)](_0x60d760(0x138)+(_0x3c2c1a instanceof api_error_1[_0x60d760(0x123)]||_0x3c2c1a instanceof salesforce_error_1[_0x60d760(0x11c)]?_0x3c2c1a[_0x60d760(0x16d)]():_0x3c2c1a)),await this[_0x60d760(0x16c)][_0x60d760(0x10f)]({}),await this[_0x60d760(0x16c)][_0x60d760(0x14c)](_0x60d760(0x150))[_0x60d760(0x17b)](()=>void 0x0);throw _0x3c2c1a;}finally{await this[_0x60d760(0x127)](),this['sfLogger'][_0x60d760(0x156)]()[_0x60d760(0x17b)](()=>void 0x0);}}};GitCommitJob=GitCommitJob_1=__decorate([typedi_1[a176_0x587629(0x15f)]({'transient':!![]}),__metadata(a176_0x587629(0x153),[auth_settings_service_1[a176_0x587629(0x132)],git_commit_service_1[a176_0x587629(0x112)]])],GitCommitJob),exports['GitCommitJob']=GitCommitJob;