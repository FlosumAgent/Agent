const a182_0x297ea3=a182_0x9777;function a182_0x2a11(){const _0x59946f=['../utils/git-commit.utils','prototype','SalesforceNotFoundError','clone','logger','replace','Error','prepareGitChangedPaths','[GIT\x20->\x20FLOSUM]\x20[Repository:\x20','fetch\x20repository/branch\x20data','isSFDXProject','checkoutTo','prepareMdapi','updateRemoteState','sync\x20components','proceedGitCommit','setCommitDto','changes','defineProperty','[INFO]\x20Force\x20commit.\x20Have\x20to\x20parse\x20','__metadata','branch','../../salesforce/utils/sfdx.utils','[INFO]\x20Download\x20components\x20metadata\x20from\x20flosum.','email','getRecordTypes',']\x20[Branch:\x20','typedi','mdapiUtils','15118LwhflE','SFDX','[INFO]\x20Proceeded\x20','getRepositoryId','../../shared/utils','gitCommitData','isLoggedIn','../../salesforce/errors/salesforce.error','Completed','git\x20commit\x20job\x20done\x20(´･ω･`)','9ttdqXG','gitCommit','create','error','catch','repositoryGit','fetchComponentsMetadata','start\x20force\x20commit\x20job\x20to\x20sync\x20repository','default','message','114340dwcWVc','proceed\x20git\x20commits\x20to\x20flosum','GitUtils','[ERROR]\x20Error\x20was\x20occured\x20when\x20commit\x20from\x20git\x20to\x20flosum\x20-\x20','AuthSettingsService','updateStatus','fileNames','../utils/git.utils','fetchCommits','1044534AhGzxs','constructor','getAccessToken','provider','send','function','describeCommit','proceedCommits','fetch\x20components\x20metadata','(((.+)+)+)+$','../../internal/fs.internal','flat','get','Service','../../../constants','call','files','toString','__createBinding','push','clone\x20repository\x20from\x20%s','log','../../git-api/services/bitbucket-api.service','gitUtils','getCurrentHash','design:paramtypes','path','getProtocol','GitCommitService','getLoggerId','getRemote','getOwnPropertyDescriptor','FlosumCommitError','bitbucket','length','../../../core','[INFO]\x20Start\x20proceeding\x20git\x20commits.','../services/git-commit.service','1627493LgJbcG','cleanUp','dir','../../salesforce/services/salesforce-logger-v2.service','username','ApiError','__decorate','[INFO]\x20Clone\x20git\x20repository.','search','decorate','GitCommitJob','4PUnklm','metadata','SalesforceError','prepare\x20mdapi\x20to\x20parse','../../salesforce/errors/not-found.error','commits','87zRBcEt','object','repository','authSettings','[INFO]\x20Job\x20done.','180605oudNZh','[INFO]\x20Fetch\x20changes\x20files\x20from\x20git\x20commits.','1247688paRYbr','\x20before\x20sync.','sfLogger','__setModuleDefault','DEFAULT_GIT_USER_EMAIL','lastCommitHash','readDir','__esModule','SalesforceCommitsManager','checkSyncStatus','6206830JFNSKW','apply','__importStar','MDApiUtils','name'];a182_0x2a11=function(){return _0x59946f;};return a182_0x2a11();}(function(_0x39ad31,_0xdcd87d){const _0x33de50=a182_0x9777,_0x5c13ce=_0x39ad31();while(!![]){try{const _0x47330c=-parseInt(_0x33de50(0x1a6))/0x1+parseInt(_0x33de50(0x192))/0x2*(parseInt(_0x33de50(0x15f))/0x3)+parseInt(_0x33de50(0x159))/0x4*(-parseInt(_0x33de50(0x164))/0x5)+-parseInt(_0x33de50(0x1af))/0x6+-parseInt(_0x33de50(0x14e))/0x7+-parseInt(_0x33de50(0x166))/0x8+-parseInt(_0x33de50(0x19c))/0x9*(-parseInt(_0x33de50(0x170))/0xa);if(_0x47330c===_0xdcd87d)break;else _0x5c13ce['push'](_0x5c13ce['shift']());}catch(_0x33c3fd){_0x5c13ce['push'](_0x5c13ce['shift']());}}}(a182_0x2a11,0x1efa4));const a182_0x2fe43b=function(){let _0x1cd574=!![];return function(_0x4b984d,_0x2bf0f3){const _0x4100e8=_0x1cd574?function(){const _0x575e76=a182_0x9777;if(_0x2bf0f3){const _0x1f3f40=_0x2bf0f3[_0x575e76(0x171)](_0x4b984d,arguments);return _0x2bf0f3=null,_0x1f3f40;}}:function(){};return _0x1cd574=![],_0x4100e8;};}(),a182_0x545352=a182_0x2fe43b(this,function(){const _0x55eb69=a182_0x9777;return a182_0x545352[_0x55eb69(0x1c0)]()['search']('(((.+)+)+)+$')[_0x55eb69(0x1c0)]()[_0x55eb69(0x1b0)](a182_0x545352)[_0x55eb69(0x156)](_0x55eb69(0x1b8));});a182_0x545352();function a182_0x9777(_0x4a9bfb,_0x55c6e8){const _0x2aee05=a182_0x2a11();return a182_0x9777=function(_0x545352,_0x2fe43b){_0x545352=_0x545352-0x145;let _0x2a111a=_0x2aee05[_0x545352];return _0x2a111a;},a182_0x9777(_0x4a9bfb,_0x55c6e8);}'use strict';var __createBinding=this&&this[a182_0x297ea3(0x1c1)]||(Object[a182_0x297ea3(0x19e)]?function(_0x3b9384,_0x45574a,_0x42d321,_0x49133d){if(_0x49133d===undefined)_0x49133d=_0x42d321;Object['defineProperty'](_0x3b9384,_0x49133d,{'enumerable':!![],'get':function(){return _0x45574a[_0x42d321];}});}:function(_0x45fe2a,_0x30107b,_0x621fd,_0x2cb2df){if(_0x2cb2df===undefined)_0x2cb2df=_0x621fd;_0x45fe2a[_0x2cb2df]=_0x30107b[_0x621fd];}),__setModuleDefault=this&&this[a182_0x297ea3(0x169)]||(Object[a182_0x297ea3(0x19e)]?function(_0x59230a,_0xc64838){Object['defineProperty'](_0x59230a,'default',{'enumerable':!![],'value':_0xc64838});}:function(_0x2601ca,_0x54fc95){_0x2601ca['default']=_0x54fc95;}),__decorate=this&&this[a182_0x297ea3(0x154)]||function(_0x218798,_0x146153,_0x51c5c9,_0x494a02){const _0x8c3a29=a182_0x297ea3;var _0x1d11e6=arguments[_0x8c3a29(0x14a)],_0x32ebf0=_0x1d11e6<0x3?_0x146153:_0x494a02===null?_0x494a02=Object[_0x8c3a29(0x147)](_0x146153,_0x51c5c9):_0x494a02,_0x2cbbb8;if(typeof Reflect===_0x8c3a29(0x160)&&typeof Reflect[_0x8c3a29(0x157)]==='function')_0x32ebf0=Reflect['decorate'](_0x218798,_0x146153,_0x51c5c9,_0x494a02);else{for(var _0x2c312f=_0x218798[_0x8c3a29(0x14a)]-0x1;_0x2c312f>=0x0;_0x2c312f--)if(_0x2cbbb8=_0x218798[_0x2c312f])_0x32ebf0=(_0x1d11e6<0x3?_0x2cbbb8(_0x32ebf0):_0x1d11e6>0x3?_0x2cbbb8(_0x146153,_0x51c5c9,_0x32ebf0):_0x2cbbb8(_0x146153,_0x51c5c9))||_0x32ebf0;}return _0x1d11e6>0x3&&_0x32ebf0&&Object[_0x8c3a29(0x187)](_0x146153,_0x51c5c9,_0x32ebf0),_0x32ebf0;},__importStar=this&&this[a182_0x297ea3(0x172)]||function(_0x50b9be){const _0x42cf1a=a182_0x297ea3;if(_0x50b9be&&_0x50b9be[_0x42cf1a(0x16d)])return _0x50b9be;var _0x296226={};if(_0x50b9be!=null){for(var _0x45cf39 in _0x50b9be)if(_0x45cf39!=='default'&&Object[_0x42cf1a(0x176)]['hasOwnProperty'][_0x42cf1a(0x1be)](_0x50b9be,_0x45cf39))__createBinding(_0x296226,_0x50b9be,_0x45cf39);}return __setModuleDefault(_0x296226,_0x50b9be),_0x296226;},__metadata=this&&this[a182_0x297ea3(0x189)]||function(_0x5f7fd3,_0x5b2975){const _0x59260b=a182_0x297ea3;if(typeof Reflect===_0x59260b(0x160)&&typeof Reflect[_0x59260b(0x15a)]===_0x59260b(0x1b4))return Reflect[_0x59260b(0x15a)](_0x5f7fd3,_0x5b2975);},GitCommitJob_1;Object[a182_0x297ea3(0x187)](exports,'__esModule',{'value':!![]}),exports[a182_0x297ea3(0x158)]=void 0x0;const core_1=require(a182_0x297ea3(0x14b)),fs_internal_1=require(a182_0x297ea3(0x1b9)),salesforce_logger_v2_service_1=require(a182_0x297ea3(0x151)),auth_settings_service_1=require('../../shared/services/auth-settings.service'),utils_1=require(a182_0x297ea3(0x196)),path_1=require(a182_0x297ea3(0x1c9)),typedi_1=__importStar(require(a182_0x297ea3(0x190))),constants_1=require(a182_0x297ea3(0x1bd)),salesforce_commits_manager_service_1=require('../../salesforce/services/salesforce-commits-manager.service'),git_commit_utils_1=require(a182_0x297ea3(0x175)),git_utils_1=require(a182_0x297ea3(0x1ad)),mdapi_utils_1=require('../utils/mdapi.utils'),api_error_1=require('../../../core/errors/api.error'),salesforce_error_1=require(a182_0x297ea3(0x199)),git_commit_service_1=require(a182_0x297ea3(0x14d)),flosum_commit_error_1=require('../errors/flosum-commit.error'),not_found_error_1=require(a182_0x297ea3(0x15d)),bitbucket_api_service_1=require(a182_0x297ea3(0x1c5)),sfdx_utils_1=require(a182_0x297ea3(0x18b));let GitCommitJob=GitCommitJob_1=class GitCommitJob{constructor(_0x364c9c,_0x57f514){const _0x9edc27=a182_0x297ea3;this[_0x9edc27(0x162)]=_0x364c9c,this[_0x9edc27(0x19d)]=_0x57f514,this[_0x9edc27(0x179)]=new core_1['Logger'](GitCommitJob_1[_0x9edc27(0x174)]);}async[a182_0x297ea3(0x146)](){const _0x1ec71f=a182_0x297ea3,{repositoryGit:_0x14b426}=this[_0x1ec71f(0x197)];let _0x4f501e=this[_0x1ec71f(0x162)]['getCredentialsFor'](this['gitCommitData'][_0x1ec71f(0x1b2)]);if(this[_0x1ec71f(0x197)][_0x1ec71f(0x1b2)]===_0x1ec71f(0x149)){const _0x96d08f=typedi_1[_0x1ec71f(0x1a4)][_0x1ec71f(0x1bb)](bitbucket_api_service_1['BitbucketApiService']);await _0x96d08f[_0x1ec71f(0x198)](),_0x4f501e+=encodeURIComponent(_0x96d08f[_0x1ec71f(0x1b1)]());}return _0x14b426[_0x1ec71f(0x17a)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x1ec71f(0x1ca)](_0x14b426)+'://'+_0x4f501e+'@');}async[a182_0x297ea3(0x1ae)](){const _0x4d7be4=a182_0x297ea3;if(this[_0x4d7be4(0x197)]['force'])return;const _0xae37a6=[];for(const _0x587cc3 of this['gitCommitData'][_0x4d7be4(0x15e)]){const _0x14a2a5=await this[_0x4d7be4(0x1c6)][_0x4d7be4(0x1b5)](_0x587cc3['id']);_0x587cc3[_0x4d7be4(0x152)]=_0x14a2a5['author'],_0x587cc3[_0x4d7be4(0x1a5)]=_0x14a2a5['message'],_0x587cc3[_0x4d7be4(0x1bf)]=_0x14a2a5[_0x4d7be4(0x186)],_0x587cc3[_0x4d7be4(0x18d)]=_0x14a2a5[_0x4d7be4(0x18d)];if(_0x587cc3[_0x4d7be4(0x18d)]===constants_1[_0x4d7be4(0x16a)])throw new flosum_commit_error_1[(_0x4d7be4(0x148))]();_0xae37a6[_0x4d7be4(0x1c2)](...Object['values'](_0x587cc3[_0x4d7be4(0x1bf)])[_0x4d7be4(0x1ba)]());}this['gitCommitData']['fileNames']=git_commit_utils_1[_0x4d7be4(0x17c)]([...new Set(_0xae37a6)]);}async[a182_0x297ea3(0x1b6)](_0xe02d38){const _0x2f6710=a182_0x297ea3,_0x4fc7c1=[...this['gitCommitData'][_0x2f6710(0x15e)]],_0xa2db0e=_0x4fc7c1['length'],_0x35461f=[];while(_0x4fc7c1[_0x2f6710(0x14a)]){const _0x44eb04=_0x4fc7c1['shift']();!this['gitCommitData']['force']&&(this['gitCommit']['getRepositoryId']()?await this[_0x2f6710(0x1c6)]['checkoutTo'](_0x44eb04['id']):await this[_0x2f6710(0x1c6)][_0x2f6710(0x180)](this[_0x2f6710(0x16b)])),_0x35461f[_0x2f6710(0x1c2)](await this[_0x2f6710(0x19d)][_0x2f6710(0x184)](_0x44eb04,this[_0x2f6710(0x191)][_0x2f6710(0x150)],_0xe02d38)),await this['sfLogger'][_0x2f6710(0x1c4)](_0x2f6710(0x194)+_0x35461f[_0x2f6710(0x14a)]+'/'+_0xa2db0e);}const _0x5a0258=new salesforce_commits_manager_service_1[(_0x2f6710(0x16e))]({'recordTypes':this[_0x2f6710(0x19d)][_0x2f6710(0x18e)](),'branchId':this['gitCommit']['getBranchId'](),'repositoryId':this[_0x2f6710(0x19d)][_0x2f6710(0x195)](),'logger':this[_0x2f6710(0x168)]});await _0x5a0258[_0x2f6710(0x1b6)](_0x35461f);}async[a182_0x297ea3(0x14f)](){const _0x50baf9=a182_0x297ea3;this[_0x50baf9(0x1c6)]&&await this[_0x50baf9(0x1c6)]['removeDir']()['catch'](()=>void 0x0),this[_0x50baf9(0x191)]&&await this['mdapiUtils']['removeDir']()['catch'](()=>void 0x0);}async['run'](_0x264983,_0x317525){const _0x11c2c4=a182_0x297ea3;this[_0x11c2c4(0x197)]=_0x264983,this['gitCommit'][_0x11c2c4(0x185)](this[_0x11c2c4(0x197)]),this['sfLogger']=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x317525[_0x11c2c4(0x145)](),(_0x317525['getPrefix']()||_0x11c2c4(0x17d)+_0x264983[_0x11c2c4(0x161)]+_0x11c2c4(0x18f)+_0x264983['branch']+']')+'\x20['+GitCommitJob_1[_0x11c2c4(0x174)]+']'),this[_0x11c2c4(0x1c6)]=new git_utils_1[(_0x11c2c4(0x1a8))](await this['getRemote']()),this[_0x11c2c4(0x191)]=new mdapi_utils_1[(_0x11c2c4(0x173))](this[_0x11c2c4(0x197)][_0x11c2c4(0x161)],this[_0x11c2c4(0x197)][_0x11c2c4(0x18a)]);try{this[_0x11c2c4(0x179)][_0x11c2c4(0x1c4)](_0x11c2c4(0x17e)),this['sfLogger'][_0x11c2c4(0x1c4)]('[INFO]\x20Fetch\x20salesforce\x20data.'),await this['gitCommit']['fetchRepositoryOrBranchData'](),this[_0x11c2c4(0x179)][_0x11c2c4(0x1c4)](_0x11c2c4(0x1c3),this[_0x11c2c4(0x197)][_0x11c2c4(0x1a1)]),this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)](_0x11c2c4(0x155)),await this[_0x11c2c4(0x1c6)][_0x11c2c4(0x178)](this[_0x11c2c4(0x197)][_0x11c2c4(0x18a)],this[_0x11c2c4(0x197)][_0x11c2c4(0x161)]),this[_0x11c2c4(0x179)][_0x11c2c4(0x1c4)]('fetching\x20git\x20commits'),await this[_0x11c2c4(0x168)]['log'](_0x11c2c4(0x165))[_0x11c2c4(0x1b3)](),await this[_0x11c2c4(0x1ae)](),await this[_0x11c2c4(0x19d)][_0x11c2c4(0x1ab)]('In\x20Progress'),this[_0x11c2c4(0x179)][_0x11c2c4(0x1c4)](_0x11c2c4(0x15c)),await this['mdapiUtils'][_0x11c2c4(0x181)](this[_0x11c2c4(0x1c6)][_0x11c2c4(0x150)]);if(_0x264983['force']){this[_0x11c2c4(0x179)][_0x11c2c4(0x1c4)](_0x11c2c4(0x1a3));const _0x2e29b9=(await fs_internal_1['FS'][_0x11c2c4(0x16c)](this[_0x11c2c4(0x191)][_0x11c2c4(0x150)],!![]))['map'](_0x271b4e=>path_1['relative'](this[_0x11c2c4(0x191)][_0x11c2c4(0x150)],_0x271b4e));this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)](_0x11c2c4(0x188)+_0x2e29b9[_0x11c2c4(0x14a)]+_0x11c2c4(0x167)),this[_0x11c2c4(0x197)][_0x11c2c4(0x1ac)]=[],this[_0x11c2c4(0x197)][_0x11c2c4(0x15e)]=[{'files':{'modified':_0x2e29b9,'added':[],'removed':[]},'id':await this[_0x11c2c4(0x1c6)][_0x11c2c4(0x1c7)](),'message':_0x11c2c4(0x183),'username':constants_1['DEFAULT_GIT_USER_NAME']}];}this[_0x11c2c4(0x16b)]=this[_0x11c2c4(0x197)][_0x11c2c4(0x15e)][this[_0x11c2c4(0x197)][_0x11c2c4(0x15e)]['length']-0x1]['id'];const _0x382b09=await this[_0x11c2c4(0x19d)][_0x11c2c4(0x16f)](this[_0x11c2c4(0x16b)]);if(_0x382b09){await this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)]('[INFO]\x20Branch\x20synchronized.\x20Skip')[_0x11c2c4(0x1b3)](),await this['gitCommit'][_0x11c2c4(0x1ab)](_0x11c2c4(0x19a));return;}const _0x3d1742=await sfdx_utils_1[_0x11c2c4(0x193)][_0x11c2c4(0x17f)](this[_0x11c2c4(0x1c6)][_0x11c2c4(0x150)]);this[_0x11c2c4(0x179)]['log'](_0x11c2c4(0x1b7)),await this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)](_0x11c2c4(0x18c)),await this['gitCommit'][_0x11c2c4(0x1a2)](_0x3d1742),await this[_0x11c2c4(0x19d)][_0x11c2c4(0x182)]({[this['gitCommitData'][_0x11c2c4(0x1a1)]]:{'lastCommit':this[_0x11c2c4(0x16b)]}}),this['logger'][_0x11c2c4(0x1c4)](_0x11c2c4(0x1a7)),this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)](_0x11c2c4(0x14c)),await this[_0x11c2c4(0x1b6)](_0x3d1742),this[_0x11c2c4(0x179)][_0x11c2c4(0x1c4)](_0x11c2c4(0x19b)),await this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)](_0x11c2c4(0x163)),await this[_0x11c2c4(0x19d)]['updateStatus'](_0x11c2c4(0x19a));}catch(_0x42ef1e){await this[_0x11c2c4(0x14f)](),this['logger'][_0x11c2c4(0x19f)](_0x42ef1e);if(_0x42ef1e instanceof not_found_error_1[_0x11c2c4(0x177)]){await this[_0x11c2c4(0x168)]['removeLogger']();return;}if(_0x42ef1e instanceof flosum_commit_error_1[_0x11c2c4(0x148)]){await this[_0x11c2c4(0x168)]['removeLogger']();return;}this[_0x11c2c4(0x168)][_0x11c2c4(0x1c4)](_0x11c2c4(0x1a9)+(_0x42ef1e instanceof api_error_1[_0x11c2c4(0x153)]||_0x42ef1e instanceof salesforce_error_1[_0x11c2c4(0x15b)]?_0x42ef1e[_0x11c2c4(0x1c0)]():_0x42ef1e)),await this[_0x11c2c4(0x19d)][_0x11c2c4(0x182)]({}),await this[_0x11c2c4(0x19d)]['updateStatus'](_0x11c2c4(0x17b))[_0x11c2c4(0x1a0)](()=>void 0x0);throw _0x42ef1e;}finally{await this[_0x11c2c4(0x14f)](),await this[_0x11c2c4(0x168)][_0x11c2c4(0x1b3)]()[_0x11c2c4(0x1a0)](()=>void 0x0);}}};GitCommitJob=GitCommitJob_1=__decorate([typedi_1[a182_0x297ea3(0x1bc)]({'transient':!![]}),__metadata(a182_0x297ea3(0x1c8),[auth_settings_service_1[a182_0x297ea3(0x1aa)],git_commit_service_1[a182_0x297ea3(0x1cb)]])],GitCommitJob),exports[a182_0x297ea3(0x158)]=GitCommitJob;