const a182_0x20fbe2=a182_0x2e35;(function(_0x373dd5,_0xb96985){const _0x498ec8=a182_0x2e35,_0x481c26=_0x373dd5();while(!![]){try{const _0x1a92b2=parseInt(_0x498ec8(0x144))/0x1*(parseInt(_0x498ec8(0x181))/0x2)+parseInt(_0x498ec8(0x1ab))/0x3+-parseInt(_0x498ec8(0x190))/0x4*(-parseInt(_0x498ec8(0x1a9))/0x5)+-parseInt(_0x498ec8(0x16e))/0x6+-parseInt(_0x498ec8(0x1b3))/0x7*(-parseInt(_0x498ec8(0x186))/0x8)+-parseInt(_0x498ec8(0x175))/0x9*(-parseInt(_0x498ec8(0x132))/0xa)+parseInt(_0x498ec8(0x179))/0xb*(-parseInt(_0x498ec8(0x18d))/0xc);if(_0x1a92b2===_0xb96985)break;else _0x481c26['push'](_0x481c26['shift']());}catch(_0x3be958){_0x481c26['push'](_0x481c26['shift']());}}}(a182_0x4093,0x928db));function a182_0x2e35(_0x225a3e,_0x559d83){const _0x359b69=a182_0x4093();return a182_0x2e35=function(_0x2d416b,_0xa0640){_0x2d416b=_0x2d416b-0x130;let _0x409308=_0x359b69[_0x2d416b];return _0x409308;},a182_0x2e35(_0x225a3e,_0x559d83);}const a182_0xa0640=function(){let _0x544691=!![];return function(_0x128f86,_0x481852){const _0x3d5333=_0x544691?function(){const _0x284799=a182_0x2e35;if(_0x481852){const _0x3bcfd8=_0x481852[_0x284799(0x13b)](_0x128f86,arguments);return _0x481852=null,_0x3bcfd8;}}:function(){};return _0x544691=![],_0x3d5333;};}(),a182_0x2d416b=a182_0xa0640(this,function(){const _0x4d5fde=a182_0x2e35;return a182_0x2d416b[_0x4d5fde(0x130)]()['search'](_0x4d5fde(0x141))[_0x4d5fde(0x130)]()[_0x4d5fde(0x1bf)](a182_0x2d416b)[_0x4d5fde(0x155)]('(((.+)+)+)+$');});a182_0x2d416b();'use strict';var __createBinding=this&&this[a182_0x20fbe2(0x1c1)]||(Object[a182_0x20fbe2(0x139)]?function(_0x557cb6,_0x521c04,_0x2ee8a2,_0x43696e){if(_0x43696e===undefined)_0x43696e=_0x2ee8a2;Object['defineProperty'](_0x557cb6,_0x43696e,{'enumerable':!![],'get':function(){return _0x521c04[_0x2ee8a2];}});}:function(_0x313600,_0x1de0df,_0x2fdbec,_0x382a1c){if(_0x382a1c===undefined)_0x382a1c=_0x2fdbec;_0x313600[_0x382a1c]=_0x1de0df[_0x2fdbec];}),__setModuleDefault=this&&this[a182_0x20fbe2(0x151)]||(Object[a182_0x20fbe2(0x139)]?function(_0x3d32fc,_0x34eec0){Object['defineProperty'](_0x3d32fc,'default',{'enumerable':!![],'value':_0x34eec0});}:function(_0x1892a4,_0x172801){_0x1892a4['default']=_0x172801;}),__decorate=this&&this[a182_0x20fbe2(0x1b7)]||function(_0x45b062,_0x1a2ec6,_0x17a1ca,_0x21110a){const _0x35b60b=a182_0x20fbe2;var _0x439177=arguments[_0x35b60b(0x168)],_0x21bc05=_0x439177<0x3?_0x1a2ec6:_0x21110a===null?_0x21110a=Object['getOwnPropertyDescriptor'](_0x1a2ec6,_0x17a1ca):_0x21110a,_0x585b40;if(typeof Reflect===_0x35b60b(0x158)&&typeof Reflect[_0x35b60b(0x177)]===_0x35b60b(0x145))_0x21bc05=Reflect[_0x35b60b(0x177)](_0x45b062,_0x1a2ec6,_0x17a1ca,_0x21110a);else{for(var _0x3fc77f=_0x45b062[_0x35b60b(0x168)]-0x1;_0x3fc77f>=0x0;_0x3fc77f--)if(_0x585b40=_0x45b062[_0x3fc77f])_0x21bc05=(_0x439177<0x3?_0x585b40(_0x21bc05):_0x439177>0x3?_0x585b40(_0x1a2ec6,_0x17a1ca,_0x21bc05):_0x585b40(_0x1a2ec6,_0x17a1ca))||_0x21bc05;}return _0x439177>0x3&&_0x21bc05&&Object[_0x35b60b(0x171)](_0x1a2ec6,_0x17a1ca,_0x21bc05),_0x21bc05;},__importStar=this&&this['__importStar']||function(_0x8e080d){const _0x2e805c=a182_0x20fbe2;if(_0x8e080d&&_0x8e080d[_0x2e805c(0x172)])return _0x8e080d;var _0x25442f={};if(_0x8e080d!=null){for(var _0x315b59 in _0x8e080d)if(_0x315b59!==_0x2e805c(0x17f)&&Object[_0x2e805c(0x196)]['hasOwnProperty'][_0x2e805c(0x194)](_0x8e080d,_0x315b59))__createBinding(_0x25442f,_0x8e080d,_0x315b59);}return __setModuleDefault(_0x25442f,_0x8e080d),_0x25442f;},__metadata=this&&this[a182_0x20fbe2(0x142)]||function(_0x1cffd5,_0x340493){const _0x137233=a182_0x20fbe2;if(typeof Reflect===_0x137233(0x158)&&typeof Reflect[_0x137233(0x1c0)]===_0x137233(0x145))return Reflect['metadata'](_0x1cffd5,_0x340493);},GitCommitJob_1;Object[a182_0x20fbe2(0x171)](exports,a182_0x20fbe2(0x172),{'value':!![]}),exports[a182_0x20fbe2(0x1b4)]=void 0x0;const core_1=require(a182_0x20fbe2(0x1a7)),fs_internal_1=require(a182_0x20fbe2(0x1b5)),salesforce_logger_v2_service_1=require(a182_0x20fbe2(0x157)),auth_settings_service_1=require('../../shared/services/auth-settings.service'),utils_1=require(a182_0x20fbe2(0x176)),path_1=require(a182_0x20fbe2(0x18c)),typedi_1=__importStar(require(a182_0x20fbe2(0x180))),constants_1=require(a182_0x20fbe2(0x1bb)),salesforce_commits_manager_service_1=require('../../salesforce/services/salesforce-commits-manager.service'),git_commit_utils_1=require(a182_0x20fbe2(0x154)),git_utils_1=require(a182_0x20fbe2(0x159)),mdapi_utils_1=require(a182_0x20fbe2(0x198)),api_error_1=require(a182_0x20fbe2(0x1ae)),salesforce_error_1=require(a182_0x20fbe2(0x19d)),git_commit_service_1=require(a182_0x20fbe2(0x14c)),flosum_commit_error_1=require(a182_0x20fbe2(0x17d)),not_found_error_1=require(a182_0x20fbe2(0x15b)),bitbucket_api_service_1=require('../../git-api/services/bitbucket-api.service'),sfdx_utils_1=require(a182_0x20fbe2(0x13c));function a182_0x4093(){const _0x323fd5=['function','getCredentialsFor','commits','get','getBranchId','email','design:paramtypes','../services/git-commit.service','SalesforceNotFoundError','[INFO]\x20Fetch\x20salesforce\x20data.','://','files','__setModuleDefault','gitCommitData','SalesforceLogger2','../utils/git-commit.utils','search','shift','../../salesforce/services/salesforce-logger-v2.service','object','../utils/git.utils','message','../../salesforce/errors/not-found.error','SalesforceCommitsManager','run','getPrefix','SFDX','sync\x20components','authSettings','gitUtils','logger','start\x20force\x20commit\x20job\x20to\x20sync\x20repository','updateRemoteState','fileNames','getProtocol','length','[INFO]\x20Fetch\x20changes\x20files\x20from\x20git\x20commits.','proceed\x20git\x20commits\x20to\x20flosum','isLoggedIn','name','getRepositoryId','397284QxTAne','branch',']\x20[Branch:\x20','defineProperty','__esModule','fetch\x20repository/branch\x20data','getRecordTypes','189ZFeqZn','../../shared/utils','decorate','relative','5071AKibRg','dir','clone\x20repository\x20from\x20%s','fetchRepositoryOrBranchData','../errors/flosum-commit.error','removeDir','default','typedi','293162lJLyHn','DEFAULT_GIT_USER_EMAIL','In\x20Progress','[GIT\x20->\x20FLOSUM]\x20[Repository:\x20','Logger','12472EZgmLQ','fetching\x20git\x20commits','flat','force','[INFO]\x20Branch\x20synchronized.\x20Skip','[INFO]\x20Clone\x20git\x20repository.','path','68496MUEiHI','checkSyncStatus','MDApiUtils','4mNsWjE','send','Completed','GitUtils','call','push','prototype','checkoutTo','../utils/mdapi.utils','provider','DEFAULT_GIT_USER_NAME','author','repository','../../salesforce/errors/salesforce.error','log','fetchComponentsMetadata','git\x20commit\x20job\x20done\x20(´･ω･`)','map','prepareGitChangedPaths','gitCommit','username','[INFO]\x20Download\x20components\x20metadata\x20from\x20flosum.','replace','../../../core','isSFDXProject','4888715QRtvNn','Error','514077bobcbc','[INFO]\x20Force\x20commit.\x20Have\x20to\x20parse\x20','error','../../../core/errors/api.error','repositoryGit','sfLogger','prepare\x20mdapi\x20to\x20parse','getAccessToken','3871RLAVoA','GitCommitJob','../../internal/fs.internal','updateStatus','__decorate','[ERROR]\x20Error\x20was\x20occured\x20when\x20commit\x20from\x20git\x20to\x20flosum\x20-\x20','values','BitbucketApiService','../../../constants','[INFO]\x20Job\x20done.','bitbucket','setCommitDto','constructor','metadata','__createBinding','toString','FlosumCommitError','124090vylJcR','lastCommitHash','proceedCommits','prepareMdapi','describeCommit','mdapiUtils','getRemote','create','proceedGitCommit','apply','../../salesforce/utils/sfdx.utils','catch','cleanUp','fetchCommits','[INFO]\x20Proceeded\x20','(((.+)+)+)+$','__metadata','[INFO]\x20Start\x20proceeding\x20git\x20commits.','7eWenyE'];a182_0x4093=function(){return _0x323fd5;};return a182_0x4093();}let GitCommitJob=GitCommitJob_1=class GitCommitJob{constructor(_0x2b81bc,_0x35790a){const _0x4c4e6e=a182_0x20fbe2;this[_0x4c4e6e(0x161)]=_0x2b81bc,this['gitCommit']=_0x35790a,this[_0x4c4e6e(0x163)]=new core_1[(_0x4c4e6e(0x185))](GitCommitJob_1['name']);}async[a182_0x20fbe2(0x138)](){const _0x49b7c7=a182_0x20fbe2,{repositoryGit:_0x40e6d2}=this[_0x49b7c7(0x152)];let _0x5cf12f=this['authSettings'][_0x49b7c7(0x146)](this[_0x49b7c7(0x152)][_0x49b7c7(0x199)]);if(this['gitCommitData'][_0x49b7c7(0x199)]===_0x49b7c7(0x1bd)){const _0x269bc0=typedi_1['default'][_0x49b7c7(0x148)](bitbucket_api_service_1[_0x49b7c7(0x1ba)]);await _0x269bc0[_0x49b7c7(0x16b)](),_0x5cf12f+=encodeURIComponent(_0x269bc0[_0x49b7c7(0x1b2)]());}return _0x40e6d2[_0x49b7c7(0x1a6)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x49b7c7(0x167)](_0x40e6d2)+_0x49b7c7(0x14f)+_0x5cf12f+'@');}async[a182_0x20fbe2(0x13f)](){const _0x2340bd=a182_0x20fbe2;if(this[_0x2340bd(0x152)][_0x2340bd(0x189)])return;const _0x244fe8=[];for(const _0x2c66b0 of this[_0x2340bd(0x152)]['commits']){const _0x40ddc5=await this['gitUtils'][_0x2340bd(0x136)](_0x2c66b0['id']);_0x2c66b0[_0x2340bd(0x1a4)]=_0x40ddc5[_0x2340bd(0x19b)],_0x2c66b0[_0x2340bd(0x15a)]=_0x40ddc5[_0x2340bd(0x15a)],_0x2c66b0[_0x2340bd(0x150)]=_0x40ddc5['changes'],_0x2c66b0[_0x2340bd(0x14a)]=_0x40ddc5['email'];if(_0x2c66b0[_0x2340bd(0x14a)]===constants_1[_0x2340bd(0x182)])throw new flosum_commit_error_1[(_0x2340bd(0x131))]();_0x244fe8[_0x2340bd(0x195)](...Object[_0x2340bd(0x1b9)](_0x2c66b0[_0x2340bd(0x150)])[_0x2340bd(0x188)]());}this[_0x2340bd(0x152)]['fileNames']=git_commit_utils_1[_0x2340bd(0x1a2)]([...new Set(_0x244fe8)]);}async[a182_0x20fbe2(0x134)](){const _0x4ce920=a182_0x20fbe2,_0x2e8b2c=[...this['gitCommitData'][_0x4ce920(0x147)]],_0x312598=_0x2e8b2c[_0x4ce920(0x168)],_0x588482=[];while(_0x2e8b2c[_0x4ce920(0x168)]){const _0x271a12=_0x2e8b2c[_0x4ce920(0x156)]();!this[_0x4ce920(0x152)][_0x4ce920(0x189)]&&(this[_0x4ce920(0x1a3)][_0x4ce920(0x16d)]()?await this[_0x4ce920(0x162)]['checkoutTo'](_0x271a12['id']):await this[_0x4ce920(0x162)][_0x4ce920(0x197)](this['lastCommitHash'])),_0x588482[_0x4ce920(0x195)](await this[_0x4ce920(0x1a3)][_0x4ce920(0x13a)](_0x271a12,this[_0x4ce920(0x137)]['dir'])),await this[_0x4ce920(0x1b0)]['log'](_0x4ce920(0x140)+_0x588482[_0x4ce920(0x168)]+'/'+_0x312598);}const _0x2bd31b=new salesforce_commits_manager_service_1[(_0x4ce920(0x15c))]({'recordTypes':this[_0x4ce920(0x1a3)][_0x4ce920(0x174)](),'branchId':this[_0x4ce920(0x1a3)][_0x4ce920(0x149)](),'repositoryId':this[_0x4ce920(0x1a3)][_0x4ce920(0x16d)](),'logger':this[_0x4ce920(0x1b0)]});await _0x2bd31b[_0x4ce920(0x134)](_0x588482);}async[a182_0x20fbe2(0x13e)](){const _0x26a25a=a182_0x20fbe2;this[_0x26a25a(0x162)]&&await this[_0x26a25a(0x162)][_0x26a25a(0x17e)]()['catch'](()=>void 0x0),this[_0x26a25a(0x137)]&&await this[_0x26a25a(0x137)][_0x26a25a(0x17e)]()[_0x26a25a(0x13d)](()=>void 0x0);}async[a182_0x20fbe2(0x15d)](_0x14954d,_0x1c8268){const _0x371a86=a182_0x20fbe2;this[_0x371a86(0x152)]=_0x14954d,this[_0x371a86(0x1a3)][_0x371a86(0x1be)](this[_0x371a86(0x152)]),this[_0x371a86(0x1b0)]=new salesforce_logger_v2_service_1[(_0x371a86(0x153))](_0x1c8268['getLoggerId'](),(_0x1c8268[_0x371a86(0x15e)]()||_0x371a86(0x184)+_0x14954d['repository']+_0x371a86(0x170)+_0x14954d[_0x371a86(0x16f)]+']')+'\x20['+GitCommitJob_1[_0x371a86(0x16c)]+']'),this['gitUtils']=new git_utils_1[(_0x371a86(0x193))](await this[_0x371a86(0x138)]()),this[_0x371a86(0x137)]=new mdapi_utils_1[(_0x371a86(0x18f))](this[_0x371a86(0x152)]['repository'],this[_0x371a86(0x152)][_0x371a86(0x16f)]);try{this[_0x371a86(0x163)][_0x371a86(0x19e)](_0x371a86(0x173)),this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x14e)),await this[_0x371a86(0x1a3)][_0x371a86(0x17c)](),this['logger'][_0x371a86(0x19e)](_0x371a86(0x17b),this[_0x371a86(0x152)][_0x371a86(0x1af)]),this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x18b)),await this[_0x371a86(0x162)]['clone'](this[_0x371a86(0x152)][_0x371a86(0x16f)],this[_0x371a86(0x152)][_0x371a86(0x19c)]),this[_0x371a86(0x163)][_0x371a86(0x19e)](_0x371a86(0x187)),await this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x169))[_0x371a86(0x191)](),await this['fetchCommits'](),await this['gitCommit'][_0x371a86(0x1b6)](_0x371a86(0x183)),this[_0x371a86(0x163)][_0x371a86(0x19e)](_0x371a86(0x1b1)),await this[_0x371a86(0x137)][_0x371a86(0x135)](this[_0x371a86(0x162)][_0x371a86(0x17a)]);if(_0x14954d['force']){this[_0x371a86(0x163)][_0x371a86(0x19e)](_0x371a86(0x164));const _0x402ca2=(await fs_internal_1['FS']['readDir'](this[_0x371a86(0x137)]['dir'],!![]))[_0x371a86(0x1a1)](_0x126355=>path_1[_0x371a86(0x178)](this[_0x371a86(0x137)][_0x371a86(0x17a)],_0x126355));this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x1ac)+_0x402ca2['length']+'\x20before\x20sync.'),this[_0x371a86(0x152)][_0x371a86(0x166)]=[],this[_0x371a86(0x152)][_0x371a86(0x147)]=[{'files':{'modified':_0x402ca2,'added':[],'removed':[]},'id':await this[_0x371a86(0x162)]['getCurrentHash'](),'message':_0x371a86(0x160),'username':constants_1[_0x371a86(0x19a)]}];}this[_0x371a86(0x133)]=this['gitCommitData']['commits'][this[_0x371a86(0x152)][_0x371a86(0x147)]['length']-0x1]['id'];const _0xa40632=await this['gitCommit'][_0x371a86(0x18e)](this[_0x371a86(0x133)]);if(_0xa40632){await this['sfLogger'][_0x371a86(0x19e)](_0x371a86(0x18a))[_0x371a86(0x191)](),await this[_0x371a86(0x1a3)]['updateStatus'](_0x371a86(0x192));return;}const _0xb00bbe=await sfdx_utils_1[_0x371a86(0x15f)][_0x371a86(0x1a8)](this[_0x371a86(0x162)][_0x371a86(0x17a)]);this[_0x371a86(0x163)][_0x371a86(0x19e)]('fetch\x20components\x20metadata'),await this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x1a5)),await this[_0x371a86(0x1a3)][_0x371a86(0x19f)](_0xb00bbe),await this[_0x371a86(0x1a3)][_0x371a86(0x165)]({[this['gitCommitData'][_0x371a86(0x1af)]]:{'lastCommit':this[_0x371a86(0x133)]}}),this[_0x371a86(0x163)][_0x371a86(0x19e)](_0x371a86(0x16a)),this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x143)),await this[_0x371a86(0x134)](),this[_0x371a86(0x163)][_0x371a86(0x19e)](_0x371a86(0x1a0)),await this[_0x371a86(0x1b0)][_0x371a86(0x19e)](_0x371a86(0x1bc)),await this[_0x371a86(0x1a3)][_0x371a86(0x1b6)](_0x371a86(0x192));}catch(_0x4668ae){await this['cleanUp'](),this[_0x371a86(0x163)][_0x371a86(0x1ad)](_0x4668ae);if(_0x4668ae instanceof not_found_error_1[_0x371a86(0x14d)]){await this['sfLogger']['removeLogger']();return;}if(_0x4668ae instanceof flosum_commit_error_1[_0x371a86(0x131)]){await this[_0x371a86(0x1b0)]['removeLogger']();return;}this['sfLogger']['log'](_0x371a86(0x1b8)+(_0x4668ae instanceof api_error_1['ApiError']||_0x4668ae instanceof salesforce_error_1['SalesforceError']?_0x4668ae['toString']():_0x4668ae)),await this[_0x371a86(0x1a3)][_0x371a86(0x165)]({}),await this['gitCommit'][_0x371a86(0x1b6)](_0x371a86(0x1aa))[_0x371a86(0x13d)](()=>void 0x0);throw _0x4668ae;}finally{await this[_0x371a86(0x13e)](),this[_0x371a86(0x1b0)]['send']()[_0x371a86(0x13d)](()=>void 0x0);}}};GitCommitJob=GitCommitJob_1=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a182_0x20fbe2(0x14b),[auth_settings_service_1['AuthSettingsService'],git_commit_service_1['GitCommitService']])],GitCommitJob),exports[a182_0x20fbe2(0x1b4)]=GitCommitJob;