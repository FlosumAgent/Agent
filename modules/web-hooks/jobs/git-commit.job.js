const a179_0x416564=a179_0x4edb;(function(_0x4b01ff,_0x1a10b3){const _0x3d663b=a179_0x4edb,_0x402f0e=_0x4b01ff();while(!![]){try{const _0x4a35f2=-parseInt(_0x3d663b(0x11b))/0x1+parseInt(_0x3d663b(0x17f))/0x2+-parseInt(_0x3d663b(0x139))/0x3+parseInt(_0x3d663b(0x11e))/0x4+parseInt(_0x3d663b(0x16f))/0x5+parseInt(_0x3d663b(0x16c))/0x6*(-parseInt(_0x3d663b(0x16b))/0x7)+parseInt(_0x3d663b(0x17d))/0x8;if(_0x4a35f2===_0x1a10b3)break;else _0x402f0e['push'](_0x402f0e['shift']());}catch(_0x56ee75){_0x402f0e['push'](_0x402f0e['shift']());}}}(a179_0x116f,0xc0716));const a179_0x2e6e05=function(){let _0xa79493=!![];return function(_0x1cb4fd,_0x5a55e6){const _0x157bb4=_0xa79493?function(){const _0x45fce6=a179_0x4edb;if(_0x5a55e6){const _0x17b77f=_0x5a55e6[_0x45fce6(0x133)](_0x1cb4fd,arguments);return _0x5a55e6=null,_0x17b77f;}}:function(){};return _0xa79493=![],_0x157bb4;};}(),a179_0x5ddb0e=a179_0x2e6e05(this,function(){const _0x379179=a179_0x4edb;return a179_0x5ddb0e[_0x379179(0x149)]()[_0x379179(0x129)](_0x379179(0x146))['toString']()[_0x379179(0x16a)](a179_0x5ddb0e)[_0x379179(0x129)](_0x379179(0x146));});a179_0x5ddb0e();'use strict';function a179_0x116f(){const _0x41c4df=['prepareGitChangedPaths','length','gitUtils','../../../constants','__decorate','repository','getBranchId','(((.+)+)+)+$','\x20[COMMIT]','setCommitDto','toString','removeLogger','Error','://','gitCommit','fetch\x20repository/branch\x20data','decorate','design:paramtypes','flat','cleanUp','SalesforceLogger2','FlosumCommitError','log','[INFO]\x20Download\x20components\x20metadata\x20from\x20flosum.','[INFO]\x20Fetch\x20changes\x20files\x20from\x20git\x20commits.','changes','fetchRepositoryOrBranchData','files','sync\x20components','[INFO]\x20Job\x20done.','../../salesforce/errors/salesforce.error','prepareMdapi','proceedGitCommit','clone','../utils/mdapi.utils','catch','readDir','logger','repositoryGit','commits','name','defineProperty','sfLogger','constructor','14ihvwDa','2320002DTEhxR','getRecordTypes','updateStatus','5703880KSJQZb','fetchCommits','[INFO]\x20Force\x20commit.\x20Have\x20to\x20parse\x20','username','../utils/git.utils','send','authSettings',']\x20[Branch:\x20','\x20before\x20sync.','../utils/git-commit.utils','removeDir','gitCommitData','../../salesforce/services/salesforce-commits-manager.service','message','538800WcbLqs','AuthSettingsService','2212220aFpjUn','git\x20commit\x20job\x20done\x20(´･ω･`)','function','prepare\x20mdapi\x20to\x20parse','typedi','clone\x20repository\x20from\x20%s','fetching\x20git\x20commits','branch','error','../../../core/errors/api.error','../errors/flosum-commit.error','994312yAkcjr','proceedCommits','[INFO]\x20Clone\x20git\x20repository.','6137768NYsMMO','remote','../../shared/utils','fetchComponentsMetadata','../../shared/services/auth-settings.service','DEFAULT_GIT_USER_NAME','[INFO]\x20Proceeded\x20','getRepositoryId','../../../core','MDApiUtils','GitCommitService','search','getProtocol','In\x20Progress','object','getOwnPropertyDescriptor','relative','getLoggerId','Completed','GitUtils','SalesforceCommitsManager','apply','force','__metadata','mdapiUtils','checkoutTo','replace','3878358mZVUTg','[GIT\x20->\x20FLOSUM]\x20[Repository:\x20','dir','metadata','GitCommitJob','getPrefix'];a179_0x116f=function(){return _0x41c4df;};return a179_0x116f();}var __decorate=this&&this[a179_0x416564(0x143)]||function(_0x324a84,_0x136a72,_0x1a7cf1,_0x1d4f54){const _0x4d9f11=a179_0x416564;var _0x290000=arguments['length'],_0x5e604f=_0x290000<0x3?_0x136a72:_0x1d4f54===null?_0x1d4f54=Object[_0x4d9f11(0x12d)](_0x136a72,_0x1a7cf1):_0x1d4f54,_0x76ea9d;if(typeof Reflect===_0x4d9f11(0x12c)&&typeof Reflect[_0x4d9f11(0x14f)]===_0x4d9f11(0x112))_0x5e604f=Reflect[_0x4d9f11(0x14f)](_0x324a84,_0x136a72,_0x1a7cf1,_0x1d4f54);else{for(var _0x425c6d=_0x324a84['length']-0x1;_0x425c6d>=0x0;_0x425c6d--)if(_0x76ea9d=_0x324a84[_0x425c6d])_0x5e604f=(_0x290000<0x3?_0x76ea9d(_0x5e604f):_0x290000>0x3?_0x76ea9d(_0x136a72,_0x1a7cf1,_0x5e604f):_0x76ea9d(_0x136a72,_0x1a7cf1))||_0x5e604f;}return _0x290000>0x3&&_0x5e604f&&Object[_0x4d9f11(0x168)](_0x136a72,_0x1a7cf1,_0x5e604f),_0x5e604f;},__metadata=this&&this[a179_0x416564(0x135)]||function(_0x1cbf55,_0x4e7827){const _0x4c3eeb=a179_0x416564;if(typeof Reflect===_0x4c3eeb(0x12c)&&typeof Reflect[_0x4c3eeb(0x13c)]==='function')return Reflect[_0x4c3eeb(0x13c)](_0x1cbf55,_0x4e7827);},GitCommitJob_1;Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['GitCommitJob']=void 0x0;const core_1=require(a179_0x416564(0x126)),fs_internal_1=require('../../internal/fs.internal'),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),auth_settings_service_1=require(a179_0x416564(0x122)),utils_1=require(a179_0x416564(0x120)),path_1=require('path'),typedi_1=require(a179_0x416564(0x114)),constants_1=require(a179_0x416564(0x142)),salesforce_commits_manager_service_1=require(a179_0x416564(0x17b)),git_commit_utils_1=require(a179_0x416564(0x178)),git_utils_1=require(a179_0x416564(0x173)),mdapi_utils_1=require(a179_0x416564(0x161)),api_error_1=require(a179_0x416564(0x119)),salesforce_error_1=require(a179_0x416564(0x15d)),git_commit_service_1=require('../services/git-commit.service'),flosum_commit_error_1=require(a179_0x416564(0x11a));function a179_0x4edb(_0x588f2a,_0x2514bd){const _0x538279=a179_0x116f();return a179_0x4edb=function(_0x5ddb0e,_0x2e6e05){_0x5ddb0e=_0x5ddb0e-0x112;let _0x116f1e=_0x538279[_0x5ddb0e];return _0x116f1e;},a179_0x4edb(_0x588f2a,_0x2514bd);}let GitCommitJob=GitCommitJob_1=class GitCommitJob{constructor(_0x18a765,_0xdb01d2){const _0x27ba28=a179_0x416564;this[_0x27ba28(0x175)]=_0x18a765,this[_0x27ba28(0x14d)]=_0xdb01d2,this[_0x27ba28(0x164)]=new core_1['Logger'](GitCommitJob_1[_0x27ba28(0x167)]);}get[a179_0x416564(0x11f)](){const _0x29d4e3=a179_0x416564,{repositoryGit:_0x2132f3}=this[_0x29d4e3(0x17a)],_0x2cdabb=this['authSettings']['getCredentialsFor'](this[_0x29d4e3(0x17a)]['provider']);return _0x2132f3[_0x29d4e3(0x138)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x29d4e3(0x12a)](_0x2132f3)+_0x29d4e3(0x14c)+_0x2cdabb+'@');}async[a179_0x416564(0x170)](){const _0xf88c05=a179_0x416564;if(this[_0xf88c05(0x17a)][_0xf88c05(0x134)])return;const _0x5d85ab=[];for(const _0x1f7c1e of this[_0xf88c05(0x17a)]['commits']){const _0x1d7b43=await this[_0xf88c05(0x141)]['describeCommit'](_0x1f7c1e['id']);_0x1f7c1e[_0xf88c05(0x172)]=_0x1d7b43['author'],_0x1f7c1e['message']=_0x1d7b43[_0xf88c05(0x17c)],_0x1f7c1e[_0xf88c05(0x15a)]=_0x1d7b43[_0xf88c05(0x158)];if(_0x1f7c1e['username']===constants_1[_0xf88c05(0x123)])throw new flosum_commit_error_1[(_0xf88c05(0x154))]();_0x5d85ab['push'](...Object['values'](_0x1f7c1e['files'])[_0xf88c05(0x151)]());}this[_0xf88c05(0x17a)]['fileNames']=git_commit_utils_1[_0xf88c05(0x13f)]([...new Set(_0x5d85ab)]);}async[a179_0x416564(0x11c)](){const _0x2df5d7=a179_0x416564,_0x644090=[...this['gitCommitData'][_0x2df5d7(0x166)]],_0xce13da=_0x644090[_0x2df5d7(0x140)],_0x55f315=[];while(_0x644090['length']){const _0x4706f9=_0x644090['shift']();!this[_0x2df5d7(0x14d)][_0x2df5d7(0x145)]()&&_0x4706f9['id']&&await this[_0x2df5d7(0x141)][_0x2df5d7(0x137)](_0x4706f9['id']),_0x55f315['push'](await this['gitCommit'][_0x2df5d7(0x15f)](_0x4706f9,this[_0x2df5d7(0x136)]['dir'])),await this[_0x2df5d7(0x169)][_0x2df5d7(0x155)](_0x2df5d7(0x124)+_0x55f315[_0x2df5d7(0x140)]+'/'+_0xce13da);}const _0x5422cb=new salesforce_commits_manager_service_1[(_0x2df5d7(0x132))]({'recordTypes':this[_0x2df5d7(0x14d)][_0x2df5d7(0x16d)](),'branchId':this['gitCommit']['getBranchId'](),'repositoryId':this[_0x2df5d7(0x14d)][_0x2df5d7(0x125)](),'logger':this[_0x2df5d7(0x169)]});await _0x5422cb[_0x2df5d7(0x11c)](_0x55f315);}async['cleanUp'](){const _0x2ee4d4=a179_0x416564;this[_0x2ee4d4(0x141)]&&await this['gitUtils'][_0x2ee4d4(0x179)]()[_0x2ee4d4(0x162)](()=>void 0x0),this[_0x2ee4d4(0x136)]&&await this[_0x2ee4d4(0x136)][_0x2ee4d4(0x179)]()['catch'](()=>void 0x0);}async['run'](_0x590235,_0x175c6f){const _0x1ab9bf=a179_0x416564;this[_0x1ab9bf(0x17a)]=_0x590235,this[_0x1ab9bf(0x14d)][_0x1ab9bf(0x148)](this['gitCommitData']),this[_0x1ab9bf(0x169)]=new salesforce_logger_v2_service_1[(_0x1ab9bf(0x153))](_0x175c6f[_0x1ab9bf(0x12f)](),(_0x175c6f[_0x1ab9bf(0x13e)]()||_0x1ab9bf(0x13a)+_0x590235[_0x1ab9bf(0x144)]+_0x1ab9bf(0x176)+_0x590235[_0x1ab9bf(0x117)]+']')+_0x1ab9bf(0x147)),this[_0x1ab9bf(0x141)]=new git_utils_1[(_0x1ab9bf(0x131))](this[_0x1ab9bf(0x11f)]),this[_0x1ab9bf(0x136)]=new mdapi_utils_1[(_0x1ab9bf(0x127))](this[_0x1ab9bf(0x17a)][_0x1ab9bf(0x144)],this[_0x1ab9bf(0x17a)]['branch']);try{this[_0x1ab9bf(0x164)][_0x1ab9bf(0x155)](_0x1ab9bf(0x14e)),this['sfLogger'][_0x1ab9bf(0x155)]('[INFO]\x20Fetch\x20salesforce\x20data.'),await this[_0x1ab9bf(0x14d)][_0x1ab9bf(0x159)](),await this[_0x1ab9bf(0x14d)]['updateStatus'](_0x1ab9bf(0x12b)),this['logger'][_0x1ab9bf(0x155)](_0x1ab9bf(0x115),this[_0x1ab9bf(0x17a)][_0x1ab9bf(0x165)]),this['sfLogger'][_0x1ab9bf(0x155)](_0x1ab9bf(0x11d)),await this[_0x1ab9bf(0x141)][_0x1ab9bf(0x160)](this['gitCommitData'][_0x1ab9bf(0x117)],this[_0x1ab9bf(0x17a)][_0x1ab9bf(0x144)]),this[_0x1ab9bf(0x164)]['log'](_0x1ab9bf(0x113)),await this[_0x1ab9bf(0x136)][_0x1ab9bf(0x15e)](this[_0x1ab9bf(0x141)]['dir']);if(_0x590235[_0x1ab9bf(0x134)]){this[_0x1ab9bf(0x164)][_0x1ab9bf(0x155)]('start\x20force\x20commit\x20job\x20to\x20sync\x20repository');const _0x16a6b9=(await fs_internal_1['FS'][_0x1ab9bf(0x163)](this['mdapiUtils']['dir'],!![]))['map'](_0x380b2c=>path_1[_0x1ab9bf(0x12e)](this[_0x1ab9bf(0x136)][_0x1ab9bf(0x13b)],_0x380b2c));this[_0x1ab9bf(0x169)][_0x1ab9bf(0x155)](_0x1ab9bf(0x171)+_0x16a6b9[_0x1ab9bf(0x140)]+_0x1ab9bf(0x177)),this[_0x1ab9bf(0x17a)]['fileNames']=[],this[_0x1ab9bf(0x17a)][_0x1ab9bf(0x166)]=[{'files':{'modified':_0x16a6b9,'added':[],'removed':[]},'id':'','message':_0x1ab9bf(0x15b),'username':constants_1[_0x1ab9bf(0x123)]}];}this[_0x1ab9bf(0x164)]['log'](_0x1ab9bf(0x116)),await this[_0x1ab9bf(0x169)][_0x1ab9bf(0x155)](_0x1ab9bf(0x157))[_0x1ab9bf(0x174)](),await this[_0x1ab9bf(0x170)](),this['logger'][_0x1ab9bf(0x155)]('fetch\x20components\x20metadata'),await this[_0x1ab9bf(0x169)]['log'](_0x1ab9bf(0x156)),await this[_0x1ab9bf(0x14d)][_0x1ab9bf(0x121)](),this[_0x1ab9bf(0x164)][_0x1ab9bf(0x155)]('proceed\x20git\x20commits\x20to\x20flosum'),this[_0x1ab9bf(0x169)][_0x1ab9bf(0x155)]('[INFO]\x20Start\x20proceeding\x20git\x20commits.'),await this[_0x1ab9bf(0x11c)](),this[_0x1ab9bf(0x164)]['log'](_0x1ab9bf(0x180)),await this[_0x1ab9bf(0x169)]['log'](_0x1ab9bf(0x15c)),await this['gitCommit'][_0x1ab9bf(0x16e)](_0x1ab9bf(0x130));}catch(_0x14c551){await this[_0x1ab9bf(0x152)](),this['logger'][_0x1ab9bf(0x118)](_0x14c551);if(_0x14c551 instanceof flosum_commit_error_1['FlosumCommitError']){await this[_0x1ab9bf(0x169)][_0x1ab9bf(0x14a)]();return;}this[_0x1ab9bf(0x169)][_0x1ab9bf(0x155)]('[ERROR]\x20Error\x20was\x20occured\x20when\x20commit\x20from\x20git\x20to\x20flosum\x20-\x20'+(_0x14c551 instanceof api_error_1['ApiError']||_0x14c551 instanceof salesforce_error_1['SalesforceError']?_0x14c551['toString']():_0x14c551)),await this[_0x1ab9bf(0x14d)][_0x1ab9bf(0x16e)](_0x1ab9bf(0x14b))[_0x1ab9bf(0x162)](()=>void 0x0);throw _0x14c551;}finally{await this[_0x1ab9bf(0x152)](),this[_0x1ab9bf(0x169)][_0x1ab9bf(0x174)]()[_0x1ab9bf(0x162)](()=>void 0x0);}}};GitCommitJob=GitCommitJob_1=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a179_0x416564(0x150),[auth_settings_service_1[a179_0x416564(0x17e)],git_commit_service_1[a179_0x416564(0x128)]])],GitCommitJob),exports[a179_0x416564(0x13d)]=GitCommitJob;