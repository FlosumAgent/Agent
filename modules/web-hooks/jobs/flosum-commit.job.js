const a119_0x470d=['body','send\x20DELETE\x20commit\x20id\x20%s','constructor','repo','__importDefault','SFDX','add','Start\x20retrieve\x20components\x20job','[ERROR]\x20','return\x20/\x22\x20+\x20this\x20+\x20\x22/','createEmptyPackageXml','ERR_JOB_IS_NOT_DONE','info','3eHAXbL','COMPONENTS_PER_TICK','default','Git','../../parsers/mdapi/writer','sort','SalesforceService','../../parsers/mdapi/child-types','../../internal/shell.internal','MDAPI_DIR','create','11sdtwpy','200964tzjwMS','GitProviderManager','2297SicjZN','decorate','587BtlWAs','convertToSFDX','Done\x20','Clonning\x20repository','1907RGZnOD','../../../constants/errors','currentJob','data','authSettings','commitId','InternalServerError','fileName','113zEtEeB','object','204mmYVeb','sfLogger','commit\x20files\x20with\x20message\x20\x22%s\x22','__setModuleDefault','message','metadata','getOwnPropertyDescriptor','exec','call','nothing\x20to\x20commit','design:paramtypes','fileType','1538nIBJMQ','length','6893PyTath','gitCredentials','log','./job','../../../core/errors/internal-server.error','clonning\x20repository\x20from\x20%s','MDApiWriter','189edcqrB','join','../../parsers/mdapi','salesforceService','FlosumCommitJob','prototype','replace','retrieveAttachment','../../sfdx/utils/sfdx','Shell','retrieveComponents','credentials','branches','[CID:\x20','deleteCommit','includes','setCredentials','281HDsITU','connect','now','commit\x20%s\x20took\x20%dms\x20to\x20proceed\x20%d\x20components','../../shared/services/auth-settings.service','FlosumRetriever','test','push','Service','defineProperty','createEmptyProjectJson','128847Ngqmzp','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../../shared/utils','run','splice','MAX_GIT_STATUS_CHECK','sleep','apply','rm\x20-rf\x20','../../../core','setComponentIds','map','branch','https://','baseDir','remove\x20git\x20repository\x20folder\x20','path','Logger','user','GIT_STATUS_CHECK_INTERVAL','split','trim','MDApiParser','\x20components','start','clone','../../sfdx/utils/flosum-retriever.util','../../../core/errors/bad-request.error','getOne','mdapiToSource','get','start\x20retrieving\x20components','__esModule','../../sfdx/services/salesforce.service'];const a119_0x59dc87=a119_0x4425;(function(_0x124831,_0x15ac2a){const _0x41b235=a119_0x4425;while(!![]){try{const _0x10aeb4=parseInt(_0x41b235(0x1f2))*-parseInt(_0x41b235(0x21a))+-parseInt(_0x41b235(0x1f4))*parseInt(_0x41b235(0x200))+-parseInt(_0x41b235(0x209))*parseInt(_0x41b235(0x1e4))+-parseInt(_0x41b235(0x225))*parseInt(_0x41b235(0x1d6))+parseInt(_0x41b235(0x1e1))*parseInt(_0x41b235(0x202))+parseInt(_0x41b235(0x1e2))+-parseInt(_0x41b235(0x1ea))*-parseInt(_0x41b235(0x1e6));if(_0x10aeb4===_0x15ac2a)break;else _0x124831['push'](_0x124831['shift']());}catch(_0x35f444){_0x124831['push'](_0x124831['shift']());}}}(a119_0x470d,0x38281));const a119_0x1892ca=function(){let _0x403048=!![];return function(_0x3b9bd1,_0x299457){const _0x3e46b0=_0x403048?function(){const _0x524302=a119_0x4425;if(_0x299457){const _0x1c8f01=_0x299457[_0x524302(0x22c)](_0x3b9bd1,arguments);return _0x299457=null,_0x1c8f01;}}:function(){};return _0x403048=![],_0x3e46b0;};}(),a119_0x5b8162=a119_0x1892ca(this,function(){const _0x4f9a37=function(){const _0x31b81d=a119_0x4425,_0x370564=_0x4f9a37[_0x31b81d(0x1cb)](_0x31b81d(0x1d2))()['constructor'](_0x31b81d(0x226));return!_0x370564[_0x31b81d(0x220)](a119_0x5b8162);};return _0x4f9a37();});function a119_0x4425(_0x5dd792,_0x37b1b6){return a119_0x4425=function(_0x1b24d3,_0x5b8162){_0x1b24d3=_0x1b24d3-0x1b6;let _0x1892ca=a119_0x470d[_0x1b24d3];return _0x1892ca;},a119_0x4425(_0x5dd792,_0x37b1b6);}a119_0x5b8162();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a119_0x59dc87(0x1e0)]?function(_0x28f087,_0x172a91,_0x4f3f31,_0x4b4023){const _0x2d9675=a119_0x59dc87;if(_0x4b4023===undefined)_0x4b4023=_0x4f3f31;Object[_0x2d9675(0x223)](_0x28f087,_0x4b4023,{'enumerable':!![],'get':function(){return _0x172a91[_0x4f3f31];}});}:function(_0x135b21,_0x24939f,_0x48447b,_0x64299b){if(_0x64299b===undefined)_0x64299b=_0x48447b;_0x135b21[_0x64299b]=_0x24939f[_0x48447b];}),__setModuleDefault=this&&this[a119_0x59dc87(0x1f7)]||(Object['create']?function(_0x34714d,_0x448233){const _0x56b6fb=a119_0x59dc87;Object[_0x56b6fb(0x223)](_0x34714d,_0x56b6fb(0x1d8),{'enumerable':!![],'value':_0x448233});}:function(_0x38ad1d,_0x403554){const _0xffd66e=a119_0x59dc87;_0x38ad1d[_0xffd66e(0x1d8)]=_0x403554;}),__decorate=this&&this['__decorate']||function(_0xd6ccce,_0x4de510,_0x4225dd,_0x43dfd7){const _0xdf3721=a119_0x59dc87;var _0x39b7e1=arguments[_0xdf3721(0x201)],_0x5da043=_0x39b7e1<0x3?_0x4de510:_0x43dfd7===null?_0x43dfd7=Object[_0xdf3721(0x1fa)](_0x4de510,_0x4225dd):_0x43dfd7,_0x436bc6;if(typeof Reflect===_0xdf3721(0x1f3)&&typeof Reflect[_0xdf3721(0x1e5)]==='function')_0x5da043=Reflect['decorate'](_0xd6ccce,_0x4de510,_0x4225dd,_0x43dfd7);else{for(var _0x3cc64c=_0xd6ccce['length']-0x1;_0x3cc64c>=0x0;_0x3cc64c--)if(_0x436bc6=_0xd6ccce[_0x3cc64c])_0x5da043=(_0x39b7e1<0x3?_0x436bc6(_0x5da043):_0x39b7e1>0x3?_0x436bc6(_0x4de510,_0x4225dd,_0x5da043):_0x436bc6(_0x4de510,_0x4225dd))||_0x5da043;}return _0x39b7e1>0x3&&_0x5da043&&Object['defineProperty'](_0x4de510,_0x4225dd,_0x5da043),_0x5da043;},__importStar=this&&this['__importStar']||function(_0x3fe292){const _0x275353=a119_0x59dc87;if(_0x3fe292&&_0x3fe292['__esModule'])return _0x3fe292;var _0x121381={};if(_0x3fe292!=null){for(var _0xe6654c in _0x3fe292)if(_0xe6654c!==_0x275353(0x1d8)&&Object[_0x275353(0x20e)]['hasOwnProperty'][_0x275353(0x1fc)](_0x3fe292,_0xe6654c))__createBinding(_0x121381,_0x3fe292,_0xe6654c);}return __setModuleDefault(_0x121381,_0x3fe292),_0x121381;},__metadata=this&&this['__metadata']||function(_0x406689,_0x5c6013){const _0x553c5c=a119_0x59dc87;if(typeof Reflect===_0x553c5c(0x1f3)&&typeof Reflect[_0x553c5c(0x1f9)]==='function')return Reflect[_0x553c5c(0x1f9)](_0x406689,_0x5c6013);},__importDefault=this&&this[a119_0x59dc87(0x1cd)]||function(_0x141dda){return _0x141dda&&_0x141dda['__esModule']?_0x141dda:{'default':_0x141dda};};Object['defineProperty'](exports,a119_0x59dc87(0x1c7),{'value':!![]}),exports[a119_0x59dc87(0x20d)]=void 0x0;const errors_1=require(a119_0x59dc87(0x1eb)),core_1=require(a119_0x59dc87(0x22e)),bad_request_error_1=require(a119_0x59dc87(0x1c2)),git_internal_1=require('../../internal/git.internal'),shell_internal_1=require(a119_0x59dc87(0x1de)),salesforce_service_1=require(a119_0x59dc87(0x1c8)),flosum_retriever_util_1=require(a119_0x59dc87(0x1c1)),git_provider_manager_1=require('../../shared/git-provider.manager'),auth_settings_service_1=require(a119_0x59dc87(0x21e)),utils_1=require(a119_0x59dc87(0x227)),path_1=__importDefault(require(a119_0x59dc87(0x1b7))),typedi_1=__importStar(require('typedi')),internal_server_error_1=require(a119_0x59dc87(0x206)),mdapi_1=require(a119_0x59dc87(0x20b)),child_types_1=__importDefault(require(a119_0x59dc87(0x1dd))),writer_1=require(a119_0x59dc87(0x1da)),sfdx_1=require(a119_0x59dc87(0x211)),job_1=require(a119_0x59dc87(0x205)),logger=new core_1[(a119_0x59dc87(0x1b8))]('flosum-commit-job');let FlosumCommitJob=class FlosumCommitJob extends job_1['Job']{constructor(_0x15fbf2,_0x42de66){const _0x4ac194=a119_0x59dc87;super(),this[_0x4ac194(0x1ee)]=_0x15fbf2,this[_0x4ac194(0x20c)]=_0x42de66,this[_0x4ac194(0x1df)]='mdapi',this['COMPONENTS_PER_TICK']=0x3e8,this[_0x4ac194(0x22a)]=0xa,this[_0x4ac194(0x1ba)]=0xbb8;}get['credentials'](){const _0x6e2a17=a119_0x59dc87;return this['authSettings'][_0x6e2a17(0x203)];}get[a119_0x59dc87(0x1ef)](){const _0x4d527b=a119_0x59dc87;var _0x5b4c65;return(_0x5b4c65=this[_0x4d527b(0x1ec)])===null||_0x5b4c65===void 0x0?void 0x0:_0x5b4c65['id'];}async[a119_0x59dc87(0x1f5)](_0x5d7486){const _0x584934=a119_0x59dc87;return this[_0x584934(0x20c)]['log'](_0x584934(0x216)+this['commitId']+']\x20'+_0x5d7486);}async[a119_0x59dc87(0x1e7)](_0x49052e){const _0x2ca267=a119_0x59dc87;try{const _0x3f2b20=path_1[_0x2ca267(0x1d8)]['join'](_0x49052e,this[_0x2ca267(0x1df)]);await sfdx_1[_0x2ca267(0x1ce)][_0x2ca267(0x224)](_0x49052e),await sfdx_1[_0x2ca267(0x1ce)][_0x2ca267(0x1d3)](_0x3f2b20),await sfdx_1[_0x2ca267(0x1ce)][_0x2ca267(0x1c4)](_0x3f2b20,_0x49052e),await shell_internal_1[_0x2ca267(0x212)][_0x2ca267(0x1fb)]('rm\x20-rf\x20'+_0x3f2b20);}catch(_0x352f25){throw new internal_server_error_1[(_0x2ca267(0x1f0))](_0x352f25);}}async[a119_0x59dc87(0x213)](_0x44e2f6,_0x5d83f3){const _0xbbc16d=a119_0x59dc87;this[_0xbbc16d(0x1f5)](_0xbbc16d(0x1d0));const {convertToSFDX:_0x1de900}=this[_0xbbc16d(0x1ec)][_0xbbc16d(0x1ed)],_0x55ceac=typedi_1[_0xbbc16d(0x1d8)][_0xbbc16d(0x1c5)](flosum_retriever_util_1[_0xbbc16d(0x21f)]);_0x55ceac[_0xbbc16d(0x22f)](_0x5d83f3);const _0x7456e8=new mdapi_1[(_0xbbc16d(0x1bd))](),_0xd89cb0=await _0x55ceac['retrieve']();_0xd89cb0[_0xbbc16d(0x1db)](_0x5f4ca7=>child_types_1[_0xbbc16d(0x1d8)][_0xbbc16d(0x218)](_0x5f4ca7[_0xbbc16d(0x1ff)])?0x1:-0x1);let _0xb416fd=0x0;while(_0xd89cb0[_0xbbc16d(0x201)]){const _0x2ccef6=await _0x7456e8['run'](_0xd89cb0[_0xbbc16d(0x229)](0x0,this[_0xbbc16d(0x1d7)])['map'](_0x3d63ed=>({'name':_0x3d63ed[_0xbbc16d(0x1f1)],'type':_0x3d63ed[_0xbbc16d(0x1ff)],'body':_0x3d63ed[_0xbbc16d(0x1c9)]}))),_0x22d9f6=new writer_1[(_0xbbc16d(0x208))](_0x2ccef6,path_1[_0xbbc16d(0x1d8)][_0xbbc16d(0x20a)](_0x44e2f6,_0x1de900?this['MDAPI_DIR']:''));await _0x22d9f6[_0xbbc16d(0x1bf)](),_0xb416fd+=_0x2ccef6['length'],logger['log']('Done\x20'+_0xb416fd+'/'+_0x5d83f3[_0xbbc16d(0x201)]+_0xbbc16d(0x1be)),this[_0xbbc16d(0x1f5)](_0xbbc16d(0x1e8)+_0xb416fd+'/'+_0x5d83f3[_0xbbc16d(0x201)]+'\x20components');}this[_0xbbc16d(0x1ec)][_0xbbc16d(0x1ed)][_0xbbc16d(0x1e7)]&&await this[_0xbbc16d(0x1e7)](_0x44e2f6);}async[a119_0x59dc87(0x1fb)](_0x42f5a8){const _0x56e806=a119_0x59dc87,_0x2762eb=Date[_0x56e806(0x21c)](),{commitId:_0x4a581e,branch:_0xbe9f38,attachmentId:_0x4f5f91,message:_0xc40591}=this[_0x56e806(0x1ec)][_0x56e806(0x1ed)];logger[_0x56e806(0x1d5)]('connect\x20to\x20salesforce'),await this['salesforceService'][_0x56e806(0x21b)](),this[_0x56e806(0x1f5)]('Recieved\x20commit\x20to\x20proceed.\x20Branch\x20-\x20'+_0xbe9f38);const _0x48371b=[];try{const _0x2fa522=await this[_0x56e806(0x20c)][_0x56e806(0x210)](_0x4f5f91);_0x48371b[_0x56e806(0x221)](..._0x2fa522[_0x56e806(0x1bb)]('\x20')[_0x56e806(0x230)](_0x5e37ae=>_0x5e37ae[_0x56e806(0x1bc)]()));const {gitUrl:_0x294c03}=_0x42f5a8,_0x3fa0d1=_0x294c03[_0x56e806(0x20f)](/https\:\/\/(.+@)?/,_0x56e806(0x232)+this[_0x56e806(0x214)]+'@');logger[_0x56e806(0x1d5)](_0x56e806(0x207),_0x3fa0d1),this['sfLogger'](_0x56e806(0x1e9));const _0x47c4a6=await git_internal_1[_0x56e806(0x1d9)][_0x56e806(0x1c0)](_0x3fa0d1,_0x4a581e,_0xbe9f38),{name:_0x2aaa0c,email:_0x5a7567}=this[_0x56e806(0x1ec)][_0x56e806(0x1ed)][_0x56e806(0x1b9)];logger[_0x56e806(0x1d5)]('set\x20credentials\x20{\x20name:\x20%s,\x20email:\x20%s\x20}',_0x2aaa0c,_0x5a7567),await _0x47c4a6[_0x56e806(0x219)](_0x2aaa0c,_0x5a7567),logger[_0x56e806(0x1d5)](_0x56e806(0x1c6)),await this[_0x56e806(0x213)](_0x47c4a6[_0x56e806(0x233)],_0x48371b),logger[_0x56e806(0x1d5)]('add\x20retrieved\x20components\x20to\x20commit'),await _0x47c4a6[_0x56e806(0x1cf)]('.'),logger[_0x56e806(0x1d5)](_0x56e806(0x1f6),_0xc40591);try{await _0x47c4a6['commit'](_0xc40591);}catch(_0x43d868){let _0x2bebba=0x0;do{_0x2bebba++;const _0x430fcd=await _0x47c4a6['status']()['catch'](_0x1a6116=>_0x1a6116['message']||_0x1a6116);if(_0x430fcd[_0x56e806(0x218)](_0x56e806(0x1fd))){_0x2bebba=0x0;break;}await utils_1[_0x56e806(0x22b)](this[_0x56e806(0x1ba)]);}while(_0x2bebba<this[_0x56e806(0x22a)]);if(_0x2bebba===this[_0x56e806(0x22a)])throw _0x43d868;}this[_0x56e806(0x1f5)]('Push\x20commit\x20to\x20branch'),logger[_0x56e806(0x1d5)]('push\x20commit\x20to\x20branch\x20\x22%s\x22',_0xbe9f38),await _0x47c4a6[_0x56e806(0x221)](_0xbe9f38),logger[_0x56e806(0x1d5)](_0x56e806(0x1b6)+_0x47c4a6[_0x56e806(0x233)]),await shell_internal_1['Shell'][_0x56e806(0x1fb)](_0x56e806(0x22d)+_0x47c4a6['baseDir']),logger[_0x56e806(0x1d5)](_0x56e806(0x1ca),_0x4a581e),await this[_0x56e806(0x20c)][_0x56e806(0x217)](_0x4a581e);}catch(_0x2b3bff){this['sfLogger'](_0x56e806(0x1d1)+(_0x2b3bff[_0x56e806(0x1f8)]||_0x2b3bff)),console[_0x56e806(0x204)]({'error':_0x2b3bff});}finally{logger[_0x56e806(0x1d5)](_0x56e806(0x21d),_0x4a581e,Date[_0x56e806(0x21c)]()-_0x2762eb,_0x48371b[_0x56e806(0x201)]),this[_0x56e806(0x1ec)]=undefined;}}async[a119_0x59dc87(0x228)](_0x4684c2){const _0x33527d=a119_0x59dc87;if(this[_0x33527d(0x1ec)])throw new bad_request_error_1['BadRequestError'](errors_1[_0x33527d(0x1d4)]);try{this['currentJob']=_0x4684c2;const _0x3a9090=typedi_1[_0x33527d(0x1d8)]['get'](git_provider_manager_1[_0x33527d(0x1e3)])['getRepoService'](),_0x30a48e=await _0x3a9090[_0x33527d(0x1c3)](_0x4684c2[_0x33527d(0x1ed)][_0x33527d(0x1cc)]);await _0x30a48e[_0x33527d(0x215)][_0x33527d(0x1c3)](_0x4684c2[_0x33527d(0x1ed)][_0x33527d(0x231)]),this[_0x33527d(0x1fb)](_0x30a48e);}catch(_0x3b886d){this[_0x33527d(0x1ec)]=undefined;throw _0x3b886d;}}};FlosumCommitJob=__decorate([typedi_1[a119_0x59dc87(0x222)](),__metadata(a119_0x59dc87(0x1fe),[auth_settings_service_1['AuthSettingsService'],salesforce_service_1[a119_0x59dc87(0x1dc)]])],FlosumCommitJob),exports[a119_0x59dc87(0x20d)]=FlosumCommitJob;