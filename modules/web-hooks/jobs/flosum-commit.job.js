const a122_0xa1e8=['Clonning\x20repository','6xHZItn','rm\x20-rf\x20','nothing\x20to\x20commit','add\x20retrieved\x20components\x20to\x20commit','.mdapi-temp','buffer','getOne','../../shared/services/auth-settings.service','[ERROR]\x20','connect','GIT_STATUS_CHECK_INTERVAL','constructor','return\x20/\x22\x20+\x20this\x20+\x20\x22/','createWriteQueue','sfLogger','join','trim','message','includes','41695CgnQDu','get','setComponentIds','add','1pDHKye','533531RqNDny','defineProperty','./job','commit\x20%s\x20took\x20%dms\x20to\x20proceed\x20%d\x20components','call','getOwnPropertyDescriptor','log','Recieved\x20commit\x20to\x20proceed.\x20Branch\x20-\x20','salesforceService','default','FlosumRetriever','create','currentJob','decorate','getRepoService','__esModule','Parser','__decorate','authSettings','../../sfdx/services/salesforce.service','object','https://','map','Service','GitProviderManager','flosum-commit-job','../../shared/utils','MAX_GIT_STATUS_CHECK','__metadata','1436358AdYWbZ','credentials','branches','__importStar','splice','../../sfdx/utils/flosum-retriever.util','__setModuleDefault','SalesforceService','FlosumCommitJob','forEach','push','createEmptyProjectJson','set\x20credentials\x20{\x20name:\x20%s,\x20email:\x20%s\x20}','419644yRQnCp','createEmptyPackageXml','typedi','all','../../internal/git.internal','BadRequestError','615879hKMysx','Shell','deleteCommit','3767365Yobqie','shift','Git','commit','length','mdapiToSource','clonning\x20repository\x20from\x20%s','branch','metadata','catch','data','gitCredentials','Start\x20retrieve\x20components\x20job','design:paramtypes','create\x20empty\x20sfdx-project.json','../../internal/shell.internal','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','__createBinding','1234657MSaXLa','WRITES_PER_TICK','setCredentials','start\x20retrieving\x20components','Retrieved\x20','\x20components','connect\x20to\x20salesforce','[CID:\x20','SFDX','ERR_JOB_IS_NOT_DONE','run','now','baseDir','Job','name','commitId','info','path','retrieve','exec','../../internal/fs.internal','function'];const a122_0xf9998a=a122_0x2839;(function(_0x2297c7,_0x12cda4){const _0x4b2146=a122_0x2839;while(!![]){try{const _0x50024b=parseInt(_0x4b2146(0x184))+parseInt(_0x4b2146(0x1c3))*parseInt(_0x4b2146(0x162))+parseInt(_0x4b2146(0x1ac))*parseInt(_0x4b2146(0x166))+parseInt(_0x4b2146(0x191))+parseInt(_0x4b2146(0x167))+parseInt(_0x4b2146(0x197))+-parseInt(_0x4b2146(0x19a));if(_0x50024b===_0x12cda4)break;else _0x2297c7['push'](_0x2297c7['shift']());}catch(_0x5c6c05){_0x2297c7['push'](_0x2297c7['shift']());}}}(a122_0xa1e8,0xb07ba));const a122_0x248058=function(){let _0x2309fd=!![];return function(_0x3b48cc,_0xeca2b9){const _0x18e26e=_0x2309fd?function(){if(_0xeca2b9){const _0x7428f2=_0xeca2b9['apply'](_0x3b48cc,arguments);return _0xeca2b9=null,_0x7428f2;}}:function(){};return _0x2309fd=![],_0x18e26e;};}(),a122_0x2db334=a122_0x248058(this,function(){const _0x4e6e2e=function(){const _0x1face5=a122_0x2839,_0x576c9d=_0x4e6e2e[_0x1face5(0x15a)](_0x1face5(0x15b))()[_0x1face5(0x15a)](_0x1face5(0x1aa));return!_0x576c9d['test'](a122_0x2db334);};return _0x4e6e2e();});a122_0x2db334();'use strict';function a122_0x2839(_0x1958d1,_0x40fe1b){return a122_0x2839=function(_0x3eb61e,_0x2db334){_0x3eb61e=_0x3eb61e-0x159;let _0x248058=a122_0xa1e8[_0x3eb61e];return _0x248058;},a122_0x2839(_0x1958d1,_0x40fe1b);}var __createBinding=this&&this[a122_0xf9998a(0x1ab)]||(Object[a122_0xf9998a(0x172)]?function(_0x2acfff,_0x5e8923,_0xd2e333,_0x27c84b){const _0x5ba7f6=a122_0xf9998a;if(_0x27c84b===undefined)_0x27c84b=_0xd2e333;Object[_0x5ba7f6(0x168)](_0x2acfff,_0x27c84b,{'enumerable':!![],'get':function(){return _0x5e8923[_0xd2e333];}});}:function(_0x29fc58,_0x4f39d5,_0x54c103,_0x4d7ea6){if(_0x4d7ea6===undefined)_0x4d7ea6=_0x54c103;_0x29fc58[_0x4d7ea6]=_0x4f39d5[_0x54c103];}),__setModuleDefault=this&&this[a122_0xf9998a(0x18a)]||(Object['create']?function(_0x304ccb,_0xf4e96c){const _0x145698=a122_0xf9998a;Object['defineProperty'](_0x304ccb,_0x145698(0x170),{'enumerable':!![],'value':_0xf4e96c});}:function(_0x34cb2b,_0x2835cb){const _0x4761a7=a122_0xf9998a;_0x34cb2b[_0x4761a7(0x170)]=_0x2835cb;}),__decorate=this&&this[a122_0xf9998a(0x178)]||function(_0x499304,_0x4489eb,_0x20b938,_0x40a57d){const _0x47e666=a122_0xf9998a;var _0x450fea=arguments[_0x47e666(0x19e)],_0x4a4410=_0x450fea<0x3?_0x4489eb:_0x40a57d===null?_0x40a57d=Object[_0x47e666(0x16c)](_0x4489eb,_0x20b938):_0x40a57d,_0x577613;if(typeof Reflect===_0x47e666(0x17b)&&typeof Reflect[_0x47e666(0x174)]==='function')_0x4a4410=Reflect['decorate'](_0x499304,_0x4489eb,_0x20b938,_0x40a57d);else{for(var _0x3dffa7=_0x499304['length']-0x1;_0x3dffa7>=0x0;_0x3dffa7--)if(_0x577613=_0x499304[_0x3dffa7])_0x4a4410=(_0x450fea<0x3?_0x577613(_0x4a4410):_0x450fea>0x3?_0x577613(_0x4489eb,_0x20b938,_0x4a4410):_0x577613(_0x4489eb,_0x20b938))||_0x4a4410;}return _0x450fea>0x3&&_0x4a4410&&Object['defineProperty'](_0x4489eb,_0x20b938,_0x4a4410),_0x4a4410;},__importStar=this&&this[a122_0xf9998a(0x187)]||function(_0x1cb1cb){const _0x37cfaa=a122_0xf9998a;if(_0x1cb1cb&&_0x1cb1cb[_0x37cfaa(0x176)])return _0x1cb1cb;var _0x79de86={};if(_0x1cb1cb!=null){for(var _0x2afde3 in _0x1cb1cb)if(_0x2afde3!=='default'&&Object['prototype']['hasOwnProperty'][_0x37cfaa(0x16b)](_0x1cb1cb,_0x2afde3))__createBinding(_0x79de86,_0x1cb1cb,_0x2afde3);}return __setModuleDefault(_0x79de86,_0x1cb1cb),_0x79de86;},__metadata=this&&this[a122_0xf9998a(0x183)]||function(_0x1390fc,_0x5d7409){const _0x27f4a7=a122_0xf9998a;if(typeof Reflect===_0x27f4a7(0x17b)&&typeof Reflect[_0x27f4a7(0x1a2)]===_0x27f4a7(0x1c1))return Reflect[_0x27f4a7(0x1a2)](_0x1390fc,_0x5d7409);},__importDefault=this&&this['__importDefault']||function(_0x559797){const _0x2da17=a122_0xf9998a;return _0x559797&&_0x559797[_0x2da17(0x176)]?_0x559797:{'default':_0x559797};};Object[a122_0xf9998a(0x168)](exports,a122_0xf9998a(0x176),{'value':!![]}),exports[a122_0xf9998a(0x18c)]=void 0x0;const errors_1=require('../../../constants/errors'),core_1=require('../../../core'),bad_request_error_1=require('../../../core/errors/bad-request.error'),fs_internal_1=require(a122_0xf9998a(0x1c0)),git_internal_1=require(a122_0xf9998a(0x195)),shell_internal_1=require(a122_0xf9998a(0x1a9)),salesforce_service_1=require(a122_0xf9998a(0x17a)),flosum_retriever_util_1=require(a122_0xf9998a(0x189)),sfdx_1=require('../../sfdx/utils/sfdx'),git_provider_manager_1=require('../../shared/git-provider.manager'),auth_settings_service_1=require(a122_0xf9998a(0x1ca)),utils_1=require(a122_0xf9998a(0x181)),parser_1=require('../../../parser'),path_1=__importDefault(require(a122_0xf9998a(0x1bd))),typedi_1=__importStar(require(a122_0xf9998a(0x193))),job_1=require(a122_0xf9998a(0x169)),logger=new core_1['Logger'](a122_0xf9998a(0x180));let FlosumCommitJob=class FlosumCommitJob extends job_1[a122_0xf9998a(0x1b9)]{constructor(_0x129644,_0x3dcbd0){const _0x2df9db=a122_0xf9998a;super(),this[_0x2df9db(0x179)]=_0x129644,this[_0x2df9db(0x16f)]=_0x3dcbd0,this[_0x2df9db(0x1ad)]=0x3e8,this[_0x2df9db(0x182)]=0xa,this['GIT_STATUS_CHECK_INTERVAL']=0xbb8;}get[a122_0xf9998a(0x185)](){const _0x48f2=a122_0xf9998a;return this[_0x48f2(0x179)][_0x48f2(0x1a5)];}get['commitId'](){const _0x160359=a122_0xf9998a;var _0x40d1cf;return(_0x40d1cf=this[_0x160359(0x173)])===null||_0x40d1cf===void 0x0?void 0x0:_0x40d1cf['id'];}async[a122_0xf9998a(0x15d)](_0x4a2322){const _0x5b26d9=a122_0xf9998a;return this[_0x5b26d9(0x16f)][_0x5b26d9(0x16d)](_0x5b26d9(0x1b3)+this[_0x5b26d9(0x1bb)]+']\x20'+_0x4a2322);}[a122_0xf9998a(0x15c)](_0x1d34d7){const _0x58a226=a122_0xf9998a,_0x17c593=[];for(const _0x2bf6a9 in _0x1d34d7){const _0x34b1da=_0x1d34d7[_0x2bf6a9];_0x34b1da[_0x58a226(0x18d)]((_0x597ac1,_0x5df5e9)=>{const _0x505e47=_0x58a226,_0x4420f9={'name':_0x2bf6a9,'buffer':_0x597ac1};_0x17c593[_0x5df5e9]?_0x17c593[_0x5df5e9]['push'](_0x4420f9):_0x17c593[_0x505e47(0x18e)]([_0x4420f9]);});}return _0x17c593;}async['retrieveComponents'](_0x4a9dd9,_0x32b0a8){const _0x1507fd=a122_0xf9998a;this['sfLogger'](_0x1507fd(0x1a6));const _0x127870=path_1[_0x1507fd(0x170)][_0x1507fd(0x15e)](_0x4a9dd9,_0x1507fd(0x1c7));logger[_0x1507fd(0x16d)](_0x1507fd(0x1a8)),await sfdx_1[_0x1507fd(0x1b4)][_0x1507fd(0x18f)](_0x4a9dd9);const _0x3ecec8=typedi_1[_0x1507fd(0x170)][_0x1507fd(0x163)](flosum_retriever_util_1[_0x1507fd(0x171)]);_0x3ecec8[_0x1507fd(0x164)](_0x32b0a8);let _0x278320=0x0;do{const _0xa09778=await _0x3ecec8[_0x1507fd(0x1be)](),_0x5d1908=await parser_1[_0x1507fd(0x177)]['readFlosumComponents'](_0xa09778),_0x1c5eee=this[_0x1507fd(0x15c)](_0x5d1908);while(_0x1c5eee['length']>0x0){const _0x1b6588=_0x1c5eee[_0x1507fd(0x19b)]();_0x278320+=_0x1b6588[_0x1507fd(0x19e)];while(_0x1b6588[_0x1507fd(0x19e)]>0x0){const _0x4fd0fd=_0x1b6588[_0x1507fd(0x188)](0x0,this[_0x1507fd(0x1ad)]),_0x409b9d=_0x4fd0fd['map'](_0x1d238e=>fs_internal_1['FS']['writeFile'](path_1['default'][_0x1507fd(0x15e)](_0x127870,_0x1d238e[_0x1507fd(0x1ba)]),_0x1d238e[_0x1507fd(0x1c8)]));await Promise[_0x1507fd(0x194)](_0x409b9d);}logger[_0x1507fd(0x16d)]('create\x20empty\x20package.xml'),await sfdx_1[_0x1507fd(0x1b4)][_0x1507fd(0x192)](_0x127870),await sfdx_1['SFDX'][_0x1507fd(0x19f)](_0x127870,_0x4a9dd9),await shell_internal_1['Shell'][_0x1507fd(0x1bf)](_0x1507fd(0x1c4)+_0x127870+'/*');}this[_0x1507fd(0x15d)](_0x1507fd(0x1b0)+_0x278320+'/'+_0x32b0a8[_0x1507fd(0x19e)]+_0x1507fd(0x1b1));}while(_0x3ecec8['hasMoreIds']);logger['log']('remove\x20sfdx-project.json'),await shell_internal_1['Shell'][_0x1507fd(0x1bf)]('rm\x20-rf\x20'+path_1[_0x1507fd(0x170)][_0x1507fd(0x15e)](_0x4a9dd9,'sfdx-project.json')),logger[_0x1507fd(0x16d)]('remove\x20temp\x20mdapi\x20folder'),await shell_internal_1[_0x1507fd(0x198)][_0x1507fd(0x1bf)](_0x1507fd(0x1c4)+_0x127870);}async['exec'](_0x200b11){const _0x437b3c=a122_0xf9998a,_0x14ca40=Date[_0x437b3c(0x1b7)](),{commitId:_0x292df8,branch:_0x11fcc9,attachmentId:_0x112bd5,message:_0x853dc9}=this[_0x437b3c(0x173)][_0x437b3c(0x1a4)];logger['info'](_0x437b3c(0x1b2)),await this[_0x437b3c(0x16f)][_0x437b3c(0x1cc)](),this[_0x437b3c(0x15d)](_0x437b3c(0x16e)+_0x11fcc9);const _0xf472a2=[];try{const _0x4fb6c2=await this[_0x437b3c(0x16f)]['retrieveAttachment'](_0x112bd5);_0xf472a2[_0x437b3c(0x18e)](..._0x4fb6c2['split']('\x20')[_0x437b3c(0x17d)](_0x5e56b2=>_0x5e56b2[_0x437b3c(0x15f)]()));const {gitUrl:_0x3d3a4f}=_0x200b11,_0xe0e6d8=_0x3d3a4f['replace'](/https\:\/\/(.+@)?/,_0x437b3c(0x17c)+this[_0x437b3c(0x185)]+'@');logger[_0x437b3c(0x1bc)](_0x437b3c(0x1a0),_0xe0e6d8),this['sfLogger'](_0x437b3c(0x1c2));const _0x2ed8b3=await git_internal_1[_0x437b3c(0x19c)]['clone'](_0xe0e6d8,_0x292df8,_0x11fcc9),{name:_0x4b6b27,email:_0x15995f}=this[_0x437b3c(0x173)][_0x437b3c(0x1a4)]['user'];logger['info'](_0x437b3c(0x190),_0x4b6b27,_0x15995f),await _0x2ed8b3[_0x437b3c(0x1ae)](_0x4b6b27,_0x15995f),logger[_0x437b3c(0x1bc)](_0x437b3c(0x1af)),await this['retrieveComponents'](_0x2ed8b3['baseDir'],_0xf472a2),logger[_0x437b3c(0x1bc)](_0x437b3c(0x1c6)),await _0x2ed8b3[_0x437b3c(0x165)]('.'),logger[_0x437b3c(0x1bc)]('commit\x20files\x20with\x20message\x20\x22%s\x22',_0x853dc9);try{await _0x2ed8b3[_0x437b3c(0x19d)](_0x853dc9);}catch(_0x34304a){let _0x33e34a=0x0;do{_0x33e34a++;const _0x47a764=await _0x2ed8b3['status']()[_0x437b3c(0x1a3)](_0x254cb4=>_0x254cb4['message']||_0x254cb4);if(_0x47a764[_0x437b3c(0x161)](_0x437b3c(0x1c5))){_0x33e34a=0x0;break;}await utils_1['sleep'](this[_0x437b3c(0x159)]);}while(_0x33e34a<this['MAX_GIT_STATUS_CHECK']);if(_0x33e34a===this[_0x437b3c(0x182)])throw _0x34304a;}this[_0x437b3c(0x15d)]('Push\x20commit\x20to\x20branch'),logger[_0x437b3c(0x1bc)]('push\x20commit\x20to\x20branch\x20\x22%s\x22',_0x11fcc9),await _0x2ed8b3[_0x437b3c(0x18e)](_0x11fcc9),logger['info']('remove\x20git\x20repository\x20folder\x20'+_0x2ed8b3[_0x437b3c(0x1b8)]),await shell_internal_1[_0x437b3c(0x198)][_0x437b3c(0x1bf)](_0x437b3c(0x1c4)+_0x2ed8b3[_0x437b3c(0x1b8)]),logger[_0x437b3c(0x1bc)]('send\x20DELETE\x20commit\x20id\x20%s',_0x292df8),await this[_0x437b3c(0x16f)][_0x437b3c(0x199)](_0x292df8);}catch(_0x244464){this[_0x437b3c(0x15d)](_0x437b3c(0x1cb)+(_0x244464[_0x437b3c(0x160)]||_0x244464)),console['log']({'error':_0x244464});}finally{logger[_0x437b3c(0x1bc)](_0x437b3c(0x16a),_0x292df8,Date[_0x437b3c(0x1b7)]()-_0x14ca40,_0xf472a2[_0x437b3c(0x19e)]),this[_0x437b3c(0x173)]=undefined;}}async[a122_0xf9998a(0x1b6)](_0x283b56){const _0x269b4b=a122_0xf9998a;if(this[_0x269b4b(0x173)])throw new bad_request_error_1[(_0x269b4b(0x196))](errors_1[_0x269b4b(0x1b5)]);try{this['currentJob']=_0x283b56;const _0x5429ed=typedi_1['default'][_0x269b4b(0x163)](git_provider_manager_1[_0x269b4b(0x17f)])[_0x269b4b(0x175)](),_0x2a081d=await _0x5429ed[_0x269b4b(0x1c9)](_0x283b56[_0x269b4b(0x1a4)]['repo']);await _0x2a081d[_0x269b4b(0x186)][_0x269b4b(0x1c9)](_0x283b56[_0x269b4b(0x1a4)][_0x269b4b(0x1a1)]),this['exec'](_0x2a081d);}catch(_0x30063c){this[_0x269b4b(0x173)]=undefined;throw _0x30063c;}}};FlosumCommitJob=__decorate([typedi_1[a122_0xf9998a(0x17e)](),__metadata(a122_0xf9998a(0x1a7),[auth_settings_service_1['AuthSettingsService'],salesforce_service_1[a122_0xf9998a(0x18b)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;