const a143_0x3432=['decorate',']\x20[Branch:\x20','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','commitData','SalesforceSyncService','GitProviderManager','user','__esModule','logger','Error','Attachment','repository','log','provider','sha','patchObject','./commit-components.job','metadata','test','[INFO]\x20Start\x20commit\x20job','BadRequestError','getComponentsToDelete','[COMMIT]\x20[','defineProperty','Service','name','exec','__decorate','salesforceService','run','171269wsXNgy','updateLastCommit','deleteAttachmentId','13889ItNWvL','../../shared/utils','typedi','../dto/commit-components.dto','length','getRepositoryRecord','encodeBase64','branches','5SQTjbP','setLoggerId','10853aZDBpl','../../salesforce/services/salesforce.service','getAttachmentIdByParent','return\x20/\x22\x20+\x20this\x20+\x20\x22/','34675IIHZYM','repo','../../salesforce/services/salesforce-retriever.service','CommitComponentsJob','gitUrl','setStatus','19yKqvgX','syncBranchId','73339DPtaDt','constructor','In\x20Progress','repositoryName','convertToSFDX','gitManager','repositoryData','all','object','salesforceSync','design:paramtypes','branchName','../../shared/git-provider.manager','components','apply','305854jycVkV','SalesforceRetrieverService','retrieveAttachment','message','commitJob','FlosumCommitJob','../../../core/errors/bad-request.error',']\x20[Repository:\x20','commitAttachmentId','getOne','function','32073weGAiJ','map','fetchRepositoryData','SalesforceService','3iZqpUI','branch','getCommitDto','deleteAttachment','catch','4TYFnIm','../../../constants/errors','send'];const a143_0x2874c7=a143_0x3901;(function(_0x3f78af,_0x408ef2){const _0xe52d3a=a143_0x3901;while(!![]){try{const _0xb00db=-parseInt(_0xe52d3a(0x16e))*parseInt(_0xe52d3a(0x139))+parseInt(_0xe52d3a(0x174))+-parseInt(_0xe52d3a(0x142))*parseInt(_0xe52d3a(0x170))+-parseInt(_0xe52d3a(0x12e))+parseInt(_0xe52d3a(0x163))+parseInt(_0xe52d3a(0x13d))*parseInt(_0xe52d3a(0x11f))+parseInt(_0xe52d3a(0x17a))*parseInt(_0xe52d3a(0x166));if(_0xb00db===_0x408ef2)break;else _0x3f78af['push'](_0x3f78af['shift']());}catch(_0x1ff33a){_0x3f78af['push'](_0x3f78af['shift']());}}}(a143_0x3432,0x2bffd));const a143_0x3e1b80=function(){let _0x285d97=!![];return function(_0x2effc2,_0x2cdf5e){const _0x12635b=_0x285d97?function(){const _0x5084ea=a143_0x3901;if(_0x2cdf5e){const _0x488d13=_0x2cdf5e[_0x5084ea(0x12d)](_0x2effc2,arguments);return _0x2cdf5e=null,_0x488d13;}}:function(){};return _0x285d97=![],_0x12635b;};}(),a143_0x562475=a143_0x3e1b80(this,function(){const _0x1ed69e=function(){const _0x52dd97=a143_0x3901,_0x1f1258=_0x1ed69e[_0x52dd97(0x120)](_0x52dd97(0x173))()['constructor'](_0x52dd97(0x147));return!_0x1f1258[_0x52dd97(0x157)](a143_0x562475);};return _0x1ed69e();});a143_0x562475();'use strict';var __decorate=this&&this[a143_0x2874c7(0x160)]||function(_0x502017,_0x4ef711,_0x471e40,_0x91bb99){const _0x51ed8b=a143_0x2874c7;var _0x51dbd1=arguments[_0x51ed8b(0x16a)],_0x34f21f=_0x51dbd1<0x3?_0x4ef711:_0x91bb99===null?_0x91bb99=Object['getOwnPropertyDescriptor'](_0x4ef711,_0x471e40):_0x91bb99,_0x2753bb;if(typeof Reflect===_0x51ed8b(0x127)&&typeof Reflect[_0x51ed8b(0x145)]===_0x51ed8b(0x138))_0x34f21f=Reflect[_0x51ed8b(0x145)](_0x502017,_0x4ef711,_0x471e40,_0x91bb99);else{for(var _0x25184d=_0x502017[_0x51ed8b(0x16a)]-0x1;_0x25184d>=0x0;_0x25184d--)if(_0x2753bb=_0x502017[_0x25184d])_0x34f21f=(_0x51dbd1<0x3?_0x2753bb(_0x34f21f):_0x51dbd1>0x3?_0x2753bb(_0x4ef711,_0x471e40,_0x34f21f):_0x2753bb(_0x4ef711,_0x471e40))||_0x34f21f;}return _0x51dbd1>0x3&&_0x34f21f&&Object[_0x51ed8b(0x15c)](_0x4ef711,_0x471e40,_0x34f21f),_0x34f21f;},__metadata=this&&this['__metadata']||function(_0x5c3f5e,_0x2256f1){const _0x4fcd8e=a143_0x2874c7;if(typeof Reflect===_0x4fcd8e(0x127)&&typeof Reflect[_0x4fcd8e(0x156)]===_0x4fcd8e(0x138))return Reflect['metadata'](_0x5c3f5e,_0x2256f1);};Object['defineProperty'](exports,a143_0x2874c7(0x14c),{'value':!![]}),exports[a143_0x2874c7(0x133)]=void 0x0;const salesforce_service_1=require(a143_0x2874c7(0x171)),git_provider_manager_1=require(a143_0x2874c7(0x12b)),typedi_1=require(a143_0x2874c7(0x168)),errors_1=require(a143_0x2874c7(0x143)),bad_request_error_1=require(a143_0x2874c7(0x134)),salesforce_retriever_service_1=require(a143_0x2874c7(0x176)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),utils_1=require(a143_0x2874c7(0x167)),commit_components_dto_1=require(a143_0x2874c7(0x169)),commit_components_job_1=require(a143_0x2874c7(0x155));let FlosumCommitJob=class FlosumCommitJob{constructor(_0x5887e5,_0x220d11,_0x65d364,_0x4482dc){const _0x39a6a6=a143_0x2874c7;this[_0x39a6a6(0x161)]=_0x5887e5,this['commitJob']=_0x220d11,this[_0x39a6a6(0x128)]=_0x65d364,this['gitManager']=_0x4482dc,this['repoService']=this[_0x39a6a6(0x124)]['getRepoService']();}[a143_0x2874c7(0x151)](_0x41a94e){const _0x39202d=a143_0x2874c7;return this[_0x39202d(0x14d)][_0x39202d(0x151)](_0x39202d(0x15b)+this[_0x39202d(0x124)][_0x39202d(0x152)]['toUpperCase']()+_0x39202d(0x135)+this[_0x39202d(0x150)][_0x39202d(0x15e)]+_0x39202d(0x146)+this[_0x39202d(0x13e)][_0x39202d(0x15e)]+']\x20'+_0x41a94e);}async[a143_0x2874c7(0x13b)](){const _0x3fe933=a143_0x2874c7;try{if(this['commitData']['syncRepositoryId'])this[_0x3fe933(0x125)]=await this[_0x3fe933(0x128)][_0x3fe933(0x16b)](this[_0x3fe933(0x148)]['syncRepositoryId']);else this['commitData'][_0x3fe933(0x17b)]&&(this[_0x3fe933(0x125)]=await this[_0x3fe933(0x128)]['getBranchRecord'](this[_0x3fe933(0x148)][_0x3fe933(0x17b)]));}catch(_0x297bff){throw new bad_request_error_1[(_0x3fe933(0x159))](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async['getComponentsToWrite'](){const _0x3ab2e5=a143_0x2874c7;if(!this[_0x3ab2e5(0x148)]['commitAttachmentId'])return[];const _0x38d085=await this[_0x3ab2e5(0x161)][_0x3ab2e5(0x130)](this['commitData'][_0x3ab2e5(0x136)])['then'](_0x49cb00=>_0x49cb00['split']('\x20')[_0x3ab2e5(0x13a)](_0x2f4b10=>_0x2f4b10['trim']())),_0x406015=new salesforce_retriever_service_1[(_0x3ab2e5(0x12f))](this[_0x3ab2e5(0x161)]),_0x123727=await _0x406015['run'](_0x38d085);return _0x123727;}async[a143_0x2874c7(0x15a)](){const _0x223959=a143_0x2874c7;if(!this['commitData'][_0x223959(0x165)])return[];const _0x208417=await this[_0x223959(0x161)]['retrieveAttachment'](this['commitData'][_0x223959(0x165)]);return _0x208417;}async[a143_0x2874c7(0x13f)](){const _0x5e43eb=a143_0x2874c7,_0x36e4dd=new commit_components_dto_1['CommitComponentsDto'](),[_0x3d39fb,_0x250409]=await Promise[_0x5e43eb(0x126)]([this['getComponentsToWrite'](),this[_0x5e43eb(0x15a)]()]);return _0x36e4dd['message']=this[_0x5e43eb(0x148)][_0x5e43eb(0x131)],_0x36e4dd['user']=this[_0x5e43eb(0x148)][_0x5e43eb(0x14b)],_0x36e4dd[_0x5e43eb(0x12c)]={'writed':_0x3d39fb,'deleted':_0x250409},_0x36e4dd[_0x5e43eb(0x123)]=this[_0x5e43eb(0x148)]['convertToSFDX'],_0x36e4dd[_0x5e43eb(0x175)]=this[_0x5e43eb(0x150)],_0x36e4dd[_0x5e43eb(0x13e)]=this[_0x5e43eb(0x13e)],_0x36e4dd;}async[a143_0x2874c7(0x164)](){const _0x40de6d=a143_0x2874c7,_0xdfbc8e=await this[_0x40de6d(0x150)][_0x40de6d(0x16d)][_0x40de6d(0x137)](this[_0x40de6d(0x13e)][_0x40de6d(0x15e)]);this[_0x40de6d(0x151)]('[INFO]\x20Update\x20remote\x20state.');const _0x4aa499=await this[_0x40de6d(0x128)][_0x40de6d(0x172)](this[_0x40de6d(0x125)]['objectId']),_0x2c1b8d={[this[_0x40de6d(0x150)][_0x40de6d(0x178)]]:{'lastCommit':_0xdfbc8e[_0x40de6d(0x153)]}};await this[_0x40de6d(0x161)][_0x40de6d(0x154)](_0x40de6d(0x14f),_0x4aa499,{'Body':utils_1[_0x40de6d(0x16c)](JSON['stringify'](_0x2c1b8d))});}async[a143_0x2874c7(0x15f)](){const _0x1cc84e=a143_0x2874c7,_0x183cc2=await this[_0x1cc84e(0x13f)]();this[_0x1cc84e(0x132)]['logger']=this['logger'],await this[_0x1cc84e(0x128)][_0x1cc84e(0x179)](this[_0x1cc84e(0x125)],_0x1cc84e(0x121)),await this[_0x1cc84e(0x132)][_0x1cc84e(0x162)](_0x183cc2),await this['updateLastCommit'](),this['commitData']['commitAttachmentId']&&await this['salesforceService'][_0x1cc84e(0x140)](this['commitData']['commitAttachmentId']),this[_0x1cc84e(0x148)]['deleteAttachmentId']&&await this[_0x1cc84e(0x161)][_0x1cc84e(0x140)](this[_0x1cc84e(0x148)][_0x1cc84e(0x165)]),await this[_0x1cc84e(0x128)][_0x1cc84e(0x179)](this[_0x1cc84e(0x125)],'Completed');}async[a143_0x2874c7(0x162)](_0x52cb69,_0x2d2d3f){const _0x3cfff0=a143_0x2874c7;try{this[_0x3cfff0(0x148)]=_0x52cb69,this[_0x3cfff0(0x161)][_0x3cfff0(0x16f)](_0x2d2d3f),this[_0x3cfff0(0x14d)]=this[_0x3cfff0(0x161)]['getLogger'](),await this[_0x3cfff0(0x13b)]();if(!this[_0x3cfff0(0x125)])throw new bad_request_error_1[(_0x3cfff0(0x159))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);this['repository']=await this['repoService'][_0x3cfff0(0x137)](this[_0x3cfff0(0x125)][_0x3cfff0(0x122)]),this[_0x3cfff0(0x13e)]=await this[_0x3cfff0(0x150)][_0x3cfff0(0x16d)]['getOne'](this[_0x3cfff0(0x125)][_0x3cfff0(0x12a)]),this[_0x3cfff0(0x151)](_0x3cfff0(0x158)),this['exec']()[_0x3cfff0(0x141)](async _0xc313d8=>{const _0x3db5ad=_0x3cfff0;return this[_0x3db5ad(0x151)]('[ERROR]\x20'+_0xc313d8),await this[_0x3db5ad(0x128)][_0x3db5ad(0x179)](this[_0x3db5ad(0x125)],_0x3db5ad(0x14e)),this[_0x3db5ad(0x14d)][_0x3db5ad(0x144)]();});}catch(_0x2f14c4){this['commitData']=undefined;throw _0x2f14c4;}}};function a143_0x3901(_0x39f026,_0x23ceef){return a143_0x3901=function(_0x1b669c,_0x562475){_0x1b669c=_0x1b669c-0x11f;let _0x3e1b80=a143_0x3432[_0x1b669c];return _0x3e1b80;},a143_0x3901(_0x39f026,_0x23ceef);}FlosumCommitJob=__decorate([typedi_1[a143_0x2874c7(0x15d)]({'transient':!![]}),__metadata(a143_0x2874c7(0x129),[salesforce_service_1[a143_0x2874c7(0x13c)],commit_components_job_1[a143_0x2874c7(0x177)],salesforce_sync_service_1[a143_0x2874c7(0x149)],git_provider_manager_1[a143_0x2874c7(0x14a)]])],FlosumCommitJob),exports[a143_0x2874c7(0x133)]=FlosumCommitJob;