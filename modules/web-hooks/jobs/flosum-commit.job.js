const a137_0x23ef=['componentsIds','getAttachmentIdByParent','encodeBase64','getOwnPropertyDescriptor','repositoryName','exec','attachmentId','[COMMIT]\x20[Repository:\x20','[ERROR]\x20','BadRequestError','then','gitManager','map','length','3jfLXBn','84642DBSfru','[INFO]\x20Update\x20remote\x20state.','return\x20/\x22\x20+\x20this\x20+\x20\x22/','run','../../salesforce/services/salesforce.service','1Modnqw','name','defineProperty','apply','repo','getRepositoryRecord','user','__metadata','catch','getOne','GitProviderManager','branch','decorate','convertToSFDX','trim','function','object','2vsspPv','237736DwqqIc','sfLogger','message','repository','../../shared/utils','repositoryData','../../../core/errors/bad-request.error','sha','gitUrl','commitData','1oLFwGC','ERR_INVALID_SYNC_RECORD_ID','185501HqfLYk','parse','commitJob','test','770eVSamv','Service','fetchRepositoryData','typedi','setStatus','10058IzyoCX','constructor','976474FfyTzz','675263sHpTWp','../../salesforce/services/salesforce-sync.service','metadata','salesforceService','getBranchRecord','getCommitDto','CommitComponentsDto','../../shared/git-provider.manager','syncRepositoryId','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','salesforceSync','getRepoService','FlosumCommitJob','SalesforceService','SalesforceSyncService','log','branchName','sendLog','51lXdvRC','repoService','patchObject','Attachment','__esModule','retrieveAttachment','updateLastCommit','design:paramtypes','setLoggerId','syncBranchId','In\x20Progress','193MOqBjE','Completed','__decorate','branches'];const a137_0x2905da=a137_0x23e7;(function(_0x302edc,_0x3397cb){const _0x1acff9=a137_0x23e7;while(!![]){try{const _0x53399b=parseInt(_0x1acff9(0xa1))*parseInt(_0x1acff9(0x89))+parseInt(_0x1acff9(0xad))*-parseInt(_0x1acff9(0xa0))+parseInt(_0x1acff9(0xb1))*parseInt(_0x1acff9(0xd6))+parseInt(_0x1acff9(0xcb))*-parseInt(_0x1acff9(0xb6))+parseInt(_0x1acff9(0x8f))*-parseInt(_0x1acff9(0xb9))+parseInt(_0x1acff9(0xab))*parseInt(_0x1acff9(0x8a))+parseInt(_0x1acff9(0xb8));if(_0x53399b===_0x3397cb)break;else _0x302edc['push'](_0x302edc['shift']());}catch(_0x23f59a){_0x302edc['push'](_0x302edc['shift']());}}}(a137_0x23ef,0x58cbf));const a137_0x254d2d=function(){let _0x584d10=!![];return function(_0x21cf58,_0x45923c){const _0xccfea8=_0x584d10?function(){const _0x2140c2=a137_0x23e7;if(_0x45923c){const _0x57aade=_0x45923c[_0x2140c2(0x92)](_0x21cf58,arguments);return _0x45923c=null,_0x57aade;}}:function(){};return _0x584d10=![],_0xccfea8;};}(),a137_0x20f64a=a137_0x254d2d(this,function(){const _0x43d567=function(){const _0x662e31=a137_0x23e7,_0x39a523=_0x43d567[_0x662e31(0xb7)](_0x662e31(0x8c))()[_0x662e31(0xb7)](_0x662e31(0xc2));return!_0x39a523[_0x662e31(0xb0)](a137_0x20f64a);};return _0x43d567();});a137_0x20f64a();'use strict';var __decorate=this&&this[a137_0x2905da(0xd8)]||function(_0x360ac9,_0x1737fa,_0x52439c,_0x3ec9aa){const _0xc4b39b=a137_0x2905da;var _0x5b9591=arguments[_0xc4b39b(0xe7)],_0x3dfced=_0x5b9591<0x3?_0x1737fa:_0x3ec9aa===null?_0x3ec9aa=Object[_0xc4b39b(0xdd)](_0x1737fa,_0x52439c):_0x3ec9aa,_0x40ff27;if(typeof Reflect==='object'&&typeof Reflect[_0xc4b39b(0x9b)]===_0xc4b39b(0x9e))_0x3dfced=Reflect[_0xc4b39b(0x9b)](_0x360ac9,_0x1737fa,_0x52439c,_0x3ec9aa);else{for(var _0x448b82=_0x360ac9['length']-0x1;_0x448b82>=0x0;_0x448b82--)if(_0x40ff27=_0x360ac9[_0x448b82])_0x3dfced=(_0x5b9591<0x3?_0x40ff27(_0x3dfced):_0x5b9591>0x3?_0x40ff27(_0x1737fa,_0x52439c,_0x3dfced):_0x40ff27(_0x1737fa,_0x52439c))||_0x3dfced;}return _0x5b9591>0x3&&_0x3dfced&&Object[_0xc4b39b(0x91)](_0x1737fa,_0x52439c,_0x3dfced),_0x3dfced;},__metadata=this&&this[a137_0x2905da(0x96)]||function(_0x2ac558,_0x37e526){const _0x1ec2e5=a137_0x2905da;if(typeof Reflect===_0x1ec2e5(0x9f)&&typeof Reflect[_0x1ec2e5(0xbb)]===_0x1ec2e5(0x9e))return Reflect[_0x1ec2e5(0xbb)](_0x2ac558,_0x37e526);};Object[a137_0x2905da(0x91)](exports,a137_0x2905da(0xcf),{'value':!![]}),exports[a137_0x2905da(0xc5)]=void 0x0;const salesforce_service_1=require(a137_0x2905da(0x8e)),git_provider_manager_1=require(a137_0x2905da(0xc0)),typedi_1=require(a137_0x2905da(0xb4)),errors_1=require('../../../constants/errors'),bad_request_error_1=require(a137_0x2905da(0xa7)),salesforce_sync_service_1=require(a137_0x2905da(0xba)),utils_1=require(a137_0x2905da(0xa5)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job');function a137_0x23e7(_0x224538,_0x5a584c){return a137_0x23e7=function(_0x2ab37c,_0x20f64a){_0x2ab37c=_0x2ab37c-0x89;let _0x254d2d=a137_0x23ef[_0x2ab37c];return _0x254d2d;},a137_0x23e7(_0x224538,_0x5a584c);}let FlosumCommitJob=class FlosumCommitJob{constructor(_0x49a780,_0xbdcbfb,_0x2311f1,_0x5c1d78){const _0xfc6edc=a137_0x2905da;this[_0xfc6edc(0xbc)]=_0x49a780,this[_0xfc6edc(0xaf)]=_0xbdcbfb,this[_0xfc6edc(0xc3)]=_0x2311f1,this['gitManager']=_0x5c1d78,this[_0xfc6edc(0xcc)]=this[_0xfc6edc(0xe5)][_0xfc6edc(0xc4)](),_0xbdcbfb['on'](_0xfc6edc(0xc8),_0x1258b3=>this['sfLogger'](_0x1258b3));}async[a137_0x2905da(0xa2)](_0x25d12f){const _0x5c7ce2=a137_0x2905da;return this['salesforceService'][_0x5c7ce2(0xca)](_0x5c7ce2(0xe1)+this['repository'][_0x5c7ce2(0x90)]+']\x20[Branch:\x20'+this[_0x5c7ce2(0x9a)][_0x5c7ce2(0x90)]+']\x20'+_0x25d12f);}async[a137_0x2905da(0xb3)](){const _0x6fb058=a137_0x2905da;try{if(this[_0x6fb058(0xaa)]['syncRepositoryId'])this[_0x6fb058(0xa6)]=await this[_0x6fb058(0xc3)][_0x6fb058(0x94)](this[_0x6fb058(0xaa)][_0x6fb058(0xc1)]);else this[_0x6fb058(0xaa)][_0x6fb058(0xd4)]&&(this['repositoryData']=await this['salesforceSync'][_0x6fb058(0xbd)](this['commitData'][_0x6fb058(0xd4)]));}catch(_0x39a5a3){throw new bad_request_error_1[(_0x6fb058(0xe3))](errors_1[_0x6fb058(0xac)]);}}async['getCommitDto'](){const _0x3e2d97=a137_0x2905da,_0x26d58a=new commit_components_dto_1[(_0x3e2d97(0xbf))](),_0x1dfe1b=await this[_0x3e2d97(0xbc)]['retrieveAttachment'](this[_0x3e2d97(0xaa)][_0x3e2d97(0xe0)])['then'](_0x259187=>_0x259187['split']('\x20')[_0x3e2d97(0xe6)](_0x1dd722=>_0x1dd722[_0x3e2d97(0x9d)]()));return _0x26d58a[_0x3e2d97(0xa3)]=this['commitData']['message'],_0x26d58a[_0x3e2d97(0x95)]=this[_0x3e2d97(0xaa)][_0x3e2d97(0x95)],_0x26d58a[_0x3e2d97(0xda)]=_0x1dfe1b,_0x26d58a[_0x3e2d97(0x9c)]=this[_0x3e2d97(0xaa)][_0x3e2d97(0x9c)],_0x26d58a[_0x3e2d97(0x93)]=this[_0x3e2d97(0xa4)],_0x26d58a['branch']=this['branch'],_0x26d58a;}async[a137_0x2905da(0xd1)](){const _0x181bf2=a137_0x2905da;var _0x36dccb;const _0xa8da42=await this[_0x181bf2(0xa4)][_0x181bf2(0xd9)][_0x181bf2(0x98)](this[_0x181bf2(0x9a)]['name']);await this[_0x181bf2(0xa2)](_0x181bf2(0x8b));const _0x38f147=await this[_0x181bf2(0xc3)][_0x181bf2(0xdb)](this[_0x181bf2(0xa6)]['objectId']),_0x5ef8d1=await this[_0x181bf2(0xbc)][_0x181bf2(0xd0)](_0x38f147)[_0x181bf2(0xe4)](_0x208634=>typeof _0x208634===_0x181bf2(0x9f)?_0x208634:JSON[_0x181bf2(0xae)](_0x208634||'{}'))[_0x181bf2(0x97)](()=>({}));_0x5ef8d1[_0x36dccb=this[_0x181bf2(0xa4)][_0x181bf2(0xa9)]]||(_0x5ef8d1[_0x36dccb]={'lastCommit':''}),_0x5ef8d1[this[_0x181bf2(0xa4)][_0x181bf2(0xa9)]]['lastCommit']=_0xa8da42[_0x181bf2(0xa8)],await this[_0x181bf2(0xbc)][_0x181bf2(0xcd)](_0x181bf2(0xce),_0x38f147,{'Body':utils_1[_0x181bf2(0xdc)](JSON['stringify'](_0x5ef8d1))});}async[a137_0x2905da(0xdf)](){const _0x5efb6d=a137_0x2905da,_0x28519a=await this[_0x5efb6d(0xbe)]();await this[_0x5efb6d(0xc3)][_0x5efb6d(0xb5)](this[_0x5efb6d(0xa6)],_0x5efb6d(0xd5)),await this['commitJob'][_0x5efb6d(0x8d)](_0x28519a),await this[_0x5efb6d(0xd1)](),await this['salesforceSync'][_0x5efb6d(0xb5)](this[_0x5efb6d(0xa6)],_0x5efb6d(0xd7));}async[a137_0x2905da(0x8d)](_0x2c8073,_0x528b76){const _0x5b9857=a137_0x2905da;try{this['commitData']=_0x2c8073,this[_0x5b9857(0xbc)][_0x5b9857(0xd3)](_0x528b76),await this[_0x5b9857(0xb3)]();if(!this[_0x5b9857(0xa6)])throw new bad_request_error_1['BadRequestError'](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);this['repository']=await this[_0x5b9857(0xcc)]['getOne'](this[_0x5b9857(0xa6)][_0x5b9857(0xde)]),this[_0x5b9857(0x9a)]=await this[_0x5b9857(0xa4)][_0x5b9857(0xd9)][_0x5b9857(0x98)](this[_0x5b9857(0xa6)][_0x5b9857(0xc9)]),await this[_0x5b9857(0xa2)]('[INFO]\x20Start\x20commit\x20job'),this[_0x5b9857(0xdf)]()[_0x5b9857(0x97)](_0x44357a=>{const _0x22d099=_0x5b9857;this[_0x22d099(0xa2)](_0x22d099(0xe2)+(_0x44357a[_0x22d099(0xa3)]||_0x44357a));});}catch(_0x543ebf){this[_0x5b9857(0xaa)]=undefined;throw _0x543ebf;}}};FlosumCommitJob=__decorate([typedi_1[a137_0x2905da(0xb2)]({'transient':!![]}),__metadata(a137_0x2905da(0xd2),[salesforce_service_1[a137_0x2905da(0xc6)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a137_0x2905da(0xc7)],git_provider_manager_1[a137_0x2905da(0x99)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;