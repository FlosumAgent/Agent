const a145_0x2804=['commitAttachmentId','../../shared/utils','../dto/commit-components.dto','metadata','1730229AjMiGG','typedi','SalesforceSyncService','[INFO]\x20Start\x20commit\x20job','repoService','trim','../../salesforce/services/salesforce.service','user','decorate','length','repositoryData','retrieveAttachment','map','gitManager','getRepositoryRecord','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../../shared/git-provider.manager','deleteAttachmentId','flosum-commit-job','sha','exec','getCommitDto','[INFO]\x20Update\x20remote\x20state.','../../../core',']\x20[Branch:\x20','branches','send','run','7RynPZW','7486daSSKA','error','BadRequestError','1073455uJPRxQ','logger','CommitComponentsDto','syncRepositoryId','ERR_UNKNOWN_SYNC_RECORD_ID','all','542646mMouMr','getOne','defineProperty','Logger','name','Attachment','19HhzArL','2321346nkBUxi','return\x20/\x22\x20+\x20this\x20+\x20\x22/','137752cHcYhg','syncBranchId','getAttachmentId','../../../core/errors/bad-request.error','ERR_INVALID_SYNC_RECORD_ID','branch','[COMMIT]\x20[','gitUrl','repository','887566oVuxrF','getBranchRecord','Completed','getRepoService','FlosumCommitJob','updateLastCommit','GitProviderManager','getOwnPropertyDescriptor','convertToSFDX','../../../constants/errors','provider','design:paramtypes','patchObject','./commit-components.job','setStatus','__metadata','encodeBase64','log','repo','SalesforceService','constructor','getComponentsToDelete','commitData','setLoggerId',']\x20[Repository:\x20','1yFkiaU','commitJob','toUpperCase','repositoryName','Error','components','SalesforceRetrieverService','salesforceSync','object','function','fetchRepositoryData','message','getComponentsToWrite','[ERROR]\x20','salesforceService'];const a145_0x110fe7=a145_0x3622;(function(_0x2a6200,_0x1a769c){const _0xf14a18=a145_0x3622;while(!![]){try{const _0x276b80=parseInt(_0xf14a18(0x150))*-parseInt(_0xf14a18(0x141))+parseInt(_0xf14a18(0x144))+-parseInt(_0xf14a18(0x14a))+-parseInt(_0xf14a18(0x175))*-parseInt(_0xf14a18(0x15c))+-parseInt(_0xf14a18(0x140))*parseInt(_0xf14a18(0x153))+-parseInt(_0xf14a18(0x124))+parseInt(_0xf14a18(0x151));if(_0x276b80===_0x1a769c)break;else _0x2a6200['push'](_0x2a6200['shift']());}catch(_0x47a3c4){_0x2a6200['push'](_0x2a6200['shift']());}}}(a145_0x2804,0xdc752));const a145_0x32604a=function(){let _0x254c9f=!![];return function(_0x16deaf,_0x73b44b){const _0x19abe6=_0x254c9f?function(){if(_0x73b44b){const _0x18c7e6=_0x73b44b['apply'](_0x16deaf,arguments);return _0x73b44b=null,_0x18c7e6;}}:function(){};return _0x254c9f=![],_0x19abe6;};}(),a145_0x2e7a3f=a145_0x32604a(this,function(){const _0x4ed55a=function(){const _0x5d4d0a=a145_0x3622,_0x1008d2=_0x4ed55a[_0x5d4d0a(0x170)](_0x5d4d0a(0x152))()['constructor'](_0x5d4d0a(0x133));return!_0x1008d2['test'](a145_0x2e7a3f);};return _0x4ed55a();});a145_0x2e7a3f();function a145_0x3622(_0x3553e2,_0x4b0c85){return a145_0x3622=function(_0x45809b,_0x2e7a3f){_0x45809b=_0x45809b-0x118;let _0x32604a=a145_0x2804[_0x45809b];return _0x32604a;},a145_0x3622(_0x3553e2,_0x4b0c85);}'use strict';var __decorate=this&&this['__decorate']||function(_0x405191,_0x251b7c,_0x1e7fe8,_0x101403){const _0x4ea524=a145_0x3622;var _0x24026c=arguments[_0x4ea524(0x12d)],_0x11e214=_0x24026c<0x3?_0x251b7c:_0x101403===null?_0x101403=Object[_0x4ea524(0x163)](_0x251b7c,_0x1e7fe8):_0x101403,_0x273221;if(typeof Reflect===_0x4ea524(0x119)&&typeof Reflect[_0x4ea524(0x12c)]===_0x4ea524(0x11a))_0x11e214=Reflect['decorate'](_0x405191,_0x251b7c,_0x1e7fe8,_0x101403);else{for(var _0x5622b5=_0x405191[_0x4ea524(0x12d)]-0x1;_0x5622b5>=0x0;_0x5622b5--)if(_0x273221=_0x405191[_0x5622b5])_0x11e214=(_0x24026c<0x3?_0x273221(_0x11e214):_0x24026c>0x3?_0x273221(_0x251b7c,_0x1e7fe8,_0x11e214):_0x273221(_0x251b7c,_0x1e7fe8))||_0x11e214;}return _0x24026c>0x3&&_0x11e214&&Object[_0x4ea524(0x14c)](_0x251b7c,_0x1e7fe8,_0x11e214),_0x11e214;},__metadata=this&&this[a145_0x110fe7(0x16b)]||function(_0x25ce49,_0x2876ba){const _0x299093=a145_0x110fe7;if(typeof Reflect===_0x299093(0x119)&&typeof Reflect[_0x299093(0x123)]===_0x299093(0x11a))return Reflect['metadata'](_0x25ce49,_0x2876ba);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a145_0x110fe7(0x160)]=void 0x0;const core_1=require(a145_0x110fe7(0x13b)),salesforce_service_1=require(a145_0x110fe7(0x12a)),git_provider_manager_1=require(a145_0x110fe7(0x134)),typedi_1=require(a145_0x110fe7(0x125)),errors_1=require(a145_0x110fe7(0x165)),bad_request_error_1=require(a145_0x110fe7(0x156)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),utils_1=require(a145_0x110fe7(0x121)),commit_components_dto_1=require(a145_0x110fe7(0x122)),commit_components_job_1=require(a145_0x110fe7(0x169)),logger=new core_1[(a145_0x110fe7(0x14d))](a145_0x110fe7(0x136));let FlosumCommitJob=class FlosumCommitJob{constructor(_0x438712,_0x55d1fb,_0x13c12b,_0x207dde){const _0x2b2c54=a145_0x110fe7;this[_0x2b2c54(0x11f)]=_0x438712,this['commitJob']=_0x55d1fb,this[_0x2b2c54(0x118)]=_0x13c12b,this[_0x2b2c54(0x131)]=_0x207dde,this[_0x2b2c54(0x128)]=this['gitManager'][_0x2b2c54(0x15f)]();}[a145_0x110fe7(0x16d)](_0xdf94aa){const _0x247647=a145_0x110fe7;return this['logger'][_0x247647(0x16d)](_0x247647(0x159)+this[_0x247647(0x131)][_0x247647(0x166)][_0x247647(0x177)]()+_0x247647(0x174)+this['repository'][_0x247647(0x14e)]+_0x247647(0x13c)+this[_0x247647(0x158)][_0x247647(0x14e)]+']\x20'+_0xdf94aa);}async[a145_0x110fe7(0x11b)](){const _0x1ed45f=a145_0x110fe7;try{if(this[_0x1ed45f(0x172)][_0x1ed45f(0x147)])this[_0x1ed45f(0x12e)]=await this[_0x1ed45f(0x118)][_0x1ed45f(0x132)](this[_0x1ed45f(0x172)][_0x1ed45f(0x147)]);else this[_0x1ed45f(0x172)][_0x1ed45f(0x154)]&&(this[_0x1ed45f(0x12e)]=await this[_0x1ed45f(0x118)][_0x1ed45f(0x15d)](this[_0x1ed45f(0x172)][_0x1ed45f(0x154)]));}catch(_0xb0b043){throw new bad_request_error_1[(_0x1ed45f(0x143))](errors_1[_0x1ed45f(0x157)]);}}async[a145_0x110fe7(0x11d)](){const _0x2869bc=a145_0x110fe7;if(!this[_0x2869bc(0x172)][_0x2869bc(0x120)])return[];const _0xfe9026=await this[_0x2869bc(0x11f)][_0x2869bc(0x12f)](this['commitData'][_0x2869bc(0x120)])['then'](_0x5160d5=>_0x5160d5['split']('\x20')[_0x2869bc(0x130)](_0x43b784=>_0x43b784[_0x2869bc(0x129)]())),_0x3c2925=new salesforce_retriever_service_1[(_0x2869bc(0x17b))](this['salesforceService']),_0x101fb3=await _0x3c2925[_0x2869bc(0x13f)](_0xfe9026);return _0x101fb3;}async['getComponentsToDelete'](){const _0xff7281=a145_0x110fe7;if(!this['commitData'][_0xff7281(0x135)])return[];const _0x422961=await this[_0xff7281(0x11f)][_0xff7281(0x12f)](this[_0xff7281(0x172)]['deleteAttachmentId']);return _0x422961;}async['getCommitDto'](){const _0x53de14=a145_0x110fe7,_0x59e82a=new commit_components_dto_1[(_0x53de14(0x146))](),[_0x43e950,_0xd77915]=await Promise[_0x53de14(0x149)]([this[_0x53de14(0x11d)](),this[_0x53de14(0x171)]()]);return _0x59e82a[_0x53de14(0x11c)]=this[_0x53de14(0x172)][_0x53de14(0x11c)],_0x59e82a[_0x53de14(0x12b)]=this[_0x53de14(0x172)][_0x53de14(0x12b)],_0x59e82a[_0x53de14(0x17a)]={'writed':_0x43e950,'deleted':_0xd77915},_0x59e82a[_0x53de14(0x164)]=this[_0x53de14(0x172)][_0x53de14(0x164)],_0x59e82a[_0x53de14(0x16e)]=this[_0x53de14(0x15b)],_0x59e82a[_0x53de14(0x158)]=this['branch'],_0x59e82a;}async[a145_0x110fe7(0x161)](){const _0x58958a=a145_0x110fe7,_0x18768c=await this[_0x58958a(0x15b)]['branches'][_0x58958a(0x14b)](this[_0x58958a(0x158)]['name']);this[_0x58958a(0x16d)](_0x58958a(0x13a));const _0x2f1481=await this[_0x58958a(0x118)][_0x58958a(0x155)](this[_0x58958a(0x12e)]),_0x3556ae={[this[_0x58958a(0x15b)][_0x58958a(0x15a)]]:{'lastCommit':_0x18768c[_0x58958a(0x137)]}};await this[_0x58958a(0x11f)][_0x58958a(0x168)](_0x58958a(0x14f),_0x2f1481,{'Body':utils_1[_0x58958a(0x16c)](JSON['stringify'](_0x3556ae))});}async[a145_0x110fe7(0x138)](){const _0xa69678=a145_0x110fe7,_0x1a1464=await this[_0xa69678(0x139)]();this[_0xa69678(0x176)][_0xa69678(0x145)]=this['logger'],await this[_0xa69678(0x118)][_0xa69678(0x16a)](this[_0xa69678(0x12e)],'In\x20Progress'),await this[_0xa69678(0x176)]['run'](_0x1a1464),await this[_0xa69678(0x161)](),this['commitData'][_0xa69678(0x120)]&&await this[_0xa69678(0x11f)]['deleteAttachment'](this['commitData']['commitAttachmentId']),this[_0xa69678(0x172)][_0xa69678(0x135)]&&await this[_0xa69678(0x11f)]['deleteAttachment'](this[_0xa69678(0x172)][_0xa69678(0x135)]),await this['salesforceSync'][_0xa69678(0x16a)](this[_0xa69678(0x12e)],_0xa69678(0x15e));}async['handleCommitJobError'](_0x248279){const _0x15b0c5=a145_0x110fe7;try{this['logger']['log'](_0x15b0c5(0x11e)+_0x248279),await this[_0x15b0c5(0x145)][_0x15b0c5(0x13e)](),await this[_0x15b0c5(0x118)]['setStatus'](this[_0x15b0c5(0x12e)],_0x15b0c5(0x179));}catch(_0x4fba36){logger[_0x15b0c5(0x142)](_0x4fba36);}}async[a145_0x110fe7(0x13f)](_0x4ff858,_0x3f400a){const _0xc856d4=a145_0x110fe7;try{this[_0xc856d4(0x172)]=_0x4ff858,this[_0xc856d4(0x11f)][_0xc856d4(0x173)](_0x3f400a),this[_0xc856d4(0x145)]=this['salesforceService']['getLogger'](),await this[_0xc856d4(0x11b)]();if(!this[_0xc856d4(0x12e)])throw new bad_request_error_1['BadRequestError'](errors_1[_0xc856d4(0x148)]);this[_0xc856d4(0x15b)]=await this[_0xc856d4(0x128)][_0xc856d4(0x14b)](this[_0xc856d4(0x12e)][_0xc856d4(0x178)]),this['branch']=await this[_0xc856d4(0x15b)][_0xc856d4(0x13d)]['getOne'](this[_0xc856d4(0x12e)]['branchName']),this[_0xc856d4(0x16d)](_0xc856d4(0x127)),this[_0xc856d4(0x138)]()['catch'](_0x24b297=>this['handleCommitJobError'](_0x24b297));}catch(_0x2a4bd2){this[_0xc856d4(0x172)]=undefined,logger['error'](_0x2a4bd2);throw _0x2a4bd2;}}};FlosumCommitJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a145_0x110fe7(0x167),[salesforce_service_1[a145_0x110fe7(0x16f)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a145_0x110fe7(0x126)],git_provider_manager_1[a145_0x110fe7(0x162)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;