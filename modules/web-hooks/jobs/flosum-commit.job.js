const a177_0x233058=a177_0x55ea;(function(_0x35f23c,_0x390604){const _0x16468d=a177_0x55ea,_0x443003=_0x35f23c();while(!![]){try{const _0x36325d=parseInt(_0x16468d(0x128))/0x1*(parseInt(_0x16468d(0xfd))/0x2)+parseInt(_0x16468d(0x10e))/0x3*(parseInt(_0x16468d(0x110))/0x4)+parseInt(_0x16468d(0xf8))/0x5+parseInt(_0x16468d(0xe9))/0x6*(-parseInt(_0x16468d(0x10f))/0x7)+parseInt(_0x16468d(0x136))/0x8+-parseInt(_0x16468d(0xdd))/0x9+-parseInt(_0x16468d(0x12e))/0xa*(parseInt(_0x16468d(0x12b))/0xb);if(_0x36325d===_0x390604)break;else _0x443003['push'](_0x443003['shift']());}catch(_0x26b725){_0x443003['push'](_0x443003['shift']());}}}(a177_0x1e33,0x82bdd));const a177_0x3552a9=function(){let _0x1f3834=!![];return function(_0x247a2a,_0x569880){const _0x4f5f2a=_0x1f3834?function(){const _0xfce8b=a177_0x55ea;if(_0x569880){const _0xf704d0=_0x569880[_0xfce8b(0xfa)](_0x247a2a,arguments);return _0x569880=null,_0xf704d0;}}:function(){};return _0x1f3834=![],_0x4f5f2a;};}(),a177_0x1b3ace=a177_0x3552a9(this,function(){const _0x692ea2=a177_0x55ea;return a177_0x1b3ace['toString']()['search'](_0x692ea2(0x129))[_0x692ea2(0x122)]()[_0x692ea2(0xf6)](a177_0x1b3ace)[_0x692ea2(0x130)](_0x692ea2(0x129));});a177_0x1b3ace();'use strict';function a177_0x1e33(){const _0x5cb865=['log','branch','updateRemoteState','In\x20Progress','repoService','object','CommitComponentsJob','commitAttachmentId','deleteAttachment','commitJob','FlosumCommitJob','getBranchRecord','[ERROR]\x20','decorate','BadRequestError','getOne','toString','send','syncBranchId','message','Service','salesforceSync','9inHvJM','(((.+)+)+)+$','salesforceService','7107859sCrRtr','SalesforceService','gitManager','20RaxWBL',']\x20[Repository:\x20','search','retrieveAttachment','sha','[FLOSUM\x20->\x20GIT]\x20[','../../salesforce/services/salesforce-retriever.service','getComponentsToDelete','6668512ryFyxl','__metadata','../../../constants/errors','catch','[INFO]\x20Start\x20commit\x20job','design:paramtypes','logger','getPrefix','metadata','name','../../../core/errors/bad-request.error','getRepoService','SalesforceLogger2','GitProviderManager','1909242hjXkPA','Logger','toUpperCase','syncRepositoryId','CommitComponentsDto','../../salesforce/services/salesforce.service','fetchRepositoryData','getLoggerId','ERR_INVALID_SYNC_RECORD_ID','function','deleteAttachmentId','updateLastCommit','4343784rpAtci','repositoryData','handleCommitJobError','setStatus','commitData','length','then','error','trim','ERR_UNKNOWN_SYNC_RECORD_ID','getCommitDto','getOwnPropertyDescriptor','\x20[COMMIT]','constructor','../../../core','3990770qEJmaq','repository','apply','convertToSFDX','run','41710heNIDu','getComponentsToWrite','typedi','sfLogger','repositoryName','Error','split','exec','Completed','../../salesforce/services/salesforce-sync.service','defineProperty','user','SalesforceSyncService','all','branches','provider','branchName','96okmPda','7MrKhxG','118068lLNawa','getRepositoryRecord'];a177_0x1e33=function(){return _0x5cb865;};return a177_0x1e33();}var __decorate=this&&this['__decorate']||function(_0x3616d1,_0x2eebba,_0x462cff,_0x46beb4){const _0x3eed70=a177_0x55ea;var _0x53cfb2=arguments['length'],_0x528da2=_0x53cfb2<0x3?_0x2eebba:_0x46beb4===null?_0x46beb4=Object[_0x3eed70(0xf4)](_0x2eebba,_0x462cff):_0x46beb4,_0x5efde9;if(typeof Reflect===_0x3eed70(0x117)&&typeof Reflect[_0x3eed70(0x11f)]===_0x3eed70(0xe6))_0x528da2=Reflect[_0x3eed70(0x11f)](_0x3616d1,_0x2eebba,_0x462cff,_0x46beb4);else{for(var _0x251496=_0x3616d1[_0x3eed70(0xee)]-0x1;_0x251496>=0x0;_0x251496--)if(_0x5efde9=_0x3616d1[_0x251496])_0x528da2=(_0x53cfb2<0x3?_0x5efde9(_0x528da2):_0x53cfb2>0x3?_0x5efde9(_0x2eebba,_0x462cff,_0x528da2):_0x5efde9(_0x2eebba,_0x462cff))||_0x528da2;}return _0x53cfb2>0x3&&_0x528da2&&Object['defineProperty'](_0x2eebba,_0x462cff,_0x528da2),_0x528da2;},__metadata=this&&this[a177_0x233058(0x137)]||function(_0x29b209,_0x239d60){const _0x424d23=a177_0x233058;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x424d23(0xe6))return Reflect[_0x424d23(0x13e)](_0x29b209,_0x239d60);},FlosumCommitJob_1;Object[a177_0x233058(0x107)](exports,'__esModule',{'value':!![]}),exports[a177_0x233058(0x11c)]=void 0x0;function a177_0x55ea(_0x16c6bc,_0xe3ae5b){const _0xc357d8=a177_0x1e33();return a177_0x55ea=function(_0x1b3ace,_0x3552a9){_0x1b3ace=_0x1b3ace-0xdd;let _0x1e3373=_0xc357d8[_0x1b3ace];return _0x1e3373;},a177_0x55ea(_0x16c6bc,_0xe3ae5b);}const core_1=require(a177_0x233058(0xf7)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),salesforce_service_1=require(a177_0x233058(0xe2)),git_provider_manager_1=require('../../shared/git-provider.manager'),typedi_1=require(a177_0x233058(0xff)),errors_1=require(a177_0x233058(0x138)),bad_request_error_1=require(a177_0x233058(0x140)),salesforce_retriever_service_1=require(a177_0x233058(0x134)),salesforce_sync_service_1=require(a177_0x233058(0x106)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job');let FlosumCommitJob=FlosumCommitJob_1=class FlosumCommitJob{constructor(_0x184a36,_0x44931b,_0x1334c8,_0x3159c5){const _0x1f54e9=a177_0x233058;this[_0x1f54e9(0x12a)]=_0x184a36,this[_0x1f54e9(0x11b)]=_0x44931b,this[_0x1f54e9(0x127)]=_0x1334c8,this[_0x1f54e9(0x12d)]=_0x3159c5,this['repoService']=this[_0x1f54e9(0x12d)][_0x1f54e9(0x141)](),this[_0x1f54e9(0x13c)]=new core_1[(_0x1f54e9(0xde))](FlosumCommitJob_1[_0x1f54e9(0x13f)]);}async[a177_0x233058(0xe3)](){const _0x1c77e1=a177_0x233058;try{if(this[_0x1c77e1(0xed)][_0x1c77e1(0xe0)])this[_0x1c77e1(0xea)]=await this[_0x1c77e1(0x127)][_0x1c77e1(0x111)](this['commitData'][_0x1c77e1(0xe0)]);else this['commitData'][_0x1c77e1(0x124)]&&(this['repositoryData']=await this[_0x1c77e1(0x127)][_0x1c77e1(0x11d)](this['commitData'][_0x1c77e1(0x124)]));}catch(_0x1130c7){throw new bad_request_error_1[(_0x1c77e1(0x120))](errors_1[_0x1c77e1(0xe5)]);}}async['getComponentsToWrite'](){const _0x55c89b=a177_0x233058;if(!this[_0x55c89b(0xed)]['commitAttachmentId'])return[];const _0x4ddac2=await this['salesforceService'][_0x55c89b(0x131)](this[_0x55c89b(0xed)][_0x55c89b(0x119)])[_0x55c89b(0xef)](_0x14ba51=>_0x14ba51[_0x55c89b(0x103)]('\x20')['map'](_0x781110=>_0x781110[_0x55c89b(0xf1)]())),_0x2cec1b=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x55c89b(0x12a)]),_0x10683f=await _0x2cec1b['run'](_0x4ddac2);return _0x10683f;}async[a177_0x233058(0x135)](){const _0x4c8ed5=a177_0x233058;if(!this['commitData']['deleteAttachmentId'])return[];const _0x9e32e6=await this[_0x4c8ed5(0x12a)]['retrieveAttachment'](this[_0x4c8ed5(0xed)][_0x4c8ed5(0xe7)]);return _0x9e32e6;}async['getCommitDto'](){const _0x527c8b=a177_0x233058,_0x44b17c=new commit_components_dto_1[(_0x527c8b(0xe1))](),[_0x5d68b8,_0x5f4bb7]=await Promise[_0x527c8b(0x10a)]([this[_0x527c8b(0xfe)](),this[_0x527c8b(0x135)]()]);return _0x44b17c['message']=this[_0x527c8b(0xed)][_0x527c8b(0x125)],_0x44b17c[_0x527c8b(0x108)]=this[_0x527c8b(0xed)][_0x527c8b(0x108)],_0x44b17c['components']={'writed':_0x5d68b8,'deleted':_0x5f4bb7},_0x44b17c[_0x527c8b(0xfb)]=this[_0x527c8b(0xed)]['convertToSFDX'],_0x44b17c['repo']=this[_0x527c8b(0xf9)],_0x44b17c[_0x527c8b(0x113)]=this[_0x527c8b(0x113)],_0x44b17c[_0x527c8b(0x10c)]=this[_0x527c8b(0x10c)],_0x44b17c;}async[a177_0x233058(0xe8)](_0x1fb818=![]){const _0x2407e4=a177_0x233058;if(_0x1fb818)await this['salesforceSync'][_0x2407e4(0x114)](this['repositoryData'],{});else{const _0x48ba71=await this[_0x2407e4(0xf9)][_0x2407e4(0x10b)][_0x2407e4(0x121)](this[_0x2407e4(0x113)][_0x2407e4(0x13f)]);this['sfLogger']['log']('[INFO]\x20Update\x20remote\x20state.');const _0x523acf={[this['repository']['gitUrl']]:{'lastCommit':_0x48ba71[_0x2407e4(0x132)]}};await this[_0x2407e4(0x127)][_0x2407e4(0x114)](this[_0x2407e4(0xea)],_0x523acf);}}async[a177_0x233058(0x104)](){const _0x3f5f55=a177_0x233058,_0x59ae00=await this[_0x3f5f55(0xf3)]();await this[_0x3f5f55(0x127)][_0x3f5f55(0xec)](this['repositoryData'],_0x3f5f55(0x115)),await this[_0x3f5f55(0x11b)][_0x3f5f55(0xfc)](_0x59ae00,this[_0x3f5f55(0x100)]),await this[_0x3f5f55(0xe8)](),this[_0x3f5f55(0xed)]['commitAttachmentId']&&await this['salesforceService'][_0x3f5f55(0x11a)](this[_0x3f5f55(0xed)][_0x3f5f55(0x119)]),this[_0x3f5f55(0xed)][_0x3f5f55(0xe7)]&&await this[_0x3f5f55(0x12a)][_0x3f5f55(0x11a)](this[_0x3f5f55(0xed)][_0x3f5f55(0xe7)]),await this[_0x3f5f55(0x127)][_0x3f5f55(0xec)](this['repositoryData'],_0x3f5f55(0x105));}async[a177_0x233058(0xeb)](_0x596988){const _0x404614=a177_0x233058;try{this[_0x404614(0x100)][_0x404614(0x112)](_0x404614(0x11e)+_0x596988),await this[_0x404614(0x100)][_0x404614(0x123)](),await this[_0x404614(0xe8)](!![]),await this[_0x404614(0x127)][_0x404614(0xec)](this[_0x404614(0xea)],_0x404614(0x102));}catch(_0x5276c0){this[_0x404614(0x13c)][_0x404614(0xf0)](_0x5276c0);}}async['run'](_0x12fc0b,_0x290f1f,_0x263bac){const _0x242086=a177_0x233058;try{this[_0x242086(0xed)]=_0x12fc0b,this[_0x242086(0x10c)]=_0x263bac,await this[_0x242086(0xe3)](),this[_0x242086(0x100)]=new salesforce_logger_v2_service_1[(_0x242086(0x142))](_0x290f1f[_0x242086(0xe4)](),(_0x290f1f[_0x242086(0x13d)]()||_0x242086(0x133)+_0x263bac[_0x242086(0xdf)]()+_0x242086(0x12f)+this[_0x242086(0xea)][_0x242086(0x101)]+']\x20[Branch:\x20'+this[_0x242086(0xea)][_0x242086(0x10d)]+']')+_0x242086(0xf5));if(!this[_0x242086(0xea)])throw new bad_request_error_1['BadRequestError'](errors_1[_0x242086(0xf2)]);this[_0x242086(0xf9)]=await this[_0x242086(0x116)][_0x242086(0x121)](this[_0x242086(0xea)]['repositoryName']),this[_0x242086(0x113)]=await this[_0x242086(0xf9)]['branches']['getOne'](this[_0x242086(0xea)][_0x242086(0x10d)]),this[_0x242086(0x100)][_0x242086(0x112)](_0x242086(0x13a)),this[_0x242086(0x104)]()[_0x242086(0x139)](_0x1989ba=>this[_0x242086(0xeb)](_0x1989ba));}catch(_0xcce742){this['commitData']=undefined,this['logger'][_0x242086(0xf0)](_0xcce742);throw _0xcce742;}}};FlosumCommitJob=FlosumCommitJob_1=__decorate([typedi_1[a177_0x233058(0x126)]({'transient':!![]}),__metadata(a177_0x233058(0x13b),[salesforce_service_1[a177_0x233058(0x12c)],commit_components_job_1[a177_0x233058(0x118)],salesforce_sync_service_1[a177_0x233058(0x109)],git_provider_manager_1[a177_0x233058(0x143)]])],FlosumCommitJob),exports[a177_0x233058(0x11c)]=FlosumCommitJob;