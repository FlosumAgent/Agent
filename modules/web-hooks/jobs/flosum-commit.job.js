function a147_0x2ecf(_0x1e0da4,_0x2cd38d){const _0xcec769=a147_0x2b12();return a147_0x2ecf=function(_0x518ae6,_0x4486dd){_0x518ae6=_0x518ae6-0x1aa;let _0x2b12e=_0xcec769[_0x518ae6];return _0x2b12e;},a147_0x2ecf(_0x1e0da4,_0x2cd38d);}const a147_0x5056d3=a147_0x2ecf;function a147_0x2b12(){const _0x2c798e=['provider','CommitComponentsJob','message','syncRepositoryId','../dto/commit-components.dto','design:paramtypes','[INFO]\x20Update\x20remote\x20state.','SalesforceRetrieverService','gitManager','exec','run','ERR_UNKNOWN_SYNC_RECORD_ID','search','error','updateRemoteState','(((.+)+)+)+$','convertToSFDX','993038DJCHBs','length','4038455TRhqQJ','getRepoService','retrieveAttachment','metadata','13doKrLJ','50902lvYnMO','all','syncBranchId','toString','apply','496812kUAfDK','log','175302eMioGp','getBranchRecord','repositoryData','object','CommitComponentsDto','../../shared/git-provider.manager','user','salesforceSync','1570cDggiX','deleteAttachmentId','__decorate','../../../constants/errors',']\x20[Repository:\x20','5741451yLUkSj','typedi','gitUrl','repoService','send','./commit-components.job','decorate','repository',']\x20[Branch:\x20','flosum-commit-job','4AFNBtP','deleteAttachment','ERR_INVALID_SYNC_RECORD_ID','fetchRepositoryData','toUpperCase','salesforceService','getComponentsToWrite','119xhChrw','branchName','function','getLogger','updateLastCommit','../../salesforce/services/salesforce-sync.service','[INFO]\x20Start\x20commit\x20job','trim','FlosumCommitJob','BadRequestError','6JbgQcd','split','name','__metadata','[ERROR]\x20','__esModule','Error','setStatus','getCommitDto','getOne','setLoggerId','../../salesforce/services/salesforce.service','getOwnPropertyDescriptor','../../salesforce/services/salesforce-retriever.service','Completed','branches','8AsKFeg','defineProperty','commitAttachmentId','36443oOViDH','SalesforceSyncService','../../../core','[COMMIT]\x20[','handleCommitJobError','sha','commitJob','logger','repositoryName','getRepositoryRecord','branch','repo','commitData'];a147_0x2b12=function(){return _0x2c798e;};return a147_0x2b12();}(function(_0x49d09a,_0x5fd33){const _0x42aa99=a147_0x2ecf,_0x268578=_0x49d09a();while(!![]){try{const _0xc66b78=-parseInt(_0x42aa99(0x1e2))/0x1+parseInt(_0x42aa99(0x1e9))/0x2*(parseInt(_0x42aa99(0x1b1))/0x3)+parseInt(_0x42aa99(0x207))/0x4*(parseInt(_0x42aa99(0x1e4))/0x5)+-parseInt(_0x42aa99(0x1f0))/0x6*(-parseInt(_0x42aa99(0x20e))/0x7)+parseInt(_0x42aa99(0x1c1))/0x8*(parseInt(_0x42aa99(0x1fd))/0x9)+parseInt(_0x42aa99(0x1f8))/0xa*(-parseInt(_0x42aa99(0x1c4))/0xb)+parseInt(_0x42aa99(0x1ee))/0xc*(parseInt(_0x42aa99(0x1e8))/0xd);if(_0xc66b78===_0x5fd33)break;else _0x268578['push'](_0x268578['shift']());}catch(_0x3e9320){_0x268578['push'](_0x268578['shift']());}}}(a147_0x2b12,0x7f4e3));const a147_0x4486dd=function(){let _0x5bf500=!![];return function(_0x221c05,_0x3f00a0){const _0x1bc96f=_0x5bf500?function(){const _0x342d7a=a147_0x2ecf;if(_0x3f00a0){const _0x4f05ea=_0x3f00a0[_0x342d7a(0x1ed)](_0x221c05,arguments);return _0x3f00a0=null,_0x4f05ea;}}:function(){};return _0x5bf500=![],_0x1bc96f;};}(),a147_0x518ae6=a147_0x4486dd(this,function(){const _0x482b80=a147_0x2ecf;return a147_0x518ae6[_0x482b80(0x1ec)]()[_0x482b80(0x1dd)]('(((.+)+)+)+$')[_0x482b80(0x1ec)]()['constructor'](a147_0x518ae6)[_0x482b80(0x1dd)](_0x482b80(0x1e0));});a147_0x518ae6();'use strict';var __decorate=this&&this[a147_0x5056d3(0x1fa)]||function(_0x59fa26,_0x21e44d,_0x2e1d35,_0x45ea57){const _0x5d8082=a147_0x5056d3;var _0x4b9281=arguments[_0x5d8082(0x1e3)],_0x25543c=_0x4b9281<0x3?_0x21e44d:_0x45ea57===null?_0x45ea57=Object[_0x5d8082(0x1bd)](_0x21e44d,_0x2e1d35):_0x45ea57,_0x5cea44;if(typeof Reflect==='object'&&typeof Reflect[_0x5d8082(0x203)]===_0x5d8082(0x210))_0x25543c=Reflect[_0x5d8082(0x203)](_0x59fa26,_0x21e44d,_0x2e1d35,_0x45ea57);else{for(var _0x51f102=_0x59fa26[_0x5d8082(0x1e3)]-0x1;_0x51f102>=0x0;_0x51f102--)if(_0x5cea44=_0x59fa26[_0x51f102])_0x25543c=(_0x4b9281<0x3?_0x5cea44(_0x25543c):_0x4b9281>0x3?_0x5cea44(_0x21e44d,_0x2e1d35,_0x25543c):_0x5cea44(_0x21e44d,_0x2e1d35))||_0x25543c;}return _0x4b9281>0x3&&_0x25543c&&Object[_0x5d8082(0x1c2)](_0x21e44d,_0x2e1d35,_0x25543c),_0x25543c;},__metadata=this&&this[a147_0x5056d3(0x1b4)]||function(_0x4d3fbc,_0x457537){const _0x212b65=a147_0x5056d3;if(typeof Reflect===_0x212b65(0x1f3)&&typeof Reflect[_0x212b65(0x1e7)]===_0x212b65(0x210))return Reflect[_0x212b65(0x1e7)](_0x4d3fbc,_0x457537);};Object[a147_0x5056d3(0x1c2)](exports,a147_0x5056d3(0x1b6),{'value':!![]}),exports[a147_0x5056d3(0x1af)]=void 0x0;const core_1=require(a147_0x5056d3(0x1c6)),salesforce_service_1=require(a147_0x5056d3(0x1bc)),git_provider_manager_1=require(a147_0x5056d3(0x1f5)),typedi_1=require(a147_0x5056d3(0x1fe)),errors_1=require(a147_0x5056d3(0x1fb)),bad_request_error_1=require('../../../core/errors/bad-request.error'),salesforce_retriever_service_1=require(a147_0x5056d3(0x1be)),salesforce_sync_service_1=require(a147_0x5056d3(0x1ac)),commit_components_dto_1=require(a147_0x5056d3(0x1d5)),commit_components_job_1=require(a147_0x5056d3(0x202)),logger=new core_1['Logger'](a147_0x5056d3(0x206));let FlosumCommitJob=class FlosumCommitJob{constructor(_0x272a64,_0x42605d,_0x346ae7,_0x342283){const _0x59ff48=a147_0x5056d3;this['salesforceService']=_0x272a64,this[_0x59ff48(0x1ca)]=_0x42605d,this[_0x59ff48(0x1f7)]=_0x346ae7,this[_0x59ff48(0x1d9)]=_0x342283,this[_0x59ff48(0x200)]=this['gitManager'][_0x59ff48(0x1e5)]();}[a147_0x5056d3(0x1ef)](_0xb2c19f){const _0x470a72=a147_0x5056d3;return this[_0x470a72(0x1cb)][_0x470a72(0x1ef)](_0x470a72(0x1c7)+this[_0x470a72(0x1d9)][_0x470a72(0x1d1)][_0x470a72(0x20b)]()+_0x470a72(0x1fc)+this[_0x470a72(0x204)][_0x470a72(0x1b3)]+_0x470a72(0x205)+this[_0x470a72(0x1ce)][_0x470a72(0x1b3)]+']\x20'+_0xb2c19f);}async['fetchRepositoryData'](){const _0x276384=a147_0x5056d3;try{if(this[_0x276384(0x1d0)][_0x276384(0x1d4)])this[_0x276384(0x1f2)]=await this['salesforceSync'][_0x276384(0x1cd)](this['commitData']['syncRepositoryId']);else this[_0x276384(0x1d0)][_0x276384(0x1eb)]&&(this[_0x276384(0x1f2)]=await this[_0x276384(0x1f7)][_0x276384(0x1f1)](this['commitData']['syncBranchId']));}catch(_0x5e863b){throw new bad_request_error_1[(_0x276384(0x1b0))](errors_1[_0x276384(0x209)]);}}async[a147_0x5056d3(0x20d)](){const _0x3f40da=a147_0x5056d3;if(!this['commitData'][_0x3f40da(0x1c3)])return[];const _0x4a598b=await this[_0x3f40da(0x20c)][_0x3f40da(0x1e6)](this[_0x3f40da(0x1d0)][_0x3f40da(0x1c3)])['then'](_0x4d2cac=>_0x4d2cac[_0x3f40da(0x1b2)]('\x20')['map'](_0xe7c5a4=>_0xe7c5a4[_0x3f40da(0x1ae)]())),_0x51e8a7=new salesforce_retriever_service_1[(_0x3f40da(0x1d8))](this[_0x3f40da(0x20c)]),_0x4f06b0=await _0x51e8a7['run'](_0x4a598b);return _0x4f06b0;}async['getComponentsToDelete'](){const _0xc4ab52=a147_0x5056d3;if(!this['commitData']['deleteAttachmentId'])return[];const _0x9fca4b=await this[_0xc4ab52(0x20c)][_0xc4ab52(0x1e6)](this['commitData']['deleteAttachmentId']);return _0x9fca4b;}async[a147_0x5056d3(0x1b9)](){const _0x48cc3f=a147_0x5056d3,_0x25b975=new commit_components_dto_1[(_0x48cc3f(0x1f4))](),[_0x419162,_0x113c28]=await Promise[_0x48cc3f(0x1ea)]([this[_0x48cc3f(0x20d)](),this['getComponentsToDelete']()]);return _0x25b975[_0x48cc3f(0x1d3)]=this[_0x48cc3f(0x1d0)][_0x48cc3f(0x1d3)],_0x25b975[_0x48cc3f(0x1f6)]=this[_0x48cc3f(0x1d0)][_0x48cc3f(0x1f6)],_0x25b975['components']={'writed':_0x419162,'deleted':_0x113c28},_0x25b975[_0x48cc3f(0x1e1)]=this[_0x48cc3f(0x1d0)][_0x48cc3f(0x1e1)],_0x25b975[_0x48cc3f(0x1cf)]=this[_0x48cc3f(0x204)],_0x25b975[_0x48cc3f(0x1ce)]=this[_0x48cc3f(0x1ce)],_0x25b975;}async['updateLastCommit'](_0x17fc96=![]){const _0x440560=a147_0x5056d3;if(_0x17fc96)await this[_0x440560(0x1f7)]['updateRemoteState'](this[_0x440560(0x1f2)],{});else{const _0x462d30=await this['repository'][_0x440560(0x1c0)][_0x440560(0x1ba)](this['branch'][_0x440560(0x1b3)]);this[_0x440560(0x1ef)](_0x440560(0x1d7));const _0x44fe8a={[this[_0x440560(0x204)][_0x440560(0x1ff)]]:{'lastCommit':_0x462d30[_0x440560(0x1c9)]}};await this[_0x440560(0x1f7)][_0x440560(0x1df)](this[_0x440560(0x1f2)],_0x44fe8a);}}async[a147_0x5056d3(0x1da)](){const _0x44a009=a147_0x5056d3,_0x342f47=await this['getCommitDto']();this[_0x44a009(0x1ca)][_0x44a009(0x1cb)]=this[_0x44a009(0x1cb)],await this['salesforceSync'][_0x44a009(0x1b8)](this[_0x44a009(0x1f2)],'In\x20Progress'),await this[_0x44a009(0x1ca)]['run'](_0x342f47),await this['updateLastCommit'](),this[_0x44a009(0x1d0)]['commitAttachmentId']&&await this[_0x44a009(0x20c)][_0x44a009(0x208)](this[_0x44a009(0x1d0)][_0x44a009(0x1c3)]),this[_0x44a009(0x1d0)][_0x44a009(0x1f9)]&&await this[_0x44a009(0x20c)][_0x44a009(0x208)](this[_0x44a009(0x1d0)]['deleteAttachmentId']),await this['salesforceSync'][_0x44a009(0x1b8)](this['repositoryData'],_0x44a009(0x1bf));}async[a147_0x5056d3(0x1c8)](_0x276fc1){const _0x4cdf40=a147_0x5056d3;try{this[_0x4cdf40(0x1cb)][_0x4cdf40(0x1ef)](_0x4cdf40(0x1b5)+_0x276fc1),await this[_0x4cdf40(0x1cb)][_0x4cdf40(0x201)](),await this[_0x4cdf40(0x1ab)](!![]),await this[_0x4cdf40(0x1f7)][_0x4cdf40(0x1b8)](this[_0x4cdf40(0x1f2)],_0x4cdf40(0x1b7));}catch(_0x201240){logger['error'](_0x201240);}}async[a147_0x5056d3(0x1db)](_0x82a576,_0x10ccd3){const _0x18dfc4=a147_0x5056d3;try{this[_0x18dfc4(0x1d0)]=_0x82a576,this[_0x18dfc4(0x20c)][_0x18dfc4(0x1bb)](_0x10ccd3),this['logger']=this[_0x18dfc4(0x20c)][_0x18dfc4(0x1aa)](),await this[_0x18dfc4(0x20a)]();if(!this[_0x18dfc4(0x1f2)])throw new bad_request_error_1['BadRequestError'](errors_1[_0x18dfc4(0x1dc)]);this[_0x18dfc4(0x204)]=await this[_0x18dfc4(0x200)][_0x18dfc4(0x1ba)](this[_0x18dfc4(0x1f2)][_0x18dfc4(0x1cc)]),this[_0x18dfc4(0x1ce)]=await this[_0x18dfc4(0x204)]['branches'][_0x18dfc4(0x1ba)](this['repositoryData'][_0x18dfc4(0x20f)]),this[_0x18dfc4(0x1ef)](_0x18dfc4(0x1ad)),this[_0x18dfc4(0x1da)]()['catch'](_0x412d94=>this[_0x18dfc4(0x1c8)](_0x412d94));}catch(_0x41a87d){this['commitData']=undefined,logger[_0x18dfc4(0x1de)](_0x41a87d);throw _0x41a87d;}}};FlosumCommitJob=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a147_0x5056d3(0x1d6),[salesforce_service_1['SalesforceService'],commit_components_job_1[a147_0x5056d3(0x1d2)],salesforce_sync_service_1[a147_0x5056d3(0x1c5)],git_provider_manager_1['GitProviderManager']])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;