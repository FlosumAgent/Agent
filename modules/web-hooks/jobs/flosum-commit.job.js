const a143_0x4450=['catch','76sHMhcq','typedi','[INFO]\x20Start\x20commit\x20job','encodeBase64','Attachment','send','gitUrl','function','6971fUkcim','SalesforceRetrieverService','commitData','object','../../../core/errors/bad-request.error','decorate','syncRepositoryId','message','salesforceService','getOne','getRepositoryRecord','__esModule','173raFtKk','getComponentsToDelete','metadata','repo','95896TdmFII','[COMMIT]\x20[','../../../core','salesforceSync','../../../constants/errors','all','branches','updateLastCommit',']\x20[Branch:\x20','test','return\x20/\x22\x20+\x20this\x20+\x20\x22/','Service','commitAttachmentId','branch','commitJob','getOwnPropertyDescriptor','Logger','setStatus','../../shared/utils','CommitComponentsDto','SalesforceSyncService','log','length','repository','branchName','__decorate','5583HKWtwR','../../salesforce/services/salesforce-sync.service','191671ByhvPv','fetchRepositoryData','user','getBranchRecord','getAttachmentId','handleCommitJobError','159yjxLpB','convertToSFDX','./commit-components.job','repoService','then','patchObject','deleteAttachmentId','[INFO]\x20Update\x20remote\x20state.','getRepoService','logger','design:paramtypes','error','syncBranchId','../../shared/git-provider.manager','constructor','repositoryName','flosum-commit-job','../dto/commit-components.dto','repositoryData','../../salesforce/services/salesforce-retriever.service','defineProperty',']\x20[Repository:\x20','components','1cUsJxr','Completed','getCommitDto','name','904549KsaJSv','retrieveAttachment','__metadata','4bQaYJd','getComponentsToWrite','sha','In\x20Progress','GitProviderManager','[ERROR]\x20','SalesforceService','gitManager','../../salesforce/services/salesforce.service','ERR_UNKNOWN_SYNC_RECORD_ID','3875qhGCrF','run','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','945879tCBRtj'];function a143_0x1bfb(_0x35ebe4,_0x46b881){return a143_0x1bfb=function(_0xc1e74,_0xf9b13d){_0xc1e74=_0xc1e74-0x1d7;let _0x440eca=a143_0x4450[_0xc1e74];return _0x440eca;},a143_0x1bfb(_0x35ebe4,_0x46b881);}const a143_0x289ab9=a143_0x1bfb;(function(_0x2bdcfc,_0xb80d4e){const _0x31f598=a143_0x1bfb;while(!![]){try{const _0x3f2e99=parseInt(_0x31f598(0x1de))+-parseInt(_0x31f598(0x1e0))*parseInt(_0x31f598(0x1e8))+parseInt(_0x31f598(0x1db))*parseInt(_0x31f598(0x1f4))+parseInt(_0x31f598(0x212))*parseInt(_0x31f598(0x21a))+-parseInt(_0x31f598(0x231))*parseInt(_0x31f598(0x235))+-parseInt(_0x31f598(0x214))+-parseInt(_0x31f598(0x1f8))*parseInt(_0x31f598(0x238));if(_0x3f2e99===_0xb80d4e)break;else _0x2bdcfc['push'](_0x2bdcfc['shift']());}catch(_0x71fcf1){_0x2bdcfc['push'](_0x2bdcfc['shift']());}}}(a143_0x4450,0x78b0f));const a143_0x440eca=function(){let _0x443f87=!![];return function(_0xe33753,_0x1ad153){const _0x149df0=_0x443f87?function(){if(_0x1ad153){const _0x59245f=_0x1ad153['apply'](_0xe33753,arguments);return _0x1ad153=null,_0x59245f;}}:function(){};return _0x443f87=![],_0x149df0;};}(),a143_0xf9b13d=a143_0x440eca(this,function(){const _0xd2aa47=function(){const _0x4c8f09=a143_0x1bfb,_0x14ab3d=_0xd2aa47['constructor'](_0x4c8f09(0x202))()[_0x4c8f09(0x228)](_0x4c8f09(0x1dd));return!_0x14ab3d[_0x4c8f09(0x201)](a143_0xf9b13d);};return _0xd2aa47();});a143_0xf9b13d();'use strict';var __decorate=this&&this[a143_0x289ab9(0x211)]||function(_0x1f6c1e,_0x2c3e07,_0x37c828,_0x57e5c9){const _0x376f8a=a143_0x289ab9;var _0x52d860=arguments['length'],_0x5689cb=_0x52d860<0x3?_0x2c3e07:_0x57e5c9===null?_0x57e5c9=Object[_0x376f8a(0x207)](_0x2c3e07,_0x37c828):_0x57e5c9,_0x223eac;if(typeof Reflect===_0x376f8a(0x1eb)&&typeof Reflect[_0x376f8a(0x1ed)]===_0x376f8a(0x1e7))_0x5689cb=Reflect[_0x376f8a(0x1ed)](_0x1f6c1e,_0x2c3e07,_0x37c828,_0x57e5c9);else{for(var _0x3c271f=_0x1f6c1e[_0x376f8a(0x20e)]-0x1;_0x3c271f>=0x0;_0x3c271f--)if(_0x223eac=_0x1f6c1e[_0x3c271f])_0x5689cb=(_0x52d860<0x3?_0x223eac(_0x5689cb):_0x52d860>0x3?_0x223eac(_0x2c3e07,_0x37c828,_0x5689cb):_0x223eac(_0x2c3e07,_0x37c828))||_0x5689cb;}return _0x52d860>0x3&&_0x5689cb&&Object['defineProperty'](_0x2c3e07,_0x37c828,_0x5689cb),_0x5689cb;},__metadata=this&&this[a143_0x289ab9(0x237)]||function(_0x58b13c,_0x9e8f67){const _0x3cc3c1=a143_0x289ab9;if(typeof Reflect===_0x3cc3c1(0x1eb)&&typeof Reflect[_0x3cc3c1(0x1f6)]===_0x3cc3c1(0x1e7))return Reflect['metadata'](_0x58b13c,_0x9e8f67);};Object[a143_0x289ab9(0x22e)](exports,a143_0x289ab9(0x1f3),{'value':!![]}),exports['FlosumCommitJob']=void 0x0;const core_1=require(a143_0x289ab9(0x1fa)),salesforce_service_1=require(a143_0x289ab9(0x1d9)),git_provider_manager_1=require(a143_0x289ab9(0x227)),typedi_1=require(a143_0x289ab9(0x1e1)),errors_1=require(a143_0x289ab9(0x1fc)),bad_request_error_1=require(a143_0x289ab9(0x1ec)),salesforce_retriever_service_1=require(a143_0x289ab9(0x22d)),salesforce_sync_service_1=require(a143_0x289ab9(0x213)),utils_1=require(a143_0x289ab9(0x20a)),commit_components_dto_1=require(a143_0x289ab9(0x22b)),commit_components_job_1=require(a143_0x289ab9(0x21c)),logger=new core_1[(a143_0x289ab9(0x208))](a143_0x289ab9(0x22a));let FlosumCommitJob=class FlosumCommitJob{constructor(_0x14d927,_0x532adf,_0x51f72e,_0x3dd268){const _0x1fffe4=a143_0x289ab9;this['salesforceService']=_0x14d927,this['commitJob']=_0x532adf,this[_0x1fffe4(0x1fb)]=_0x51f72e,this[_0x1fffe4(0x1d8)]=_0x3dd268,this[_0x1fffe4(0x21d)]=this[_0x1fffe4(0x1d8)][_0x1fffe4(0x222)]();}['log'](_0x98f715){const _0xcb3d97=a143_0x289ab9;return this['logger'][_0xcb3d97(0x20d)](_0xcb3d97(0x1f9)+this['gitManager']['provider']['toUpperCase']()+_0xcb3d97(0x22f)+this[_0xcb3d97(0x20f)][_0xcb3d97(0x234)]+_0xcb3d97(0x200)+this[_0xcb3d97(0x205)]['name']+']\x20'+_0x98f715);}async[a143_0x289ab9(0x215)](){const _0x2bf7b5=a143_0x289ab9;try{if(this['commitData'][_0x2bf7b5(0x1ee)])this[_0x2bf7b5(0x22c)]=await this[_0x2bf7b5(0x1fb)][_0x2bf7b5(0x1f2)](this[_0x2bf7b5(0x1ea)][_0x2bf7b5(0x1ee)]);else this[_0x2bf7b5(0x1ea)][_0x2bf7b5(0x226)]&&(this[_0x2bf7b5(0x22c)]=await this[_0x2bf7b5(0x1fb)][_0x2bf7b5(0x217)](this['commitData'][_0x2bf7b5(0x226)]));}catch(_0x40f10c){throw new bad_request_error_1['BadRequestError'](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async[a143_0x289ab9(0x239)](){const _0x5df6d5=a143_0x289ab9;if(!this['commitData'][_0x5df6d5(0x204)])return[];const _0x4691e4=await this[_0x5df6d5(0x1f0)][_0x5df6d5(0x236)](this[_0x5df6d5(0x1ea)][_0x5df6d5(0x204)])[_0x5df6d5(0x21e)](_0x4513a8=>_0x4513a8['split']('\x20')['map'](_0x44e482=>_0x44e482['trim']())),_0x11dbda=new salesforce_retriever_service_1[(_0x5df6d5(0x1e9))](this[_0x5df6d5(0x1f0)]),_0x160a8f=await _0x11dbda[_0x5df6d5(0x1dc)](_0x4691e4);return _0x160a8f;}async[a143_0x289ab9(0x1f5)](){const _0xe6831e=a143_0x289ab9;if(!this['commitData'][_0xe6831e(0x220)])return[];const _0x45b669=await this[_0xe6831e(0x1f0)][_0xe6831e(0x236)](this[_0xe6831e(0x1ea)][_0xe6831e(0x220)]);return _0x45b669;}async[a143_0x289ab9(0x233)](){const _0x559ead=a143_0x289ab9,_0x503ad4=new commit_components_dto_1[(_0x559ead(0x20b))](),[_0x556bc6,_0x172fa6]=await Promise[_0x559ead(0x1fd)]([this['getComponentsToWrite'](),this['getComponentsToDelete']()]);return _0x503ad4['message']=this[_0x559ead(0x1ea)][_0x559ead(0x1ef)],_0x503ad4[_0x559ead(0x216)]=this[_0x559ead(0x1ea)][_0x559ead(0x216)],_0x503ad4[_0x559ead(0x230)]={'writed':_0x556bc6,'deleted':_0x172fa6},_0x503ad4[_0x559ead(0x21b)]=this[_0x559ead(0x1ea)][_0x559ead(0x21b)],_0x503ad4[_0x559ead(0x1f7)]=this[_0x559ead(0x20f)],_0x503ad4[_0x559ead(0x205)]=this['branch'],_0x503ad4;}async[a143_0x289ab9(0x1ff)](){const _0x5aada0=a143_0x289ab9,_0x325e9d=await this[_0x5aada0(0x20f)][_0x5aada0(0x1fe)]['getOne'](this[_0x5aada0(0x205)][_0x5aada0(0x234)]);this['log'](_0x5aada0(0x221));const _0x2d29ef=await this[_0x5aada0(0x1fb)][_0x5aada0(0x218)](this[_0x5aada0(0x22c)]),_0x2e345a={[this[_0x5aada0(0x20f)][_0x5aada0(0x1e6)]]:{'lastCommit':_0x325e9d[_0x5aada0(0x23a)]}};await this[_0x5aada0(0x1f0)][_0x5aada0(0x21f)](_0x5aada0(0x1e4),_0x2d29ef,{'Body':utils_1[_0x5aada0(0x1e3)](JSON['stringify'](_0x2e345a))});}async['exec'](){const _0x500a1c=a143_0x289ab9,_0x4250e1=await this['getCommitDto']();this[_0x500a1c(0x206)][_0x500a1c(0x223)]=this[_0x500a1c(0x223)],await this[_0x500a1c(0x1fb)][_0x500a1c(0x209)](this[_0x500a1c(0x22c)],_0x500a1c(0x23b)),await this['commitJob']['run'](_0x4250e1),await this[_0x500a1c(0x1ff)](),this['commitData'][_0x500a1c(0x204)]&&await this[_0x500a1c(0x1f0)]['deleteAttachment'](this['commitData'][_0x500a1c(0x204)]),this['commitData']['deleteAttachmentId']&&await this[_0x500a1c(0x1f0)]['deleteAttachment'](this[_0x500a1c(0x1ea)]['deleteAttachmentId']),await this[_0x500a1c(0x1fb)][_0x500a1c(0x209)](this[_0x500a1c(0x22c)],_0x500a1c(0x232));}async[a143_0x289ab9(0x219)](_0x2586eb){const _0x4c488f=a143_0x289ab9;try{this[_0x4c488f(0x223)][_0x4c488f(0x20d)](_0x4c488f(0x23d)+_0x2586eb),await this['logger'][_0x4c488f(0x1e5)](),await this['salesforceSync'][_0x4c488f(0x209)](this['repositoryData'],'Error');}catch(_0x165185){logger[_0x4c488f(0x225)](_0x165185);}}async['run'](_0x412648,_0x5ed5b9){const _0x118fee=a143_0x289ab9;try{this['commitData']=_0x412648,this[_0x118fee(0x1f0)]['setLoggerId'](_0x5ed5b9),this[_0x118fee(0x223)]=this[_0x118fee(0x1f0)]['getLogger'](),await this[_0x118fee(0x215)]();if(!this['repositoryData'])throw new bad_request_error_1['BadRequestError'](errors_1[_0x118fee(0x1da)]);this[_0x118fee(0x20f)]=await this['repoService'][_0x118fee(0x1f1)](this['repositoryData'][_0x118fee(0x229)]),this[_0x118fee(0x205)]=await this[_0x118fee(0x20f)][_0x118fee(0x1fe)][_0x118fee(0x1f1)](this['repositoryData'][_0x118fee(0x210)]),this[_0x118fee(0x20d)](_0x118fee(0x1e2)),this['exec']()[_0x118fee(0x1df)](_0x2551ee=>this[_0x118fee(0x219)](_0x2551ee));}catch(_0x39003c){this[_0x118fee(0x1ea)]=undefined,logger['error'](_0x39003c);throw _0x39003c;}}};FlosumCommitJob=__decorate([typedi_1[a143_0x289ab9(0x203)]({'transient':!![]}),__metadata(a143_0x289ab9(0x224),[salesforce_service_1[a143_0x289ab9(0x1d7)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a143_0x289ab9(0x20c)],git_provider_manager_1[a143_0x289ab9(0x23c)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;