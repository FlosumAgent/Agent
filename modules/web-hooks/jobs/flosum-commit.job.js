const a137_0x1406=['gitManager','decorate','repoService','syncRepositoryId','object','__metadata','../dto/commit-components.dto','deleteAttachment','../../salesforce/services/salesforce-sync.service','./commit-components.job','../../../core/errors/bad-request.error','fetchRepositoryData','user','split','getOne','ERR_UNKNOWN_SYNC_RECORD_ID','Completed','[COMMIT]\x20[Repository:\x20','syncBranchId','retrieveAttachment','stringify','commitJob','updateLastCommit','Attachment','patchObject','constructor','salesforceSync','gitUrl','commitData','then','15743TcNLLq','name','convertToSFDX','467963hywhHb','setLoggerId',']\x20[Branch:\x20','attachmentId','repositoryData','branch','map','getRepoService','getAttachmentIdByParent','1prDcew','CommitComponentsDto','550178mkDrKD','log','FlosumCommitJob','message','[INFO]\x20Start\x20commit\x20job','sha','../../../constants/errors','169615hCAyHV','run','ERR_INVALID_SYNC_RECORD_ID','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','exec','salesforceService','SalesforceService','defineProperty','907871rbevrK','setStatus','repo','design:paramtypes','__decorate','trim','BadRequestError','../../salesforce/services/salesforce-retriever.service','sfLogger','Service','branchName','__esModule','function','14lbEGAV','componentsIds','length','5WNWVbH','metadata','84269mRXoot','622154PHnqPp','typedi','branches','GitProviderManager','getBranchRecord','getRepositoryRecord','repository'];const a137_0x159370=a137_0x50bc;(function(_0x2defc5,_0x2bba86){const _0x2b1145=a137_0x50bc;while(!![]){try{const _0x6fc9bb=parseInt(_0x2b1145(0xba))+-parseInt(_0x2b1145(0xdb))*-parseInt(_0x2b1145(0xd9))+parseInt(_0x2b1145(0xc1))*parseInt(_0x2b1145(0xb8))+-parseInt(_0x2b1145(0xaf))+-parseInt(_0x2b1145(0xc9))+parseInt(_0x2b1145(0xac))*parseInt(_0x2b1145(0xd6))+parseInt(_0x2b1145(0xdc));if(_0x6fc9bb===_0x2bba86)break;else _0x2defc5['push'](_0x2defc5['shift']());}catch(_0x580881){_0x2defc5['push'](_0x2defc5['shift']());}}}(a137_0x1406,0x94674));function a137_0x50bc(_0x3b2b69,_0x4768b0){return a137_0x50bc=function(_0x2fa042,_0x3f5d93){_0x2fa042=_0x2fa042-0xab;let _0x1f3330=a137_0x1406[_0x2fa042];return _0x1f3330;},a137_0x50bc(_0x3b2b69,_0x4768b0);}const a137_0x1f3330=function(){let _0x3e4681=!![];return function(_0x4de315,_0x59b7b4){const _0x16f638=_0x3e4681?function(){if(_0x59b7b4){const _0x2ab42c=_0x59b7b4['apply'](_0x4de315,arguments);return _0x59b7b4=null,_0x2ab42c;}}:function(){};return _0x3e4681=![],_0x16f638;};}(),a137_0x3f5d93=a137_0x1f3330(this,function(){const _0x378f81=function(){const _0x3edc47=a137_0x50bc,_0x1f5377=_0x378f81['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x3edc47(0xfc)](_0x3edc47(0xc4));return!_0x1f5377['test'](a137_0x3f5d93);};return _0x378f81();});a137_0x3f5d93();'use strict';var __decorate=this&&this[a137_0x159370(0xcd)]||function(_0x4ecb57,_0x869535,_0x331a00,_0x4efef5){const _0x1cf4ac=a137_0x159370;var _0x1a07e4=arguments['length'],_0x3a39d6=_0x1a07e4<0x3?_0x869535:_0x4efef5===null?_0x4efef5=Object['getOwnPropertyDescriptor'](_0x869535,_0x331a00):_0x4efef5,_0x45be8d;if(typeof Reflect===_0x1cf4ac(0xe7)&&typeof Reflect[_0x1cf4ac(0xe4)]===_0x1cf4ac(0xd5))_0x3a39d6=Reflect[_0x1cf4ac(0xe4)](_0x4ecb57,_0x869535,_0x331a00,_0x4efef5);else{for(var _0x3fa283=_0x4ecb57[_0x1cf4ac(0xd8)]-0x1;_0x3fa283>=0x0;_0x3fa283--)if(_0x45be8d=_0x4ecb57[_0x3fa283])_0x3a39d6=(_0x1a07e4<0x3?_0x45be8d(_0x3a39d6):_0x1a07e4>0x3?_0x45be8d(_0x869535,_0x331a00,_0x3a39d6):_0x45be8d(_0x869535,_0x331a00))||_0x3a39d6;}return _0x1a07e4>0x3&&_0x3a39d6&&Object[_0x1cf4ac(0xc8)](_0x869535,_0x331a00,_0x3a39d6),_0x3a39d6;},__metadata=this&&this[a137_0x159370(0xe8)]||function(_0x2d95a7,_0xfc2e3a){const _0x1025e4=a137_0x159370;if(typeof Reflect==='object'&&typeof Reflect[_0x1025e4(0xda)]==='function')return Reflect[_0x1025e4(0xda)](_0x2d95a7,_0xfc2e3a);};Object[a137_0x159370(0xc8)](exports,a137_0x159370(0xd4),{'value':!![]}),exports[a137_0x159370(0xbc)]=void 0x0;const salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require('../../shared/git-provider.manager'),typedi_1=require(a137_0x159370(0xdd)),errors_1=require(a137_0x159370(0xc0)),bad_request_error_1=require(a137_0x159370(0xed)),salesforce_retriever_service_1=require(a137_0x159370(0xd0)),salesforce_sync_service_1=require(a137_0x159370(0xeb)),utils_1=require('../../shared/utils'),commit_components_dto_1=require(a137_0x159370(0xe9)),commit_components_job_1=require(a137_0x159370(0xec));let FlosumCommitJob=class FlosumCommitJob{constructor(_0x254509,_0x57070a,_0x212dc6,_0xdf6bb2){const _0x313537=a137_0x159370;this[_0x313537(0xc6)]=_0x254509,this[_0x313537(0xf8)]=_0x57070a,this[_0x313537(0xfd)]=_0x212dc6,this[_0x313537(0xe3)]=_0xdf6bb2,this[_0x313537(0xe5)]=this[_0x313537(0xe3)][_0x313537(0xb6)](),_0x57070a['retriever']=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x313537(0xc6)]),_0x57070a['on'](_0x313537(0xbb),_0x922663=>this[_0x313537(0xd1)](_0x922663));}async['sfLogger'](_0x765a1f){const _0x172e85=a137_0x159370;return this['salesforceService']['sendLog'](_0x172e85(0xf4)+this[_0x172e85(0xe2)][_0x172e85(0xad)]+_0x172e85(0xb1)+this['branch'][_0x172e85(0xad)]+']\x20'+_0x765a1f);}async[a137_0x159370(0xee)](){const _0x2cb47e=a137_0x159370;try{if(this['commitData'][_0x2cb47e(0xe6)])this[_0x2cb47e(0xb3)]=await this[_0x2cb47e(0xfd)][_0x2cb47e(0xe1)](this['commitData'][_0x2cb47e(0xe6)]);else this['commitData'][_0x2cb47e(0xf5)]&&(this[_0x2cb47e(0xb3)]=await this[_0x2cb47e(0xfd)][_0x2cb47e(0xe0)](this[_0x2cb47e(0xff)][_0x2cb47e(0xf5)]));}catch(_0x2c7af9){throw new bad_request_error_1['BadRequestError'](errors_1[_0x2cb47e(0xc3)]);}}async['getCommitDto'](){const _0x49cd68=a137_0x159370,_0x4df1e0=new commit_components_dto_1[(_0x49cd68(0xb9))](),_0x1b35d9=await this[_0x49cd68(0xc6)][_0x49cd68(0xf6)](this[_0x49cd68(0xff)][_0x49cd68(0xb2)])[_0x49cd68(0xab)](_0x5c9912=>_0x5c9912[_0x49cd68(0xf0)]('\x20')[_0x49cd68(0xb5)](_0x56c0a0=>_0x56c0a0[_0x49cd68(0xce)]()));return _0x4df1e0[_0x49cd68(0xbd)]=this['commitData']['message'],_0x4df1e0[_0x49cd68(0xef)]=this[_0x49cd68(0xff)]['user'],_0x4df1e0[_0x49cd68(0xd7)]=_0x1b35d9,_0x4df1e0[_0x49cd68(0xae)]=this[_0x49cd68(0xff)][_0x49cd68(0xae)],_0x4df1e0[_0x49cd68(0xcb)]=this[_0x49cd68(0xe2)],_0x4df1e0[_0x49cd68(0xb4)]=this[_0x49cd68(0xb4)],_0x4df1e0;}async[a137_0x159370(0xf9)](){const _0x57e967=a137_0x159370,_0x2225c6=await this[_0x57e967(0xe2)][_0x57e967(0xde)][_0x57e967(0xf1)](this['branch'][_0x57e967(0xad)]);await this[_0x57e967(0xd1)]('[INFO]\x20Update\x20remote\x20state.');const _0x360494=await this[_0x57e967(0xfd)][_0x57e967(0xb7)](this[_0x57e967(0xb3)]['objectId']),_0x2fb36b={[this['repository'][_0x57e967(0xfe)]]:{'lastCommit':_0x2225c6[_0x57e967(0xbf)]}};await this[_0x57e967(0xc6)][_0x57e967(0xfb)](_0x57e967(0xfa),_0x360494,{'Body':utils_1['encodeBase64'](JSON[_0x57e967(0xf7)](_0x2fb36b))});}async[a137_0x159370(0xc5)](){const _0x5eb380=a137_0x159370,_0x2516f4=await this['getCommitDto']();await this[_0x5eb380(0xfd)][_0x5eb380(0xca)](this[_0x5eb380(0xb3)],'In\x20Progress'),await this['commitJob']['run'](_0x2516f4),await this[_0x5eb380(0xf9)](),await this[_0x5eb380(0xc6)][_0x5eb380(0xea)](this[_0x5eb380(0xff)][_0x5eb380(0xb2)]),await this['salesforceSync'][_0x5eb380(0xca)](this[_0x5eb380(0xb3)],_0x5eb380(0xf3));}async[a137_0x159370(0xc2)](_0x338131,_0x405c1b){const _0xbcec83=a137_0x159370;try{this[_0xbcec83(0xff)]=_0x338131,this[_0xbcec83(0xc6)][_0xbcec83(0xb0)](_0x405c1b),await this[_0xbcec83(0xee)]();if(!this[_0xbcec83(0xb3)])throw new bad_request_error_1[(_0xbcec83(0xcf))](errors_1[_0xbcec83(0xf2)]);this[_0xbcec83(0xe2)]=await this['repoService'][_0xbcec83(0xf1)](this[_0xbcec83(0xb3)]['repositoryName']),this[_0xbcec83(0xb4)]=await this['repository'][_0xbcec83(0xde)][_0xbcec83(0xf1)](this[_0xbcec83(0xb3)][_0xbcec83(0xd3)]),await this[_0xbcec83(0xd1)](_0xbcec83(0xbe)),this[_0xbcec83(0xc5)]()['catch'](_0x71ea74=>{const _0x4f9043=_0xbcec83;this[_0x4f9043(0xd1)]('[ERROR]\x20'+(_0x71ea74['message']||_0x71ea74));});}catch(_0x29afce){this[_0xbcec83(0xff)]=undefined;throw _0x29afce;}}};FlosumCommitJob=__decorate([typedi_1[a137_0x159370(0xd2)]({'transient':!![]}),__metadata(a137_0x159370(0xcc),[salesforce_service_1[a137_0x159370(0xc7)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a137_0x159370(0xdf)]])],FlosumCommitJob),exports[a137_0x159370(0xbc)]=FlosumCommitJob;