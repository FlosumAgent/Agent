const a119_0x3fea=['gitCredentials','function','__importStar','__decorate','apply','../../internal/shell.internal','fileName','createEmptyPackageXml','\x20components','../../../core','1117012LLGGEs','rm\x20-rf\x20','test','constructor','GitProviderManager','../../../core/errors/internal-server.error','Logger','BadRequestError','SFDX','start\x20retrieving\x20components','__esModule','default','MDApiWriter','now','split','GIT_STATUS_CHECK_INTERVAL','log','InternalServerError','AuthSettingsService','design:paramtypes','defineProperty','commitId','MDApiParser','673589IEAFbb','convertToSFDX','branches','503630gkhcOR','flosum-commit-job','object','replace','Done\x20','../../../constants/errors','Clonning\x20repository','repo','retrieve','baseDir','commit\x20%s\x20took\x20%dms\x20to\x20proceed\x20%d\x20components','../../../core/errors/bad-request.error','SalesforceService','MDAPI_DIR','create','../../sfdx/services/salesforce.service','data','FlosumCommitJob','Git','decorate','16635StBiRE','salesforceService','../../parsers/mdapi','mdapiToSource','sort','hasOwnProperty','join','call','run','connect\x20to\x20salesforce','../../shared/git-provider.manager','add\x20retrieved\x20components\x20to\x20commit','currentJob','__metadata','length','../../parsers/mdapi/child-types','retrieveComponents','__setModuleDefault','start','Recieved\x20commit\x20to\x20proceed.\x20Branch\x20-\x20','fileType','message','authSettings','body','deleteCommit','../../internal/git.internal','set\x20credentials\x20{\x20name:\x20%s,\x20email:\x20%s\x20}','createEmptyProjectJson','getRepoService','add','getOne','send\x20DELETE\x20commit\x20id\x20%s','Shell','11mSiiZY','retrieveAttachment','https://','Service','credentials','nothing\x20to\x20commit','17811kVlvOK','sleep','setComponentIds','sfLogger','Job','info','commit\x20files\x20with\x20message\x20\x22%s\x22','ERR_JOB_IS_NOT_DONE','trim','metadata','typedi','getOwnPropertyDescriptor','commit','[CID:\x20','exec','675335UShBve','COMPONENTS_PER_TICK','path','map','FlosumRetriever','user','MAX_GIT_STATUS_CHECK','push','return\x20/\x22\x20+\x20this\x20+\x20\x22/','63878DwWSoj','includes','status'];const a119_0x4e159a=a119_0x42e5;(function(_0x2f8a12,_0x5ae92c){const _0x4865a2=a119_0x42e5;while(!![]){try{const _0xb968d3=parseInt(_0x4865a2(0xde))+parseInt(_0x4865a2(0x12b))+parseInt(_0x4865a2(0xe1))+parseInt(_0x4865a2(0x11c))+parseInt(_0x4865a2(0xf5))*-parseInt(_0x4865a2(0x116))+parseInt(_0x4865a2(0x134))+-parseInt(_0x4865a2(0x141));if(_0xb968d3===_0x5ae92c)break;else _0x2f8a12['push'](_0x2f8a12['shift']());}catch(_0x588e81){_0x2f8a12['push'](_0x2f8a12['shift']());}}}(a119_0x3fea,0x9ad86));const a119_0x419f0c=function(){let _0x1aac23=!![];return function(_0x2c7fed,_0x2c631a){const _0x212d52=_0x1aac23?function(){const _0x3d39a2=a119_0x42e5;if(_0x2c631a){const _0x5ab9e5=_0x2c631a[_0x3d39a2(0x13b)](_0x2c7fed,arguments);return _0x2c631a=null,_0x5ab9e5;}}:function(){};return _0x1aac23=![],_0x212d52;};}(),a119_0x1a4979=a119_0x419f0c(this,function(){const _0x562c60=function(){const _0x1dba72=a119_0x42e5,_0x24f744=_0x562c60[_0x1dba72(0xca)](_0x1dba72(0x133))()[_0x1dba72(0xca)]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x24f744[_0x1dba72(0x143)](a119_0x1a4979);};return _0x562c60();});a119_0x1a4979();'use strict';var __createBinding=this&&this['__createBinding']||(Object['create']?function(_0x551499,_0x8a3184,_0xd21b1a,_0x5f47ad){if(_0x5f47ad===undefined)_0x5f47ad=_0xd21b1a;Object['defineProperty'](_0x551499,_0x5f47ad,{'enumerable':!![],'get':function(){return _0x8a3184[_0xd21b1a];}});}:function(_0x417240,_0x5df341,_0xc4cf99,_0x21d346){if(_0x21d346===undefined)_0x21d346=_0xc4cf99;_0x417240[_0x21d346]=_0x5df341[_0xc4cf99];}),__setModuleDefault=this&&this[a119_0x4e159a(0x106)]||(Object[a119_0x4e159a(0xef)]?function(_0x31b01f,_0x35fd34){Object['defineProperty'](_0x31b01f,'default',{'enumerable':!![],'value':_0x35fd34});}:function(_0x2790b7,_0x4d12bc){_0x2790b7['default']=_0x4d12bc;}),__decorate=this&&this[a119_0x4e159a(0x13a)]||function(_0x107edf,_0x4e49e0,_0x43ab53,_0x192752){const _0x507ef6=a119_0x4e159a;var _0x5e4450=arguments[_0x507ef6(0x103)],_0xd6a118=_0x5e4450<0x3?_0x4e49e0:_0x192752===null?_0x192752=Object[_0x507ef6(0x127)](_0x4e49e0,_0x43ab53):_0x192752,_0x149e20;if(typeof Reflect===_0x507ef6(0xe3)&&typeof Reflect[_0x507ef6(0xf4)]===_0x507ef6(0x138))_0xd6a118=Reflect[_0x507ef6(0xf4)](_0x107edf,_0x4e49e0,_0x43ab53,_0x192752);else{for(var _0x49d7f8=_0x107edf[_0x507ef6(0x103)]-0x1;_0x49d7f8>=0x0;_0x49d7f8--)if(_0x149e20=_0x107edf[_0x49d7f8])_0xd6a118=(_0x5e4450<0x3?_0x149e20(_0xd6a118):_0x5e4450>0x3?_0x149e20(_0x4e49e0,_0x43ab53,_0xd6a118):_0x149e20(_0x4e49e0,_0x43ab53))||_0xd6a118;}return _0x5e4450>0x3&&_0xd6a118&&Object[_0x507ef6(0xdb)](_0x4e49e0,_0x43ab53,_0xd6a118),_0xd6a118;},__importStar=this&&this[a119_0x4e159a(0x139)]||function(_0x47e87d){const _0x4a2389=a119_0x4e159a;if(_0x47e87d&&_0x47e87d[_0x4a2389(0xd1)])return _0x47e87d;var _0xd2e436={};if(_0x47e87d!=null){for(var _0x37c51c in _0x47e87d)if(_0x37c51c!=='default'&&Object['prototype'][_0x4a2389(0xfa)][_0x4a2389(0xfc)](_0x47e87d,_0x37c51c))__createBinding(_0xd2e436,_0x47e87d,_0x37c51c);}return __setModuleDefault(_0xd2e436,_0x47e87d),_0xd2e436;},__metadata=this&&this[a119_0x4e159a(0x102)]||function(_0x2be6ae,_0x4066ec){const _0x2a2f0e=a119_0x4e159a;if(typeof Reflect==='object'&&typeof Reflect[_0x2a2f0e(0x125)]==='function')return Reflect[_0x2a2f0e(0x125)](_0x2be6ae,_0x4066ec);},__importDefault=this&&this['__importDefault']||function(_0x44c44b){const _0x145f14=a119_0x4e159a;return _0x44c44b&&_0x44c44b[_0x145f14(0xd1)]?_0x44c44b:{'default':_0x44c44b};};Object[a119_0x4e159a(0xdb)](exports,a119_0x4e159a(0xd1),{'value':!![]}),exports[a119_0x4e159a(0xf2)]=void 0x0;const errors_1=require(a119_0x4e159a(0xe6)),core_1=require(a119_0x4e159a(0x140)),bad_request_error_1=require(a119_0x4e159a(0xec)),git_internal_1=require(a119_0x4e159a(0x10e)),shell_internal_1=require(a119_0x4e159a(0x13c)),salesforce_service_1=require(a119_0x4e159a(0xf0)),flosum_retriever_util_1=require('../../sfdx/utils/flosum-retriever.util'),git_provider_manager_1=require(a119_0x4e159a(0xff)),auth_settings_service_1=require('../../shared/services/auth-settings.service'),utils_1=require('../../shared/utils'),path_1=__importDefault(require(a119_0x4e159a(0x12d))),typedi_1=__importStar(require(a119_0x4e159a(0x126))),internal_server_error_1=require(a119_0x4e159a(0xcc)),mdapi_1=require(a119_0x4e159a(0xf7)),child_types_1=__importDefault(require(a119_0x4e159a(0x104))),writer_1=require('../../parsers/mdapi/writer'),sfdx_1=require('../../sfdx/utils/sfdx'),job_1=require('./job'),logger=new core_1[(a119_0x4e159a(0xcd))](a119_0x4e159a(0xe2));let FlosumCommitJob=class FlosumCommitJob extends job_1[a119_0x4e159a(0x120)]{constructor(_0x2bd4c4,_0x76996a){const _0x1eecff=a119_0x4e159a;super(),this[_0x1eecff(0x10b)]=_0x2bd4c4,this['salesforceService']=_0x76996a,this[_0x1eecff(0xee)]='mdapi',this[_0x1eecff(0x12c)]=0x3e8,this['MAX_GIT_STATUS_CHECK']=0xa,this[_0x1eecff(0xd6)]=0xbb8;}get[a119_0x4e159a(0x11a)](){const _0x3ec909=a119_0x4e159a;return this['authSettings'][_0x3ec909(0x137)];}get[a119_0x4e159a(0xdc)](){const _0xc9af9d=a119_0x4e159a;var _0x1fe984;return(_0x1fe984=this[_0xc9af9d(0x101)])===null||_0x1fe984===void 0x0?void 0x0:_0x1fe984['id'];}async['sfLogger'](_0x6389c6){const _0x415125=a119_0x4e159a;return this[_0x415125(0xf6)][_0x415125(0xd7)](_0x415125(0x129)+this[_0x415125(0xdc)]+']\x20'+_0x6389c6);}async[a119_0x4e159a(0xdf)](_0x12db9f){const _0x231096=a119_0x4e159a;try{const _0x303e34=path_1[_0x231096(0xd2)]['join'](_0x12db9f,this[_0x231096(0xee)]);await sfdx_1[_0x231096(0xcf)][_0x231096(0x110)](_0x12db9f),await sfdx_1[_0x231096(0xcf)][_0x231096(0x13e)](_0x303e34),await sfdx_1['SFDX'][_0x231096(0xf8)](_0x303e34,_0x12db9f),await shell_internal_1[_0x231096(0x115)][_0x231096(0x12a)](_0x231096(0x142)+_0x303e34);}catch(_0x4cc576){throw new internal_server_error_1[(_0x231096(0xd8))](_0x4cc576);}}async[a119_0x4e159a(0x105)](_0x35876a,_0xa36a35){const _0x459021=a119_0x4e159a;this[_0x459021(0x11f)]('Start\x20retrieve\x20components\x20job');const {convertToSFDX:_0x11d6e2}=this[_0x459021(0x101)][_0x459021(0xf1)],_0x592202=typedi_1[_0x459021(0xd2)]['get'](flosum_retriever_util_1[_0x459021(0x12f)]);_0x592202[_0x459021(0x11e)](_0xa36a35);const _0x1b1044=new mdapi_1[(_0x459021(0xdd))](),_0x427e2b=await _0x592202[_0x459021(0xe9)]();_0x427e2b[_0x459021(0xf9)](_0x4be653=>child_types_1['default'][_0x459021(0x135)](_0x4be653[_0x459021(0x109)])?0x1:-0x1);let _0xa2c15e=0x0;while(_0x427e2b[_0x459021(0x103)]){const _0x29b4ce=await _0x1b1044[_0x459021(0xfd)](_0x427e2b['splice'](0x0,this['COMPONENTS_PER_TICK'])[_0x459021(0x12e)](_0xf89b16=>({'name':_0xf89b16[_0x459021(0x13d)],'type':_0xf89b16[_0x459021(0x109)],'body':_0xf89b16[_0x459021(0x10c)]}))),_0x4ec1fc=new writer_1[(_0x459021(0xd3))](_0x29b4ce,path_1[_0x459021(0xd2)][_0x459021(0xfb)](_0x35876a,_0x11d6e2?this['MDAPI_DIR']:''));await _0x4ec1fc[_0x459021(0x107)](),_0xa2c15e+=_0x29b4ce[_0x459021(0x103)],logger['log']('Done\x20'+_0xa2c15e+'/'+_0xa36a35[_0x459021(0x103)]+_0x459021(0x13f)),this[_0x459021(0x11f)](_0x459021(0xe5)+_0xa2c15e+'/'+_0xa36a35[_0x459021(0x103)]+_0x459021(0x13f));}this[_0x459021(0x101)]['data'][_0x459021(0xdf)]&&await this[_0x459021(0xdf)](_0x35876a);}async[a119_0x4e159a(0x12a)](_0xe7721f){const _0x2a1979=a119_0x4e159a,_0x4b8bd5=Date[_0x2a1979(0xd4)](),{commitId:_0x28e614,branch:_0x35089a,attachmentId:_0x5706a3,message:_0x155e9b}=this[_0x2a1979(0x101)][_0x2a1979(0xf1)];logger[_0x2a1979(0x121)](_0x2a1979(0xfe)),await this[_0x2a1979(0xf6)]['connect'](),this[_0x2a1979(0x11f)](_0x2a1979(0x108)+_0x35089a);const _0x11740c=[];try{const _0x85e8a6=await this['salesforceService'][_0x2a1979(0x117)](_0x5706a3);_0x11740c[_0x2a1979(0x132)](..._0x85e8a6[_0x2a1979(0xd5)]('\x20')[_0x2a1979(0x12e)](_0x5348f6=>_0x5348f6[_0x2a1979(0x124)]()));const {gitUrl:_0x3033b7}=_0xe7721f,_0x42a10e=_0x3033b7[_0x2a1979(0xe4)](/https\:\/\/(.+@)?/,_0x2a1979(0x118)+this[_0x2a1979(0x11a)]+'@');logger['info']('clonning\x20repository\x20from\x20%s',_0x42a10e),this['sfLogger'](_0x2a1979(0xe7));const _0x4f1513=await git_internal_1[_0x2a1979(0xf3)]['clone'](_0x42a10e,_0x28e614,_0x35089a),{name:_0x4811a6,email:_0xc54011}=this['currentJob'][_0x2a1979(0xf1)][_0x2a1979(0x130)];logger[_0x2a1979(0x121)](_0x2a1979(0x10f),_0x4811a6,_0xc54011),await _0x4f1513['setCredentials'](_0x4811a6,_0xc54011),logger['info'](_0x2a1979(0xd0)),await this[_0x2a1979(0x105)](_0x4f1513[_0x2a1979(0xea)],_0x11740c),logger[_0x2a1979(0x121)](_0x2a1979(0x100)),await _0x4f1513[_0x2a1979(0x112)]('.'),logger[_0x2a1979(0x121)](_0x2a1979(0x122),_0x155e9b);try{await _0x4f1513[_0x2a1979(0x128)](_0x155e9b);}catch(_0x1dd6d4){let _0x5951ee=0x0;do{_0x5951ee++;const _0x543d58=await _0x4f1513[_0x2a1979(0x136)]()['catch'](_0x23ca60=>_0x23ca60[_0x2a1979(0x10a)]||_0x23ca60);if(_0x543d58[_0x2a1979(0x135)](_0x2a1979(0x11b))){_0x5951ee=0x0;break;}await utils_1[_0x2a1979(0x11d)](this[_0x2a1979(0xd6)]);}while(_0x5951ee<this[_0x2a1979(0x131)]);if(_0x5951ee===this[_0x2a1979(0x131)])throw _0x1dd6d4;}this[_0x2a1979(0x11f)]('Push\x20commit\x20to\x20branch'),logger['info']('push\x20commit\x20to\x20branch\x20\x22%s\x22',_0x35089a),await _0x4f1513['push'](_0x35089a),logger[_0x2a1979(0x121)]('remove\x20git\x20repository\x20folder\x20'+_0x4f1513[_0x2a1979(0xea)]),await shell_internal_1[_0x2a1979(0x115)]['exec'](_0x2a1979(0x142)+_0x4f1513[_0x2a1979(0xea)]),logger['info'](_0x2a1979(0x114),_0x28e614),await this[_0x2a1979(0xf6)][_0x2a1979(0x10d)](_0x28e614);}catch(_0x23ebcc){this['sfLogger']('[ERROR]\x20'+(_0x23ebcc[_0x2a1979(0x10a)]||_0x23ebcc)),console[_0x2a1979(0xd7)]({'error':_0x23ebcc});}finally{logger['info'](_0x2a1979(0xeb),_0x28e614,Date[_0x2a1979(0xd4)]()-_0x4b8bd5,_0x11740c[_0x2a1979(0x103)]),this['currentJob']=undefined;}}async[a119_0x4e159a(0xfd)](_0x43b3a4){const _0x482ea9=a119_0x4e159a;if(this[_0x482ea9(0x101)])throw new bad_request_error_1[(_0x482ea9(0xce))](errors_1[_0x482ea9(0x123)]);try{this[_0x482ea9(0x101)]=_0x43b3a4;const _0x27f5a8=typedi_1[_0x482ea9(0xd2)]['get'](git_provider_manager_1[_0x482ea9(0xcb)])[_0x482ea9(0x111)](),_0x1c7fb0=await _0x27f5a8[_0x482ea9(0x113)](_0x43b3a4[_0x482ea9(0xf1)][_0x482ea9(0xe8)]);await _0x1c7fb0[_0x482ea9(0xe0)][_0x482ea9(0x113)](_0x43b3a4[_0x482ea9(0xf1)]['branch']),this[_0x482ea9(0x12a)](_0x1c7fb0);}catch(_0x294367){this[_0x482ea9(0x101)]=undefined;throw _0x294367;}}};function a119_0x42e5(_0x30bcb6,_0x486ad6){return a119_0x42e5=function(_0x248aa8,_0x1a4979){_0x248aa8=_0x248aa8-0xca;let _0x419f0c=a119_0x3fea[_0x248aa8];return _0x419f0c;},a119_0x42e5(_0x30bcb6,_0x486ad6);}FlosumCommitJob=__decorate([typedi_1[a119_0x4e159a(0x119)](),__metadata(a119_0x4e159a(0xda),[auth_settings_service_1[a119_0x4e159a(0xd9)],salesforce_service_1[a119_0x4e159a(0xed)]])],FlosumCommitJob),exports[a119_0x4e159a(0xf2)]=FlosumCommitJob;