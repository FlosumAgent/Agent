function a147_0x35d0(){const _0x349c55=['../../../constants/errors','getComponentsToDelete','gitUrl','branch','[INFO]\x20Update\x20remote\x20state.','8LlwEwx','707672piPQCZ','getRepoService','components','getRepositoryRecord','Logger','defineProperty','getCommitDto','setStatus','setLoggerId','../../../core/errors/bad-request.error','Service','../../salesforce/services/salesforce-sync.service','exec','gitManager','2rpvfwY','metadata','commitAttachmentId','user','BadRequestError','__esModule','[COMMIT]\x20[','salesforceSync','toString','apply','deleteAttachmentId','627662vrTDWR','getBranchRecord','1108815hDtrOd','handleCommitJobError','commitData','160715yIWKli','SalesforceRetrieverService','then','1978770DUMyae','design:paramtypes','3266343NDJkQO','catch','__decorate','updateRemoteState','[INFO]\x20Start\x20commit\x20job','../../shared/git-provider.manager','retrieveAttachment','salesforceService','name','syncRepositoryId','Error','function','ERR_UNKNOWN_SYNC_RECORD_ID','CommitComponentsDto','decorate','getComponentsToWrite','length','toUpperCase','logger','In\x20Progress','Completed','repositoryData','CommitComponentsJob','../dto/commit-components.dto','convertToSFDX','(((.+)+)+)+$','object','../../salesforce/services/salesforce-retriever.service','repositoryName','branches','commitJob','message','getOne','updateLastCommit','send','log','deleteAttachment',']\x20[Branch:\x20','repository','../../../core','SalesforceSyncService','error','repo','syncBranchId','GitProviderManager','ERR_INVALID_SYNC_RECORD_ID','search','repoService','207750YVaTcu','FlosumCommitJob'];a147_0x35d0=function(){return _0x349c55;};return a147_0x35d0();}const a147_0x5153c4=a147_0x2dfd;(function(_0x4afb66,_0x44d6e5){const _0x17d18f=a147_0x2dfd,_0x5cd02d=_0x4afb66();while(!![]){try{const _0x2e2c09=-parseInt(_0x17d18f(0x1c8))/0x1*(-parseInt(_0x17d18f(0x1b8))/0x2)+-parseInt(_0x17d18f(0x1fd))/0x3+-parseInt(_0x17d18f(0x205))/0x4+parseInt(_0x17d18f(0x1c5))/0x5+parseInt(_0x17d18f(0x1cb))/0x6+parseInt(_0x17d18f(0x1c3))/0x7+-parseInt(_0x17d18f(0x204))/0x8*(parseInt(_0x17d18f(0x1cd))/0x9);if(_0x2e2c09===_0x44d6e5)break;else _0x5cd02d['push'](_0x5cd02d['shift']());}catch(_0x23efc6){_0x5cd02d['push'](_0x5cd02d['shift']());}}}(a147_0x35d0,0x2f14c));const a147_0x328a6f=function(){let _0xc78ad=!![];return function(_0x1d3640,_0x1601a4){const _0x1df9b3=_0xc78ad?function(){const _0x402c5c=a147_0x2dfd;if(_0x1601a4){const _0x3e3776=_0x1601a4[_0x402c5c(0x1c1)](_0x1d3640,arguments);return _0x1601a4=null,_0x3e3776;}}:function(){};return _0xc78ad=![],_0x1df9b3;};}(),a147_0x163f61=a147_0x328a6f(this,function(){const _0x2204ca=a147_0x2dfd;return a147_0x163f61[_0x2204ca(0x1c0)]()[_0x2204ca(0x1fb)](_0x2204ca(0x1e6))['toString']()['constructor'](a147_0x163f61)[_0x2204ca(0x1fb)](_0x2204ca(0x1e6));});function a147_0x2dfd(_0x886fc0,_0x3e47ca){const _0x20965e=a147_0x35d0();return a147_0x2dfd=function(_0x163f61,_0x328a6f){_0x163f61=_0x163f61-0x1af;let _0x35d055=_0x20965e[_0x163f61];return _0x35d055;},a147_0x2dfd(_0x886fc0,_0x3e47ca);}a147_0x163f61();'use strict';var __decorate=this&&this[a147_0x5153c4(0x1cf)]||function(_0x486437,_0x51e9c4,_0x387e9a,_0x2a4085){const _0x46d698=a147_0x5153c4;var _0x2f6b37=arguments[_0x46d698(0x1dd)],_0x14156c=_0x2f6b37<0x3?_0x51e9c4:_0x2a4085===null?_0x2a4085=Object['getOwnPropertyDescriptor'](_0x51e9c4,_0x387e9a):_0x2a4085,_0x300590;if(typeof Reflect===_0x46d698(0x1e7)&&typeof Reflect[_0x46d698(0x1db)]===_0x46d698(0x1d8))_0x14156c=Reflect[_0x46d698(0x1db)](_0x486437,_0x51e9c4,_0x387e9a,_0x2a4085);else{for(var _0x35ef44=_0x486437[_0x46d698(0x1dd)]-0x1;_0x35ef44>=0x0;_0x35ef44--)if(_0x300590=_0x486437[_0x35ef44])_0x14156c=(_0x2f6b37<0x3?_0x300590(_0x14156c):_0x2f6b37>0x3?_0x300590(_0x51e9c4,_0x387e9a,_0x14156c):_0x300590(_0x51e9c4,_0x387e9a))||_0x14156c;}return _0x2f6b37>0x3&&_0x14156c&&Object[_0x46d698(0x1af)](_0x51e9c4,_0x387e9a,_0x14156c),_0x14156c;},__metadata=this&&this['__metadata']||function(_0x4867ff,_0x235c11){const _0x55c489=a147_0x5153c4;if(typeof Reflect===_0x55c489(0x1e7)&&typeof Reflect[_0x55c489(0x1b9)]===_0x55c489(0x1d8))return Reflect['metadata'](_0x4867ff,_0x235c11);};Object[a147_0x5153c4(0x1af)](exports,a147_0x5153c4(0x1bd),{'value':!![]}),exports[a147_0x5153c4(0x1fe)]=void 0x0;const core_1=require(a147_0x5153c4(0x1f4)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a147_0x5153c4(0x1d2)),typedi_1=require('typedi'),errors_1=require(a147_0x5153c4(0x1ff)),bad_request_error_1=require(a147_0x5153c4(0x1b3)),salesforce_retriever_service_1=require(a147_0x5153c4(0x1e8)),salesforce_sync_service_1=require(a147_0x5153c4(0x1b5)),commit_components_dto_1=require(a147_0x5153c4(0x1e4)),commit_components_job_1=require('./commit-components.job'),logger=new core_1[(a147_0x5153c4(0x209))]('flosum-commit-job');let FlosumCommitJob=class FlosumCommitJob{constructor(_0xe9b98d,_0x43936e,_0x30df44,_0x27527e){const _0x26900a=a147_0x5153c4;this[_0x26900a(0x1d4)]=_0xe9b98d,this[_0x26900a(0x1eb)]=_0x43936e,this[_0x26900a(0x1bf)]=_0x30df44,this[_0x26900a(0x1b7)]=_0x27527e,this[_0x26900a(0x1fc)]=this[_0x26900a(0x1b7)][_0x26900a(0x206)]();}[a147_0x5153c4(0x1f0)](_0x5f5398){const _0x16e741=a147_0x5153c4;return this['logger'][_0x16e741(0x1f0)](_0x16e741(0x1be)+this[_0x16e741(0x1b7)]['provider'][_0x16e741(0x1de)]()+']\x20[Repository:\x20'+this[_0x16e741(0x1f3)]['name']+_0x16e741(0x1f2)+this[_0x16e741(0x202)][_0x16e741(0x1d5)]+']\x20'+_0x5f5398);}async['fetchRepositoryData'](){const _0x44a2e0=a147_0x5153c4;try{if(this['commitData'][_0x44a2e0(0x1d6)])this['repositoryData']=await this['salesforceSync'][_0x44a2e0(0x208)](this[_0x44a2e0(0x1c7)][_0x44a2e0(0x1d6)]);else this['commitData']['syncBranchId']&&(this['repositoryData']=await this['salesforceSync'][_0x44a2e0(0x1c4)](this[_0x44a2e0(0x1c7)][_0x44a2e0(0x1f8)]));}catch(_0x248c8c){throw new bad_request_error_1['BadRequestError'](errors_1[_0x44a2e0(0x1fa)]);}}async[a147_0x5153c4(0x1dc)](){const _0x3da709=a147_0x5153c4;if(!this[_0x3da709(0x1c7)][_0x3da709(0x1ba)])return[];const _0x115dfc=await this[_0x3da709(0x1d4)][_0x3da709(0x1d3)](this[_0x3da709(0x1c7)][_0x3da709(0x1ba)])[_0x3da709(0x1ca)](_0x19eed1=>_0x19eed1['split']('\x20')['map'](_0x5736f3=>_0x5736f3['trim']())),_0x3e29ca=new salesforce_retriever_service_1[(_0x3da709(0x1c9))](this['salesforceService']),_0x3d8173=await _0x3e29ca['run'](_0x115dfc);return _0x3d8173;}async[a147_0x5153c4(0x200)](){const _0x1ba784=a147_0x5153c4;if(!this[_0x1ba784(0x1c7)][_0x1ba784(0x1c2)])return[];const _0x2c97fd=await this[_0x1ba784(0x1d4)]['retrieveAttachment'](this[_0x1ba784(0x1c7)]['deleteAttachmentId']);return _0x2c97fd;}async[a147_0x5153c4(0x1b0)](){const _0x501b46=a147_0x5153c4,_0x58ab1c=new commit_components_dto_1[(_0x501b46(0x1da))](),[_0x1ea552,_0x4e2eb]=await Promise['all']([this[_0x501b46(0x1dc)](),this[_0x501b46(0x200)]()]);return _0x58ab1c[_0x501b46(0x1ec)]=this[_0x501b46(0x1c7)][_0x501b46(0x1ec)],_0x58ab1c[_0x501b46(0x1bb)]=this['commitData']['user'],_0x58ab1c[_0x501b46(0x207)]={'writed':_0x1ea552,'deleted':_0x4e2eb},_0x58ab1c[_0x501b46(0x1e5)]=this[_0x501b46(0x1c7)]['convertToSFDX'],_0x58ab1c[_0x501b46(0x1f7)]=this['repository'],_0x58ab1c['branch']=this[_0x501b46(0x202)],_0x58ab1c;}async[a147_0x5153c4(0x1ee)](_0x4e7889=![]){const _0x4e3a36=a147_0x5153c4;if(_0x4e7889)await this[_0x4e3a36(0x1bf)][_0x4e3a36(0x1d0)](this['repositoryData'],{});else{const _0x516ef7=await this[_0x4e3a36(0x1f3)]['branches'][_0x4e3a36(0x1ed)](this['branch']['name']);this[_0x4e3a36(0x1f0)](_0x4e3a36(0x203));const _0x43b056={[this['repository'][_0x4e3a36(0x201)]]:{'lastCommit':_0x516ef7['sha']}};await this['salesforceSync']['updateRemoteState'](this[_0x4e3a36(0x1e2)],_0x43b056);}}async[a147_0x5153c4(0x1b6)](){const _0x580ad5=a147_0x5153c4,_0x1ff4c3=await this[_0x580ad5(0x1b0)]();this[_0x580ad5(0x1eb)]['logger']=this[_0x580ad5(0x1df)],await this[_0x580ad5(0x1bf)][_0x580ad5(0x1b1)](this[_0x580ad5(0x1e2)],_0x580ad5(0x1e0)),await this[_0x580ad5(0x1eb)]['run'](_0x1ff4c3),await this[_0x580ad5(0x1ee)](),this['commitData'][_0x580ad5(0x1ba)]&&await this[_0x580ad5(0x1d4)][_0x580ad5(0x1f1)](this[_0x580ad5(0x1c7)]['commitAttachmentId']),this[_0x580ad5(0x1c7)][_0x580ad5(0x1c2)]&&await this[_0x580ad5(0x1d4)]['deleteAttachment'](this[_0x580ad5(0x1c7)]['deleteAttachmentId']),await this[_0x580ad5(0x1bf)][_0x580ad5(0x1b1)](this[_0x580ad5(0x1e2)],_0x580ad5(0x1e1));}async[a147_0x5153c4(0x1c6)](_0x1430da){const _0x1d6c79=a147_0x5153c4;try{this[_0x1d6c79(0x1df)][_0x1d6c79(0x1f0)]('[ERROR]\x20'+_0x1430da),await this[_0x1d6c79(0x1df)][_0x1d6c79(0x1ef)](),await this[_0x1d6c79(0x1ee)](!![]),await this['salesforceSync'][_0x1d6c79(0x1b1)](this[_0x1d6c79(0x1e2)],_0x1d6c79(0x1d7));}catch(_0x292ca1){logger[_0x1d6c79(0x1f6)](_0x292ca1);}}async['run'](_0x5ba282,_0x42c226){const _0x4c74ce=a147_0x5153c4;try{this['commitData']=_0x5ba282,this[_0x4c74ce(0x1d4)][_0x4c74ce(0x1b2)](_0x42c226),this[_0x4c74ce(0x1df)]=this['salesforceService']['getLogger'](),await this['fetchRepositoryData']();if(!this[_0x4c74ce(0x1e2)])throw new bad_request_error_1[(_0x4c74ce(0x1bc))](errors_1[_0x4c74ce(0x1d9)]);this[_0x4c74ce(0x1f3)]=await this[_0x4c74ce(0x1fc)][_0x4c74ce(0x1ed)](this[_0x4c74ce(0x1e2)][_0x4c74ce(0x1e9)]),this[_0x4c74ce(0x202)]=await this[_0x4c74ce(0x1f3)][_0x4c74ce(0x1ea)][_0x4c74ce(0x1ed)](this['repositoryData']['branchName']),this[_0x4c74ce(0x1f0)](_0x4c74ce(0x1d1)),this['exec']()[_0x4c74ce(0x1ce)](_0x45e716=>this[_0x4c74ce(0x1c6)](_0x45e716));}catch(_0x3bf83f){this[_0x4c74ce(0x1c7)]=undefined,logger[_0x4c74ce(0x1f6)](_0x3bf83f);throw _0x3bf83f;}}};FlosumCommitJob=__decorate([(0x0,typedi_1[a147_0x5153c4(0x1b4)])({'transient':!![]}),__metadata(a147_0x5153c4(0x1cc),[salesforce_service_1['SalesforceService'],commit_components_job_1[a147_0x5153c4(0x1e3)],salesforce_sync_service_1[a147_0x5153c4(0x1f5)],git_provider_manager_1[a147_0x5153c4(0x1f9)]])],FlosumCommitJob),exports[a147_0x5153c4(0x1fe)]=FlosumCommitJob;