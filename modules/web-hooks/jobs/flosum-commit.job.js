const a143_0x373c=['typedi','6pGErKM','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','all','constructor','sha','../../salesforce/services/salesforce.service','deleteAttachmentId','__metadata','repo','log','repoService','Completed','GitProviderManager','__esModule','SalesforceSyncService','getAttachmentIdByParent','repositoryData','getOne','metadata','BadRequestError','name','branch','decorate','gitUrl','message','send','deleteAttachment','getCommitDto','In\x20Progress','__decorate','SalesforceService','salesforceSync','64THaWhC','design:paramtypes','encodeBase64','salesforceService','syncRepositoryId','run','getOwnPropertyDescriptor','SalesforceRetrieverService','function','getRepositoryRecord','repositoryName','branchName','Service','fetchRepositoryData','logger','getComponentsToWrite','syncBranchId','../../salesforce/services/salesforce-retriever.service','[INFO]\x20Start\x20commit\x20job','retrieveAttachment','split','trim','getBranchRecord','setStatus','length','../../shared/git-provider.manager','map','20784AgfXEl','object','FlosumCommitJob',']\x20[Branch:\x20','gitManager','exec','[ERROR]\x20','commitData','7603emTbAi','commitAttachmentId','../dto/commit-components.dto','../../shared/utils','apply','[INFO]\x20Update\x20remote\x20state.','user','updateLastCommit','300855FCNfxe','./commit-components.job','../../../core/errors/bad-request.error','651511ekndwJ','commitJob','360095jvJLrh','Error','objectId','5479ZypoPV','CommitComponentsDto','defineProperty','../../../constants/errors','components','getLogger','getComponentsToDelete','60443VKKzzd','Attachment','66gGwJYg','return\x20/\x22\x20+\x20this\x20+\x20\x22/','repository','then'];const a143_0x367efe=a143_0xc628;function a143_0xc628(_0x16791e,_0x5d7cf5){return a143_0xc628=function(_0xef5e96,_0x21c85d){_0xef5e96=_0xef5e96-0xf2;let _0x35d2a2=a143_0x373c[_0xef5e96];return _0x35d2a2;},a143_0xc628(_0x16791e,_0x5d7cf5);}(function(_0x4b9156,_0x4fd929){const _0x40b0c2=a143_0xc628;while(!![]){try{const _0x12517f=-parseInt(_0x40b0c2(0x136))*-parseInt(_0x40b0c2(0x14f))+-parseInt(_0x40b0c2(0x143))+parseInt(_0x40b0c2(0x113))*parseInt(_0x40b0c2(0x146))+parseInt(_0x40b0c2(0x12e))+-parseInt(_0x40b0c2(0x14d))*parseInt(_0x40b0c2(0xf3))+parseInt(_0x40b0c2(0x141))+-parseInt(_0x40b0c2(0x13e));if(_0x12517f===_0x4fd929)break;else _0x4b9156['push'](_0x4b9156['shift']());}catch(_0x3ba196){_0x4b9156['push'](_0x4b9156['shift']());}}}(a143_0x373c,0x7a595));const a143_0x35d2a2=function(){let _0x418649=!![];return function(_0x3c99cd,_0xc732b6){const _0x2eff52=_0x418649?function(){const _0x5a9112=a143_0xc628;if(_0xc732b6){const _0x5e927a=_0xc732b6[_0x5a9112(0x13a)](_0x3c99cd,arguments);return _0xc732b6=null,_0x5e927a;}}:function(){};return _0x418649=![],_0x2eff52;};}(),a143_0x21c85d=a143_0x35d2a2(this,function(){const _0xf3bd24=function(){const _0x2677de=a143_0xc628,_0x2fd237=_0xf3bd24[_0x2677de(0xf6)](_0x2677de(0x150))()[_0x2677de(0xf6)](_0x2677de(0xf4));return!_0x2fd237['test'](a143_0x21c85d);};return _0xf3bd24();});a143_0x21c85d();'use strict';var __decorate=this&&this[a143_0x367efe(0x110)]||function(_0x1c1fa7,_0x2b9e12,_0xb9127,_0x56f140){const _0x4413ac=a143_0x367efe;var _0x1b29b6=arguments[_0x4413ac(0x12b)],_0x5cd74f=_0x1b29b6<0x3?_0x2b9e12:_0x56f140===null?_0x56f140=Object[_0x4413ac(0x119)](_0x2b9e12,_0xb9127):_0x56f140,_0x5a2cea;if(typeof Reflect===_0x4413ac(0x12f)&&typeof Reflect[_0x4413ac(0x109)]==='function')_0x5cd74f=Reflect[_0x4413ac(0x109)](_0x1c1fa7,_0x2b9e12,_0xb9127,_0x56f140);else{for(var _0x5c89a3=_0x1c1fa7['length']-0x1;_0x5c89a3>=0x0;_0x5c89a3--)if(_0x5a2cea=_0x1c1fa7[_0x5c89a3])_0x5cd74f=(_0x1b29b6<0x3?_0x5a2cea(_0x5cd74f):_0x1b29b6>0x3?_0x5a2cea(_0x2b9e12,_0xb9127,_0x5cd74f):_0x5a2cea(_0x2b9e12,_0xb9127))||_0x5cd74f;}return _0x1b29b6>0x3&&_0x5cd74f&&Object['defineProperty'](_0x2b9e12,_0xb9127,_0x5cd74f),_0x5cd74f;},__metadata=this&&this[a143_0x367efe(0xfa)]||function(_0x141140,_0x2e879d){const _0x1c0e36=a143_0x367efe;if(typeof Reflect===_0x1c0e36(0x12f)&&typeof Reflect[_0x1c0e36(0x105)]===_0x1c0e36(0x11b))return Reflect[_0x1c0e36(0x105)](_0x141140,_0x2e879d);};Object[a143_0x367efe(0x148)](exports,a143_0x367efe(0x100),{'value':!![]}),exports[a143_0x367efe(0x130)]=void 0x0;const salesforce_service_1=require(a143_0x367efe(0xf8)),git_provider_manager_1=require(a143_0x367efe(0x12c)),typedi_1=require(a143_0x367efe(0xf2)),errors_1=require(a143_0x367efe(0x149)),bad_request_error_1=require(a143_0x367efe(0x140)),salesforce_retriever_service_1=require(a143_0x367efe(0x124)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),utils_1=require(a143_0x367efe(0x139)),commit_components_dto_1=require(a143_0x367efe(0x138)),commit_components_job_1=require(a143_0x367efe(0x13f));let FlosumCommitJob=class FlosumCommitJob{constructor(_0x19054a,_0x4c766e,_0x1744bd,_0x45308f){const _0x2380ba=a143_0x367efe;this[_0x2380ba(0x116)]=_0x19054a,this[_0x2380ba(0x142)]=_0x4c766e,this[_0x2380ba(0x112)]=_0x1744bd,this[_0x2380ba(0x132)]=_0x45308f,this[_0x2380ba(0xfd)]=this['gitManager']['getRepoService']();}['log'](_0x5e037a){const _0x21288d=a143_0x367efe;return this['logger']['log']('[COMMIT]\x20['+this['gitManager']['provider']['toUpperCase']()+']\x20[Repository:\x20'+this[_0x21288d(0x151)][_0x21288d(0x107)]+_0x21288d(0x131)+this[_0x21288d(0x108)][_0x21288d(0x107)]+']\x20'+_0x5e037a);}async[a143_0x367efe(0x120)](){const _0x3f29c8=a143_0x367efe;try{if(this['commitData'][_0x3f29c8(0x117)])this[_0x3f29c8(0x103)]=await this['salesforceSync'][_0x3f29c8(0x11c)](this[_0x3f29c8(0x135)][_0x3f29c8(0x117)]);else this[_0x3f29c8(0x135)][_0x3f29c8(0x123)]&&(this[_0x3f29c8(0x103)]=await this[_0x3f29c8(0x112)][_0x3f29c8(0x129)](this['commitData'][_0x3f29c8(0x123)]));}catch(_0x1f9917){throw new bad_request_error_1[(_0x3f29c8(0x106))](errors_1['ERR_INVALID_SYNC_RECORD_ID']);}}async['getComponentsToWrite'](){const _0xfcb74b=a143_0x367efe;if(!this[_0xfcb74b(0x135)][_0xfcb74b(0x137)])return[];const _0x4d281b=await this[_0xfcb74b(0x116)][_0xfcb74b(0x126)](this[_0xfcb74b(0x135)][_0xfcb74b(0x137)])[_0xfcb74b(0x152)](_0x45ae6b=>_0x45ae6b[_0xfcb74b(0x127)]('\x20')[_0xfcb74b(0x12d)](_0x17e77e=>_0x17e77e[_0xfcb74b(0x128)]())),_0x1f90d3=new salesforce_retriever_service_1[(_0xfcb74b(0x11a))](this[_0xfcb74b(0x116)]),_0x1d2318=await _0x1f90d3[_0xfcb74b(0x118)](_0x4d281b);return _0x1d2318;}async[a143_0x367efe(0x14c)](){const _0x23cabb=a143_0x367efe;if(!this['commitData']['deleteAttachmentId'])return[];const _0x482c00=await this[_0x23cabb(0x116)][_0x23cabb(0x126)](this[_0x23cabb(0x135)][_0x23cabb(0xf9)]);return _0x482c00;}async[a143_0x367efe(0x10e)](){const _0x47f6f2=a143_0x367efe,_0x38c66b=new commit_components_dto_1[(_0x47f6f2(0x147))](),[_0x23f445,_0x5d5503]=await Promise[_0x47f6f2(0xf5)]([this[_0x47f6f2(0x122)](),this[_0x47f6f2(0x14c)]()]);return _0x38c66b[_0x47f6f2(0x10b)]=this[_0x47f6f2(0x135)]['message'],_0x38c66b[_0x47f6f2(0x13c)]=this[_0x47f6f2(0x135)][_0x47f6f2(0x13c)],_0x38c66b[_0x47f6f2(0x14a)]={'writed':_0x23f445,'deleted':_0x5d5503},_0x38c66b['convertToSFDX']=this[_0x47f6f2(0x135)]['convertToSFDX'],_0x38c66b[_0x47f6f2(0xfb)]=this[_0x47f6f2(0x151)],_0x38c66b[_0x47f6f2(0x108)]=this[_0x47f6f2(0x108)],_0x38c66b;}async[a143_0x367efe(0x13d)](){const _0x1f9d63=a143_0x367efe,_0x474232=await this[_0x1f9d63(0x151)]['branches'][_0x1f9d63(0x104)](this[_0x1f9d63(0x108)][_0x1f9d63(0x107)]);this[_0x1f9d63(0xfc)](_0x1f9d63(0x13b));const _0x5c6cc1=await this[_0x1f9d63(0x112)][_0x1f9d63(0x102)](this['repositoryData'][_0x1f9d63(0x145)]),_0x3790c0={[this[_0x1f9d63(0x151)][_0x1f9d63(0x10a)]]:{'lastCommit':_0x474232[_0x1f9d63(0xf7)]}};await this[_0x1f9d63(0x116)]['patchObject'](_0x1f9d63(0x14e),_0x5c6cc1,{'Body':utils_1[_0x1f9d63(0x115)](JSON['stringify'](_0x3790c0))});}async['exec'](){const _0x4b019d=a143_0x367efe,_0x27c85b=await this[_0x4b019d(0x10e)]();this['commitJob'][_0x4b019d(0x121)]=this['logger'],await this[_0x4b019d(0x112)]['setStatus'](this[_0x4b019d(0x103)],_0x4b019d(0x10f)),await this[_0x4b019d(0x142)][_0x4b019d(0x118)](_0x27c85b),await this[_0x4b019d(0x13d)](),this[_0x4b019d(0x135)]['commitAttachmentId']&&await this['salesforceService']['deleteAttachment'](this[_0x4b019d(0x135)][_0x4b019d(0x137)]),this[_0x4b019d(0x135)]['deleteAttachmentId']&&await this[_0x4b019d(0x116)][_0x4b019d(0x10d)](this[_0x4b019d(0x135)][_0x4b019d(0xf9)]),await this['salesforceSync'][_0x4b019d(0x12a)](this[_0x4b019d(0x103)],_0x4b019d(0xfe));}async['run'](_0x2bf50e,_0x2b7081){const _0x477bd4=a143_0x367efe;try{this[_0x477bd4(0x135)]=_0x2bf50e,this[_0x477bd4(0x116)]['setLoggerId'](_0x2b7081),this['logger']=this[_0x477bd4(0x116)][_0x477bd4(0x14b)](),await this['fetchRepositoryData']();if(!this['repositoryData'])throw new bad_request_error_1[(_0x477bd4(0x106))](errors_1['ERR_UNKNOWN_SYNC_RECORD_ID']);this[_0x477bd4(0x151)]=await this[_0x477bd4(0xfd)]['getOne'](this[_0x477bd4(0x103)][_0x477bd4(0x11d)]),this[_0x477bd4(0x108)]=await this['repository']['branches'][_0x477bd4(0x104)](this['repositoryData'][_0x477bd4(0x11e)]),this[_0x477bd4(0xfc)](_0x477bd4(0x125)),this[_0x477bd4(0x133)]()['catch'](async _0x3feb6e=>{const _0x3d78f1=_0x477bd4;return this[_0x3d78f1(0xfc)](_0x3d78f1(0x134)+_0x3feb6e),await this[_0x3d78f1(0x112)]['setStatus'](this['repositoryData'],_0x3d78f1(0x144)),this[_0x3d78f1(0x121)][_0x3d78f1(0x10c)]();});}catch(_0x44e035){this[_0x477bd4(0x135)]=undefined;throw _0x44e035;}}};FlosumCommitJob=__decorate([typedi_1[a143_0x367efe(0x11f)]({'transient':!![]}),__metadata(a143_0x367efe(0x114),[salesforce_service_1[a143_0x367efe(0x111)],commit_components_job_1['CommitComponentsJob'],salesforce_sync_service_1[a143_0x367efe(0x101)],git_provider_manager_1[a143_0x367efe(0xff)]])],FlosumCommitJob),exports[a143_0x367efe(0x130)]=FlosumCommitJob;