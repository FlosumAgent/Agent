const a122_0x201c=['SalesforceService','Clonning\x20repository','Service','Parser','push\x20commit\x20to\x20branch\x20\x22%s\x22','salesforceService','credentials','124349kEbjsE','buffer','forEach','info','createEmptyProjectJson','clonning\x20repository\x20from\x20%s','default','retrieve','commit\x20files\x20with\x20message\x20\x22%s\x22','getOwnPropertyDescriptor','defineProperty','Push\x20commit\x20to\x20branch','add\x20retrieved\x20components\x20to\x20commit','writeFile','8wVFhRL','__importStar','apply','log','message','../../sfdx/services/salesforce.service','Logger','typedi','createEmptyPackageXml','return\x20/\x22\x20+\x20this\x20+\x20\x22/','./job','getOne','length','createWriteQueue','replace','readFlosumComponents','exec','sleep','__createBinding','rm\x20-rf\x20','180957HBShCz','deleteCommit','../../internal/shell.internal','retrieveComponents','__decorate','connect','setComponentIds','../../internal/fs.internal','FlosumCommitJob','currentJob','[ERROR]\x20','status','getRepoService','data','splice','[CID:\x20','get','trim','__metadata','baseDir','split','create','.mdapi-temp','1TIcDwv','../../shared/services/auth-settings.service','../../shared/utils','design:paramtypes','gitCredentials','join','825206KTQkxn','authSettings','start\x20retrieving\x20components','SFDX','retrieveAttachment','prototype','clone','834557ZtQePt','map','includes','Recieved\x20commit\x20to\x20proceed.\x20Branch\x20-\x20','../../internal/git.internal','WRITES_PER_TICK','add','push','hasMoreIds','commit\x20%s\x20took\x20%dms\x20to\x20proceed\x20%d\x20components','../../sfdx/utils/sfdx','AuthSettingsService','__esModule','369194cDbDOu','Job','call','ERR_JOB_IS_NOT_DONE','flosum-commit-job','create\x20empty\x20sfdx-project.json','function','../../shared/git-provider.manager','Shell','commit','branch','shift','FlosumRetriever','sfdx-project.json','../../../parser','580203wCMydZ','now','Git','decorate','GIT_STATUS_CHECK_INTERVAL','MAX_GIT_STATUS_CHECK','catch','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','constructor','object','all','name','setCredentials','repo','../../../constants/errors','commitId','sfLogger','__setModuleDefault','user','send\x20DELETE\x20commit\x20id\x20%s','remove\x20git\x20repository\x20folder\x20','\x20components','1PBiFhC','2359756CbqkjI','metadata'];const a122_0x565dee=a122_0x3722;(function(_0x28815c,_0x15b2d0){const _0x8b6077=a122_0x3722;while(!![]){try{const _0x1995d0=-parseInt(_0x8b6077(0x1f1))+-parseInt(_0x8b6077(0x1d4))+parseInt(_0x8b6077(0x1c0))*parseInt(_0x8b6077(0x1b2))+-parseInt(_0x8b6077(0x205))+parseInt(_0x8b6077(0x1f8))*-parseInt(_0x8b6077(0x1a8))+-parseInt(_0x8b6077(0x214))+parseInt(_0x8b6077(0x1eb))*parseInt(_0x8b6077(0x1a9));if(_0x1995d0===_0x15b2d0)break;else _0x28815c['push'](_0x28815c['shift']());}catch(_0x5c9510){_0x28815c['push'](_0x28815c['shift']());}}}(a122_0x201c,0x89ccf));const a122_0x4df0db=function(){let _0x173423=!![];return function(_0x345ca2,_0x28659f){const _0x3799fb=_0x173423?function(){const _0x2b26dd=a122_0x3722;if(_0x28659f){const _0x1cb3da=_0x28659f[_0x2b26dd(0x1c2)](_0x345ca2,arguments);return _0x28659f=null,_0x1cb3da;}}:function(){};return _0x173423=![],_0x3799fb;};}(),a122_0x1c28d5=a122_0x4df0db(this,function(){const _0x565d87=function(){const _0xc7a329=a122_0x3722,_0x48a590=_0x565d87[_0xc7a329(0x19a)](_0xc7a329(0x1c9))()[_0xc7a329(0x19a)](_0xc7a329(0x199));return!_0x48a590['test'](a122_0x1c28d5);};return _0x565d87();});a122_0x1c28d5();'use strict';var __createBinding=this&&this[a122_0x565dee(0x1d2)]||(Object['create']?function(_0x12aaa,_0x2c8f5c,_0x5562d8,_0x181805){const _0x566281=a122_0x565dee;if(_0x181805===undefined)_0x181805=_0x5562d8;Object[_0x566281(0x1bc)](_0x12aaa,_0x181805,{'enumerable':!![],'get':function(){return _0x2c8f5c[_0x5562d8];}});}:function(_0x14174c,_0x5ebdbb,_0x24b39b,_0x171237){if(_0x171237===undefined)_0x171237=_0x24b39b;_0x14174c[_0x171237]=_0x5ebdbb[_0x24b39b];}),__setModuleDefault=this&&this[a122_0x565dee(0x1a3)]||(Object[a122_0x565dee(0x1e9)]?function(_0x1e7caa,_0x10935d){const _0x4696ef=a122_0x565dee;Object[_0x4696ef(0x1bc)](_0x1e7caa,_0x4696ef(0x1b8),{'enumerable':!![],'value':_0x10935d});}:function(_0x122ef3,_0x4f93e8){const _0x1cd596=a122_0x565dee;_0x122ef3[_0x1cd596(0x1b8)]=_0x4f93e8;}),__decorate=this&&this[a122_0x565dee(0x1d8)]||function(_0x361535,_0x35f099,_0x13c25f,_0x2c9d9b){const _0x26706b=a122_0x565dee;var _0xce33ca=arguments[_0x26706b(0x1cc)],_0x2ea09e=_0xce33ca<0x3?_0x35f099:_0x2c9d9b===null?_0x2c9d9b=Object[_0x26706b(0x1bb)](_0x35f099,_0x13c25f):_0x2c9d9b,_0x60777d;if(typeof Reflect===_0x26706b(0x19b)&&typeof Reflect[_0x26706b(0x195)]===_0x26706b(0x20b))_0x2ea09e=Reflect[_0x26706b(0x195)](_0x361535,_0x35f099,_0x13c25f,_0x2c9d9b);else{for(var _0x1061b1=_0x361535['length']-0x1;_0x1061b1>=0x0;_0x1061b1--)if(_0x60777d=_0x361535[_0x1061b1])_0x2ea09e=(_0xce33ca<0x3?_0x60777d(_0x2ea09e):_0xce33ca>0x3?_0x60777d(_0x35f099,_0x13c25f,_0x2ea09e):_0x60777d(_0x35f099,_0x13c25f))||_0x2ea09e;}return _0xce33ca>0x3&&_0x2ea09e&&Object[_0x26706b(0x1bc)](_0x35f099,_0x13c25f,_0x2ea09e),_0x2ea09e;},__importStar=this&&this[a122_0x565dee(0x1c1)]||function(_0x4cc59e){const _0x27cb21=a122_0x565dee;if(_0x4cc59e&&_0x4cc59e['__esModule'])return _0x4cc59e;var _0x4ec7b3={};if(_0x4cc59e!=null){for(var _0x419714 in _0x4cc59e)if(_0x419714!==_0x27cb21(0x1b8)&&Object[_0x27cb21(0x1f6)]['hasOwnProperty'][_0x27cb21(0x207)](_0x4cc59e,_0x419714))__createBinding(_0x4ec7b3,_0x4cc59e,_0x419714);}return __setModuleDefault(_0x4ec7b3,_0x4cc59e),_0x4ec7b3;},__metadata=this&&this[a122_0x565dee(0x1e6)]||function(_0x37a1fd,_0x438b70){const _0x184902=a122_0x565dee;if(typeof Reflect===_0x184902(0x19b)&&typeof Reflect[_0x184902(0x1aa)]===_0x184902(0x20b))return Reflect[_0x184902(0x1aa)](_0x37a1fd,_0x438b70);},__importDefault=this&&this['__importDefault']||function(_0x330b99){const _0x171c70=a122_0x565dee;return _0x330b99&&_0x330b99[_0x171c70(0x204)]?_0x330b99:{'default':_0x330b99};};Object[a122_0x565dee(0x1bc)](exports,'__esModule',{'value':!![]}),exports['FlosumCommitJob']=void 0x0;function a122_0x3722(_0x9a1314,_0x37abec){return a122_0x3722=function(_0x51ebaa,_0x1c28d5){_0x51ebaa=_0x51ebaa-0x195;let _0x4df0db=a122_0x201c[_0x51ebaa];return _0x4df0db;},a122_0x3722(_0x9a1314,_0x37abec);}const errors_1=require(a122_0x565dee(0x1a0)),core_1=require('../../../core'),bad_request_error_1=require('../../../core/errors/bad-request.error'),fs_internal_1=require(a122_0x565dee(0x1db)),git_internal_1=require(a122_0x565dee(0x1fc)),shell_internal_1=require(a122_0x565dee(0x1d6)),salesforce_service_1=require(a122_0x565dee(0x1c5)),flosum_retriever_util_1=require('../../sfdx/utils/flosum-retriever.util'),sfdx_1=require(a122_0x565dee(0x202)),git_provider_manager_1=require(a122_0x565dee(0x20c)),auth_settings_service_1=require(a122_0x565dee(0x1ec)),utils_1=require(a122_0x565dee(0x1ed)),parser_1=require(a122_0x565dee(0x213)),path_1=__importDefault(require('path')),typedi_1=__importStar(require(a122_0x565dee(0x1c7))),job_1=require(a122_0x565dee(0x1ca)),logger=new core_1[(a122_0x565dee(0x1c6))](a122_0x565dee(0x209));let FlosumCommitJob=class FlosumCommitJob extends job_1[a122_0x565dee(0x206)]{constructor(_0x39b2e3,_0x42074f){const _0x41e43d=a122_0x565dee;super(),this['authSettings']=_0x39b2e3,this[_0x41e43d(0x1b0)]=_0x42074f,this['WRITES_PER_TICK']=0x3e8,this[_0x41e43d(0x197)]=0xa,this[_0x41e43d(0x196)]=0xbb8;}get[a122_0x565dee(0x1b1)](){const _0x2d7932=a122_0x565dee;return this[_0x2d7932(0x1f2)][_0x2d7932(0x1ef)];}get['commitId'](){const _0x1a5f7d=a122_0x565dee;var _0x33c057;return(_0x33c057=this[_0x1a5f7d(0x1dd)])===null||_0x33c057===void 0x0?void 0x0:_0x33c057['id'];}async[a122_0x565dee(0x1a2)](_0x1bdf42){const _0x3ba142=a122_0x565dee;return this[_0x3ba142(0x1b0)]['log'](_0x3ba142(0x1e3)+this[_0x3ba142(0x1a1)]+']\x20'+_0x1bdf42);}[a122_0x565dee(0x1cd)](_0x3fc794){const _0x1841dc=a122_0x565dee,_0x3a33e9=[];for(const _0x1a698b in _0x3fc794){const _0x5936a4=_0x3fc794[_0x1a698b];_0x5936a4[_0x1841dc(0x1b4)]((_0x14e540,_0xa8d5b0)=>{const _0x5cd5e3=_0x1841dc,_0x201e3a={'name':_0x1a698b,'buffer':_0x14e540};_0x3a33e9[_0xa8d5b0]?_0x3a33e9[_0xa8d5b0][_0x5cd5e3(0x1ff)](_0x201e3a):_0x3a33e9[_0x5cd5e3(0x1ff)]([_0x201e3a]);});}return _0x3a33e9;}async[a122_0x565dee(0x1d7)](_0x41bc43,_0x19a865){const _0x216730=a122_0x565dee;this['sfLogger']('Start\x20retrieve\x20components\x20job');const _0x205a55=path_1['default'][_0x216730(0x1f0)](_0x41bc43,_0x216730(0x1ea));logger[_0x216730(0x1c3)](_0x216730(0x20a)),await sfdx_1[_0x216730(0x1f4)][_0x216730(0x1b6)](_0x41bc43);const _0x43b18c=typedi_1[_0x216730(0x1b8)][_0x216730(0x1e4)](flosum_retriever_util_1[_0x216730(0x211)]);_0x43b18c[_0x216730(0x1da)](_0x19a865);let _0x4e5264=0x0;do{const _0x5054a3=await _0x43b18c[_0x216730(0x1b9)](),_0x25c579=await parser_1[_0x216730(0x1ae)][_0x216730(0x1cf)](_0x5054a3),_0x1f0617=this[_0x216730(0x1cd)](_0x25c579);while(_0x1f0617['length']>0x0){const _0x190b72=_0x1f0617[_0x216730(0x210)]();_0x4e5264+=_0x190b72[_0x216730(0x1cc)];while(_0x190b72['length']>0x0){const _0x5d77fa=_0x190b72[_0x216730(0x1e2)](0x0,this[_0x216730(0x1fd)]),_0x1725ae=_0x5d77fa[_0x216730(0x1f9)](_0x4905dc=>fs_internal_1['FS'][_0x216730(0x1bf)](path_1['default'][_0x216730(0x1f0)](_0x205a55,_0x4905dc[_0x216730(0x19d)]),_0x4905dc[_0x216730(0x1b3)]));await Promise[_0x216730(0x19c)](_0x1725ae);}logger['log']('create\x20empty\x20package.xml'),await sfdx_1[_0x216730(0x1f4)][_0x216730(0x1c8)](_0x205a55),await sfdx_1[_0x216730(0x1f4)]['mdapiToSource'](_0x205a55,_0x41bc43),await shell_internal_1[_0x216730(0x20d)]['exec'](_0x216730(0x1d3)+_0x205a55+'/*');}this[_0x216730(0x1a2)]('Retrieved\x20'+_0x4e5264+'/'+_0x19a865[_0x216730(0x1cc)]+_0x216730(0x1a7));}while(_0x43b18c[_0x216730(0x200)]);logger[_0x216730(0x1c3)]('remove\x20sfdx-project.json'),await shell_internal_1[_0x216730(0x20d)][_0x216730(0x1d0)]('rm\x20-rf\x20'+path_1[_0x216730(0x1b8)]['join'](_0x41bc43,_0x216730(0x212))),logger[_0x216730(0x1c3)]('remove\x20temp\x20mdapi\x20folder'),await shell_internal_1['Shell']['exec']('rm\x20-rf\x20'+_0x205a55);}async['exec'](_0x36256c){const _0x3ebe0e=a122_0x565dee,_0x45c73f=Date['now'](),{commitId:_0x386774,branch:_0x4d349c,attachmentId:_0xc7a39d,message:_0x59e305}=this['currentJob'][_0x3ebe0e(0x1e1)];logger[_0x3ebe0e(0x1b5)]('connect\x20to\x20salesforce'),await this[_0x3ebe0e(0x1b0)][_0x3ebe0e(0x1d9)](),this['sfLogger'](_0x3ebe0e(0x1fb)+_0x4d349c);const _0x4a636e=[];try{const _0x418b06=await this[_0x3ebe0e(0x1b0)][_0x3ebe0e(0x1f5)](_0xc7a39d);_0x4a636e[_0x3ebe0e(0x1ff)](..._0x418b06[_0x3ebe0e(0x1e8)]('\x20')[_0x3ebe0e(0x1f9)](_0xd40811=>_0xd40811[_0x3ebe0e(0x1e5)]()));const {gitUrl:_0xc92423}=_0x36256c,_0x452ff1=_0xc92423[_0x3ebe0e(0x1ce)](/https\:\/\/(.+@)?/,'https://'+this[_0x3ebe0e(0x1b1)]+'@');logger['info'](_0x3ebe0e(0x1b7),_0x452ff1),this['sfLogger'](_0x3ebe0e(0x1ac));const _0x23f4f4=await git_internal_1[_0x3ebe0e(0x216)][_0x3ebe0e(0x1f7)](_0x452ff1,_0x386774,_0x4d349c),{name:_0x5e9b24,email:_0x1b74c1}=this[_0x3ebe0e(0x1dd)]['data'][_0x3ebe0e(0x1a4)];logger[_0x3ebe0e(0x1b5)]('set\x20credentials\x20{\x20name:\x20%s,\x20email:\x20%s\x20}',_0x5e9b24,_0x1b74c1),await _0x23f4f4[_0x3ebe0e(0x19e)](_0x5e9b24,_0x1b74c1),logger[_0x3ebe0e(0x1b5)](_0x3ebe0e(0x1f3)),await this[_0x3ebe0e(0x1d7)](_0x23f4f4[_0x3ebe0e(0x1e7)],_0x4a636e),logger[_0x3ebe0e(0x1b5)](_0x3ebe0e(0x1be)),await _0x23f4f4[_0x3ebe0e(0x1fe)]('.'),logger[_0x3ebe0e(0x1b5)](_0x3ebe0e(0x1ba),_0x59e305);try{await _0x23f4f4[_0x3ebe0e(0x20e)](_0x59e305);}catch(_0x5bdcb3){let _0x3a6927=0x0;do{_0x3a6927++;const _0x5d261a=await _0x23f4f4[_0x3ebe0e(0x1df)]()[_0x3ebe0e(0x198)](_0x5d9bf5=>_0x5d9bf5[_0x3ebe0e(0x1c4)]||_0x5d9bf5);if(_0x5d261a[_0x3ebe0e(0x1fa)]('nothing\x20to\x20commit')){_0x3a6927=0x0;break;}await utils_1[_0x3ebe0e(0x1d1)](this[_0x3ebe0e(0x196)]);}while(_0x3a6927<this[_0x3ebe0e(0x197)]);if(_0x3a6927===this[_0x3ebe0e(0x197)])throw _0x5bdcb3;}this[_0x3ebe0e(0x1a2)](_0x3ebe0e(0x1bd)),logger[_0x3ebe0e(0x1b5)](_0x3ebe0e(0x1af),_0x4d349c),await _0x23f4f4['push'](_0x4d349c),logger[_0x3ebe0e(0x1b5)](_0x3ebe0e(0x1a6)+_0x23f4f4[_0x3ebe0e(0x1e7)]),await shell_internal_1[_0x3ebe0e(0x20d)][_0x3ebe0e(0x1d0)](_0x3ebe0e(0x1d3)+_0x23f4f4['baseDir']),logger[_0x3ebe0e(0x1b5)](_0x3ebe0e(0x1a5),_0x386774),await this['salesforceService'][_0x3ebe0e(0x1d5)](_0x386774);}catch(_0x4e463e){this[_0x3ebe0e(0x1a2)](_0x3ebe0e(0x1de)+(_0x4e463e['message']||_0x4e463e)),console[_0x3ebe0e(0x1c3)]({'error':_0x4e463e});}finally{logger['info'](_0x3ebe0e(0x201),_0x386774,Date[_0x3ebe0e(0x215)]()-_0x45c73f,_0x4a636e[_0x3ebe0e(0x1cc)]),this[_0x3ebe0e(0x1dd)]=undefined;}}async['run'](_0x3e1d3e){const _0x2c80a4=a122_0x565dee;if(this[_0x2c80a4(0x1dd)])throw new bad_request_error_1['BadRequestError'](errors_1[_0x2c80a4(0x208)]);try{this[_0x2c80a4(0x1dd)]=_0x3e1d3e;const _0x32ef4f=typedi_1[_0x2c80a4(0x1b8)][_0x2c80a4(0x1e4)](git_provider_manager_1['GitProviderManager'])[_0x2c80a4(0x1e0)](),_0x13f08d=await _0x32ef4f[_0x2c80a4(0x1cb)](_0x3e1d3e[_0x2c80a4(0x1e1)][_0x2c80a4(0x19f)]);await _0x13f08d['branches'][_0x2c80a4(0x1cb)](_0x3e1d3e[_0x2c80a4(0x1e1)][_0x2c80a4(0x20f)]),this[_0x2c80a4(0x1d0)](_0x13f08d);}catch(_0x4afdb2){this[_0x2c80a4(0x1dd)]=undefined;throw _0x4afdb2;}}};FlosumCommitJob=__decorate([typedi_1[a122_0x565dee(0x1ad)](),__metadata(a122_0x565dee(0x1ee),[auth_settings_service_1[a122_0x565dee(0x203)],salesforce_service_1[a122_0x565dee(0x1ab)]])],FlosumCommitJob),exports[a122_0x565dee(0x1dc)]=FlosumCommitJob;