const a143_0x35a8=['4xCBjad','decorate','385562ezrmQx','getRepositoryRecord','CommitComponentsDto','handleCommitJobError','fetchRepositoryData','repo','branchName','syncBranchId','deleteAttachmentId','Logger','commitAttachmentId','trim','name','deleteAttachment','BadRequestError','toUpperCase','salesforceSync','map','run','typedi','metadata','getLogger','gitManager','262asVFhl','SalesforceRetrieverService','556738lzGdmY','__metadata','provider','then','function','error','140971NBCdjR','./commit-components.job','repositoryData','getBranchRecord','569230baygPy','FlosumCommitJob','getRepoService','repositoryName','__esModule','commitData','user','syncRepositoryId','[INFO]\x20Start\x20commit\x20job','getComponentsToWrite','object','../../../core','components','defineProperty','../../shared/git-provider.manager','repoService','gitUrl','CommitComponentsJob','SalesforceService','logger','[ERROR]\x20','setStatus','616737YcWLKp','In\x20Progress','[COMMIT]\x20[','GitProviderManager','branch','constructor','repository','send',']\x20[Repository:\x20',']\x20[Branch:\x20','getComponentsToDelete','1AwEarU','Error','salesforceService','ERR_UNKNOWN_SYNC_RECORD_ID','Completed','retrieveAttachment','../../../constants/errors','getCommitDto','message','patchObject','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','__decorate','length','convertToSFDX','getOne','design:paramtypes','log','2224RwbdAr','apply','test','1JwfHyx','updateLastCommit','ERR_INVALID_SYNC_RECORD_ID','branches','1guPbzg','commitJob','562945FstesV','catch','[INFO]\x20Update\x20remote\x20state.','../../../core/errors/bad-request.error','encodeBase64'];function a143_0x26a8(_0x4cf207,_0x4714f5){return a143_0x26a8=function(_0x322dd9,_0x32f8d5){_0x322dd9=_0x322dd9-0x1ce;let _0x1656a9=a143_0x35a8[_0x322dd9];return _0x1656a9;},a143_0x26a8(_0x4cf207,_0x4714f5);}const a143_0x382c3c=a143_0x26a8;(function(_0xcdcba1,_0x39e91d){const _0x2f6956=a143_0x26a8;while(!![]){try{const _0x136c1d=-parseInt(_0x2f6956(0x1dd))*-parseInt(_0x2f6956(0x1d7))+parseInt(_0x2f6956(0x1d4))*parseInt(_0x2f6956(0x1fb))+-parseInt(_0x2f6956(0x207))+-parseInt(_0x2f6956(0x228))*parseInt(_0x2f6956(0x21d))+parseInt(_0x2f6956(0x1e2))*parseInt(_0x2f6956(0x203))+-parseInt(_0x2f6956(0x1fd))+-parseInt(_0x2f6956(0x1e4))*-parseInt(_0x2f6956(0x1db));if(_0x136c1d===_0x39e91d)break;else _0xcdcba1['push'](_0xcdcba1['shift']());}catch(_0x4a6946){_0xcdcba1['push'](_0xcdcba1['shift']());}}}(a143_0x35a8,0x56076));const a143_0x1656a9=function(){let _0x4fe320=!![];return function(_0x2c2703,_0x5b5157){const _0xa040a8=_0x4fe320?function(){const _0x1dbefd=a143_0x26a8;if(_0x5b5157){const _0x2a5cf8=_0x5b5157[_0x1dbefd(0x1d5)](_0x2c2703,arguments);return _0x5b5157=null,_0x2a5cf8;}}:function(){};return _0x4fe320=![],_0xa040a8;};}(),a143_0x32f8d5=a143_0x1656a9(this,function(){const _0x22ae7e=function(){const _0x2d4eda=a143_0x26a8,_0x5004c7=_0x22ae7e[_0x2d4eda(0x222)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x2d4eda(0x222)](_0x2d4eda(0x232));return!_0x5004c7[_0x2d4eda(0x1d6)](a143_0x32f8d5);};return _0x22ae7e();});a143_0x32f8d5();'use strict';var __decorate=this&&this[a143_0x382c3c(0x1ce)]||function(_0x4642c4,_0x3f1b1e,_0x21e18b,_0x49bcc3){const _0x1fb787=a143_0x382c3c;var _0x3211af=arguments[_0x1fb787(0x1cf)],_0x48529f=_0x3211af<0x3?_0x3f1b1e:_0x49bcc3===null?_0x49bcc3=Object['getOwnPropertyDescriptor'](_0x3f1b1e,_0x21e18b):_0x49bcc3,_0x62b9fd;if(typeof Reflect==='object'&&typeof Reflect[_0x1fb787(0x1e3)]===_0x1fb787(0x201))_0x48529f=Reflect[_0x1fb787(0x1e3)](_0x4642c4,_0x3f1b1e,_0x21e18b,_0x49bcc3);else{for(var _0x59af38=_0x4642c4[_0x1fb787(0x1cf)]-0x1;_0x59af38>=0x0;_0x59af38--)if(_0x62b9fd=_0x4642c4[_0x59af38])_0x48529f=(_0x3211af<0x3?_0x62b9fd(_0x48529f):_0x3211af>0x3?_0x62b9fd(_0x3f1b1e,_0x21e18b,_0x48529f):_0x62b9fd(_0x3f1b1e,_0x21e18b))||_0x48529f;}return _0x3211af>0x3&&_0x48529f&&Object[_0x1fb787(0x214)](_0x3f1b1e,_0x21e18b,_0x48529f),_0x48529f;},__metadata=this&&this[a143_0x382c3c(0x1fe)]||function(_0x58750c,_0x2a1b9d){const _0x3772a1=a143_0x382c3c;if(typeof Reflect===_0x3772a1(0x211)&&typeof Reflect[_0x3772a1(0x1f8)]==='function')return Reflect[_0x3772a1(0x1f8)](_0x58750c,_0x2a1b9d);};Object[a143_0x382c3c(0x214)](exports,a143_0x382c3c(0x20b),{'value':!![]}),exports[a143_0x382c3c(0x208)]=void 0x0;const core_1=require(a143_0x382c3c(0x212)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a143_0x382c3c(0x215)),typedi_1=require(a143_0x382c3c(0x1f7)),errors_1=require(a143_0x382c3c(0x22e)),bad_request_error_1=require(a143_0x382c3c(0x1e0)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),utils_1=require('../../shared/utils'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a143_0x382c3c(0x204)),logger=new core_1[(a143_0x382c3c(0x1ed))]('flosum-commit-job');let FlosumCommitJob=class FlosumCommitJob{constructor(_0x231c5f,_0x254c64,_0x42647b,_0x480769){const _0x4013d1=a143_0x382c3c;this[_0x4013d1(0x22a)]=_0x231c5f,this[_0x4013d1(0x1dc)]=_0x254c64,this['salesforceSync']=_0x42647b,this[_0x4013d1(0x1fa)]=_0x480769,this['repoService']=this[_0x4013d1(0x1fa)][_0x4013d1(0x209)]();}[a143_0x382c3c(0x1d3)](_0x528bf3){const _0x285c27=a143_0x382c3c;return this[_0x285c27(0x21a)][_0x285c27(0x1d3)](_0x285c27(0x21f)+this[_0x285c27(0x1fa)][_0x285c27(0x1ff)][_0x285c27(0x1f3)]()+_0x285c27(0x225)+this['repository'][_0x285c27(0x1f0)]+_0x285c27(0x226)+this[_0x285c27(0x221)][_0x285c27(0x1f0)]+']\x20'+_0x528bf3);}async[a143_0x382c3c(0x1e8)](){const _0x4c30f2=a143_0x382c3c;try{if(this[_0x4c30f2(0x20c)][_0x4c30f2(0x20e)])this[_0x4c30f2(0x205)]=await this[_0x4c30f2(0x1f4)][_0x4c30f2(0x1e5)](this[_0x4c30f2(0x20c)][_0x4c30f2(0x20e)]);else this[_0x4c30f2(0x20c)][_0x4c30f2(0x1eb)]&&(this[_0x4c30f2(0x205)]=await this[_0x4c30f2(0x1f4)][_0x4c30f2(0x206)](this[_0x4c30f2(0x20c)][_0x4c30f2(0x1eb)]));}catch(_0xf68846){throw new bad_request_error_1[(_0x4c30f2(0x1f2))](errors_1[_0x4c30f2(0x1d9)]);}}async[a143_0x382c3c(0x210)](){const _0x299b98=a143_0x382c3c;if(!this[_0x299b98(0x20c)][_0x299b98(0x1ee)])return[];const _0x1b33df=await this[_0x299b98(0x22a)][_0x299b98(0x22d)](this['commitData'][_0x299b98(0x1ee)])[_0x299b98(0x200)](_0x5570cf=>_0x5570cf['split']('\x20')[_0x299b98(0x1f5)](_0x304fef=>_0x304fef[_0x299b98(0x1ef)]())),_0x39be48=new salesforce_retriever_service_1[(_0x299b98(0x1fc))](this[_0x299b98(0x22a)]),_0x257660=await _0x39be48[_0x299b98(0x1f6)](_0x1b33df);return _0x257660;}async['getComponentsToDelete'](){const _0x5e3b90=a143_0x382c3c;if(!this['commitData'][_0x5e3b90(0x1ec)])return[];const _0x5cc410=await this[_0x5e3b90(0x22a)][_0x5e3b90(0x22d)](this['commitData'][_0x5e3b90(0x1ec)]);return _0x5cc410;}async[a143_0x382c3c(0x22f)](){const _0x412fc7=a143_0x382c3c,_0x28a039=new commit_components_dto_1[(_0x412fc7(0x1e6))](),[_0x266064,_0x129237]=await Promise['all']([this[_0x412fc7(0x210)](),this[_0x412fc7(0x227)]()]);return _0x28a039[_0x412fc7(0x230)]=this[_0x412fc7(0x20c)]['message'],_0x28a039[_0x412fc7(0x20d)]=this[_0x412fc7(0x20c)][_0x412fc7(0x20d)],_0x28a039[_0x412fc7(0x213)]={'writed':_0x266064,'deleted':_0x129237},_0x28a039[_0x412fc7(0x1d0)]=this[_0x412fc7(0x20c)][_0x412fc7(0x1d0)],_0x28a039[_0x412fc7(0x1e9)]=this[_0x412fc7(0x223)],_0x28a039['branch']=this[_0x412fc7(0x221)],_0x28a039;}async[a143_0x382c3c(0x1d8)](){const _0x3c693c=a143_0x382c3c,_0xd44598=await this['repository'][_0x3c693c(0x1da)][_0x3c693c(0x1d1)](this[_0x3c693c(0x221)][_0x3c693c(0x1f0)]);this['log'](_0x3c693c(0x1df));const _0x261c4e=await this[_0x3c693c(0x1f4)]['getAttachmentId'](this['repositoryData']),_0x2e9e68={[this['repository'][_0x3c693c(0x217)]]:{'lastCommit':_0xd44598['sha']}};await this[_0x3c693c(0x22a)][_0x3c693c(0x231)]('Attachment',_0x261c4e,{'Body':utils_1[_0x3c693c(0x1e1)](JSON['stringify'](_0x2e9e68))});}async['exec'](){const _0x55b311=a143_0x382c3c,_0x3096a5=await this[_0x55b311(0x22f)]();this['commitJob'][_0x55b311(0x21a)]=this['logger'],await this[_0x55b311(0x1f4)][_0x55b311(0x21c)](this[_0x55b311(0x205)],_0x55b311(0x21e)),await this[_0x55b311(0x1dc)][_0x55b311(0x1f6)](_0x3096a5),await this[_0x55b311(0x1d8)](),this['commitData'][_0x55b311(0x1ee)]&&await this['salesforceService'][_0x55b311(0x1f1)](this[_0x55b311(0x20c)]['commitAttachmentId']),this[_0x55b311(0x20c)][_0x55b311(0x1ec)]&&await this[_0x55b311(0x22a)][_0x55b311(0x1f1)](this[_0x55b311(0x20c)][_0x55b311(0x1ec)]),await this['salesforceSync'][_0x55b311(0x21c)](this[_0x55b311(0x205)],_0x55b311(0x22c));}async[a143_0x382c3c(0x1e7)](_0x515264){const _0x1e6eb6=a143_0x382c3c;try{this['logger']['log'](_0x1e6eb6(0x21b)+_0x515264),await this[_0x1e6eb6(0x21a)][_0x1e6eb6(0x224)](),await this[_0x1e6eb6(0x1f4)][_0x1e6eb6(0x21c)](this[_0x1e6eb6(0x205)],_0x1e6eb6(0x229));}catch(_0x470c34){logger[_0x1e6eb6(0x202)](_0x470c34);}}async['run'](_0x54770f,_0x454052){const _0x3daa07=a143_0x382c3c;try{this[_0x3daa07(0x20c)]=_0x54770f,this['salesforceService']['setLoggerId'](_0x454052),this[_0x3daa07(0x21a)]=this[_0x3daa07(0x22a)][_0x3daa07(0x1f9)](),await this[_0x3daa07(0x1e8)]();if(!this[_0x3daa07(0x205)])throw new bad_request_error_1[(_0x3daa07(0x1f2))](errors_1[_0x3daa07(0x22b)]);this[_0x3daa07(0x223)]=await this[_0x3daa07(0x216)][_0x3daa07(0x1d1)](this[_0x3daa07(0x205)][_0x3daa07(0x20a)]),this[_0x3daa07(0x221)]=await this[_0x3daa07(0x223)][_0x3daa07(0x1da)][_0x3daa07(0x1d1)](this[_0x3daa07(0x205)][_0x3daa07(0x1ea)]),this[_0x3daa07(0x1d3)](_0x3daa07(0x20f)),this['exec']()[_0x3daa07(0x1de)](_0x5df770=>this[_0x3daa07(0x1e7)](_0x5df770));}catch(_0x1e3cbe){this[_0x3daa07(0x20c)]=undefined,logger[_0x3daa07(0x202)](_0x1e3cbe);throw _0x1e3cbe;}}};FlosumCommitJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a143_0x382c3c(0x1d2),[salesforce_service_1[a143_0x382c3c(0x219)],commit_components_job_1[a143_0x382c3c(0x218)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a143_0x382c3c(0x220)]])],FlosumCommitJob),exports['FlosumCommitJob']=FlosumCommitJob;