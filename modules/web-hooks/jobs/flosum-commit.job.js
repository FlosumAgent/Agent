function a146_0x30f8(_0x1e8ad9,_0x1f87e5){const _0x12fd16=a146_0x180f();return a146_0x30f8=function(_0x33ae2e,_0x317ef5){_0x33ae2e=_0x33ae2e-0x14c;let _0x180fd5=_0x12fd16[_0x33ae2e];return _0x180fd5;},a146_0x30f8(_0x1e8ad9,_0x1f87e5);}const a146_0x2d0971=a146_0x30f8;(function(_0x3d5499,_0x1a10da){const _0x35a5f7=a146_0x30f8,_0x3b2727=_0x3d5499();while(!![]){try{const _0x2c8b74=parseInt(_0x35a5f7(0x15a))/0x1*(parseInt(_0x35a5f7(0x16d))/0x2)+parseInt(_0x35a5f7(0x166))/0x3*(parseInt(_0x35a5f7(0x194))/0x4)+parseInt(_0x35a5f7(0x161))/0x5+-parseInt(_0x35a5f7(0x195))/0x6*(-parseInt(_0x35a5f7(0x19a))/0x7)+parseInt(_0x35a5f7(0x1a3))/0x8*(parseInt(_0x35a5f7(0x17c))/0x9)+-parseInt(_0x35a5f7(0x165))/0xa+-parseInt(_0x35a5f7(0x160))/0xb;if(_0x2c8b74===_0x1a10da)break;else _0x3b2727['push'](_0x3b2727['shift']());}catch(_0x2a4250){_0x3b2727['push'](_0x3b2727['shift']());}}}(a146_0x180f,0xc588e));const a146_0x317ef5=function(){let _0x29d858=!![];return function(_0x2bb6b1,_0x1ccaae){const _0x4dd87d=_0x29d858?function(){const _0x411048=a146_0x30f8;if(_0x1ccaae){const _0xc8093=_0x1ccaae[_0x411048(0x14f)](_0x2bb6b1,arguments);return _0x1ccaae=null,_0xc8093;}}:function(){};return _0x29d858=![],_0x4dd87d;};}(),a146_0x33ae2e=a146_0x317ef5(this,function(){const _0x2d953f=a146_0x30f8;return a146_0x33ae2e[_0x2d953f(0x14c)]()[_0x2d953f(0x169)](_0x2d953f(0x179))[_0x2d953f(0x14c)]()[_0x2d953f(0x177)](a146_0x33ae2e)[_0x2d953f(0x169)](_0x2d953f(0x179));});a146_0x33ae2e();'use strict';var __decorate=this&&this['__decorate']||function(_0x36719b,_0x31eaa3,_0xf2285a,_0xe36f49){const _0x57626a=a146_0x30f8;var _0x3ecfef=arguments['length'],_0xd69b7a=_0x3ecfef<0x3?_0x31eaa3:_0xe36f49===null?_0xe36f49=Object[_0x57626a(0x172)](_0x31eaa3,_0xf2285a):_0xe36f49,_0x7d2b4a;if(typeof Reflect===_0x57626a(0x15f)&&typeof Reflect[_0x57626a(0x158)]===_0x57626a(0x19d))_0xd69b7a=Reflect[_0x57626a(0x158)](_0x36719b,_0x31eaa3,_0xf2285a,_0xe36f49);else{for(var _0x718988=_0x36719b['length']-0x1;_0x718988>=0x0;_0x718988--)if(_0x7d2b4a=_0x36719b[_0x718988])_0xd69b7a=(_0x3ecfef<0x3?_0x7d2b4a(_0xd69b7a):_0x3ecfef>0x3?_0x7d2b4a(_0x31eaa3,_0xf2285a,_0xd69b7a):_0x7d2b4a(_0x31eaa3,_0xf2285a))||_0xd69b7a;}return _0x3ecfef>0x3&&_0xd69b7a&&Object[_0x57626a(0x180)](_0x31eaa3,_0xf2285a,_0xd69b7a),_0xd69b7a;},__metadata=this&&this['__metadata']||function(_0x49d143,_0x54e6b2){const _0x591f69=a146_0x30f8;if(typeof Reflect==='object'&&typeof Reflect[_0x591f69(0x1a9)]===_0x591f69(0x19d))return Reflect['metadata'](_0x49d143,_0x54e6b2);};Object[a146_0x2d0971(0x180)](exports,'__esModule',{'value':!![]}),exports[a146_0x2d0971(0x152)]=void 0x0;const core_1=require(a146_0x2d0971(0x18e)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a146_0x2d0971(0x1aa)),typedi_1=require(a146_0x2d0971(0x192)),errors_1=require(a146_0x2d0971(0x1a0)),bad_request_error_1=require(a146_0x2d0971(0x198)),salesforce_retriever_service_1=require(a146_0x2d0971(0x1a1)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),commit_components_dto_1=require(a146_0x2d0971(0x18d)),commit_components_job_1=require(a146_0x2d0971(0x182)),logger=new core_1[(a146_0x2d0971(0x186))](a146_0x2d0971(0x154));function a146_0x180f(){const _0x1773a2=['91XWOoFs','exec','branch','function','logger','Service','../../../constants/errors','../../salesforce/services/salesforce-retriever.service','salesforceService','7079216zGzSMX','handleCommitJobError','SalesforceRetrieverService','components','error','provider','metadata','../../shared/git-provider.manager','convertToSFDX','split','toString','gitUrl','syncBranchId','apply','repoService','updateLastCommit','FlosumCommitJob','getLogger','flosum-commit-job','repository','retrieveAttachment','sha','decorate','BadRequestError','1BLXpui','repo','setStatus','user','getComponentsToDelete','object','33824450OkCKva','7661565DOVLfO','trim','commitJob','getComponentsToWrite','4071010JlQXix','3PyhbgJ','run','ERR_INVALID_SYNC_RECORD_ID','search','commitData','CommitComponentsJob','design:paramtypes','2365802nTZZok','updateRemoteState','commitAttachmentId',']\x20[Repository:\x20','syncRepositoryId','getOwnPropertyDescriptor','gitManager','SalesforceService','catch','message','constructor','map','(((.+)+)+)+$','all','[INFO]\x20Start\x20commit\x20job','9kVXVFm','[COMMIT]\x20[','ERR_UNKNOWN_SYNC_RECORD_ID','getOne','defineProperty','salesforceSync','./commit-components.job','CommitComponentsDto','fetchRepositoryData','log','Logger','getCommitDto','repositoryName','name','toUpperCase',']\x20[Branch:\x20','deleteAttachmentId','../dto/commit-components.dto','../../../core','send','branches','setLoggerId','typedi','In\x20Progress','299764XwhHVD','284352zvpJiT','repositoryData','deleteAttachment','../../../core/errors/bad-request.error','then'];a146_0x180f=function(){return _0x1773a2;};return a146_0x180f();}let FlosumCommitJob=class FlosumCommitJob{constructor(_0x4dd524,_0x1e2127,_0x17545b,_0x39086b){const _0x235959=a146_0x2d0971;this['salesforceService']=_0x4dd524,this[_0x235959(0x163)]=_0x1e2127,this['salesforceSync']=_0x17545b,this[_0x235959(0x173)]=_0x39086b,this[_0x235959(0x150)]=this[_0x235959(0x173)]['getRepoService']();}[a146_0x2d0971(0x185)](_0xe4e8dd){const _0x1ead10=a146_0x2d0971;return this[_0x1ead10(0x19e)][_0x1ead10(0x185)](_0x1ead10(0x17d)+this[_0x1ead10(0x173)][_0x1ead10(0x1a8)][_0x1ead10(0x18a)]()+_0x1ead10(0x170)+this[_0x1ead10(0x155)][_0x1ead10(0x189)]+_0x1ead10(0x18b)+this[_0x1ead10(0x19c)][_0x1ead10(0x189)]+']\x20'+_0xe4e8dd);}async['fetchRepositoryData'](){const _0x2bb7f6=a146_0x2d0971;try{if(this[_0x2bb7f6(0x16a)][_0x2bb7f6(0x171)])this[_0x2bb7f6(0x196)]=await this['salesforceSync']['getRepositoryRecord'](this[_0x2bb7f6(0x16a)]['syncRepositoryId']);else this[_0x2bb7f6(0x16a)][_0x2bb7f6(0x14e)]&&(this[_0x2bb7f6(0x196)]=await this['salesforceSync']['getBranchRecord'](this[_0x2bb7f6(0x16a)][_0x2bb7f6(0x14e)]));}catch(_0x29849f){throw new bad_request_error_1[(_0x2bb7f6(0x159))](errors_1[_0x2bb7f6(0x168)]);}}async[a146_0x2d0971(0x164)](){const _0x588e3f=a146_0x2d0971;if(!this[_0x588e3f(0x16a)][_0x588e3f(0x16f)])return[];const _0x1a652c=await this[_0x588e3f(0x1a2)][_0x588e3f(0x156)](this[_0x588e3f(0x16a)]['commitAttachmentId'])[_0x588e3f(0x199)](_0x27be32=>_0x27be32[_0x588e3f(0x1ac)]('\x20')[_0x588e3f(0x178)](_0x2c7f61=>_0x2c7f61[_0x588e3f(0x162)]())),_0x42b577=new salesforce_retriever_service_1[(_0x588e3f(0x1a5))](this[_0x588e3f(0x1a2)]),_0x18d9a5=await _0x42b577[_0x588e3f(0x167)](_0x1a652c);return _0x18d9a5;}async[a146_0x2d0971(0x15e)](){const _0x422eb8=a146_0x2d0971;if(!this[_0x422eb8(0x16a)]['deleteAttachmentId'])return[];const _0x23a2cb=await this['salesforceService'][_0x422eb8(0x156)](this[_0x422eb8(0x16a)][_0x422eb8(0x18c)]);return _0x23a2cb;}async[a146_0x2d0971(0x187)](){const _0x31de27=a146_0x2d0971,_0x3df905=new commit_components_dto_1[(_0x31de27(0x183))](),[_0x117d54,_0x38af11]=await Promise[_0x31de27(0x17a)]([this[_0x31de27(0x164)](),this[_0x31de27(0x15e)]()]);return _0x3df905[_0x31de27(0x176)]=this[_0x31de27(0x16a)][_0x31de27(0x176)],_0x3df905[_0x31de27(0x15d)]=this['commitData'][_0x31de27(0x15d)],_0x3df905[_0x31de27(0x1a6)]={'writed':_0x117d54,'deleted':_0x38af11},_0x3df905[_0x31de27(0x1ab)]=this['commitData'][_0x31de27(0x1ab)],_0x3df905[_0x31de27(0x15b)]=this[_0x31de27(0x155)],_0x3df905[_0x31de27(0x19c)]=this[_0x31de27(0x19c)],_0x3df905;}async['updateLastCommit'](_0x22f742=![]){const _0x4c4a36=a146_0x2d0971;if(_0x22f742)await this['salesforceSync'][_0x4c4a36(0x16e)](this[_0x4c4a36(0x196)],{});else{const _0x65c2c=await this[_0x4c4a36(0x155)][_0x4c4a36(0x190)]['getOne'](this[_0x4c4a36(0x19c)][_0x4c4a36(0x189)]);this[_0x4c4a36(0x185)]('[INFO]\x20Update\x20remote\x20state.');const _0xe15e03={[this[_0x4c4a36(0x155)][_0x4c4a36(0x14d)]]:{'lastCommit':_0x65c2c[_0x4c4a36(0x157)]}};await this['salesforceSync'][_0x4c4a36(0x16e)](this['repositoryData'],_0xe15e03);}}async['exec'](){const _0x36377c=a146_0x2d0971,_0x4f1581=await this['getCommitDto']();this[_0x36377c(0x163)][_0x36377c(0x19e)]=this[_0x36377c(0x19e)],await this[_0x36377c(0x181)][_0x36377c(0x15c)](this[_0x36377c(0x196)],_0x36377c(0x193)),await this[_0x36377c(0x163)]['run'](_0x4f1581),await this['updateLastCommit'](),this[_0x36377c(0x16a)]['commitAttachmentId']&&await this[_0x36377c(0x1a2)]['deleteAttachment'](this[_0x36377c(0x16a)][_0x36377c(0x16f)]),this[_0x36377c(0x16a)][_0x36377c(0x18c)]&&await this[_0x36377c(0x1a2)][_0x36377c(0x197)](this[_0x36377c(0x16a)][_0x36377c(0x18c)]),await this['salesforceSync']['setStatus'](this[_0x36377c(0x196)],'Completed');}async[a146_0x2d0971(0x1a4)](_0x486e61){const _0x262a8d=a146_0x2d0971;try{this[_0x262a8d(0x19e)][_0x262a8d(0x185)]('[ERROR]\x20'+_0x486e61),await this[_0x262a8d(0x19e)][_0x262a8d(0x18f)](),await this[_0x262a8d(0x151)](!![]),await this[_0x262a8d(0x181)][_0x262a8d(0x15c)](this[_0x262a8d(0x196)],'Error');}catch(_0x6dc4b9){logger[_0x262a8d(0x1a7)](_0x6dc4b9);}}async[a146_0x2d0971(0x167)](_0x1cc4e6,_0x1a9907){const _0x22d3b6=a146_0x2d0971;try{this[_0x22d3b6(0x16a)]=_0x1cc4e6,this['salesforceService'][_0x22d3b6(0x191)](_0x1a9907),this['logger']=this[_0x22d3b6(0x1a2)][_0x22d3b6(0x153)](),await this[_0x22d3b6(0x184)]();if(!this[_0x22d3b6(0x196)])throw new bad_request_error_1[(_0x22d3b6(0x159))](errors_1[_0x22d3b6(0x17e)]);this[_0x22d3b6(0x155)]=await this[_0x22d3b6(0x150)][_0x22d3b6(0x17f)](this[_0x22d3b6(0x196)][_0x22d3b6(0x188)]),this[_0x22d3b6(0x19c)]=await this[_0x22d3b6(0x155)][_0x22d3b6(0x190)][_0x22d3b6(0x17f)](this['repositoryData']['branchName']),this[_0x22d3b6(0x185)](_0x22d3b6(0x17b)),this[_0x22d3b6(0x19b)]()[_0x22d3b6(0x175)](_0x2977ae=>this[_0x22d3b6(0x1a4)](_0x2977ae));}catch(_0x20ef2d){this[_0x22d3b6(0x16a)]=undefined,logger[_0x22d3b6(0x1a7)](_0x20ef2d);throw _0x20ef2d;}}};FlosumCommitJob=__decorate([(0x0,typedi_1[a146_0x2d0971(0x19f)])({'transient':!![]}),__metadata(a146_0x2d0971(0x16c),[salesforce_service_1[a146_0x2d0971(0x174)],commit_components_job_1[a146_0x2d0971(0x16b)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1['GitProviderManager']])],FlosumCommitJob),exports[a146_0x2d0971(0x152)]=FlosumCommitJob;