const a173_0x5b6c28=a173_0xae8b;(function(_0xaf07df,_0x42d8aa){const _0x21bac1=a173_0xae8b,_0x4b038f=_0xaf07df();while(!![]){try{const _0x299fcd=parseInt(_0x21bac1(0x147))/0x1+parseInt(_0x21bac1(0x14b))/0x2+-parseInt(_0x21bac1(0x116))/0x3+-parseInt(_0x21bac1(0xf4))/0x4*(parseInt(_0x21bac1(0x11f))/0x5)+parseInt(_0x21bac1(0x150))/0x6+parseInt(_0x21bac1(0x108))/0x7*(-parseInt(_0x21bac1(0x113))/0x8)+parseInt(_0x21bac1(0xf8))/0x9*(parseInt(_0x21bac1(0x143))/0xa);if(_0x299fcd===_0x42d8aa)break;else _0x4b038f['push'](_0x4b038f['shift']());}catch(_0x50b632){_0x4b038f['push'](_0x4b038f['shift']());}}}(a173_0x1e20,0x45718));const a173_0x2b7d06=function(){let _0x2df7d2=!![];return function(_0x39e0f1,_0x3b64b4){const _0x491dcf=_0x2df7d2?function(){const _0xdb17f3=a173_0xae8b;if(_0x3b64b4){const _0x4b1526=_0x3b64b4[_0xdb17f3(0x103)](_0x39e0f1,arguments);return _0x3b64b4=null,_0x4b1526;}}:function(){};return _0x2df7d2=![],_0x491dcf;};}(),a173_0x28adb1=a173_0x2b7d06(this,function(){const _0x4a72a2=a173_0xae8b;return a173_0x28adb1[_0x4a72a2(0x13a)]()['search'](_0x4a72a2(0xfe))[_0x4a72a2(0x13a)]()[_0x4a72a2(0x10f)](a173_0x28adb1)['search'](_0x4a72a2(0xfe));});a173_0x28adb1();'use strict';function a173_0xae8b(_0x375984,_0xc32d9f){const _0xf00cec=a173_0x1e20();return a173_0xae8b=function(_0x28adb1,_0x2b7d06){_0x28adb1=_0x28adb1-0xf0;let _0x1e20f7=_0xf00cec[_0x28adb1];return _0x1e20f7;},a173_0xae8b(_0x375984,_0xc32d9f);}var __decorate=this&&this[a173_0x5b6c28(0x132)]||function(_0x5b8cb3,_0x2d358a,_0x1a536c,_0x36e268){const _0x2a377f=a173_0x5b6c28;var _0x12cca9=arguments[_0x2a377f(0x13b)],_0x23e899=_0x12cca9<0x3?_0x2d358a:_0x36e268===null?_0x36e268=Object['getOwnPropertyDescriptor'](_0x2d358a,_0x1a536c):_0x36e268,_0x523bad;if(typeof Reflect==='object'&&typeof Reflect[_0x2a377f(0x127)]===_0x2a377f(0x119))_0x23e899=Reflect[_0x2a377f(0x127)](_0x5b8cb3,_0x2d358a,_0x1a536c,_0x36e268);else{for(var _0x526ebd=_0x5b8cb3['length']-0x1;_0x526ebd>=0x0;_0x526ebd--)if(_0x523bad=_0x5b8cb3[_0x526ebd])_0x23e899=(_0x12cca9<0x3?_0x523bad(_0x23e899):_0x12cca9>0x3?_0x523bad(_0x2d358a,_0x1a536c,_0x23e899):_0x523bad(_0x2d358a,_0x1a536c))||_0x23e899;}return _0x12cca9>0x3&&_0x23e899&&Object[_0x2a377f(0x10b)](_0x2d358a,_0x1a536c,_0x23e899),_0x23e899;},__metadata=this&&this[a173_0x5b6c28(0x124)]||function(_0x133c46,_0xd43504){const _0x652102=a173_0x5b6c28;if(typeof Reflect===_0x652102(0x10c)&&typeof Reflect['metadata']===_0x652102(0x119))return Reflect[_0x652102(0x136)](_0x133c46,_0xd43504);},__importDefault=this&&this['__importDefault']||function(_0x89a76e){return _0x89a76e&&_0x89a76e['__esModule']?_0x89a76e:{'default':_0x89a76e};};Object['defineProperty'](exports,a173_0x5b6c28(0x110),{'value':!![]}),exports['CommitComponentsJob']=void 0x0;const auth_settings_service_1=require(a173_0x5b6c28(0xf3)),events_1=__importDefault(require('events')),git_utils_1=require(a173_0x5b6c28(0x135)),mdapi_utils_1=require(a173_0x5b6c28(0x100)),sfdx_utils_1=require(a173_0x5b6c28(0x10a)),typedi_1=require('typedi'),child_types_1=__importDefault(require(a173_0x5b6c28(0x13e))),utils_1=require(a173_0x5b6c28(0x138)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service');let CommitComponentsJob=class CommitComponentsJob extends events_1[a173_0x5b6c28(0xfd)]{constructor(_0x214d74){const _0x3ec40e=a173_0x5b6c28;super(),this[_0x3ec40e(0x11d)]=_0x214d74,this[_0x3ec40e(0x129)]=0x3e8,this['componentsToWrite']=0x0,this[_0x3ec40e(0x12f)]=0x0,this['startTime']=Date['now']();}get[a173_0x5b6c28(0x11e)](){const _0x506f46=a173_0x5b6c28,{repo:_0x3e3b02}=this[_0x506f46(0x12d)],_0x26d889=this['authSettings'][_0x506f46(0x128)](this[_0x506f46(0x12d)][_0x506f46(0x122)]);return _0x3e3b02['gitUrl']['replace'](/http(s)?\:\/\/(.+@)?/,utils_1['getProtocol'](_0x3e3b02[_0x506f46(0x109)])+_0x506f46(0xf9)+_0x26d889+'@');}[a173_0x5b6c28(0x117)](_0x265488){const _0x12da04=a173_0x5b6c28;var _0x71aa1c;_0x265488[_0x12da04(0x106)](_0x21af8a=>child_types_1[_0x12da04(0xfd)]['includes'](_0x21af8a[_0x12da04(0x14d)])?0x1:-0x1);const _0x56ff0f={};for(const _0x11bbe5 of _0x265488){_0x56ff0f[_0x71aa1c=_0x11bbe5['fileName']]||(_0x56ff0f[_0x71aa1c]=[]),_0x56ff0f[_0x11bbe5[_0x12da04(0x141)]][_0x12da04(0xfc)](_0x11bbe5);}return Object[_0x12da04(0x121)](_0x56ff0f)[_0x12da04(0x134)]((_0x33d30e,_0x479ec7)=>[..._0x33d30e,..._0x479ec7],[]);}async[a173_0x5b6c28(0x144)](_0x33191c){const _0x4689d9=a173_0x5b6c28;_0x33191c=this[_0x4689d9(0x117)](_0x33191c);let _0x38b537=0x0;while(_0x33191c[_0x4689d9(0x13b)]){const _0x19b203=_0x33191c[_0x4689d9(0xf5)](0x0,this[_0x4689d9(0x129)]);await this[_0x4689d9(0x13d)][_0x4689d9(0x11a)](_0x19b203,{'skipChildErrors':this[_0x4689d9(0x12d)]['branch']['name']===_0x4689d9(0x126)}),_0x38b537+=_0x19b203['length'],this['sfLogger'][_0x4689d9(0xf6)](_0x4689d9(0x12b)+_0x38b537+'/'+this[_0x4689d9(0x11b)]+_0x4689d9(0x14a)),await this['sfLogger'][_0x4689d9(0x125)]();}}async['removeComponents'](_0x357aa0){const _0x556bb8=a173_0x5b6c28;_0x357aa0[_0x556bb8(0x106)](_0x1bda35=>child_types_1['default'][_0x556bb8(0x114)](_0x1bda35[_0x556bb8(0xfa)])?-0x1:0x1);let _0x1b0ca3=0x0;while(_0x357aa0[_0x556bb8(0x13b)]){const _0x1196af=_0x357aa0['splice'](0x0,this[_0x556bb8(0x129)]);await this[_0x556bb8(0x13d)][_0x556bb8(0xf2)](_0x1196af),_0x1b0ca3+=_0x1196af[_0x556bb8(0x13b)],this['sfLogger'][_0x556bb8(0xf6)](_0x556bb8(0x107)+_0x1b0ca3+'/'+this[_0x556bb8(0x12f)]+_0x556bb8(0x14a)),await this[_0x556bb8(0x118)][_0x556bb8(0x125)]();}}async[a173_0x5b6c28(0x12a)](){const _0xb5b15e=a173_0x5b6c28;this['gitUtils']&&await this['gitUtils'][_0xb5b15e(0x130)]()[_0xb5b15e(0x10e)](()=>void 0x0),this[_0xb5b15e(0x13d)]&&await this[_0xb5b15e(0x13d)][_0xb5b15e(0x130)]()['catch'](()=>void 0x0),this['sfdxUtils']&&await this[_0xb5b15e(0x140)][_0xb5b15e(0x130)]()[_0xb5b15e(0x10e)](()=>void 0x0);}async[a173_0x5b6c28(0x146)](){const _0x36ac90=a173_0x5b6c28,{repo:_0x3b72d0,branch:_0x3ba2e2,components:_0x47d100,convertToSFDX:_0x5ec334,message:_0x11affe,user:_0x5bc586}=this[_0x36ac90(0x12d)];this[_0x36ac90(0x13d)]=new mdapi_utils_1[(_0x36ac90(0x14e))](_0x3b72d0[_0x36ac90(0x115)],_0x3ba2e2['name']),this[_0x36ac90(0xff)]=new git_utils_1[(_0x36ac90(0x139))](this[_0x36ac90(0x11e)]),this[_0x36ac90(0x140)]=new sfdx_utils_1['SFDXUtils'](_0x3b72d0[_0x36ac90(0x115)],_0x3ba2e2[_0x36ac90(0x115)]);try{this[_0x36ac90(0x118)][_0x36ac90(0xf6)](_0x36ac90(0x142)),await this[_0x36ac90(0xff)][_0x36ac90(0x12e)](_0x3ba2e2[_0x36ac90(0x115)],_0x3b72d0[_0x36ac90(0x115)]);!this[_0x36ac90(0x12d)][_0x36ac90(0x105)]?(this['sfLogger']['log']('[INFO]\x20Prepare\x20mdapi\x20files'),await this[_0x36ac90(0x13d)][_0x36ac90(0x148)](this[_0x36ac90(0xff)][_0x36ac90(0x133)])):this[_0x36ac90(0x118)]['log']('[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.');_0x47d100[_0x36ac90(0x102)]&&(this[_0x36ac90(0x118)][_0x36ac90(0xf6)]('[INFO]\x20Preparing\x20to\x20write\x20components'),this[_0x36ac90(0x11b)]=_0x47d100[_0x36ac90(0x102)]['length'],await this[_0x36ac90(0x144)](_0x47d100[_0x36ac90(0x102)]),await this[_0x36ac90(0x118)][_0x36ac90(0x125)]());_0x47d100[_0x36ac90(0x12c)]&&(this[_0x36ac90(0x118)][_0x36ac90(0xf6)]('[INFO]\x20Preparing\x20to\x20delete\x20components'),this[_0x36ac90(0x12f)]=_0x47d100['deleted'][_0x36ac90(0x13b)],await this[_0x36ac90(0xf2)](_0x47d100[_0x36ac90(0x12c)]),await this[_0x36ac90(0x118)][_0x36ac90(0x125)]());await this[_0x36ac90(0xff)][_0x36ac90(0x101)](),await this[_0x36ac90(0x118)][_0x36ac90(0x125)]();_0x5ec334?(this[_0x36ac90(0x118)][_0x36ac90(0xf6)](_0x36ac90(0x11c)),await this[_0x36ac90(0x140)][_0x36ac90(0xf0)](this[_0x36ac90(0x13d)][_0x36ac90(0x133)]),await this[_0x36ac90(0x140)][_0x36ac90(0x10d)](this[_0x36ac90(0xff)][_0x36ac90(0x133)]),await this['sfdxUtils'][_0x36ac90(0x130)](),await this[_0x36ac90(0x118)][_0x36ac90(0x125)]()):(this[_0x36ac90(0x118)][_0x36ac90(0xf6)](_0x36ac90(0x145)),await this[_0x36ac90(0x13d)][_0x36ac90(0xf1)](this['gitUtils'][_0x36ac90(0x133)]),await this[_0x36ac90(0x118)][_0x36ac90(0x125)]());this[_0x36ac90(0x118)][_0x36ac90(0xf6)](_0x36ac90(0x13f)),await this['gitUtils'][_0x36ac90(0x149)](_0x11affe,{'email':_0x5bc586['email'],'name':_0x5bc586[_0x36ac90(0x115)]},_0x3ba2e2[_0x36ac90(0x115)]),await this['gitUtils'][_0x36ac90(0x130)](),await this[_0x36ac90(0x13d)]['removeDir']();const _0x108a04=this[_0x36ac90(0x11b)]+this[_0x36ac90(0x12f)];this[_0x36ac90(0x118)][_0x36ac90(0xf6)]('[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x36ac90(0x131)]()-this[_0x36ac90(0x137)])+_0x36ac90(0x14f)+_0x108a04),await this['sfLogger'][_0x36ac90(0x125)]();}catch(_0x447f33){await this[_0x36ac90(0x12a)](),this['sfLogger']['log']('[ERROR]\x20'+_0x447f33),await this[_0x36ac90(0x118)][_0x36ac90(0x125)]();throw _0x447f33;}}async['run'](_0x4ca4e2,_0x40b037){const _0x382dfa=a173_0x5b6c28;var _0x209519,_0x43176c,_0x39e533,_0x2c3451;this[_0x382dfa(0x118)]=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x40b037[_0x382dfa(0x104)](),_0x40b037[_0x382dfa(0x123)]()+_0x382dfa(0x13c));const _0x3369c4=!!((_0x43176c=(_0x209519=_0x4ca4e2[_0x382dfa(0x120)])===null||_0x209519===void 0x0?void 0x0:_0x209519[_0x382dfa(0x102)])===null||_0x43176c===void 0x0?void 0x0:_0x43176c[_0x382dfa(0x13b)])||!!((_0x2c3451=(_0x39e533=_0x4ca4e2[_0x382dfa(0x120)])===null||_0x39e533===void 0x0?void 0x0:_0x39e533['deleted'])===null||_0x2c3451===void 0x0?void 0x0:_0x2c3451[_0x382dfa(0x13b)]);if(!_0x3369c4){this[_0x382dfa(0x118)][_0x382dfa(0xf6)](_0x382dfa(0xf7)),await this[_0x382dfa(0x118)][_0x382dfa(0x125)]();return;}this['commitData']=_0x4ca4e2,await this[_0x382dfa(0x146)]();}};function a173_0x1e20(){const _0x3ceefd=['sfdxUtils','fileName','[INFO]\x20Start\x20clonning\x20repository','470rBEmVy','writeComponents','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','exec','432084zbcTFt','prepareMdapi','commitAndPush','\x20components','2462spApvm','CommitComponentsJob','fileType','MDApiUtils','ms.\x20Commited\x20components\x20-\x20','1420206RkymKm','createProjectFrom','copyMdapiTo','removeComponents','../../shared/services/auth-settings.service','8308hCHgSY','splice','log','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','67230dJTooQ','://','type','AuthSettingsService','push','default','(((.+)+)+)+$','gitUtils','../utils/mdapi.utils','clearDir','writed','apply','getLoggerId','force','sort','[INFO]\x20Deleted\x20','233905Eeygsu','gitUrl','../utils/sfdx.utils','defineProperty','object','copyProjectTo','catch','constructor','__esModule','Service','design:paramtypes','104LpWEQg','includes','name','607725qLbJyH','groupComponentsByFileName','sfLogger','function','writeFlosumComponents','componentsToWrite','[INFO]\x20Start\x20converting\x20to\x20SFDX','authSettings','remote','240MAWzsC','components','values','provider','getPrefix','__metadata','send','master','decorate','getCredentialsFor','COMPONENTS_PER_TICK','cleanUp','[INFO]\x20Writed\x20','deleted','commitData','clone','componentsToDelete','removeDir','now','__decorate','dir','reduce','../utils/git.utils','metadata','startTime','../../shared/utils','GitUtils','toString','length','\x20[COMMIT]','mdapiUtils','../../parsers/data/child-types','[INFO]\x20Commiting\x20and\x20pushing\x20source\x20to\x20git'];a173_0x1e20=function(){return _0x3ceefd;};return a173_0x1e20();}CommitComponentsJob=__decorate([typedi_1[a173_0x5b6c28(0x111)]({'transient':!![]}),__metadata(a173_0x5b6c28(0x112),[auth_settings_service_1[a173_0x5b6c28(0xfb)]])],CommitComponentsJob),exports[a173_0x5b6c28(0x14c)]=CommitComponentsJob;