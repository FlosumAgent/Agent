const a179_0x5f1a1d=a179_0x2415;(function(_0xe5a5a0,_0x134170){const _0x25597c=a179_0x2415,_0x17f9bf=_0xe5a5a0();while(!![]){try{const _0x37dbdd=-parseInt(_0x25597c(0x242))/0x1*(parseInt(_0x25597c(0x25b))/0x2)+-parseInt(_0x25597c(0x25f))/0x3*(parseInt(_0x25597c(0x21b))/0x4)+parseInt(_0x25597c(0x243))/0x5+-parseInt(_0x25597c(0x25c))/0x6+parseInt(_0x25597c(0x1f7))/0x7*(-parseInt(_0x25597c(0x21c))/0x8)+-parseInt(_0x25597c(0x200))/0x9*(-parseInt(_0x25597c(0x1f0))/0xa)+-parseInt(_0x25597c(0x237))/0xb*(-parseInt(_0x25597c(0x246))/0xc);if(_0x37dbdd===_0x134170)break;else _0x17f9bf['push'](_0x17f9bf['shift']());}catch(_0x4acce5){_0x17f9bf['push'](_0x17f9bf['shift']());}}}(a179_0x4ae5,0x2fc11));const a179_0x505242=function(){let _0x118106=!![];return function(_0x3a3d76,_0x2f0576){const _0x4491a5=_0x118106?function(){const _0x41afd3=a179_0x2415;if(_0x2f0576){const _0x133235=_0x2f0576[_0x41afd3(0x229)](_0x3a3d76,arguments);return _0x2f0576=null,_0x133235;}}:function(){};return _0x118106=![],_0x4491a5;};}(),a179_0x336be5=a179_0x505242(this,function(){const _0x48e8d5=a179_0x2415;return a179_0x336be5[_0x48e8d5(0x226)]()[_0x48e8d5(0x23d)](_0x48e8d5(0x238))[_0x48e8d5(0x226)]()[_0x48e8d5(0x20a)](a179_0x336be5)[_0x48e8d5(0x23d)](_0x48e8d5(0x238));});function a179_0x2415(_0x1154f9,_0x3db66d){const _0x11f3ae=a179_0x4ae5();return a179_0x2415=function(_0x336be5,_0x505242){_0x336be5=_0x336be5-0x1f0;let _0x4ae52b=_0x11f3ae[_0x336be5];return _0x4ae52b;},a179_0x2415(_0x1154f9,_0x3db66d);}function a179_0x4ae5(){const _0x4e9e11=['length','sfLogger','CommitComponentsDto','[INFO]\x20Preparing\x20to\x20write\x20components','[INFO]\x20Committing\x20and\x20pushing\x20source\x20to\x20git','getProtocol','57099buCeJL','\x20components','../utils/sfdx.utils','../../git-api/services/bitbucket-api.service','../../shared/services/auth-settings.service','gitUrl','default','[INFO]\x20Start\x20clonning\x20repository','force','1503UwRKpj','components','exec','defineProperty','branch','BitbucketApiService','send','dir','object','mdapiUtils','constructor','startTime','getAccessToken','__esModule','componentsToWrite','groupComponentsByFileName','fileName','componentsToDelete','create','sfdxUtils','design:paramtypes','[INFO]\x20Copying\x20mdapi\x20to\x20git\x20folder','provider','COMPONENTS_PER_TICK','[INFO]\x20Wrote\x20','master','../dto/commit-components.dto','699292qptHLB','232keUbzK','clearDir','push','createProjectFrom','[INFO]\x20Start\x20converting\x20to\x20SFDX','prototype','__createBinding','authSettings','getCredentialsFor','../../parsers/data/child-types','toString','writeFlosumComponents','Service','apply','[INFO]\x20Force\x20sync.\x20Skip\x20preparing\x20mdapi\x20from\x20repository.','name','catch','__decorate','sort','call','AuthSettingsService','log','__importDefault','writed','isLoggedIn','ms.\x20Committed\x20components\x20-\x20','now','11OXDjvJ','(((.+)+)+)+$','clone','SFDXUtils','prepareMdapi','copyMdapiTo','search','DEFAULT_GIT_USER_EMAIL','cleanUp','[INFO]\x20Nothing\x20to\x20commit.\x20Skip.','__setModuleDefault','83xiBtgU','633150TKKIBs','CommitComponentsJob','getLoggerId','10318452eWdIQV','typedi','values','metadata','GitUtils','MDApiUtils','writeComponents','get','function','gitUtils','removeComponents','splice','replace','reduce','commitData','../../salesforce/services/salesforce-logger-v2.service','://','[INFO]\x20Preparing\x20to\x20delete\x20components','removeDir','__metadata','includes','8232eUZyfU','520962wuAeqt','decorate','deleted','3vRNNnt','type','events','2930lZKCBw'];a179_0x4ae5=function(){return _0x4e9e11;};return a179_0x4ae5();}a179_0x336be5();'use strict';var __createBinding=this&&this[a179_0x5f1a1d(0x222)]||(Object[a179_0x5f1a1d(0x212)]?function(_0x5361a6,_0x2394c9,_0x3be2b7,_0x4b7df3){const _0x1e2100=a179_0x5f1a1d;if(_0x4b7df3===undefined)_0x4b7df3=_0x3be2b7;Object[_0x1e2100(0x203)](_0x5361a6,_0x4b7df3,{'enumerable':!![],'get':function(){return _0x2394c9[_0x3be2b7];}});}:function(_0x3fb9e0,_0x2392d4,_0x57a289,_0xcabde8){if(_0xcabde8===undefined)_0xcabde8=_0x57a289;_0x3fb9e0[_0xcabde8]=_0x2392d4[_0x57a289];}),__setModuleDefault=this&&this[a179_0x5f1a1d(0x241)]||(Object[a179_0x5f1a1d(0x212)]?function(_0x173019,_0x56ba4f){const _0x3dcdaf=a179_0x5f1a1d;Object['defineProperty'](_0x173019,_0x3dcdaf(0x1fd),{'enumerable':!![],'value':_0x56ba4f});}:function(_0x3be05e,_0x343f77){const _0x168b4d=a179_0x5f1a1d;_0x3be05e[_0x168b4d(0x1fd)]=_0x343f77;}),__decorate=this&&this[a179_0x5f1a1d(0x22d)]||function(_0x4eb496,_0x8071e8,_0x1b5e6e,_0xd2103f){const _0x5f110a=a179_0x5f1a1d;var _0x4acf2f=arguments[_0x5f110a(0x1f1)],_0x643f97=_0x4acf2f<0x3?_0x8071e8:_0xd2103f===null?_0xd2103f=Object['getOwnPropertyDescriptor'](_0x8071e8,_0x1b5e6e):_0xd2103f,_0x3a8670;if(typeof Reflect==='object'&&typeof Reflect[_0x5f110a(0x25d)]===_0x5f110a(0x24e))_0x643f97=Reflect[_0x5f110a(0x25d)](_0x4eb496,_0x8071e8,_0x1b5e6e,_0xd2103f);else{for(var _0x45a5cd=_0x4eb496['length']-0x1;_0x45a5cd>=0x0;_0x45a5cd--)if(_0x3a8670=_0x4eb496[_0x45a5cd])_0x643f97=(_0x4acf2f<0x3?_0x3a8670(_0x643f97):_0x4acf2f>0x3?_0x3a8670(_0x8071e8,_0x1b5e6e,_0x643f97):_0x3a8670(_0x8071e8,_0x1b5e6e))||_0x643f97;}return _0x4acf2f>0x3&&_0x643f97&&Object[_0x5f110a(0x203)](_0x8071e8,_0x1b5e6e,_0x643f97),_0x643f97;},__importStar=this&&this['__importStar']||function(_0x281e91){const _0x4de14d=a179_0x5f1a1d;if(_0x281e91&&_0x281e91[_0x4de14d(0x20d)])return _0x281e91;var _0x142ed1={};if(_0x281e91!=null){for(var _0x1ce681 in _0x281e91)if(_0x1ce681!==_0x4de14d(0x1fd)&&Object[_0x4de14d(0x221)]['hasOwnProperty'][_0x4de14d(0x22f)](_0x281e91,_0x1ce681))__createBinding(_0x142ed1,_0x281e91,_0x1ce681);}return __setModuleDefault(_0x142ed1,_0x281e91),_0x142ed1;},__metadata=this&&this[a179_0x5f1a1d(0x259)]||function(_0x4a5481,_0x408fcf){const _0x4280ed=a179_0x5f1a1d;if(typeof Reflect===_0x4280ed(0x208)&&typeof Reflect['metadata']==='function')return Reflect[_0x4280ed(0x249)](_0x4a5481,_0x408fcf);},__importDefault=this&&this[a179_0x5f1a1d(0x232)]||function(_0x55eda1){return _0x55eda1&&_0x55eda1['__esModule']?_0x55eda1:{'default':_0x55eda1};};Object[a179_0x5f1a1d(0x203)](exports,a179_0x5f1a1d(0x20d),{'value':!![]}),exports[a179_0x5f1a1d(0x244)]=void 0x0;const auth_settings_service_1=require(a179_0x5f1a1d(0x1fb)),commit_components_dto_1=require(a179_0x5f1a1d(0x21a)),events_1=__importDefault(require(a179_0x5f1a1d(0x261))),git_utils_1=require('../utils/git.utils'),mdapi_utils_1=require('../utils/mdapi.utils'),sfdx_utils_1=require(a179_0x5f1a1d(0x1f9)),typedi_1=__importStar(require(a179_0x5f1a1d(0x247))),child_types_1=__importDefault(require(a179_0x5f1a1d(0x225))),utils_1=require('../../shared/utils'),salesforce_logger_v2_service_1=require(a179_0x5f1a1d(0x255)),constants_1=require('../../../constants'),bitbucket_api_service_1=require(a179_0x5f1a1d(0x1fa));let CommitComponentsJob=class CommitComponentsJob extends events_1[a179_0x5f1a1d(0x1fd)]{constructor(_0x3beda4){const _0x5b3965=a179_0x5f1a1d;super(),this[_0x5b3965(0x223)]=_0x3beda4,this[_0x5b3965(0x217)]=0x3e8,this[_0x5b3965(0x20e)]=0x0,this[_0x5b3965(0x211)]=0x0,this['startTime']=Date[_0x5b3965(0x236)]();}async['getRemote'](){const _0x5ad30f=a179_0x5f1a1d,{repo:_0x3d369d}=this[_0x5ad30f(0x254)];let _0x2d467f=this['authSettings'][_0x5ad30f(0x224)](this[_0x5ad30f(0x254)]['provider']);if(this[_0x5ad30f(0x254)][_0x5ad30f(0x216)]==='bitbucket'){const _0x5adf5a=typedi_1[_0x5ad30f(0x1fd)][_0x5ad30f(0x24d)](bitbucket_api_service_1[_0x5ad30f(0x205)]);await _0x5adf5a[_0x5ad30f(0x234)](),_0x2d467f+=encodeURIComponent(_0x5adf5a[_0x5ad30f(0x20c)]());}return _0x3d369d[_0x5ad30f(0x1fc)][_0x5ad30f(0x252)](/http(s)?\:\/\/(.+@)?/,utils_1[_0x5ad30f(0x1f6)](_0x3d369d['gitUrl'])+_0x5ad30f(0x256)+_0x2d467f+'@');}[a179_0x5f1a1d(0x20f)](_0x47acc1){const _0x190a71=a179_0x5f1a1d;var _0x55874f;_0x47acc1[_0x190a71(0x22e)](_0x103756=>child_types_1[_0x190a71(0x1fd)]['includes'](_0x103756['fileType'])?0x1:-0x1);const _0x591c8f={};for(const _0x80243d of _0x47acc1){_0x591c8f[_0x55874f=_0x80243d['fileName']]||(_0x591c8f[_0x55874f]=[]),_0x591c8f[_0x80243d[_0x190a71(0x210)]][_0x190a71(0x21e)](_0x80243d);}return Object[_0x190a71(0x248)](_0x591c8f)[_0x190a71(0x253)]((_0x582247,_0x120bee)=>[..._0x582247,..._0x120bee],[]);}async[a179_0x5f1a1d(0x24c)](_0x2a7530){const _0x8569cc=a179_0x5f1a1d;_0x2a7530=this[_0x8569cc(0x20f)](_0x2a7530);let _0x3b363d=0x0;while(_0x2a7530['length']){const _0x5aab3f=_0x2a7530[_0x8569cc(0x251)](0x0,this['COMPONENTS_PER_TICK']);await this['mdapiUtils'][_0x8569cc(0x227)](_0x5aab3f,{'skipChildErrors':this[_0x8569cc(0x254)][_0x8569cc(0x204)][_0x8569cc(0x22b)]===_0x8569cc(0x219)}),_0x3b363d+=_0x5aab3f[_0x8569cc(0x1f1)],this[_0x8569cc(0x1f2)][_0x8569cc(0x231)](_0x8569cc(0x218)+_0x3b363d+'/'+this[_0x8569cc(0x20e)]+_0x8569cc(0x1f8)),await this[_0x8569cc(0x1f2)][_0x8569cc(0x206)]();}}async[a179_0x5f1a1d(0x250)](_0x5ab481){const _0x218f22=a179_0x5f1a1d;_0x5ab481[_0x218f22(0x22e)](_0x4c5560=>child_types_1[_0x218f22(0x1fd)][_0x218f22(0x25a)](_0x4c5560[_0x218f22(0x260)])?-0x1:0x1);let _0x10d00d=0x0;while(_0x5ab481['length']){const _0x4b2c06=_0x5ab481[_0x218f22(0x251)](0x0,this[_0x218f22(0x217)]);await this[_0x218f22(0x209)][_0x218f22(0x250)](_0x4b2c06),_0x10d00d+=_0x4b2c06[_0x218f22(0x1f1)],this[_0x218f22(0x1f2)][_0x218f22(0x231)]('[INFO]\x20Deleted\x20'+_0x10d00d+'/'+this['componentsToDelete']+_0x218f22(0x1f8)),await this[_0x218f22(0x1f2)][_0x218f22(0x206)]();}}async['cleanUp'](){const _0x47bb66=a179_0x5f1a1d;this[_0x47bb66(0x24f)]&&await this[_0x47bb66(0x24f)]['removeDir']()[_0x47bb66(0x22c)](()=>void 0x0),this[_0x47bb66(0x209)]&&await this[_0x47bb66(0x209)][_0x47bb66(0x258)]()[_0x47bb66(0x22c)](()=>void 0x0),this[_0x47bb66(0x213)]&&await this[_0x47bb66(0x213)][_0x47bb66(0x258)]()['catch'](()=>void 0x0);}async[a179_0x5f1a1d(0x202)](){const _0x34ef37=a179_0x5f1a1d,{repo:_0x42013a,branch:_0x41167e,components:_0x460408,convertToSFDX:_0x2346b0,message:_0x1addea,user:_0x1a066a}=this[_0x34ef37(0x254)];this[_0x34ef37(0x209)]=new mdapi_utils_1[(_0x34ef37(0x24b))](_0x42013a['name'],_0x41167e[_0x34ef37(0x22b)]),this['gitUtils']=new git_utils_1[(_0x34ef37(0x24a))](await this['getRemote']()),this['sfdxUtils']=new sfdx_utils_1[(_0x34ef37(0x23a))](_0x42013a[_0x34ef37(0x22b)],_0x41167e[_0x34ef37(0x22b)]);try{this[_0x34ef37(0x1f2)]['log'](_0x34ef37(0x1fe)),await this['gitUtils'][_0x34ef37(0x239)](_0x41167e[_0x34ef37(0x22b)],_0x42013a[_0x34ef37(0x22b)]);!this['commitData'][_0x34ef37(0x1ff)]?(this[_0x34ef37(0x1f2)][_0x34ef37(0x231)]('[INFO]\x20Prepare\x20mdapi\x20files'),await this[_0x34ef37(0x209)][_0x34ef37(0x23b)](this[_0x34ef37(0x24f)][_0x34ef37(0x207)])):this[_0x34ef37(0x1f2)]['log'](_0x34ef37(0x22a));_0x460408[_0x34ef37(0x233)]&&(this[_0x34ef37(0x1f2)][_0x34ef37(0x231)](_0x34ef37(0x1f4)),this[_0x34ef37(0x20e)]=_0x460408[_0x34ef37(0x233)][_0x34ef37(0x1f1)],await this['writeComponents'](_0x460408[_0x34ef37(0x233)]),await this[_0x34ef37(0x1f2)][_0x34ef37(0x206)]());_0x460408[_0x34ef37(0x25e)]&&(this[_0x34ef37(0x1f2)][_0x34ef37(0x231)](_0x34ef37(0x257)),this['componentsToDelete']=_0x460408[_0x34ef37(0x25e)][_0x34ef37(0x1f1)],await this[_0x34ef37(0x250)](_0x460408[_0x34ef37(0x25e)]),await this[_0x34ef37(0x1f2)]['send']());await this[_0x34ef37(0x24f)][_0x34ef37(0x21d)](),await this[_0x34ef37(0x1f2)][_0x34ef37(0x206)]();_0x2346b0?(this[_0x34ef37(0x1f2)]['log'](_0x34ef37(0x220)),await this[_0x34ef37(0x213)][_0x34ef37(0x21f)](this['mdapiUtils'][_0x34ef37(0x207)]),await this[_0x34ef37(0x213)]['copyProjectTo'](this[_0x34ef37(0x24f)][_0x34ef37(0x207)]),await this[_0x34ef37(0x213)][_0x34ef37(0x258)](),await this[_0x34ef37(0x1f2)][_0x34ef37(0x206)]()):(this[_0x34ef37(0x1f2)][_0x34ef37(0x231)](_0x34ef37(0x215)),await this[_0x34ef37(0x209)][_0x34ef37(0x23c)](this[_0x34ef37(0x24f)]['dir']),await this[_0x34ef37(0x1f2)][_0x34ef37(0x206)]());this[_0x34ef37(0x1f2)]['log'](_0x34ef37(0x1f5)),await this[_0x34ef37(0x24f)]['commitAndPush'](_0x1addea,{'email':constants_1[_0x34ef37(0x23e)],'name':_0x1a066a[_0x34ef37(0x22b)]},_0x41167e[_0x34ef37(0x22b)]),await this[_0x34ef37(0x24f)][_0x34ef37(0x258)](),await this['mdapiUtils'][_0x34ef37(0x258)]();const _0x5b060e=this[_0x34ef37(0x20e)]+this[_0x34ef37(0x211)];this[_0x34ef37(0x1f2)][_0x34ef37(0x231)]('[INFO]\x20Commit\x20job\x20done.\x20Time\x20spent\x20-\x20'+(Date[_0x34ef37(0x236)]()-this[_0x34ef37(0x20b)])+_0x34ef37(0x235)+_0x5b060e),await this[_0x34ef37(0x1f2)][_0x34ef37(0x206)]();}catch(_0xa64c5c){await this[_0x34ef37(0x23f)](),this[_0x34ef37(0x1f2)][_0x34ef37(0x231)]('[ERROR]\x20'+_0xa64c5c),await this[_0x34ef37(0x1f2)][_0x34ef37(0x206)]();throw _0xa64c5c;}}async['run'](_0x51bba5,_0x4a36e7){const _0x2320f9=a179_0x5f1a1d;var _0x1c1ef0,_0x4c7828;this[_0x2320f9(0x1f2)]=new salesforce_logger_v2_service_1['SalesforceLogger2'](_0x4a36e7[_0x2320f9(0x245)](),_0x4a36e7['getPrefix']()+'\x20['+commit_components_dto_1[_0x2320f9(0x1f3)]['name']+']');const _0x444a6c=!!((_0x1c1ef0=_0x51bba5[_0x2320f9(0x201)])===null||_0x1c1ef0===void 0x0?void 0x0:_0x1c1ef0[_0x2320f9(0x233)])||!!((_0x4c7828=_0x51bba5[_0x2320f9(0x201)])===null||_0x4c7828===void 0x0?void 0x0:_0x4c7828[_0x2320f9(0x25e)]);if(!_0x444a6c){this[_0x2320f9(0x1f2)]['log'](_0x2320f9(0x240)),await this[_0x2320f9(0x1f2)]['send']();return;}this[_0x2320f9(0x254)]=_0x51bba5,await this[_0x2320f9(0x202)]();}};CommitComponentsJob=__decorate([typedi_1[a179_0x5f1a1d(0x228)]({'transient':!![]}),__metadata(a179_0x5f1a1d(0x214),[auth_settings_service_1[a179_0x5f1a1d(0x230)]])],CommitComponentsJob),exports[a179_0x5f1a1d(0x244)]=CommitComponentsJob;