function a147_0x35ba(_0x2ee85c,_0x13b67e){const _0x80578f=a147_0x136a();return a147_0x35ba=function(_0x50c663,_0x3f8939){_0x50c663=_0x50c663-0xad;let _0x136aa8=_0x80578f[_0x50c663];return _0x136aa8;},a147_0x35ba(_0x2ee85c,_0x13b67e);}const a147_0x7817a9=a147_0x35ba;(function(_0xcc6cbb,_0x2d865c){const _0x1f14a3=a147_0x35ba,_0xaf9a1f=_0xcc6cbb();while(!![]){try{const _0x216b32=parseInt(_0x1f14a3(0xe7))/0x1*(-parseInt(_0x1f14a3(0xaf))/0x2)+parseInt(_0x1f14a3(0xb5))/0x3*(-parseInt(_0x1f14a3(0xee))/0x4)+-parseInt(_0x1f14a3(0xb3))/0x5+parseInt(_0x1f14a3(0xc4))/0x6+parseInt(_0x1f14a3(0xeb))/0x7*(parseInt(_0x1f14a3(0x10d))/0x8)+parseInt(_0x1f14a3(0xb8))/0x9+parseInt(_0x1f14a3(0xc9))/0xa*(parseInt(_0x1f14a3(0x100))/0xb);if(_0x216b32===_0x2d865c)break;else _0xaf9a1f['push'](_0xaf9a1f['shift']());}catch(_0x27df2f){_0xaf9a1f['push'](_0xaf9a1f['shift']());}}}(a147_0x136a,0x55398));const a147_0x3f8939=function(){let _0xd98032=!![];return function(_0x4e96f4,_0x30af8e){const _0x2e9d42=_0xd98032?function(){const _0x2b4df1=a147_0x35ba;if(_0x30af8e){const _0x48dc87=_0x30af8e[_0x2b4df1(0xfe)](_0x4e96f4,arguments);return _0x30af8e=null,_0x48dc87;}}:function(){};return _0xd98032=![],_0x2e9d42;};}(),a147_0x50c663=a147_0x3f8939(this,function(){const _0x6f95d7=a147_0x35ba;return a147_0x50c663[_0x6f95d7(0xd6)]()[_0x6f95d7(0xf8)]('(((.+)+)+)+$')[_0x6f95d7(0xd6)]()['constructor'](a147_0x50c663)['search']('(((.+)+)+)+$');});function a147_0x136a(){const _0x227c62=['130163wfJCvK','setStatus','Unable\x20to\x20synchronize\x20branch\x20\x27','function','__decorate','create','REPOSITORY_NAME_REGEXP','object','\x27\x20in\x20repository\x20\x27','__esModule','Unable\x20to\x20synchronize\x20repository\x20\x27','find','TooManyRequests','41128DrgwDt','send','gitManager','defineProperty','8dJwjrr','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','BRANCH_NAME_REGEXP','968955QDSJbD','checkValidNaming','3XqrzQS','FlosumSyncJob','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','2654487HuWNhZ','Logger','hasOwnProperty','getOwnPropertyDescriptor','getLogger','../../shared/git-provider.manager','metadata','getRepositoryRecords','setLoggerId','stringify','../../../core/errors/too-many-requests.error','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','2333556wEJxOg','getAll','prototype','get','getBranchRecords','70YoJkMw','error','salesforceService','convertToSFDX','SalesforceService','GitProviderManager','decorate','toLowerCase','__metadata','[INFO]\x20Start\x20sync\x20job','Service','isIntersects','./sync.job','toString','../../shared/utils','design:paramtypes','SalesforceSyncService','__createBinding','repositoryName','encodeBase64','repoService','salesforceSync','handleRecordSyncError','logger','call','run','../../../core','length','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','catch','66244CCQuoK','default','repositoriesIntersections','patchObject','168hSCANc',']\x20due\x20error\x20-\x20','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','328948mlJUml','../../salesforce/errors/salesforce.error','SyncJob','name','repositoryId','[INFO]\x20Sync\x20job\x20done.','__importStar','test','Attachment','\x27\x20[','search','SalesforceError','all','log','Error','branchName','apply','getRepoService'];a147_0x136a=function(){return _0x227c62;};return a147_0x136a();}a147_0x50c663();'use strict';var __createBinding=this&&this[a147_0x7817a9(0xda)]||(Object[a147_0x7817a9(0x105)]?function(_0x29a644,_0xae6046,_0x550abb,_0x5ec364){if(_0x5ec364===undefined)_0x5ec364=_0x550abb;Object['defineProperty'](_0x29a644,_0x5ec364,{'enumerable':!![],'get':function(){return _0xae6046[_0x550abb];}});}:function(_0x49e5f9,_0x9e2102,_0xe756f3,_0xa683f0){if(_0xa683f0===undefined)_0xa683f0=_0xe756f3;_0x49e5f9[_0xa683f0]=_0x9e2102[_0xe756f3];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a147_0x7817a9(0x105)]?function(_0x3233e9,_0x307d99){const _0x132fb3=a147_0x7817a9;Object[_0x132fb3(0xae)](_0x3233e9,_0x132fb3(0xe8),{'enumerable':!![],'value':_0x307d99});}:function(_0xca1aa9,_0x4c2885){const _0x328c85=a147_0x7817a9;_0xca1aa9[_0x328c85(0xe8)]=_0x4c2885;}),__decorate=this&&this[a147_0x7817a9(0x104)]||function(_0x2ae81b,_0x46d9a1,_0x54c48f,_0x1b2563){const _0x3b979d=a147_0x7817a9;var _0x12254d=arguments[_0x3b979d(0xe4)],_0x89f736=_0x12254d<0x3?_0x46d9a1:_0x1b2563===null?_0x1b2563=Object[_0x3b979d(0xbb)](_0x46d9a1,_0x54c48f):_0x1b2563,_0x308136;if(typeof Reflect===_0x3b979d(0x107)&&typeof Reflect[_0x3b979d(0xcf)]===_0x3b979d(0x103))_0x89f736=Reflect[_0x3b979d(0xcf)](_0x2ae81b,_0x46d9a1,_0x54c48f,_0x1b2563);else{for(var _0x40dace=_0x2ae81b['length']-0x1;_0x40dace>=0x0;_0x40dace--)if(_0x308136=_0x2ae81b[_0x40dace])_0x89f736=(_0x12254d<0x3?_0x308136(_0x89f736):_0x12254d>0x3?_0x308136(_0x46d9a1,_0x54c48f,_0x89f736):_0x308136(_0x46d9a1,_0x54c48f))||_0x89f736;}return _0x12254d>0x3&&_0x89f736&&Object['defineProperty'](_0x46d9a1,_0x54c48f,_0x89f736),_0x89f736;},__importStar=this&&this[a147_0x7817a9(0xf4)]||function(_0x5c2592){const _0x5d9471=a147_0x7817a9;if(_0x5c2592&&_0x5c2592[_0x5d9471(0x109)])return _0x5c2592;var _0x2a77f7={};if(_0x5c2592!=null){for(var _0x2572b9 in _0x5c2592)if(_0x2572b9!==_0x5d9471(0xe8)&&Object[_0x5d9471(0xc6)][_0x5d9471(0xba)][_0x5d9471(0xe1)](_0x5c2592,_0x2572b9))__createBinding(_0x2a77f7,_0x5c2592,_0x2572b9);}return __setModuleDefault(_0x2a77f7,_0x5c2592),_0x2a77f7;},__metadata=this&&this[a147_0x7817a9(0xd1)]||function(_0xd1ec8,_0x1c54a7){const _0xf49dca=a147_0x7817a9;if(typeof Reflect===_0xf49dca(0x107)&&typeof Reflect[_0xf49dca(0xbe)]==='function')return Reflect[_0xf49dca(0xbe)](_0xd1ec8,_0x1c54a7);},FlosumSyncJob_1;Object[a147_0x7817a9(0xae)](exports,a147_0x7817a9(0x109),{'value':!![]}),exports[a147_0x7817a9(0xb6)]=void 0x0;const constants_1=require('../../../constants'),typedi_1=__importStar(require('typedi')),core_1=require(a147_0x7817a9(0xe3)),too_many_requests_error_1=require(a147_0x7817a9(0xc2)),salesforce_error_1=require(a147_0x7817a9(0xef)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a147_0x7817a9(0xbd)),utils_1=require(a147_0x7817a9(0xd7)),sync_job_1=require(a147_0x7817a9(0xd5)),logger=new core_1[(a147_0x7817a9(0xb9))]('flosum-sync-job');let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x354443,_0x40bc0f,_0x484850){const _0x40a594=a147_0x7817a9;this[_0x40a594(0xcb)]=_0x354443,this['salesforceSync']=_0x40bc0f,this[_0x40a594(0xad)]=_0x484850,this['repoService']=this['gitManager'][_0x40a594(0xff)](),this[_0x40a594(0xe9)]={};}async[a147_0x7817a9(0xdf)](_0xdf85a8,_0x152411){const _0x4c579f=a147_0x7817a9;if(_0x152411 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x4c579f(0xde)][_0x4c579f(0x101)](_0xdf85a8,'Waiting');throw _0x152411;}try{const _0x4f4b8b=await this['salesforceSync']['getAttachmentId'](_0xdf85a8);this['logger']['log'](_0x4c579f(0xe5)+_0xdf85a8[_0x4c579f(0xdb)]+_0x4c579f(0xf7)+_0xdf85a8[_0x4c579f(0xfd)]+_0x4c579f(0xec)+_0x152411),await this[_0x4c579f(0xe0)][_0x4c579f(0x10e)](),await this['salesforceService'][_0x4c579f(0xea)](_0x4c579f(0xf6),_0x4f4b8b,{'Body':(0x0,utils_1[_0x4c579f(0xdc)])(JSON[_0x4c579f(0xc1)]({}))}),await this[_0x4c579f(0xde)][_0x4c579f(0x101)](_0xdf85a8,_0x4c579f(0xfc));}catch(_0x11a621){if(_0x11a621 instanceof salesforce_error_1[_0x4c579f(0xf9)])throw _0x11a621;}}async[a147_0x7817a9(0xd4)](_0x184aea){const _0x5ce44e=a147_0x7817a9;if(_0x184aea['repositoryId']){const _0x185f63=_0x184aea[_0x5ce44e(0xdb)][_0x5ce44e(0xd0)](),_0x5a9b4d=this[_0x5ce44e(0xe9)][_0x185f63];if(!_0x5a9b4d)this[_0x5ce44e(0xe9)][_0x185f63]=_0x184aea['repositoryName'];else{if(_0x5a9b4d&&_0x5a9b4d!==_0x184aea['repositoryName'])return await this[_0x5ce44e(0xdf)](_0x184aea,new Error(_0x5ce44e(0x10a)+_0x184aea[_0x5ce44e(0xdb)]+_0x5ce44e(0xb0)+_0x185f63+'\x27\x20-\x20\x27'+_0x5a9b4d+'\x27')),!![];}}return![];}async[a147_0x7817a9(0xb4)](_0x5a3b2e){const _0x401c86=a147_0x7817a9;if(!constants_1[_0x401c86(0x106)][_0x401c86(0xf5)](_0x5a3b2e[_0x401c86(0xdb)]))return await this[_0x401c86(0xdf)](_0x5a3b2e,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x5a3b2e[_0x401c86(0xdb)]+_0x401c86(0xed))),![];if(!constants_1[_0x401c86(0xb2)][_0x401c86(0xf5)](_0x5a3b2e[_0x401c86(0xfd)]))return await this[_0x401c86(0xdf)](_0x5a3b2e,new Error(_0x401c86(0x102)+_0x5a3b2e[_0x401c86(0xfd)]+_0x401c86(0x108)+_0x5a3b2e[_0x401c86(0xdb)]+_0x401c86(0xb1))),![];return!![];}async[a147_0x7817a9(0xe2)](_0x4f00f3,_0x32c623){const _0x5b5f85=a147_0x7817a9;this[_0x5b5f85(0xcb)][_0x5b5f85(0xc0)](_0x32c623),this[_0x5b5f85(0xe0)]=this[_0x5b5f85(0xcb)][_0x5b5f85(0xbc)]();try{this[_0x5b5f85(0xe0)]['log'](_0x5b5f85(0xd2)),await this['logger'][_0x5b5f85(0x10e)]();const [_0x4e18a2,_0x1aaa6c]=await Promise[_0x5b5f85(0xfa)]([this[_0x5b5f85(0xde)][_0x5b5f85(0xc8)](),this[_0x5b5f85(0xde)][_0x5b5f85(0xbf)]()]),_0x446e89=await this[_0x5b5f85(0xdd)][_0x5b5f85(0xc5)](),_0x1c234f=[..._0x1aaa6c,..._0x4e18a2];logger[_0x5b5f85(0xfb)]('have\x20to\x20synchronize\x20%d\x20branches',_0x1c234f['length']);for(const _0x53beb4 of _0x1c234f){const _0x567d96=typedi_1[_0x5b5f85(0xe8)]['get'](sync_job_1[_0x5b5f85(0xf0)]);logger[_0x5b5f85(0xfb)](_0x5b5f85(0xc3),_0x53beb4['repositoryName'],_0x53beb4[_0x5b5f85(0xf2)],_0x53beb4[_0x5b5f85(0xfd)],_0x53beb4['branchId']);const _0x196e88=await this['checkValidNaming'](_0x53beb4);if(!_0x196e88)continue;const _0x56cefe=await this[_0x5b5f85(0xd4)](_0x53beb4);if(_0x56cefe)continue;const _0x2a5746=_0x446e89[_0x5b5f85(0x10b)](_0x30cedb=>_0x30cedb[_0x5b5f85(0xf1)]===_0x53beb4[_0x5b5f85(0xdb)]);await _0x567d96[_0x5b5f85(0xe2)]({'repository':_0x2a5746,'convertToSFDX':_0x4f00f3[_0x5b5f85(0xcc)],'loggerId':_0x32c623,'syncRecord':_0x53beb4})[_0x5b5f85(0xe6)](_0x2615ec=>this['handleRecordSyncError'](_0x53beb4,_0x2615ec));}}catch(_0x545689){logger[_0x5b5f85(0xca)](_0x545689);if(_0x545689 instanceof too_many_requests_error_1[_0x5b5f85(0x10c)]){this[_0x5b5f85(0xe0)]['log']('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x20Wait\x20for\x201h\x20to\x20continue;'),await this[_0x5b5f85(0xe0)][_0x5b5f85(0x10e)]()[_0x5b5f85(0xe6)](()=>void 0x0),await(0x0,utils_1['sleep'])(0x3c*0x3c*0x3e8);const _0x59b736=typedi_1[_0x5b5f85(0xe8)][_0x5b5f85(0xc7)](FlosumSyncJob_1);_0x59b736[_0x5b5f85(0xe2)](_0x4f00f3,_0x32c623);}else this[_0x5b5f85(0xe0)][_0x5b5f85(0xfb)](_0x5b5f85(0xb7)+_0x545689),await this[_0x5b5f85(0xe0)][_0x5b5f85(0x10e)]()[_0x5b5f85(0xe6)](()=>void 0x0);return;}this[_0x5b5f85(0xe0)][_0x5b5f85(0xfb)](_0x5b5f85(0xf3)),await this['logger']['send'](),await this[_0x5b5f85(0xde)]['disableSync'](_0x4f00f3['syncID'])[_0x5b5f85(0xe6)](()=>null);}};FlosumSyncJob=FlosumSyncJob_1=__decorate([(0x0,typedi_1[a147_0x7817a9(0xd3)])({'transient':!![]}),__metadata(a147_0x7817a9(0xd8),[salesforce_service_1[a147_0x7817a9(0xcd)],salesforce_sync_service_1[a147_0x7817a9(0xd9)],git_provider_manager_1[a147_0x7817a9(0xce)]])],FlosumSyncJob),exports[a147_0x7817a9(0xb6)]=FlosumSyncJob;