const a147_0x59a24d=a147_0x15be;(function(_0x3862f3,_0x6d83d9){const _0x54f5c7=a147_0x15be,_0x1f78a3=_0x3862f3();while(!![]){try{const _0x542c45=-parseInt(_0x54f5c7(0x103))/0x1+-parseInt(_0x54f5c7(0xde))/0x2+parseInt(_0x54f5c7(0xb4))/0x3*(-parseInt(_0x54f5c7(0xf5))/0x4)+parseInt(_0x54f5c7(0xee))/0x5*(parseInt(_0x54f5c7(0xc1))/0x6)+-parseInt(_0x54f5c7(0xa7))/0x7+parseInt(_0x54f5c7(0x100))/0x8*(-parseInt(_0x54f5c7(0xc2))/0x9)+parseInt(_0x54f5c7(0xfb))/0xa*(parseInt(_0x54f5c7(0xb1))/0xb);if(_0x542c45===_0x6d83d9)break;else _0x1f78a3['push'](_0x1f78a3['shift']());}catch(_0x3b7548){_0x1f78a3['push'](_0x1f78a3['shift']());}}}(a147_0x2afe,0x72a38));const a147_0x388e72=function(){let _0x386dc4=!![];return function(_0x459de4,_0x5d623a){const _0x5e2707=_0x386dc4?function(){const _0x401825=a147_0x15be;if(_0x5d623a){const _0x4abf96=_0x5d623a[_0x401825(0xc0)](_0x459de4,arguments);return _0x5d623a=null,_0x4abf96;}}:function(){};return _0x386dc4=![],_0x5e2707;};}(),a147_0x143107=a147_0x388e72(this,function(){const _0x322426=a147_0x15be;return a147_0x143107[_0x322426(0x102)]()['search']('(((.+)+)+)+$')[_0x322426(0x102)]()[_0x322426(0xf0)](a147_0x143107)['search'](_0x322426(0xda));});function a147_0x2afe(){const _0x46bcb5=['convertToSFDX','../../shared/utils','__metadata','test','SalesforceSyncService','defineProperty','function','error','\x27\x20-\x20\x27','getAll','BRANCH_NAME_REGEXP','flosum-sync-job','syncID','call','../../../core','design:paramtypes',']\x20due\x20error\x20-\x20','(((.+)+)+)+$','repositoryName','[INFO]\x20Sync\x20job\x20done.','__esModule','102000aVIwzg','branchName','getRepositoryRecords','./sync.job','find','__decorate','stringify','logger','../../shared/git-provider.manager','SalesforceError','name','TooManyRequests','Unable\x20to\x20synchronize\x20branch\x20\x27','repoService','__createBinding','__setModuleDefault','23475GTiuZA','get','constructor','decorate','have\x20to\x20synchronize\x20%d\x20branches','[INFO]\x20Start\x20sync\x20job','handleRecordSyncError','3220SZNCxT','../../salesforce/errors/salesforce.error','setStatus','../../../core/errors/too-many-requests.error','checkValidNaming','GitProviderManager','12864080fpGRhh','Attachment','../../../constants','SalesforceService','../../salesforce/services/salesforce-sync.service','16UpnUNK','catch','toString','20743BSiKtz','create','FlosumSyncJob','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repositoriesIntersections','isIntersects','1282099AqpkIB','Unable\x20to\x20synchronize\x20repository\x20\x27','object','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x20Wait\x20for\x201h\x20to\x20continue;','patchObject','getAttachmentId','prototype','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','default','SyncJob','11mqdDGg','send','disableSync','1767EknwQQ','\x27\x20[','hasOwnProperty','metadata','../../salesforce/services/salesforce.service','log','salesforceSync','sleep','gitManager','length','branchId','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','apply','966SVtWoH','3796641JCrPzH','\x27\x20in\x20repository\x20\x27','getLogger','repositoryId','run','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'];a147_0x2afe=function(){return _0x46bcb5;};return a147_0x2afe();}a147_0x143107();function a147_0x15be(_0x2200d5,_0x1cfcbf){const _0x55b9c5=a147_0x2afe();return a147_0x15be=function(_0x143107,_0x388e72){_0x143107=_0x143107-0xa6;let _0x2afef3=_0x55b9c5[_0x143107];return _0x2afef3;},a147_0x15be(_0x2200d5,_0x1cfcbf);}'use strict';var __createBinding=this&&this[a147_0x59a24d(0xec)]||(Object['create']?function(_0x2c3542,_0x2381ca,_0x39bef4,_0x48eae5){const _0x131e81=a147_0x59a24d;if(_0x48eae5===undefined)_0x48eae5=_0x39bef4;Object[_0x131e81(0xce)](_0x2c3542,_0x48eae5,{'enumerable':!![],'get':function(){return _0x2381ca[_0x39bef4];}});}:function(_0x4188c0,_0x2de823,_0x3dbe83,_0x179918){if(_0x179918===undefined)_0x179918=_0x3dbe83;_0x4188c0[_0x179918]=_0x2de823[_0x3dbe83];}),__setModuleDefault=this&&this[a147_0x59a24d(0xed)]||(Object[a147_0x59a24d(0x104)]?function(_0x1e0e58,_0x3bcd72){const _0x9906f=a147_0x59a24d;Object[_0x9906f(0xce)](_0x1e0e58,_0x9906f(0xaf),{'enumerable':!![],'value':_0x3bcd72});}:function(_0x439c2c,_0x47c6ff){const _0x2fe337=a147_0x59a24d;_0x439c2c[_0x2fe337(0xaf)]=_0x47c6ff;}),__decorate=this&&this[a147_0x59a24d(0xe3)]||function(_0x55e07e,_0x448b5d,_0x582a94,_0x2f0391){const _0x29eeba=a147_0x59a24d;var _0x27db3e=arguments['length'],_0x4dc954=_0x27db3e<0x3?_0x448b5d:_0x2f0391===null?_0x2f0391=Object['getOwnPropertyDescriptor'](_0x448b5d,_0x582a94):_0x2f0391,_0x2a6f9d;if(typeof Reflect===_0x29eeba(0xa9)&&typeof Reflect['decorate']===_0x29eeba(0xcf))_0x4dc954=Reflect[_0x29eeba(0xf1)](_0x55e07e,_0x448b5d,_0x582a94,_0x2f0391);else{for(var _0x5852dc=_0x55e07e['length']-0x1;_0x5852dc>=0x0;_0x5852dc--)if(_0x2a6f9d=_0x55e07e[_0x5852dc])_0x4dc954=(_0x27db3e<0x3?_0x2a6f9d(_0x4dc954):_0x27db3e>0x3?_0x2a6f9d(_0x448b5d,_0x582a94,_0x4dc954):_0x2a6f9d(_0x448b5d,_0x582a94))||_0x4dc954;}return _0x27db3e>0x3&&_0x4dc954&&Object[_0x29eeba(0xce)](_0x448b5d,_0x582a94,_0x4dc954),_0x4dc954;},__importStar=this&&this['__importStar']||function(_0x318a43){const _0x3edd53=a147_0x59a24d;if(_0x318a43&&_0x318a43[_0x3edd53(0xdd)])return _0x318a43;var _0x44eec5={};if(_0x318a43!=null){for(var _0x36750f in _0x318a43)if(_0x36750f!=='default'&&Object[_0x3edd53(0xad)][_0x3edd53(0xb6)][_0x3edd53(0xd6)](_0x318a43,_0x36750f))__createBinding(_0x44eec5,_0x318a43,_0x36750f);}return __setModuleDefault(_0x44eec5,_0x318a43),_0x44eec5;},__metadata=this&&this[a147_0x59a24d(0xcb)]||function(_0x37370a,_0x5f2b7){const _0x31772c=a147_0x59a24d;if(typeof Reflect==='object'&&typeof Reflect[_0x31772c(0xb7)]===_0x31772c(0xcf))return Reflect[_0x31772c(0xb7)](_0x37370a,_0x5f2b7);},FlosumSyncJob_1;Object[a147_0x59a24d(0xce)](exports,'__esModule',{'value':!![]}),exports[a147_0x59a24d(0x105)]=void 0x0;const constants_1=require(a147_0x59a24d(0xfd)),typedi_1=__importStar(require('typedi')),core_1=require(a147_0x59a24d(0xd7)),too_many_requests_error_1=require(a147_0x59a24d(0xf8)),salesforce_error_1=require(a147_0x59a24d(0xf6)),salesforce_sync_service_1=require(a147_0x59a24d(0xff)),salesforce_service_1=require(a147_0x59a24d(0xb8)),git_provider_manager_1=require(a147_0x59a24d(0xe6)),utils_1=require(a147_0x59a24d(0xca)),sync_job_1=require(a147_0x59a24d(0xe1)),logger=new core_1['Logger'](a147_0x59a24d(0xd4));let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x270291,_0x4764bf,_0x212c81){const _0x3c3c93=a147_0x59a24d;this['salesforceService']=_0x270291,this[_0x3c3c93(0xba)]=_0x4764bf,this[_0x3c3c93(0xbc)]=_0x212c81,this[_0x3c3c93(0xeb)]=this['gitManager']['getRepoService'](),this['repositoriesIntersections']={};}async['handleRecordSyncError'](_0x65f739,_0x138221){const _0x3dfc51=a147_0x59a24d;if(_0x138221 instanceof too_many_requests_error_1[_0x3dfc51(0xe9)]){await this[_0x3dfc51(0xba)][_0x3dfc51(0xf7)](_0x65f739,'Waiting');throw _0x138221;}try{const _0x1b4fc8=await this[_0x3dfc51(0xba)][_0x3dfc51(0xac)](_0x65f739);this[_0x3dfc51(0xe5)][_0x3dfc51(0xb9)](_0x3dfc51(0xc7)+_0x65f739[_0x3dfc51(0xdb)]+_0x3dfc51(0xb5)+_0x65f739[_0x3dfc51(0xdf)]+_0x3dfc51(0xd9)+_0x138221),await this[_0x3dfc51(0xe5)][_0x3dfc51(0xb2)](),await this['salesforceService'][_0x3dfc51(0xab)](_0x3dfc51(0xfc),_0x1b4fc8,{'Body':(0x0,utils_1['encodeBase64'])(JSON[_0x3dfc51(0xe4)]({}))}),await this[_0x3dfc51(0xba)]['setStatus'](_0x65f739,'Error');}catch(_0x3cd988){if(_0x3cd988 instanceof salesforce_error_1[_0x3dfc51(0xe7)])throw _0x3cd988;}}async[a147_0x59a24d(0xa6)](_0x276476){const _0x22f72d=a147_0x59a24d;if(_0x276476[_0x22f72d(0xc5)]){const _0x2cd659=_0x276476[_0x22f72d(0xdb)]['toLowerCase'](),_0x55b989=this[_0x22f72d(0x107)][_0x2cd659];if(!_0x55b989)this[_0x22f72d(0x107)][_0x2cd659]=_0x276476[_0x22f72d(0xdb)];else{if(_0x55b989&&_0x55b989!==_0x276476[_0x22f72d(0xdb)])return await this[_0x22f72d(0xf4)](_0x276476,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x276476['repositoryName']+_0x22f72d(0xc8)+_0x2cd659+_0x22f72d(0xd1)+_0x55b989+'\x27')),!![];}}return![];}async[a147_0x59a24d(0xf9)](_0x34772c){const _0x311406=a147_0x59a24d;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x311406(0xcc)](_0x34772c['repositoryName']))return await this['handleRecordSyncError'](_0x34772c,new Error(_0x311406(0xa8)+_0x34772c[_0x311406(0xdb)]+_0x311406(0x106))),![];if(!constants_1[_0x311406(0xd3)][_0x311406(0xcc)](_0x34772c[_0x311406(0xdf)]))return await this[_0x311406(0xf4)](_0x34772c,new Error(_0x311406(0xea)+_0x34772c[_0x311406(0xdf)]+_0x311406(0xc3)+_0x34772c[_0x311406(0xdb)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a147_0x59a24d(0xc6)](_0x225d21,_0x29c3c9){const _0x478237=a147_0x59a24d;this['salesforceService']['setLoggerId'](_0x29c3c9),this[_0x478237(0xe5)]=this['salesforceService'][_0x478237(0xc4)]();try{this[_0x478237(0xe5)]['log'](_0x478237(0xf3)),await this[_0x478237(0xe5)]['send']();const [_0x4ee7a3,_0x18684f]=await Promise['all']([this['salesforceSync']['getBranchRecords'](),this[_0x478237(0xba)][_0x478237(0xe0)]()]),_0x3dd44d=await this['repoService'][_0x478237(0xd2)](),_0x542499=[..._0x18684f,..._0x4ee7a3];logger[_0x478237(0xb9)](_0x478237(0xf2),_0x542499[_0x478237(0xbd)]);for(const _0x268f67 of _0x542499){const _0x168ac8=typedi_1[_0x478237(0xaf)][_0x478237(0xef)](sync_job_1[_0x478237(0xb0)]);logger[_0x478237(0xb9)](_0x478237(0xae),_0x268f67[_0x478237(0xdb)],_0x268f67[_0x478237(0xc5)],_0x268f67['branchName'],_0x268f67[_0x478237(0xbe)]);const _0xe34eb2=await this[_0x478237(0xf9)](_0x268f67);if(!_0xe34eb2)continue;const _0x2c72b9=await this['isIntersects'](_0x268f67);if(_0x2c72b9)continue;const _0x4dff0a=_0x3dd44d[_0x478237(0xe2)](_0x144814=>_0x144814[_0x478237(0xe8)]===_0x268f67['repositoryName']);await _0x168ac8['run']({'repository':_0x4dff0a,'convertToSFDX':_0x225d21[_0x478237(0xc9)],'loggerId':_0x29c3c9,'syncRecord':_0x268f67})[_0x478237(0x101)](_0x34e4b5=>this[_0x478237(0xf4)](_0x268f67,_0x34e4b5));}}catch(_0x407e02){logger[_0x478237(0xd0)](_0x407e02);if(_0x407e02 instanceof too_many_requests_error_1[_0x478237(0xe9)]){this[_0x478237(0xe5)][_0x478237(0xb9)](_0x478237(0xaa)),await this[_0x478237(0xe5)][_0x478237(0xb2)]()[_0x478237(0x101)](()=>void 0x0),await(0x0,utils_1[_0x478237(0xbb)])(0x3c*0x3c*0x3e8);const _0xe477eb=typedi_1['default'][_0x478237(0xef)](FlosumSyncJob_1);_0xe477eb[_0x478237(0xc6)](_0x225d21,_0x29c3c9);}else this[_0x478237(0xe5)]['log'](_0x478237(0xbf)+_0x407e02),await this[_0x478237(0xe5)][_0x478237(0xb2)]()[_0x478237(0x101)](()=>void 0x0);return;}this[_0x478237(0xe5)][_0x478237(0xb9)](_0x478237(0xdc)),await this['logger'][_0x478237(0xb2)](),await this['salesforceSync'][_0x478237(0xb3)](_0x225d21[_0x478237(0xd5)])['catch'](()=>null);}};FlosumSyncJob=FlosumSyncJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a147_0x59a24d(0xd8),[salesforce_service_1[a147_0x59a24d(0xfe)],salesforce_sync_service_1[a147_0x59a24d(0xcd)],git_provider_manager_1[a147_0x59a24d(0xfa)]])],FlosumSyncJob),exports[a147_0x59a24d(0x105)]=FlosumSyncJob;