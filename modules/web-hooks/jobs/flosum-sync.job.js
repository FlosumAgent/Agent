const a181_0x4476a8=a181_0x5645;function a181_0x4a10(){const _0x40ae1a=['Completed','../../../core','string','parse','user','name','create','101570YARBDj','branches','465527rNjWdy','../../../constants','getCommitDto','getComponents','convertToSFDX','[INFO]\x20Update\x20remote\x20state.','length','lastCommit','function','(((.+)+)+)+$','4vjhSJw','salesforceService','search','object','branchName','getOne','apply','repository','setStatus','commitJob','[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','../../salesforce/services/salesforce-sync.service','getComponentsFromRepository','2462790bvzKbJ','send','sfLogger','repo','logger','[INFO]\x20Start\x20sync\x20job','FlosumSyncJob','defineProperty','force','1949091lpCKqY','decorate','Sync\x20repository','checkSyncStatus','getLoggerId','2MjYVhp','getPrefix','__decorate','gitUrl','catch','[INFO]\x20Sync\x20job\x20done.','updateLastCommit','branchId','DEFAULT_GIT_USER_NAME','updateRemoteState','branch','message','sha','./commit-components.job','provider','10222795gLtLye','SalesforceRetrieverService','[INFO]\x20Branch\x20synchronized.\x20Skip','CommitComponentsDto','SalesforceLogger2','metadata','getRemoteStateAttachmentId','232PslMtu','syncData','then','\x20[FLOSUM\x20->\x20GIT]\x20[Repository:\x20','9xIKbzw','createBranchIfNotExists','__esModule','2326266CftEdr','repositoryId','salesforceSync','__metadata','getBranchComponents','toString','run','Logger','repositoryName','SalesforceService','log','6691080SdDpWm'];a181_0x4a10=function(){return _0x40ae1a;};return a181_0x4a10();}function a181_0x5645(_0xfcb61e,_0x472134){const _0x2aa604=a181_0x4a10();return a181_0x5645=function(_0x1901e1,_0x534434){_0x1901e1=_0x1901e1-0xcb;let _0x4a106b=_0x2aa604[_0x1901e1];return _0x4a106b;},a181_0x5645(_0xfcb61e,_0x472134);}(function(_0x3eb445,_0x2951fc){const _0x11ff52=a181_0x5645,_0x12a019=_0x3eb445();while(!![]){try{const _0x55a21c=-parseInt(_0x11ff52(0xfb))/0x1*(-parseInt(_0x11ff52(0x120))/0x2)+parseInt(_0x11ff52(0x11b))/0x3*(parseInt(_0x11ff52(0x105))/0x4)+-parseInt(_0x11ff52(0x112))/0x5+-parseInt(_0x11ff52(0xe6))/0x6+-parseInt(_0x11ff52(0xf9))/0x7*(-parseInt(_0x11ff52(0xdf))/0x8)+-parseInt(_0x11ff52(0xe3))/0x9*(-parseInt(_0x11ff52(0xf1))/0xa)+-parseInt(_0x11ff52(0xd8))/0xb;if(_0x55a21c===_0x2951fc)break;else _0x12a019['push'](_0x12a019['shift']());}catch(_0x87d1fc){_0x12a019['push'](_0x12a019['shift']());}}}(a181_0x4a10,0x608f4));const a181_0x534434=function(){let _0x5ec6c6=!![];return function(_0x380f09,_0x54430e){const _0x34f59e=_0x5ec6c6?function(){const _0x15d035=a181_0x5645;if(_0x54430e){const _0x497fff=_0x54430e[_0x15d035(0x10b)](_0x380f09,arguments);return _0x54430e=null,_0x497fff;}}:function(){};return _0x5ec6c6=![],_0x34f59e;};}(),a181_0x1901e1=a181_0x534434(this,function(){const _0x493baa=a181_0x5645;return a181_0x1901e1[_0x493baa(0xeb)]()[_0x493baa(0x107)](_0x493baa(0x104))[_0x493baa(0xeb)]()['constructor'](a181_0x1901e1)[_0x493baa(0x107)](_0x493baa(0x104));});a181_0x1901e1();'use strict';var __decorate=this&&this[a181_0x4476a8(0xcb)]||function(_0x3b0ba2,_0x1dc80f,_0x46fbfe,_0x2acccc){const _0x398c0e=a181_0x4476a8;var _0x5643a1=arguments[_0x398c0e(0x101)],_0xca266=_0x5643a1<0x3?_0x1dc80f:_0x2acccc===null?_0x2acccc=Object['getOwnPropertyDescriptor'](_0x1dc80f,_0x46fbfe):_0x2acccc,_0x4e26f9;if(typeof Reflect===_0x398c0e(0x108)&&typeof Reflect[_0x398c0e(0x11c)]==='function')_0xca266=Reflect['decorate'](_0x3b0ba2,_0x1dc80f,_0x46fbfe,_0x2acccc);else{for(var _0x3ab101=_0x3b0ba2[_0x398c0e(0x101)]-0x1;_0x3ab101>=0x0;_0x3ab101--)if(_0x4e26f9=_0x3b0ba2[_0x3ab101])_0xca266=(_0x5643a1<0x3?_0x4e26f9(_0xca266):_0x5643a1>0x3?_0x4e26f9(_0x1dc80f,_0x46fbfe,_0xca266):_0x4e26f9(_0x1dc80f,_0x46fbfe))||_0xca266;}return _0x5643a1>0x3&&_0xca266&&Object[_0x398c0e(0x119)](_0x1dc80f,_0x46fbfe,_0xca266),_0xca266;},__metadata=this&&this[a181_0x4476a8(0xe9)]||function(_0x140fdf,_0x39988b){const _0x3c5047=a181_0x4476a8;if(typeof Reflect===_0x3c5047(0x108)&&typeof Reflect[_0x3c5047(0xdd)]===_0x3c5047(0x103))return Reflect[_0x3c5047(0xdd)](_0x140fdf,_0x39988b);},FlosumSyncJob_1;Object['defineProperty'](exports,a181_0x4476a8(0xe5),{'value':!![]}),exports[a181_0x4476a8(0x118)]=void 0x0;const core_1=require(a181_0x4476a8(0xf3)),salesforce_logger_v2_service_1=require('../../salesforce/services/salesforce-logger-v2.service'),typedi_1=require('typedi'),constants_1=require(a181_0x4476a8(0xfc)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a181_0x4476a8(0x110)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a181_0x4476a8(0xd6));let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x3e5a18,_0xb19291,_0x151ed1){const _0x527162=a181_0x4476a8;this[_0x527162(0xe8)]=_0x3e5a18,this[_0x527162(0x106)]=_0xb19291,this[_0x527162(0x10e)]=_0x151ed1,this[_0x527162(0x116)]=new core_1[(_0x527162(0xed))](FlosumSyncJob_1[_0x527162(0xf7)]);}[a181_0x4476a8(0xf0)](_0x24e340){const _0x29aac2=a181_0x4476a8;return this[_0x29aac2(0x114)]['log'](_0x29aac2(0x10f)+this[_0x29aac2(0xe0)][_0x29aac2(0xee)]+']\x20[Branch:\x20'+this['syncData'][_0x29aac2(0x109)]+']\x20'+_0x24e340);}async['createBranchIfNotExists'](){const _0x1fcc41=a181_0x4476a8;let _0x1ba019=await this['repository'][_0x1fcc41(0xfa)][_0x1fcc41(0x10a)](this['syncData'][_0x1fcc41(0x109)])['catch'](()=>null);!_0x1ba019&&(_0x1ba019=await this[_0x1fcc41(0x10c)]['branches'][_0x1fcc41(0xf8)]({'name':this[_0x1fcc41(0xe0)][_0x1fcc41(0x109)]})),this[_0x1fcc41(0xd3)]=_0x1ba019;}async['getComponentIds'](){const _0x2a560e=a181_0x4476a8;return this[_0x2a560e(0xe0)][_0x2a560e(0xe7)]?this[_0x2a560e(0xe8)][_0x2a560e(0x111)](this[_0x2a560e(0xe0)]['repositoryId']):this[_0x2a560e(0xe8)][_0x2a560e(0xea)](this[_0x2a560e(0xe0)][_0x2a560e(0xd0)]);}async['getComponents'](){const _0x1f7187=a181_0x4476a8,_0x42a0fe=await this['getComponentIds'](),_0x39d437=new salesforce_retriever_service_1[(_0x1f7187(0xd9))](this['salesforceService']),_0x1e1797=await _0x39d437[_0x1f7187(0xec)](_0x42a0fe);return _0x1e1797;}async[a181_0x4476a8(0xfd)](_0x243cb3){const _0x2f75cc=a181_0x4476a8,_0x220f67=new commit_components_dto_1[(_0x2f75cc(0xdb))]();return _0x220f67[_0x2f75cc(0xd4)]=_0x2f75cc(0x11d),_0x220f67[_0x2f75cc(0xf6)]={'name':constants_1[_0x2f75cc(0xd1)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x220f67['components']={'writed':await this[_0x2f75cc(0xfe)]()},_0x220f67[_0x2f75cc(0xff)]=_0x243cb3,_0x220f67[_0x2f75cc(0x115)]=this['repository'],_0x220f67['branch']=this['branch'],_0x220f67[_0x2f75cc(0x11a)]=!![],_0x220f67[_0x2f75cc(0xd7)]=this[_0x2f75cc(0xd7)],_0x220f67;}async['checkSyncStatus'](){const _0x1dc0b0=a181_0x4476a8,_0x1be070=await this[_0x1dc0b0(0xe8)][_0x1dc0b0(0xde)](this['syncData']),_0x1f1ec8=await this['salesforceService']['retrieveAttachment'](_0x1be070)[_0x1dc0b0(0xe1)](_0x425087=>typeof _0x425087===_0x1dc0b0(0xf4)?JSON[_0x1dc0b0(0xf5)](_0x425087):_0x425087)[_0x1dc0b0(0xcd)](()=>({}));if(_0x1f1ec8[this[_0x1dc0b0(0x10c)]['gitUrl']]){if(_0x1f1ec8[this['repository'][_0x1dc0b0(0xcc)]][_0x1dc0b0(0x102)]===this[_0x1dc0b0(0xd3)]['sha'])return!![];}return![];}async[a181_0x4476a8(0xcf)](){const _0x5cd2a6=a181_0x4476a8,_0x20042f=await this['repository']['branches'][_0x5cd2a6(0x10a)](this[_0x5cd2a6(0xd3)]['name']);await this[_0x5cd2a6(0xf0)](_0x5cd2a6(0x100));const _0x5e4e87={[this['repository'][_0x5cd2a6(0xcc)]]:{'lastCommit':_0x20042f[_0x5cd2a6(0xd5)]}};await this['salesforceSync'][_0x5cd2a6(0xd2)](this[_0x5cd2a6(0xe0)],_0x5e4e87);}async[a181_0x4476a8(0xec)]({syncRecord:_0x2faab9,repository:_0x28d152,logger:_0x399707,convertToSFDX:_0x4b264e,provider:_0x2e8eeb}){const _0xaf433e=a181_0x4476a8;this[_0xaf433e(0xe0)]=_0x2faab9,this[_0xaf433e(0xd7)]=_0x2e8eeb,this[_0xaf433e(0x10c)]=_0x28d152,this['sfLogger']=new salesforce_logger_v2_service_1[(_0xaf433e(0xdc))](_0x399707[_0xaf433e(0x11f)](),_0x399707[_0xaf433e(0x121)]()+_0xaf433e(0xe2)+this[_0xaf433e(0xe0)]['repositoryName']+']\x20[Branch:\x20'+this['syncData'][_0xaf433e(0x109)]+']');try{await this[_0xaf433e(0xe8)][_0xaf433e(0x10d)](this[_0xaf433e(0xe0)],'In\x20Progress'),await this[_0xaf433e(0xf0)](_0xaf433e(0x117)),await this[_0xaf433e(0xe4)]();const _0x1b8fdf=await this[_0xaf433e(0x11e)]();if(_0x1b8fdf){await this[_0xaf433e(0xe8)][_0xaf433e(0x10d)](this[_0xaf433e(0xe0)],_0xaf433e(0xf2)),await this[_0xaf433e(0xf0)](_0xaf433e(0xda))['send']();return;}const _0x4234b1=await this[_0xaf433e(0xfd)](_0x4b264e);await this['commitJob'][_0xaf433e(0xec)](_0x4234b1,this['sfLogger']),await this[_0xaf433e(0xe8)]['setStatus'](this[_0xaf433e(0xe0)],_0xaf433e(0xf2)),await this[_0xaf433e(0xcf)](),await this['log'](_0xaf433e(0xce));}catch(_0x435b9b){throw _0x435b9b;}finally{await this['sfLogger'][_0xaf433e(0x113)]();}}};FlosumSyncJob=FlosumSyncJob_1=__decorate([typedi_1['Service']({'transient':!![]}),__metadata('design:paramtypes',[salesforce_sync_service_1['SalesforceSyncService'],salesforce_service_1[a181_0x4476a8(0xef)],commit_components_job_1['CommitComponentsJob']])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;