const a148_0x2e7365=a148_0x4e65;(function(_0xfaf8c0,_0x184c31){const _0x4a702b=a148_0x4e65,_0x219490=_0xfaf8c0();while(!![]){try{const _0xe34d6c=parseInt(_0x4a702b(0x240))/0x1+-parseInt(_0x4a702b(0x20a))/0x2+parseInt(_0x4a702b(0x224))/0x3+-parseInt(_0x4a702b(0x20d))/0x4+-parseInt(_0x4a702b(0x22a))/0x5+-parseInt(_0x4a702b(0x215))/0x6*(parseInt(_0x4a702b(0x20f))/0x7)+-parseInt(_0x4a702b(0x243))/0x8*(-parseInt(_0x4a702b(0x20e))/0x9);if(_0xe34d6c===_0x184c31)break;else _0x219490['push'](_0x219490['shift']());}catch(_0x438d6d){_0x219490['push'](_0x219490['shift']());}}}(a148_0x43ac,0x5efc3));const a148_0x247698=function(){let _0x506fe8=!![];return function(_0x2e34e6,_0x461f63){const _0x4c63cc=_0x506fe8?function(){const _0x5787f9=a148_0x4e65;if(_0x461f63){const _0x1a5ecd=_0x461f63[_0x5787f9(0x211)](_0x2e34e6,arguments);return _0x461f63=null,_0x1a5ecd;}}:function(){};return _0x506fe8=![],_0x4c63cc;};}(),a148_0x79570c=a148_0x247698(this,function(){const _0x356444=a148_0x4e65;return a148_0x79570c['toString']()[_0x356444(0x228)]('(((.+)+)+)+$')[_0x356444(0x21a)]()[_0x356444(0x1fa)](a148_0x79570c)[_0x356444(0x228)](_0x356444(0x1fb));});a148_0x79570c();'use strict';var __createBinding=this&&this[a148_0x2e7365(0x22f)]||(Object[a148_0x2e7365(0x214)]?function(_0x373a22,_0x240fb7,_0x539405,_0x3e023f){const _0x1d07e8=a148_0x2e7365;if(_0x3e023f===undefined)_0x3e023f=_0x539405;Object[_0x1d07e8(0x218)](_0x373a22,_0x3e023f,{'enumerable':!![],'get':function(){return _0x240fb7[_0x539405];}});}:function(_0x1d6330,_0x4bab98,_0x789aa6,_0x473728){if(_0x473728===undefined)_0x473728=_0x789aa6;_0x1d6330[_0x473728]=_0x4bab98[_0x789aa6];}),__setModuleDefault=this&&this[a148_0x2e7365(0x23b)]||(Object[a148_0x2e7365(0x214)]?function(_0x11fcb8,_0x5b8c23){const _0x4d7222=a148_0x2e7365;Object[_0x4d7222(0x218)](_0x11fcb8,'default',{'enumerable':!![],'value':_0x5b8c23});}:function(_0x3ccde8,_0x448fd2){const _0x1693a0=a148_0x2e7365;_0x3ccde8[_0x1693a0(0x238)]=_0x448fd2;}),__decorate=this&&this[a148_0x2e7365(0x236)]||function(_0x17598b,_0x155da7,_0x2dc126,_0x148f0b){const _0x558444=a148_0x2e7365;var _0x4090e3=arguments[_0x558444(0x232)],_0x1335e5=_0x4090e3<0x3?_0x155da7:_0x148f0b===null?_0x148f0b=Object[_0x558444(0x231)](_0x155da7,_0x2dc126):_0x148f0b,_0x5abacd;if(typeof Reflect===_0x558444(0x250)&&typeof Reflect[_0x558444(0x206)]===_0x558444(0x23e))_0x1335e5=Reflect[_0x558444(0x206)](_0x17598b,_0x155da7,_0x2dc126,_0x148f0b);else{for(var _0xa514fb=_0x17598b['length']-0x1;_0xa514fb>=0x0;_0xa514fb--)if(_0x5abacd=_0x17598b[_0xa514fb])_0x1335e5=(_0x4090e3<0x3?_0x5abacd(_0x1335e5):_0x4090e3>0x3?_0x5abacd(_0x155da7,_0x2dc126,_0x1335e5):_0x5abacd(_0x155da7,_0x2dc126))||_0x1335e5;}return _0x4090e3>0x3&&_0x1335e5&&Object[_0x558444(0x218)](_0x155da7,_0x2dc126,_0x1335e5),_0x1335e5;},__importStar=this&&this[a148_0x2e7365(0x1f6)]||function(_0x1f2a31){const _0x8548c2=a148_0x2e7365;if(_0x1f2a31&&_0x1f2a31[_0x8548c2(0x202)])return _0x1f2a31;var _0x40aaef={};if(_0x1f2a31!=null){for(var _0x4441e7 in _0x1f2a31)if(_0x4441e7!==_0x8548c2(0x238)&&Object[_0x8548c2(0x230)]['hasOwnProperty'][_0x8548c2(0x219)](_0x1f2a31,_0x4441e7))__createBinding(_0x40aaef,_0x1f2a31,_0x4441e7);}return __setModuleDefault(_0x40aaef,_0x1f2a31),_0x40aaef;},__metadata=this&&this[a148_0x2e7365(0x1ff)]||function(_0x261112,_0x12882f){const _0x525755=a148_0x2e7365;if(typeof Reflect===_0x525755(0x250)&&typeof Reflect[_0x525755(0x24b)]===_0x525755(0x23e))return Reflect['metadata'](_0x261112,_0x12882f);},FlosumSyncJob_1;Object[a148_0x2e7365(0x218)](exports,a148_0x2e7365(0x202),{'value':!![]}),exports[a148_0x2e7365(0x239)]=void 0x0;function a148_0x4e65(_0x2c9362,_0x3d4de5){const _0x504024=a148_0x43ac();return a148_0x4e65=function(_0x79570c,_0x247698){_0x79570c=_0x79570c-0x1f3;let _0x43accb=_0x504024[_0x79570c];return _0x43accb;},a148_0x4e65(_0x2c9362,_0x3d4de5);}const constants_1=require(a148_0x2e7365(0x237)),typedi_1=__importStar(require('typedi')),core_1=require(a148_0x2e7365(0x21d)),too_many_requests_error_1=require(a148_0x2e7365(0x212)),salesforce_error_1=require(a148_0x2e7365(0x201)),salesforce_sync_service_1=require(a148_0x2e7365(0x242)),salesforce_service_1=require(a148_0x2e7365(0x20b)),git_provider_manager_1=require(a148_0x2e7365(0x208)),utils_1=require(a148_0x2e7365(0x209)),sync_job_1=require(a148_0x2e7365(0x220)),logger=new core_1['Logger']('flosum-sync-job');let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x4f2c1f,_0x47c1c2,_0xeb6873){const _0x3e921f=a148_0x2e7365;this['salesforceService']=_0x4f2c1f,this[_0x3e921f(0x24d)]=_0x47c1c2,this[_0x3e921f(0x24c)]=_0xeb6873,this['repoService']=this[_0x3e921f(0x24c)][_0x3e921f(0x227)](),this['repositoriesIntersections']={},this[_0x3e921f(0x21f)]=[];}async[a148_0x2e7365(0x23d)](_0x5f295d,_0x12ad68){const _0x274558=a148_0x2e7365;if(_0x12ad68 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x274558(0x24d)][_0x274558(0x216)](_0x5f295d,_0x274558(0x249));throw _0x12ad68;}try{this[_0x274558(0x22c)][_0x274558(0x1fd)](_0x274558(0x247)+_0x5f295d[_0x274558(0x23a)]+'\x27\x20['+_0x5f295d['branchName']+']\x20due\x20error\x20-\x20'+_0x12ad68),await this[_0x274558(0x22c)][_0x274558(0x1f4)](),await this['salesforceSync'][_0x274558(0x1f3)](_0x5f295d,{}),await this[_0x274558(0x24d)]['setStatus'](_0x5f295d,_0x274558(0x252));}catch(_0xf81aec){if(_0xf81aec instanceof salesforce_error_1[_0x274558(0x1f5)])throw _0xf81aec;}}async[a148_0x2e7365(0x229)](_0x63520f){const _0x37997b=a148_0x2e7365;if(_0x63520f['repositoryId']){const _0x53f81a=_0x63520f[_0x37997b(0x23a)][_0x37997b(0x233)](),_0x2c1a92=this[_0x37997b(0x1fe)][_0x53f81a];if(!_0x2c1a92)this[_0x37997b(0x1fe)][_0x53f81a]=_0x63520f[_0x37997b(0x23a)];else{if(_0x2c1a92&&_0x2c1a92!==_0x63520f[_0x37997b(0x23a)])return await this[_0x37997b(0x23d)](_0x63520f,new Error(_0x37997b(0x21e)+_0x63520f[_0x37997b(0x23a)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x53f81a+_0x37997b(0x226)+_0x2c1a92+'\x27')),!![];}}return![];}async[a148_0x2e7365(0x213)](_0x372033){const _0x586b6e=a148_0x2e7365;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x586b6e(0x253)](_0x372033[_0x586b6e(0x23a)]))return await this[_0x586b6e(0x23d)](_0x372033,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x372033[_0x586b6e(0x23a)]+_0x586b6e(0x203))),![];if(!constants_1[_0x586b6e(0x244)][_0x586b6e(0x253)](_0x372033['branchName']))return await this[_0x586b6e(0x23d)](_0x372033,new Error(_0x586b6e(0x248)+_0x372033[_0x586b6e(0x204)]+_0x586b6e(0x217)+_0x372033['repositoryName']+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async['getOrCreateRepo'](_0x380635){const _0x46b569=a148_0x2e7365,_0x234cde=this[_0x46b569(0x21f)][_0x46b569(0x1fc)](_0x18f1f2=>_0x380635[_0x46b569(0x23a)]===_0x18f1f2[_0x46b569(0x22d)]);if(_0x234cde)return _0x234cde;const _0x4d0ab1=await this[_0x46b569(0x210)][_0x46b569(0x214)]({'name':_0x380635[_0x46b569(0x23a)],'autoInit':!![],'defaultBranch':_0x380635[_0x46b569(0x204)],'private':!![]});return this[_0x46b569(0x21f)]['push'](_0x4d0ab1),_0x4d0ab1;}async[a148_0x2e7365(0x234)](_0x3b550c,_0x13a39f){const _0x2b7791=a148_0x2e7365;this[_0x2b7791(0x22e)][_0x2b7791(0x223)](_0x13a39f),this[_0x2b7791(0x22c)]=this['salesforceService'][_0x2b7791(0x1f8)]();try{this[_0x2b7791(0x22c)]['log']('[INFO]\x20Start\x20sync\x20job'),await this[_0x2b7791(0x22c)][_0x2b7791(0x1f4)]();const [_0x4d6f24,_0x3bdd21]=await Promise[_0x2b7791(0x222)]([this[_0x2b7791(0x24d)][_0x2b7791(0x1f7)](),this[_0x2b7791(0x24d)][_0x2b7791(0x23c)]()]);this[_0x2b7791(0x21f)]=await this[_0x2b7791(0x210)][_0x2b7791(0x1f9)]();const _0x342906=[..._0x3bdd21,..._0x4d6f24];logger[_0x2b7791(0x1fd)](_0x2b7791(0x235),_0x342906[_0x2b7791(0x232)]);for(const _0x5e5745 of _0x342906){const _0x4de4eb=typedi_1[_0x2b7791(0x238)]['get'](sync_job_1[_0x2b7791(0x24f)]);logger[_0x2b7791(0x1fd)]('syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch',_0x5e5745[_0x2b7791(0x23a)],_0x5e5745[_0x2b7791(0x246)],_0x5e5745['branchName'],_0x5e5745[_0x2b7791(0x23f)]);const _0x209425=await this[_0x2b7791(0x213)](_0x5e5745);if(!_0x209425)continue;const _0x23b8a0=await this[_0x2b7791(0x229)](_0x5e5745);if(_0x23b8a0)continue;const _0x5d0950=await this[_0x2b7791(0x24a)](_0x5e5745);await _0x4de4eb['run']({'repository':_0x5d0950,'convertToSFDX':_0x3b550c[_0x2b7791(0x20c)],'loggerId':_0x13a39f,'syncRecord':_0x5e5745})['catch'](_0x2d42b2=>this['handleRecordSyncError'](_0x5e5745,_0x2d42b2));}}catch(_0x481e28){logger[_0x2b7791(0x205)](_0x481e28);if(_0x481e28 instanceof too_many_requests_error_1[_0x2b7791(0x200)]){this[_0x2b7791(0x22c)]['log'](_0x2b7791(0x225)),await this[_0x2b7791(0x22c)]['send']()[_0x2b7791(0x241)](()=>void 0x0),await(0x0,utils_1[_0x2b7791(0x245)])(0x3c*0x3c*0x3e8);const _0x1ccf15=typedi_1[_0x2b7791(0x238)][_0x2b7791(0x21b)](FlosumSyncJob_1);_0x1ccf15[_0x2b7791(0x234)](_0x3b550c,_0x13a39f);}else this[_0x2b7791(0x22c)][_0x2b7791(0x1fd)]('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x481e28),await this['logger'][_0x2b7791(0x1f4)]()[_0x2b7791(0x241)](()=>void 0x0);return;}this[_0x2b7791(0x22c)][_0x2b7791(0x1fd)](_0x2b7791(0x24e)),await this[_0x2b7791(0x22c)][_0x2b7791(0x1f4)](),await this[_0x2b7791(0x24d)][_0x2b7791(0x22b)](_0x3b550c['syncID'])['catch'](()=>null);}};FlosumSyncJob=FlosumSyncJob_1=__decorate([(0x0,typedi_1[a148_0x2e7365(0x207)])({'transient':!![]}),__metadata(a148_0x2e7365(0x251),[salesforce_service_1[a148_0x2e7365(0x21c)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a148_0x2e7365(0x221)]])],FlosumSyncJob),exports[a148_0x2e7365(0x239)]=FlosumSyncJob;function a148_0x43ac(){const _0x18357b=['salesforceSync','[INFO]\x20Sync\x20job\x20done.','SyncJob','object','design:paramtypes','Error','test','updateRemoteState','send','SalesforceError','__importStar','getBranchRecords','getLogger','getAll','constructor','(((.+)+)+)+$','find','log','repositoriesIntersections','__metadata','TooManyRequests','../../salesforce/errors/salesforce.error','__esModule','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','branchName','error','decorate','Service','../../shared/git-provider.manager','../../shared/utils','959696pDkdMT','../../salesforce/services/salesforce.service','convertToSFDX','1394280vzITNX','92754TLWqEY','763AxpmEI','repoService','apply','../../../core/errors/too-many-requests.error','checkValidNaming','create','16374FhKEcQ','setStatus','\x27\x20in\x20repository\x20\x27','defineProperty','call','toString','get','SalesforceService','../../../core','Unable\x20to\x20synchronize\x20repository\x20\x27','repoList','./sync.job','GitProviderManager','all','setLoggerId','1237899FBHREX','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x20Wait\x20for\x201h\x20to\x20continue;','\x27\x20-\x20\x27','getRepoService','search','isIntersects','1754920moimpA','disableSync','logger','name','salesforceService','__createBinding','prototype','getOwnPropertyDescriptor','length','toLowerCase','run','have\x20to\x20synchronize\x20%d\x20branches','__decorate','../../../constants','default','FlosumSyncJob','repositoryName','__setModuleDefault','getRepositoryRecords','handleRecordSyncError','function','branchId','144427pisoEy','catch','../../salesforce/services/salesforce-sync.service','1016VRpfXc','BRANCH_NAME_REGEXP','sleep','repositoryId','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','Unable\x20to\x20synchronize\x20branch\x20\x27','Waiting','getOrCreateRepo','metadata','gitManager'];a148_0x43ac=function(){return _0x18357b;};return a148_0x43ac();}