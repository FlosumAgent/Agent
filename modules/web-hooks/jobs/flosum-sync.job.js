const a146_0x3335=['setStatus','getBranchRecords','metadata','[INFO]\x20Sync\x20job\x20done.','get','logger','Service','151IDBtmu','syncID','function','SalesforceError',']\x20due\x20error\x20-\x20','../../salesforce/services/salesforce-sync.service','checkValidNaming','decorate','length','salesforceSync','branchName','SyncJob','\x27\x20-\x20\x27','286612VuQbCk','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','101Znyniq','getOwnPropertyDescriptor','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','default','encodeBase64','handleRecordSyncError','typedi','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','patchObject','constructor','202DlnbEL','object','Unable\x20to\x20synchronize\x20branch\x20\x27','../../salesforce/errors/salesforce.error','run','branchId','../../../core','prototype','repositoryId','repositoriesIntersections','log','getRepositoryRecords','SalesforceService','Logger','__importStar','SalesforceSyncService','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','getLogger','defineProperty','24286SQktei','FlosumSyncJob','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','264674eepbwT','flosum-sync-job','REPOSITORY_NAME_REGEXP','Unable\x20to\x20synchronize\x20repository\x20\x27','93283xkDdXl','30443llypvj','1XhHFzW','salesforceService','isIntersects','return\x20/\x22\x20+\x20this\x20+\x20\x22/','test','1iapwKe','send','create','toLowerCase','__createBinding','catch','repositoryName','../../salesforce/services/salesforce.service','2377AfaWhT','setLoggerId','all'];const a146_0x150051=a146_0x3bc1;(function(_0x5d2732,_0x39d6f6){const _0x176ead=a146_0x3bc1;while(!![]){try{const _0x2e70f5=parseInt(_0x176ead(0xd3))*-parseInt(_0x176ead(0xda))+parseInt(_0x176ead(0xac))+parseInt(_0x176ead(0xcf))+parseInt(_0x176ead(0xd4))+parseInt(_0x176ead(0xe2))*-parseInt(_0x176ead(0xae))+parseInt(_0x176ead(0xcc))*parseInt(_0x176ead(0xd5))+parseInt(_0x176ead(0xb9))*parseInt(_0x176ead(0xec));if(_0x2e70f5===_0x39d6f6)break;else _0x5d2732['push'](_0x5d2732['shift']());}catch(_0x19ac0f){_0x5d2732['push'](_0x5d2732['shift']());}}}(a146_0x3335,0x4a035));const a146_0x432b5f=function(){let _0x3f13f3=!![];return function(_0x9e52e7,_0x1c3992){const _0x51be4b=_0x3f13f3?function(){if(_0x1c3992){const _0x42007c=_0x1c3992['apply'](_0x9e52e7,arguments);return _0x1c3992=null,_0x42007c;}}:function(){};return _0x3f13f3=![],_0x51be4b;};}(),a146_0x2b5e6e=a146_0x432b5f(this,function(){const _0x58d3d8=function(){const _0x2a0b74=a146_0x3bc1,_0xe64f5b=_0x58d3d8['constructor'](_0x2a0b74(0xd8))()[_0x2a0b74(0xb8)](_0x2a0b74(0xad));return!_0xe64f5b['test'](a146_0x2b5e6e);};return _0x58d3d8();});a146_0x2b5e6e();'use strict';var __createBinding=this&&this[a146_0x150051(0xde)]||(Object[a146_0x150051(0xdc)]?function(_0x3d84a3,_0x52f656,_0x52aaf6,_0x4cb06e){const _0x4d1957=a146_0x150051;if(_0x4cb06e===undefined)_0x4cb06e=_0x52aaf6;Object[_0x4d1957(0xcb)](_0x3d84a3,_0x4cb06e,{'enumerable':!![],'get':function(){return _0x52f656[_0x52aaf6];}});}:function(_0x24bcb6,_0x51ed21,_0x589db5,_0x5a287c){if(_0x5a287c===undefined)_0x5a287c=_0x589db5;_0x24bcb6[_0x5a287c]=_0x51ed21[_0x589db5];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a146_0x150051(0xdc)]?function(_0x3c51c8,_0x119610){const _0x290b24=a146_0x150051;Object[_0x290b24(0xcb)](_0x3c51c8,'default',{'enumerable':!![],'value':_0x119610});}:function(_0x264fca,_0xee466a){_0x264fca['default']=_0xee466a;}),__decorate=this&&this['__decorate']||function(_0x4445df,_0x3e39fd,_0x40ec6b,_0x187d0a){const _0x4b9a76=a146_0x150051;var _0x173e71=arguments[_0x4b9a76(0xa7)],_0x2209bf=_0x173e71<0x3?_0x3e39fd:_0x187d0a===null?_0x187d0a=Object[_0x4b9a76(0xaf)](_0x3e39fd,_0x40ec6b):_0x187d0a,_0x4977d2;if(typeof Reflect===_0x4b9a76(0xba)&&typeof Reflect[_0x4b9a76(0xa6)]===_0x4b9a76(0xa1))_0x2209bf=Reflect[_0x4b9a76(0xa6)](_0x4445df,_0x3e39fd,_0x40ec6b,_0x187d0a);else{for(var _0x504253=_0x4445df[_0x4b9a76(0xa7)]-0x1;_0x504253>=0x0;_0x504253--)if(_0x4977d2=_0x4445df[_0x504253])_0x2209bf=(_0x173e71<0x3?_0x4977d2(_0x2209bf):_0x173e71>0x3?_0x4977d2(_0x3e39fd,_0x40ec6b,_0x2209bf):_0x4977d2(_0x3e39fd,_0x40ec6b))||_0x2209bf;}return _0x173e71>0x3&&_0x2209bf&&Object[_0x4b9a76(0xcb)](_0x3e39fd,_0x40ec6b,_0x2209bf),_0x2209bf;},__importStar=this&&this[a146_0x150051(0xc7)]||function(_0x1f64ab){const _0x445ffc=a146_0x150051;if(_0x1f64ab&&_0x1f64ab['__esModule'])return _0x1f64ab;var _0xcfcf62={};if(_0x1f64ab!=null){for(var _0x1eac1e in _0x1f64ab)if(_0x1eac1e!==_0x445ffc(0xb2)&&Object[_0x445ffc(0xc0)]['hasOwnProperty']['call'](_0x1f64ab,_0x1eac1e))__createBinding(_0xcfcf62,_0x1f64ab,_0x1eac1e);}return __setModuleDefault(_0xcfcf62,_0x1f64ab),_0xcfcf62;},__metadata=this&&this['__metadata']||function(_0x1985c0,_0x4d97f1){const _0x3bab86=a146_0x150051;if(typeof Reflect===_0x3bab86(0xba)&&typeof Reflect[_0x3bab86(0xe7)]===_0x3bab86(0xa1))return Reflect[_0x3bab86(0xe7)](_0x1985c0,_0x4d97f1);};Object[a146_0x150051(0xcb)](exports,'__esModule',{'value':!![]}),exports['FlosumSyncJob']=void 0x0;function a146_0x3bc1(_0x47f2a7,_0x13ce66){return a146_0x3bc1=function(_0x4195e0,_0x2b5e6e){_0x4195e0=_0x4195e0-0xa0;let _0x432b5f=a146_0x3335[_0x4195e0];return _0x432b5f;},a146_0x3bc1(_0x47f2a7,_0x13ce66);}const constants_1=require('../../../constants'),typedi_1=__importStar(require(a146_0x150051(0xb5))),core_1=require(a146_0x150051(0xbf)),salesforce_error_1=require(a146_0x150051(0xbc)),salesforce_sync_service_1=require(a146_0x150051(0xa4)),salesforce_service_1=require(a146_0x150051(0xe1)),utils_1=require('../../shared/utils'),sync_job_1=require('./sync.job'),logger=new core_1[(a146_0x150051(0xc6))](a146_0x150051(0xd0));let FlosumSyncJob=class FlosumSyncJob{constructor(_0x1cea65,_0x568c5e){const _0x4647fd=a146_0x150051;this['salesforceService']=_0x1cea65,this['salesforceSync']=_0x568c5e,this[_0x4647fd(0xc2)]={};}async['handleRecordSyncError'](_0x5f12b3,_0x4f1690){const _0x532803=a146_0x150051;try{const _0x5ab917=await this[_0x532803(0xa8)]['getAttachmentId'](_0x5f12b3);this[_0x532803(0xea)]['log'](_0x532803(0xc9)+_0x5f12b3[_0x532803(0xe0)]+'\x27\x20['+_0x5f12b3['branchName']+_0x532803(0xa3)+_0x4f1690),await this[_0x532803(0xea)][_0x532803(0xdb)](),await this[_0x532803(0xd6)][_0x532803(0xb7)]('Attachment',_0x5ab917,{'Body':utils_1[_0x532803(0xb3)](JSON['stringify']({}))}),await this[_0x532803(0xa8)][_0x532803(0xe5)](_0x5f12b3,'Error');}catch(_0x41b6af){logger['error'](_0x41b6af);if(_0x41b6af instanceof salesforce_error_1[_0x532803(0xa2)])throw _0x41b6af;}}async['isIntersects'](_0x5b52a7){const _0x11920a=a146_0x150051;if(_0x5b52a7[_0x11920a(0xc1)]){const _0x5cd8c6=_0x5b52a7[_0x11920a(0xe0)][_0x11920a(0xdd)](),_0x4274f1=this['repositoriesIntersections'][_0x5cd8c6];if(!_0x4274f1)this[_0x11920a(0xc2)][_0x5cd8c6]=_0x5b52a7[_0x11920a(0xe0)];else{if(_0x4274f1&&_0x4274f1!==_0x5b52a7[_0x11920a(0xe0)])return await this[_0x11920a(0xb4)](_0x5b52a7,new Error(_0x11920a(0xd2)+_0x5b52a7[_0x11920a(0xe0)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x5cd8c6+_0x11920a(0xab)+_0x4274f1+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x170a87){const _0x437457=a146_0x150051;if(!constants_1[_0x437457(0xd1)][_0x437457(0xd9)](_0x170a87[_0x437457(0xe0)]))return await this[_0x437457(0xb4)](_0x170a87,new Error(_0x437457(0xd2)+_0x170a87[_0x437457(0xe0)]+_0x437457(0xb0))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x437457(0xd9)](_0x170a87[_0x437457(0xa9)]))return await this[_0x437457(0xb4)](_0x170a87,new Error(_0x437457(0xbb)+_0x170a87[_0x437457(0xa9)]+'\x27\x20in\x20repository\x20\x27'+_0x170a87['repositoryName']+_0x437457(0xb1))),![];return!![];}async[a146_0x150051(0xbd)](_0x3cbb8a,_0x39be8c){const _0x78a8a5=a146_0x150051;this['salesforceService'][_0x78a8a5(0xe3)](_0x39be8c),this[_0x78a8a5(0xea)]=this[_0x78a8a5(0xd6)][_0x78a8a5(0xca)]();try{this[_0x78a8a5(0xea)][_0x78a8a5(0xc3)]('[INFO]\x20Start\x20sync\x20job'),await this[_0x78a8a5(0xea)][_0x78a8a5(0xdb)]();const [_0x8e7f0c,_0x5c46ce]=await Promise[_0x78a8a5(0xe4)]([this[_0x78a8a5(0xa8)][_0x78a8a5(0xe6)](),this[_0x78a8a5(0xa8)][_0x78a8a5(0xc4)]()]),_0x2fad34=[..._0x5c46ce,..._0x8e7f0c];logger[_0x78a8a5(0xc3)]('have\x20to\x20synchronize\x20%d\x20branches',_0x2fad34[_0x78a8a5(0xa7)]);for(const _0x5696d9 of _0x2fad34){const _0x39768b=typedi_1['default'][_0x78a8a5(0xe9)](sync_job_1[_0x78a8a5(0xaa)]);logger['log'](_0x78a8a5(0xce),_0x5696d9[_0x78a8a5(0xe0)],_0x5696d9['repositoryId'],_0x5696d9['branchName'],_0x5696d9[_0x78a8a5(0xbe)]);const _0x3cdd10=await this[_0x78a8a5(0xa5)](_0x5696d9);if(!_0x3cdd10)continue;const _0x40f8c8=await this[_0x78a8a5(0xd7)](_0x5696d9);if(_0x40f8c8)continue;await _0x39768b[_0x78a8a5(0xbd)](_0x5696d9,_0x39be8c,_0x3cbb8a['convertToSFDX'])[_0x78a8a5(0xdf)](_0x1fb612=>this[_0x78a8a5(0xb4)](_0x5696d9,_0x1fb612));}}catch(_0x59e263){logger['error'](_0x59e263),this['logger'][_0x78a8a5(0xc3)](_0x78a8a5(0xb6)+_0x59e263),await this[_0x78a8a5(0xea)][_0x78a8a5(0xdb)]()[_0x78a8a5(0xdf)](()=>void 0x0);return;}this[_0x78a8a5(0xea)]['log'](_0x78a8a5(0xe8)),await this[_0x78a8a5(0xea)][_0x78a8a5(0xdb)](),await this['salesforceSync']['disableSync'](_0x3cbb8a[_0x78a8a5(0xa0)]);}};FlosumSyncJob=__decorate([typedi_1[a146_0x150051(0xeb)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a146_0x150051(0xc5)],salesforce_sync_service_1[a146_0x150051(0xc8)]])],FlosumSyncJob),exports[a146_0x150051(0xcd)]=FlosumSyncJob;