const a147_0x1ec6d2=a147_0x508c;function a147_0x508c(_0x280a43,_0x4180aa){const _0x3f8192=a147_0x54d0();return a147_0x508c=function(_0x59b1d1,_0x3fdf80){_0x59b1d1=_0x59b1d1-0x1cf;let _0x54d050=_0x3f8192[_0x59b1d1];return _0x54d050;},a147_0x508c(_0x280a43,_0x4180aa);}(function(_0xbf533c,_0x1da217){const _0x14217a=a147_0x508c,_0x2a6b18=_0xbf533c();while(!![]){try{const _0x146e6b=parseInt(_0x14217a(0x217))/0x1+parseInt(_0x14217a(0x221))/0x2+-parseInt(_0x14217a(0x1f9))/0x3*(-parseInt(_0x14217a(0x1ed))/0x4)+parseInt(_0x14217a(0x1ee))/0x5*(-parseInt(_0x14217a(0x223))/0x6)+parseInt(_0x14217a(0x1fe))/0x7*(-parseInt(_0x14217a(0x216))/0x8)+parseInt(_0x14217a(0x1df))/0x9*(-parseInt(_0x14217a(0x1d8))/0xa)+-parseInt(_0x14217a(0x1d5))/0xb*(-parseInt(_0x14217a(0x21e))/0xc);if(_0x146e6b===_0x1da217)break;else _0x2a6b18['push'](_0x2a6b18['shift']());}catch(_0x106c11){_0x2a6b18['push'](_0x2a6b18['shift']());}}}(a147_0x54d0,0x83299));const a147_0x3fdf80=function(){let _0x387f4a=!![];return function(_0x2df6a1,_0x583637){const _0x20f230=_0x387f4a?function(){const _0x1f7d85=a147_0x508c;if(_0x583637){const _0x4e3f17=_0x583637[_0x1f7d85(0x1f0)](_0x2df6a1,arguments);return _0x583637=null,_0x4e3f17;}}:function(){};return _0x387f4a=![],_0x20f230;};}(),a147_0x59b1d1=a147_0x3fdf80(this,function(){const _0x311d35=a147_0x508c;return a147_0x59b1d1[_0x311d35(0x1e1)]()[_0x311d35(0x1f6)]('(((.+)+)+)+$')[_0x311d35(0x1e1)]()['constructor'](a147_0x59b1d1)[_0x311d35(0x1f6)](_0x311d35(0x1da));});a147_0x59b1d1();'use strict';var __createBinding=this&&this['__createBinding']||(Object[a147_0x1ec6d2(0x21c)]?function(_0x2332c2,_0x581fa3,_0x2f8752,_0x1942b9){const _0x35254c=a147_0x1ec6d2;if(_0x1942b9===undefined)_0x1942b9=_0x2f8752;Object[_0x35254c(0x1ea)](_0x2332c2,_0x1942b9,{'enumerable':!![],'get':function(){return _0x581fa3[_0x2f8752];}});}:function(_0x7e4bf3,_0x5a9b99,_0x4b3c75,_0x304ab9){if(_0x304ab9===undefined)_0x304ab9=_0x4b3c75;_0x7e4bf3[_0x304ab9]=_0x5a9b99[_0x4b3c75];}),__setModuleDefault=this&&this[a147_0x1ec6d2(0x229)]||(Object[a147_0x1ec6d2(0x21c)]?function(_0x4116df,_0x43ddf9){const _0x2c8383=a147_0x1ec6d2;Object[_0x2c8383(0x1ea)](_0x4116df,_0x2c8383(0x1dd),{'enumerable':!![],'value':_0x43ddf9});}:function(_0x4db46d,_0x5e4229){const _0x1190b6=a147_0x1ec6d2;_0x4db46d[_0x1190b6(0x1dd)]=_0x5e4229;}),__decorate=this&&this[a147_0x1ec6d2(0x1e3)]||function(_0x1de7f4,_0xd36904,_0x54f24e,_0x4de9d9){const _0xbf577d=a147_0x1ec6d2;var _0x3ee847=arguments[_0xbf577d(0x200)],_0x520692=_0x3ee847<0x3?_0xd36904:_0x4de9d9===null?_0x4de9d9=Object['getOwnPropertyDescriptor'](_0xd36904,_0x54f24e):_0x4de9d9,_0x4075e3;if(typeof Reflect==='object'&&typeof Reflect['decorate']==='function')_0x520692=Reflect[_0xbf577d(0x1fb)](_0x1de7f4,_0xd36904,_0x54f24e,_0x4de9d9);else{for(var _0x28eb53=_0x1de7f4[_0xbf577d(0x200)]-0x1;_0x28eb53>=0x0;_0x28eb53--)if(_0x4075e3=_0x1de7f4[_0x28eb53])_0x520692=(_0x3ee847<0x3?_0x4075e3(_0x520692):_0x3ee847>0x3?_0x4075e3(_0xd36904,_0x54f24e,_0x520692):_0x4075e3(_0xd36904,_0x54f24e))||_0x520692;}return _0x3ee847>0x3&&_0x520692&&Object['defineProperty'](_0xd36904,_0x54f24e,_0x520692),_0x520692;},__importStar=this&&this[a147_0x1ec6d2(0x211)]||function(_0x97ff0b){const _0x107ed4=a147_0x1ec6d2;if(_0x97ff0b&&_0x97ff0b[_0x107ed4(0x1d3)])return _0x97ff0b;var _0x58d01b={};if(_0x97ff0b!=null){for(var _0x2bc409 in _0x97ff0b)if(_0x2bc409!=='default'&&Object[_0x107ed4(0x1db)]['hasOwnProperty'][_0x107ed4(0x21f)](_0x97ff0b,_0x2bc409))__createBinding(_0x58d01b,_0x97ff0b,_0x2bc409);}return __setModuleDefault(_0x58d01b,_0x97ff0b),_0x58d01b;},__metadata=this&&this[a147_0x1ec6d2(0x1e4)]||function(_0x911e74,_0x2e3d46){const _0x55befc=a147_0x1ec6d2;if(typeof Reflect==='object'&&typeof Reflect[_0x55befc(0x22a)]==='function')return Reflect[_0x55befc(0x22a)](_0x911e74,_0x2e3d46);},FlosumSyncJob_1;Object[a147_0x1ec6d2(0x1ea)](exports,'__esModule',{'value':!![]}),exports[a147_0x1ec6d2(0x1f5)]=void 0x0;const constants_1=require(a147_0x1ec6d2(0x208)),typedi_1=__importStar(require('typedi')),core_1=require('../../../core'),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),salesforce_error_1=require(a147_0x1ec6d2(0x1f3)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a147_0x1ec6d2(0x21d)),utils_1=require('../../shared/utils'),sync_job_1=require(a147_0x1ec6d2(0x1eb)),logger=new core_1['Logger'](a147_0x1ec6d2(0x205));function a147_0x54d0(){const _0x58a227=['branchName','\x27\x20in\x20repository\x20\x27','all','SalesforceError','__esModule','isIntersects','11jJusWV','syncID','SalesforceService','170DTQxud','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x20Wait\x20for\x201h\x20to\x20continue;','(((.+)+)+)+$','prototype','REPOSITORY_NAME_REGEXP','default','salesforceSync','258210nAprPe','getAttachmentId','toString','patchObject','__decorate','__metadata','salesforceService','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','send','get','test','defineProperty','./sync.job','setStatus','36sKcZZJ','6115SQwLyq','name','apply','repoService','log','../../salesforce/errors/salesforce.error','handleRecordSyncError','FlosumSyncJob','search','catch','BRANCH_NAME_REGEXP','58152JOkVjy','getLogger','decorate','GitProviderManager','run','54061JgfMfU','getBranchRecords','length','repositoriesIntersections','repositoryId','error','\x27\x20[','flosum-sync-job','sleep','find','../../../constants','[INFO]\x20Start\x20sync\x20job','Attachment','logger','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.',']\x20due\x20error\x20-\x20','disableSync','getAll','__importStar','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','\x27\x20-\x20\x27','setLoggerId','repositoryName','88KBkxxf','571221kITUuv','gitManager','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','have\x20to\x20synchronize\x20%d\x20branches','TooManyRequests','create','../../shared/git-provider.manager','1243992hJBKHJ','call','Unable\x20to\x20synchronize\x20repository\x20\x27','1663444DahkmR','convertToSFDX','2802mOgiXe','checkValidNaming','encodeBase64','branchId','Error','Service','__setModuleDefault','metadata'];a147_0x54d0=function(){return _0x58a227;};return a147_0x54d0();}let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x46a24b,_0x323573,_0x3fe370){const _0x51aada=a147_0x1ec6d2;this[_0x51aada(0x1e5)]=_0x46a24b,this[_0x51aada(0x1de)]=_0x323573,this[_0x51aada(0x218)]=_0x3fe370,this[_0x51aada(0x1f1)]=this[_0x51aada(0x218)]['getRepoService'](),this[_0x51aada(0x201)]={};}async[a147_0x1ec6d2(0x1f4)](_0x27ba82,_0x15d7bc){const _0x250495=a147_0x1ec6d2;if(_0x15d7bc instanceof too_many_requests_error_1[_0x250495(0x21b)]){await this[_0x250495(0x1de)][_0x250495(0x1ec)](_0x27ba82,'Waiting');throw _0x15d7bc;}try{const _0x2a5b98=await this[_0x250495(0x1de)][_0x250495(0x1e0)](_0x27ba82);this[_0x250495(0x20b)][_0x250495(0x1f2)](_0x250495(0x20c)+_0x27ba82[_0x250495(0x215)]+_0x250495(0x204)+_0x27ba82['branchName']+_0x250495(0x20e)+_0x15d7bc),await this[_0x250495(0x20b)][_0x250495(0x1e7)](),await this[_0x250495(0x1e5)][_0x250495(0x1e2)](_0x250495(0x20a),_0x2a5b98,{'Body':(0x0,utils_1[_0x250495(0x225)])(JSON['stringify']({}))}),await this[_0x250495(0x1de)]['setStatus'](_0x27ba82,_0x250495(0x227));}catch(_0x5a7a8b){if(_0x5a7a8b instanceof salesforce_error_1[_0x250495(0x1d2)])throw _0x5a7a8b;}}async['isIntersects'](_0xe32cf9){const _0xa2bfa9=a147_0x1ec6d2;if(_0xe32cf9[_0xa2bfa9(0x202)]){const _0x45981b=_0xe32cf9['repositoryName']['toLowerCase'](),_0xd32ea4=this[_0xa2bfa9(0x201)][_0x45981b];if(!_0xd32ea4)this[_0xa2bfa9(0x201)][_0x45981b]=_0xe32cf9['repositoryName'];else{if(_0xd32ea4&&_0xd32ea4!==_0xe32cf9['repositoryName'])return await this[_0xa2bfa9(0x1f4)](_0xe32cf9,new Error(_0xa2bfa9(0x220)+_0xe32cf9[_0xa2bfa9(0x215)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x45981b+_0xa2bfa9(0x213)+_0xd32ea4+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x8bce92){const _0x27db60=a147_0x1ec6d2;if(!constants_1[_0x27db60(0x1dc)][_0x27db60(0x1e9)](_0x8bce92[_0x27db60(0x215)]))return await this['handleRecordSyncError'](_0x8bce92,new Error(_0x27db60(0x220)+_0x8bce92[_0x27db60(0x215)]+_0x27db60(0x1e6))),![];if(!constants_1[_0x27db60(0x1f8)]['test'](_0x8bce92[_0x27db60(0x1cf)]))return await this[_0x27db60(0x1f4)](_0x8bce92,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x8bce92[_0x27db60(0x1cf)]+_0x27db60(0x1d0)+_0x8bce92[_0x27db60(0x215)]+_0x27db60(0x20d))),![];return!![];}async[a147_0x1ec6d2(0x1fd)](_0x366b0f,_0xbe5dbd){const _0x3c0e04=a147_0x1ec6d2;this[_0x3c0e04(0x1e5)][_0x3c0e04(0x214)](_0xbe5dbd),this['logger']=this[_0x3c0e04(0x1e5)][_0x3c0e04(0x1fa)]();try{this[_0x3c0e04(0x20b)][_0x3c0e04(0x1f2)](_0x3c0e04(0x209)),await this['logger'][_0x3c0e04(0x1e7)]();const [_0x41718f,_0x39c8dd]=await Promise[_0x3c0e04(0x1d1)]([this[_0x3c0e04(0x1de)][_0x3c0e04(0x1ff)](),this[_0x3c0e04(0x1de)]['getRepositoryRecords']()]),_0x286676=await this[_0x3c0e04(0x1f1)][_0x3c0e04(0x210)](),_0x4c3a1e=[..._0x39c8dd,..._0x41718f];logger['log'](_0x3c0e04(0x21a),_0x4c3a1e[_0x3c0e04(0x200)]);for(const _0x54eed6 of _0x4c3a1e){const _0x2be10c=typedi_1['default'][_0x3c0e04(0x1e8)](sync_job_1['SyncJob']);logger[_0x3c0e04(0x1f2)](_0x3c0e04(0x219),_0x54eed6[_0x3c0e04(0x215)],_0x54eed6[_0x3c0e04(0x202)],_0x54eed6['branchName'],_0x54eed6[_0x3c0e04(0x226)]);const _0x535af2=await this[_0x3c0e04(0x224)](_0x54eed6);if(!_0x535af2)continue;const _0x36050f=await this[_0x3c0e04(0x1d4)](_0x54eed6);if(_0x36050f)continue;const _0x526f30=_0x286676[_0x3c0e04(0x207)](_0x2a5d1b=>_0x2a5d1b[_0x3c0e04(0x1ef)]===_0x54eed6[_0x3c0e04(0x215)]);await _0x2be10c[_0x3c0e04(0x1fd)]({'repository':_0x526f30,'convertToSFDX':_0x366b0f[_0x3c0e04(0x222)],'loggerId':_0xbe5dbd,'syncRecord':_0x54eed6})['catch'](_0x257bb8=>this[_0x3c0e04(0x1f4)](_0x54eed6,_0x257bb8));}}catch(_0x3643a7){logger[_0x3c0e04(0x203)](_0x3643a7);if(_0x3643a7 instanceof too_many_requests_error_1['TooManyRequests']){this['logger'][_0x3c0e04(0x1f2)](_0x3c0e04(0x1d9)),await this[_0x3c0e04(0x20b)][_0x3c0e04(0x1e7)]()[_0x3c0e04(0x1f7)](()=>void 0x0),await(0x0,utils_1[_0x3c0e04(0x206)])(0x3c*0x3c*0x3e8);const _0x665567=typedi_1['default'][_0x3c0e04(0x1e8)](FlosumSyncJob_1);_0x665567[_0x3c0e04(0x1fd)](_0x366b0f,_0xbe5dbd);}else this['logger'][_0x3c0e04(0x1f2)](_0x3c0e04(0x212)+_0x3643a7),await this[_0x3c0e04(0x20b)][_0x3c0e04(0x1e7)]()['catch'](()=>void 0x0);return;}this[_0x3c0e04(0x20b)][_0x3c0e04(0x1f2)]('[INFO]\x20Sync\x20job\x20done.'),await this['logger']['send'](),await this['salesforceSync'][_0x3c0e04(0x20f)](_0x366b0f[_0x3c0e04(0x1d6)])[_0x3c0e04(0x1f7)](()=>null);}};FlosumSyncJob=FlosumSyncJob_1=__decorate([(0x0,typedi_1[a147_0x1ec6d2(0x228)])({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a147_0x1ec6d2(0x1d7)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a147_0x1ec6d2(0x1fc)]])],FlosumSyncJob),exports[a147_0x1ec6d2(0x1f5)]=FlosumSyncJob;