const a148_0x3d8b7f=a148_0x1f95;(function(_0x2264a0,_0x52ee11){const _0x8f5075=a148_0x1f95,_0x13a3ea=_0x2264a0();while(!![]){try{const _0x3844d6=-parseInt(_0x8f5075(0x16e))/0x1*(-parseInt(_0x8f5075(0x16b))/0x2)+parseInt(_0x8f5075(0x170))/0x3+parseInt(_0x8f5075(0x159))/0x4*(parseInt(_0x8f5075(0x186))/0x5)+-parseInt(_0x8f5075(0x168))/0x6*(-parseInt(_0x8f5075(0x15c))/0x7)+parseInt(_0x8f5075(0x140))/0x8*(-parseInt(_0x8f5075(0x161))/0x9)+parseInt(_0x8f5075(0x17c))/0xa*(parseInt(_0x8f5075(0x177))/0xb)+parseInt(_0x8f5075(0x133))/0xc*(-parseInt(_0x8f5075(0x158))/0xd);if(_0x3844d6===_0x52ee11)break;else _0x13a3ea['push'](_0x13a3ea['shift']());}catch(_0x569b37){_0x13a3ea['push'](_0x13a3ea['shift']());}}}(a148_0xa7b7,0xc06e0));const a148_0x454acf=function(){let _0x44d6cb=!![];return function(_0x22bd7b,_0x2eee6e){const _0x1be804=_0x44d6cb?function(){if(_0x2eee6e){const _0x39b8bb=_0x2eee6e['apply'](_0x22bd7b,arguments);return _0x2eee6e=null,_0x39b8bb;}}:function(){};return _0x44d6cb=![],_0x1be804;};}(),a148_0x1b226c=a148_0x454acf(this,function(){const _0x4ed316=a148_0x1f95;return a148_0x1b226c[_0x4ed316(0x15e)]()[_0x4ed316(0x145)]('(((.+)+)+)+$')['toString']()[_0x4ed316(0x181)](a148_0x1b226c)['search'](_0x4ed316(0x12f));});a148_0x1b226c();function a148_0xa7b7(){const _0x253683=['FlosumSyncJob','decorate','design:paramtypes','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','catch','Error','updateRemoteState','[INFO]\x20Start\x20sync\x20job','error','repoList','__importStar','__esModule','function','\x27\x20in\x20repository\x20\x27','test','13BwkrCe','37740pjzhQI','toLowerCase','../../salesforce/errors/salesforce.error','112PWTVIn','handleRecordSyncError','toString','../../shared/utils','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','71901HHrhDS','typedi','__decorate','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repositoriesIntersections','log','gitManager','216936LzxUeb','\x27\x20-\x20\x27','length','50BnNZwf','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','GitProviderManager','2937AGunvh','repositoryName','209034wGAcKk','get','object','[INFO]\x20Sync\x20job\x20done.','syncID','isIntersects','run','77nFdgeA','logger','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','../../../core','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','1192270pulYmE','repositoryId','send','metadata','default','constructor','call','../../salesforce/services/salesforce-sync.service','all','TooManyRequests','805hWmuxx','salesforceService','Unable\x20to\x20synchronize\x20branch\x20\x27','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','repoService','create','../../../core/errors/too-many-requests.error','defineProperty','(((.+)+)+)+$','SalesforceError','hasOwnProperty','getAll','23897256vtCcsg','salesforceSync','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','../../salesforce/services/salesforce.service','disableSync','SyncJob','getLogger','getBranchRecords','setStatus','__createBinding','have\x20to\x20synchronize\x20%d\x20branches','branchName','convertToSFDX','296SaJvew','find',']\x20due\x20error\x20-\x20','__metadata','getOrCreateRepo','search','flosum-sync-job','SalesforceService','\x27\x20['];a148_0xa7b7=function(){return _0x253683;};return a148_0xa7b7();}function a148_0x1f95(_0x221d22,_0xceeea3){const _0x30205c=a148_0xa7b7();return a148_0x1f95=function(_0x1b226c,_0x454acf){_0x1b226c=_0x1b226c-0x12a;let _0xa7b7ed=_0x30205c[_0x1b226c];return _0xa7b7ed;},a148_0x1f95(_0x221d22,_0xceeea3);}'use strict';var __createBinding=this&&this[a148_0x3d8b7f(0x13c)]||(Object['create']?function(_0x487fb9,_0x553fbc,_0x259352,_0x55ed2b){const _0x5c2fd3=a148_0x3d8b7f;if(_0x55ed2b===undefined)_0x55ed2b=_0x259352;Object[_0x5c2fd3(0x12e)](_0x487fb9,_0x55ed2b,{'enumerable':!![],'get':function(){return _0x553fbc[_0x259352];}});}:function(_0x1b2912,_0x435b7e,_0x167fef,_0x12a42a){if(_0x12a42a===undefined)_0x12a42a=_0x167fef;_0x1b2912[_0x12a42a]=_0x435b7e[_0x167fef];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a148_0x3d8b7f(0x12c)]?function(_0x143898,_0x35f458){const _0x44dfd6=a148_0x3d8b7f;Object[_0x44dfd6(0x12e)](_0x143898,_0x44dfd6(0x180),{'enumerable':!![],'value':_0x35f458});}:function(_0x57b9b0,_0x3fa165){const _0x1efd53=a148_0x3d8b7f;_0x57b9b0[_0x1efd53(0x180)]=_0x3fa165;}),__decorate=this&&this[a148_0x3d8b7f(0x163)]||function(_0x3fb4d9,_0x4f7b81,_0x2c71e4,_0x273600){const _0xcb91b0=a148_0x3d8b7f;var _0x2c76d2=arguments[_0xcb91b0(0x16a)],_0xdfe2fa=_0x2c76d2<0x3?_0x4f7b81:_0x273600===null?_0x273600=Object['getOwnPropertyDescriptor'](_0x4f7b81,_0x2c71e4):_0x273600,_0x4bcc98;if(typeof Reflect==='object'&&typeof Reflect[_0xcb91b0(0x14a)]===_0xcb91b0(0x155))_0xdfe2fa=Reflect['decorate'](_0x3fb4d9,_0x4f7b81,_0x2c71e4,_0x273600);else{for(var _0xd9d978=_0x3fb4d9[_0xcb91b0(0x16a)]-0x1;_0xd9d978>=0x0;_0xd9d978--)if(_0x4bcc98=_0x3fb4d9[_0xd9d978])_0xdfe2fa=(_0x2c76d2<0x3?_0x4bcc98(_0xdfe2fa):_0x2c76d2>0x3?_0x4bcc98(_0x4f7b81,_0x2c71e4,_0xdfe2fa):_0x4bcc98(_0x4f7b81,_0x2c71e4))||_0xdfe2fa;}return _0x2c76d2>0x3&&_0xdfe2fa&&Object[_0xcb91b0(0x12e)](_0x4f7b81,_0x2c71e4,_0xdfe2fa),_0xdfe2fa;},__importStar=this&&this[a148_0x3d8b7f(0x153)]||function(_0x4da363){const _0x14cc36=a148_0x3d8b7f;if(_0x4da363&&_0x4da363[_0x14cc36(0x154)])return _0x4da363;var _0x817c36={};if(_0x4da363!=null){for(var _0x163ae8 in _0x4da363)if(_0x163ae8!==_0x14cc36(0x180)&&Object['prototype'][_0x14cc36(0x131)][_0x14cc36(0x182)](_0x4da363,_0x163ae8))__createBinding(_0x817c36,_0x4da363,_0x163ae8);}return __setModuleDefault(_0x817c36,_0x4da363),_0x817c36;},__metadata=this&&this[a148_0x3d8b7f(0x143)]||function(_0x586a1f,_0x349539){const _0x5755fe=a148_0x3d8b7f;if(typeof Reflect===_0x5755fe(0x172)&&typeof Reflect[_0x5755fe(0x17f)]==='function')return Reflect['metadata'](_0x586a1f,_0x349539);},FlosumSyncJob_1;Object[a148_0x3d8b7f(0x12e)](exports,a148_0x3d8b7f(0x154),{'value':!![]}),exports[a148_0x3d8b7f(0x149)]=void 0x0;const constants_1=require('../../../constants'),typedi_1=__importStar(require(a148_0x3d8b7f(0x162))),core_1=require(a148_0x3d8b7f(0x17a)),too_many_requests_error_1=require(a148_0x3d8b7f(0x12d)),salesforce_error_1=require(a148_0x3d8b7f(0x15b)),salesforce_sync_service_1=require(a148_0x3d8b7f(0x183)),salesforce_service_1=require(a148_0x3d8b7f(0x136)),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a148_0x3d8b7f(0x15f)),sync_job_1=require('./sync.job'),logger=new core_1['Logger'](a148_0x3d8b7f(0x146));let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0x231c24,_0xd7bb21,_0x5b2979){const _0x36c836=a148_0x3d8b7f;this[_0x36c836(0x187)]=_0x231c24,this['salesforceSync']=_0xd7bb21,this['gitManager']=_0x5b2979,this[_0x36c836(0x12b)]=this[_0x36c836(0x167)]['getRepoService'](),this['repositoriesIntersections']={},this[_0x36c836(0x152)]=[];}async[a148_0x3d8b7f(0x15d)](_0x40a1dc,_0x26d286){const _0x212e2d=a148_0x3d8b7f;if(_0x26d286 instanceof too_many_requests_error_1[_0x212e2d(0x185)]){await this[_0x212e2d(0x134)]['setStatus'](_0x40a1dc,'Waiting');throw _0x26d286;}try{this[_0x212e2d(0x178)][_0x212e2d(0x166)](_0x212e2d(0x17b)+_0x40a1dc['repositoryName']+_0x212e2d(0x148)+_0x40a1dc[_0x212e2d(0x13e)]+_0x212e2d(0x142)+_0x26d286),await this[_0x212e2d(0x178)]['send'](),await this[_0x212e2d(0x134)][_0x212e2d(0x14f)](_0x40a1dc,{}),await this[_0x212e2d(0x134)][_0x212e2d(0x13b)](_0x40a1dc,_0x212e2d(0x14e));}catch(_0x22c3e3){if(_0x22c3e3 instanceof salesforce_error_1[_0x212e2d(0x130)])throw _0x22c3e3;}}async[a148_0x3d8b7f(0x175)](_0x4ea03b){const _0x10f630=a148_0x3d8b7f;if(_0x4ea03b[_0x10f630(0x17d)]){const _0x3702bc=_0x4ea03b[_0x10f630(0x16f)][_0x10f630(0x15a)](),_0x17577e=this['repositoriesIntersections'][_0x3702bc];if(!_0x17577e)this[_0x10f630(0x165)][_0x3702bc]=_0x4ea03b[_0x10f630(0x16f)];else{if(_0x17577e&&_0x17577e!==_0x4ea03b[_0x10f630(0x16f)])return await this['handleRecordSyncError'](_0x4ea03b,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x4ea03b[_0x10f630(0x16f)]+_0x10f630(0x12a)+_0x3702bc+_0x10f630(0x169)+_0x17577e+'\x27')),!![];}}return![];}async['checkValidNaming'](_0x3fe200){const _0x1a8679=a148_0x3d8b7f;if(!constants_1['REPOSITORY_NAME_REGEXP']['test'](_0x3fe200[_0x1a8679(0x16f)]))return await this[_0x1a8679(0x15d)](_0x3fe200,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x3fe200['repositoryName']+_0x1a8679(0x16c))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x1a8679(0x157)](_0x3fe200[_0x1a8679(0x13e)]))return await this[_0x1a8679(0x15d)](_0x3fe200,new Error(_0x1a8679(0x188)+_0x3fe200[_0x1a8679(0x13e)]+_0x1a8679(0x156)+_0x3fe200[_0x1a8679(0x16f)]+_0x1a8679(0x164))),![];return!![];}async[a148_0x3d8b7f(0x144)](_0x11fa1f){const _0x3405f0=a148_0x3d8b7f,_0x929731=this[_0x3405f0(0x152)][_0x3405f0(0x141)](_0x4efc72=>_0x11fa1f[_0x3405f0(0x16f)]===_0x4efc72['name']);if(_0x929731)return _0x929731;const _0x36b8eb=await this[_0x3405f0(0x12b)][_0x3405f0(0x12c)]({'name':_0x11fa1f[_0x3405f0(0x16f)],'autoInit':!![],'defaultBranch':_0x11fa1f[_0x3405f0(0x13e)],'private':!![]});return this['repoList']['push'](_0x36b8eb),_0x36b8eb;}async['run'](_0x1291ce,_0x4c7719){const _0x40fc89=a148_0x3d8b7f;this['salesforceService']['setLoggerId'](_0x4c7719),this['logger']=this['salesforceService'][_0x40fc89(0x139)]();try{this['logger'][_0x40fc89(0x166)](_0x40fc89(0x150)),await this[_0x40fc89(0x178)][_0x40fc89(0x17e)]();const [_0x5820c9,_0x5afd62]=await Promise[_0x40fc89(0x184)]([this[_0x40fc89(0x134)][_0x40fc89(0x13a)](),this[_0x40fc89(0x134)]['getRepositoryRecords']()]);this['repoList']=await this['repoService'][_0x40fc89(0x132)]();const _0x4d2bd6=[..._0x5afd62,..._0x5820c9];logger[_0x40fc89(0x166)](_0x40fc89(0x13d),_0x4d2bd6[_0x40fc89(0x16a)]);for(const _0x2416ff of _0x4d2bd6){const _0x45b972=typedi_1[_0x40fc89(0x180)][_0x40fc89(0x171)](sync_job_1[_0x40fc89(0x138)]);logger[_0x40fc89(0x166)](_0x40fc89(0x160),_0x2416ff[_0x40fc89(0x16f)],_0x2416ff[_0x40fc89(0x17d)],_0x2416ff['branchName'],_0x2416ff['branchId']);const _0x1495b2=await this['checkValidNaming'](_0x2416ff);if(!_0x1495b2)continue;const _0x446881=await this[_0x40fc89(0x175)](_0x2416ff);if(_0x446881)continue;let _0x103dd0;try{_0x103dd0=await this[_0x40fc89(0x144)](_0x2416ff);}catch(_0x6965e6){await this[_0x40fc89(0x15d)](_0x2416ff,new Error(_0x40fc89(0x14c)+_0x6965e6));continue;}await _0x45b972[_0x40fc89(0x176)]({'repository':_0x103dd0,'convertToSFDX':_0x1291ce[_0x40fc89(0x13f)],'loggerId':_0x4c7719,'syncRecord':_0x2416ff})[_0x40fc89(0x14d)](_0x40badb=>this[_0x40fc89(0x15d)](_0x2416ff,_0x40badb));}}catch(_0x1e771d){logger[_0x40fc89(0x151)](_0x1e771d);if(_0x1e771d instanceof too_many_requests_error_1['TooManyRequests']){this[_0x40fc89(0x178)][_0x40fc89(0x166)](_0x40fc89(0x135)),await this[_0x40fc89(0x178)][_0x40fc89(0x17e)]()[_0x40fc89(0x14d)](()=>void 0x0),await(0x0,utils_1['sleep'])(0x3c*0x3c*0x3e8);const _0x164302=typedi_1[_0x40fc89(0x180)][_0x40fc89(0x171)](FlosumSyncJob_1);_0x164302[_0x40fc89(0x176)](_0x1291ce,_0x4c7719);}else this[_0x40fc89(0x178)]['log'](_0x40fc89(0x179)+_0x1e771d),await this[_0x40fc89(0x178)][_0x40fc89(0x17e)]()['catch'](()=>void 0x0);return;}this[_0x40fc89(0x178)][_0x40fc89(0x166)](_0x40fc89(0x173)),await this['logger']['send'](),await this[_0x40fc89(0x134)][_0x40fc89(0x137)](_0x1291ce[_0x40fc89(0x174)])[_0x40fc89(0x14d)](()=>null);}};FlosumSyncJob=FlosumSyncJob_1=__decorate([(0x0,typedi_1['Service'])({'transient':!![]}),__metadata(a148_0x3d8b7f(0x14b),[salesforce_service_1[a148_0x3d8b7f(0x147)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a148_0x3d8b7f(0x16d)]])],FlosumSyncJob),exports[a148_0x3d8b7f(0x149)]=FlosumSyncJob;