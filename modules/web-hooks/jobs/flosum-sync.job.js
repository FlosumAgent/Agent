const a148_0x8df210=a148_0x1075;(function(_0x2c8253,_0x1202d3){const _0x915f08=a148_0x1075,_0x2feb2f=_0x2c8253();while(!![]){try{const _0x589903=-parseInt(_0x915f08(0x228))/0x1*(parseInt(_0x915f08(0x21e))/0x2)+parseInt(_0x915f08(0x20e))/0x3+parseInt(_0x915f08(0x1fc))/0x4*(-parseInt(_0x915f08(0x220))/0x5)+parseInt(_0x915f08(0x21a))/0x6+parseInt(_0x915f08(0x1ed))/0x7*(parseInt(_0x915f08(0x22f))/0x8)+-parseInt(_0x915f08(0x1f7))/0x9*(parseInt(_0x915f08(0x216))/0xa)+-parseInt(_0x915f08(0x22b))/0xb;if(_0x589903===_0x1202d3)break;else _0x2feb2f['push'](_0x2feb2f['shift']());}catch(_0x5e573d){_0x2feb2f['push'](_0x2feb2f['shift']());}}}(a148_0x4b8c,0x47a3a));const a148_0x417470=function(){let _0x310b18=!![];return function(_0x167eac,_0x1f6458){const _0x412c1a=_0x310b18?function(){const _0x39d3f5=a148_0x1075;if(_0x1f6458){const _0x268636=_0x1f6458[_0x39d3f5(0x20b)](_0x167eac,arguments);return _0x1f6458=null,_0x268636;}}:function(){};return _0x310b18=![],_0x412c1a;};}(),a148_0x40c7b4=a148_0x417470(this,function(){const _0x422433=a148_0x1075;return a148_0x40c7b4[_0x422433(0x221)]()[_0x422433(0x1ea)](_0x422433(0x1dc))[_0x422433(0x221)]()['constructor'](a148_0x40c7b4)['search'](_0x422433(0x1dc));});function a148_0x4b8c(){const _0x1525a2=['1444026rswDJh','metadata','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','getOwnPropertyDescriptor','2gGCHaV','default','809720fODxbu','toString','push','log','checkValidNaming','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','\x27\x20in\x20repository\x20\x27','sleep','34549mQnvfv','getRepositoryRecords','isIntersects','491227WSXpHG',']\x20due\x20error\x20-\x20','../../shared/utils','BRANCH_NAME_REGEXP','4580584UTTHZW','repositoryName','repoList','object','Error','gitManager','get','typedi','design:paramtypes','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repositoryId','../../../core/errors/too-many-requests.error','function','call','(((.+)+)+)+$','TooManyRequests','getRepoService','__importStar','SalesforceService','handleRecordSyncError','Unable\x20to\x20synchronize\x20repository\x20\x27','test','__metadata','run','SalesforceError','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x20Wait\x20for\x201h\x20to\x20continue;','length','updateRemoteState','search','Logger','__decorate','7aiYOCL','defineProperty','../../../core','repositoriesIntersections','getAll','./sync.job','SyncJob','catch','disableSync','branchId','9tIMcdt','\x27\x20-\x20\x27','__esModule','repoService','send','8UZHwFS','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','__createBinding','branchName','GitProviderManager','salesforceSync','setLoggerId','__setModuleDefault','SalesforceSyncService','FlosumSyncJob','logger','../../salesforce/errors/salesforce.error','flosum-sync-job','getOrCreateRepo','REPOSITORY_NAME_REGEXP','apply','create','../../salesforce/services/salesforce-sync.service','1110744mTnwPp','prototype','Waiting','salesforceService','[INFO]\x20Sync\x20job\x20done.','Service','name','all','4869640vGzBYN','error','have\x20to\x20synchronize\x20%d\x20branches','setStatus'];a148_0x4b8c=function(){return _0x1525a2;};return a148_0x4b8c();}function a148_0x1075(_0xf34363,_0x2ed7c7){const _0x2cee40=a148_0x4b8c();return a148_0x1075=function(_0x40c7b4,_0x417470){_0x40c7b4=_0x40c7b4-0x1d1;let _0x4b8cb3=_0x2cee40[_0x40c7b4];return _0x4b8cb3;},a148_0x1075(_0xf34363,_0x2ed7c7);}a148_0x40c7b4();'use strict';var __createBinding=this&&this[a148_0x8df210(0x1fe)]||(Object[a148_0x8df210(0x20c)]?function(_0x5cc318,_0x23a89c,_0x5e3e76,_0x6489d3){const _0x4e922e=a148_0x8df210;if(_0x6489d3===undefined)_0x6489d3=_0x5e3e76;Object[_0x4e922e(0x1ee)](_0x5cc318,_0x6489d3,{'enumerable':!![],'get':function(){return _0x23a89c[_0x5e3e76];}});}:function(_0xb7be8b,_0x473289,_0x128ce7,_0x482f90){if(_0x482f90===undefined)_0x482f90=_0x128ce7;_0xb7be8b[_0x482f90]=_0x473289[_0x128ce7];}),__setModuleDefault=this&&this[a148_0x8df210(0x203)]||(Object[a148_0x8df210(0x20c)]?function(_0x495376,_0x4dd1fb){const _0xbbb137=a148_0x8df210;Object[_0xbbb137(0x1ee)](_0x495376,_0xbbb137(0x21f),{'enumerable':!![],'value':_0x4dd1fb});}:function(_0x3d7ce6,_0x296f33){const _0x56ecaf=a148_0x8df210;_0x3d7ce6[_0x56ecaf(0x21f)]=_0x296f33;}),__decorate=this&&this[a148_0x8df210(0x1ec)]||function(_0x236933,_0x19007f,_0x290cb2,_0xbd2a55){const _0x458b98=a148_0x8df210;var _0x1deb4c=arguments[_0x458b98(0x1e8)],_0x3ee1b4=_0x1deb4c<0x3?_0x19007f:_0xbd2a55===null?_0xbd2a55=Object[_0x458b98(0x21d)](_0x19007f,_0x290cb2):_0xbd2a55,_0x146bee;if(typeof Reflect===_0x458b98(0x1d1)&&typeof Reflect['decorate']==='function')_0x3ee1b4=Reflect['decorate'](_0x236933,_0x19007f,_0x290cb2,_0xbd2a55);else{for(var _0x4573b0=_0x236933['length']-0x1;_0x4573b0>=0x0;_0x4573b0--)if(_0x146bee=_0x236933[_0x4573b0])_0x3ee1b4=(_0x1deb4c<0x3?_0x146bee(_0x3ee1b4):_0x1deb4c>0x3?_0x146bee(_0x19007f,_0x290cb2,_0x3ee1b4):_0x146bee(_0x19007f,_0x290cb2))||_0x3ee1b4;}return _0x1deb4c>0x3&&_0x3ee1b4&&Object[_0x458b98(0x1ee)](_0x19007f,_0x290cb2,_0x3ee1b4),_0x3ee1b4;},__importStar=this&&this[a148_0x8df210(0x1df)]||function(_0x38852d){const _0x19391a=a148_0x8df210;if(_0x38852d&&_0x38852d['__esModule'])return _0x38852d;var _0x1f7fdb={};if(_0x38852d!=null){for(var _0xe9c2ae in _0x38852d)if(_0xe9c2ae!==_0x19391a(0x21f)&&Object[_0x19391a(0x20f)]['hasOwnProperty'][_0x19391a(0x1db)](_0x38852d,_0xe9c2ae))__createBinding(_0x1f7fdb,_0x38852d,_0xe9c2ae);}return __setModuleDefault(_0x1f7fdb,_0x38852d),_0x1f7fdb;},__metadata=this&&this[a148_0x8df210(0x1e4)]||function(_0x5a587b,_0x255de9){const _0x21f037=a148_0x8df210;if(typeof Reflect===_0x21f037(0x1d1)&&typeof Reflect[_0x21f037(0x21b)]===_0x21f037(0x1da))return Reflect['metadata'](_0x5a587b,_0x255de9);},FlosumSyncJob_1;Object[a148_0x8df210(0x1ee)](exports,a148_0x8df210(0x1f9),{'value':!![]}),exports[a148_0x8df210(0x205)]=void 0x0;const constants_1=require('../../../constants'),typedi_1=__importStar(require(a148_0x8df210(0x1d5))),core_1=require(a148_0x8df210(0x1ef)),too_many_requests_error_1=require(a148_0x8df210(0x1d9)),salesforce_error_1=require(a148_0x8df210(0x207)),salesforce_sync_service_1=require(a148_0x8df210(0x20d)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a148_0x8df210(0x22d)),sync_job_1=require(a148_0x8df210(0x1f2)),logger=new core_1[(a148_0x8df210(0x1eb))](a148_0x8df210(0x208));let FlosumSyncJob=FlosumSyncJob_1=class FlosumSyncJob{constructor(_0xd8a81,_0x252215,_0x3dd104){const _0x1e0c5d=a148_0x8df210;this['salesforceService']=_0xd8a81,this[_0x1e0c5d(0x201)]=_0x252215,this[_0x1e0c5d(0x1d3)]=_0x3dd104,this[_0x1e0c5d(0x1fa)]=this[_0x1e0c5d(0x1d3)][_0x1e0c5d(0x1de)](),this[_0x1e0c5d(0x1f0)]={},this['repoList']=[];}async['handleRecordSyncError'](_0x5624d4,_0x4dc04a){const _0x375926=a148_0x8df210;if(_0x4dc04a instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x375926(0x201)]['setStatus'](_0x5624d4,_0x375926(0x210));throw _0x4dc04a;}try{this[_0x375926(0x206)][_0x375926(0x223)]('[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27'+_0x5624d4[_0x375926(0x230)]+'\x27\x20['+_0x5624d4['branchName']+_0x375926(0x22c)+_0x4dc04a),await this['logger'][_0x375926(0x1fb)](),await this['salesforceSync'][_0x375926(0x1e9)](_0x5624d4,{}),await this['salesforceSync'][_0x375926(0x219)](_0x5624d4,_0x375926(0x1d2));}catch(_0xb20412){if(_0xb20412 instanceof salesforce_error_1[_0x375926(0x1e6)])throw _0xb20412;}}async[a148_0x8df210(0x22a)](_0x319e29){const _0x3a954f=a148_0x8df210;if(_0x319e29['repositoryId']){const _0x4bc08e=_0x319e29['repositoryName']['toLowerCase'](),_0x569b3a=this[_0x3a954f(0x1f0)][_0x4bc08e];if(!_0x569b3a)this[_0x3a954f(0x1f0)][_0x4bc08e]=_0x319e29[_0x3a954f(0x230)];else{if(_0x569b3a&&_0x569b3a!==_0x319e29[_0x3a954f(0x230)])return await this['handleRecordSyncError'](_0x319e29,new Error(_0x3a954f(0x1e2)+_0x319e29[_0x3a954f(0x230)]+_0x3a954f(0x21c)+_0x4bc08e+_0x3a954f(0x1f8)+_0x569b3a+'\x27')),!![];}}return![];}async[a148_0x8df210(0x224)](_0x2dfd93){const _0x3fe7d2=a148_0x8df210;if(!constants_1[_0x3fe7d2(0x20a)][_0x3fe7d2(0x1e3)](_0x2dfd93[_0x3fe7d2(0x230)]))return await this[_0x3fe7d2(0x1e1)](_0x2dfd93,new Error(_0x3fe7d2(0x1e2)+_0x2dfd93['repositoryName']+_0x3fe7d2(0x1d7))),![];if(!constants_1[_0x3fe7d2(0x22e)][_0x3fe7d2(0x1e3)](_0x2dfd93[_0x3fe7d2(0x1ff)]))return await this[_0x3fe7d2(0x1e1)](_0x2dfd93,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x2dfd93['branchName']+_0x3fe7d2(0x226)+_0x2dfd93['repositoryName']+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a148_0x8df210(0x209)](_0x1f431f){const _0x164b03=a148_0x8df210,_0x10c680=this[_0x164b03(0x231)]['find'](_0x660659=>_0x1f431f[_0x164b03(0x230)]===_0x660659[_0x164b03(0x214)]);if(_0x10c680)return _0x10c680;const _0x46d64c=await this[_0x164b03(0x1fa)][_0x164b03(0x20c)]({'name':_0x1f431f['repositoryName'],'autoInit':!![],'defaultBranch':_0x1f431f[_0x164b03(0x1ff)],'private':!![]});return this[_0x164b03(0x231)][_0x164b03(0x222)](_0x46d64c),_0x46d64c;}async[a148_0x8df210(0x1e5)](_0x2340b7,_0x1ca2ff){const _0x52e003=a148_0x8df210;this[_0x52e003(0x211)][_0x52e003(0x202)](_0x1ca2ff),this[_0x52e003(0x206)]=this['salesforceService']['getLogger']();try{this['logger'][_0x52e003(0x223)]('[INFO]\x20Start\x20sync\x20job'),await this[_0x52e003(0x206)][_0x52e003(0x1fb)]();const [_0x1a63b2,_0x39420f]=await Promise[_0x52e003(0x215)]([this['salesforceSync']['getBranchRecords'](),this[_0x52e003(0x201)][_0x52e003(0x229)]()]);this['repoList']=await this[_0x52e003(0x1fa)][_0x52e003(0x1f1)]();const _0x4f2c98=[..._0x39420f,..._0x1a63b2];logger['log'](_0x52e003(0x218),_0x4f2c98['length']);for(const _0x1689f0 of _0x4f2c98){const _0x55ce68=typedi_1[_0x52e003(0x21f)][_0x52e003(0x1d4)](sync_job_1[_0x52e003(0x1f3)]);logger[_0x52e003(0x223)](_0x52e003(0x1fd),_0x1689f0[_0x52e003(0x230)],_0x1689f0[_0x52e003(0x1d8)],_0x1689f0[_0x52e003(0x1ff)],_0x1689f0[_0x52e003(0x1f6)]);const _0x10a810=await this[_0x52e003(0x224)](_0x1689f0);if(!_0x10a810)continue;const _0x364e9a=await this['isIntersects'](_0x1689f0);if(_0x364e9a)continue;const _0x4139c4=await this[_0x52e003(0x209)](_0x1689f0)[_0x52e003(0x1f4)](()=>null);if(!_0x4139c4){this['logger'][_0x52e003(0x223)]('[ERROR]\x20Could\x20not\x20find\x20any\x20repository\x20mathed\x20'+_0x1689f0['repositoryName']),await this['logger'][_0x52e003(0x1fb)]();continue;}await _0x55ce68['run']({'repository':_0x4139c4,'convertToSFDX':_0x2340b7['convertToSFDX'],'loggerId':_0x1ca2ff,'syncRecord':_0x1689f0})['catch'](_0x4ea7e8=>this['handleRecordSyncError'](_0x1689f0,_0x4ea7e8));}}catch(_0x3450e5){logger[_0x52e003(0x217)](_0x3450e5);if(_0x3450e5 instanceof too_many_requests_error_1[_0x52e003(0x1dd)]){this[_0x52e003(0x206)][_0x52e003(0x223)](_0x52e003(0x1e7)),await this['logger']['send']()[_0x52e003(0x1f4)](()=>void 0x0),await(0x0,utils_1[_0x52e003(0x227)])(0x3c*0x3c*0x3e8);const _0x3799da=typedi_1[_0x52e003(0x21f)][_0x52e003(0x1d4)](FlosumSyncJob_1);_0x3799da['run'](_0x2340b7,_0x1ca2ff);}else this['logger'][_0x52e003(0x223)](_0x52e003(0x225)+_0x3450e5),await this[_0x52e003(0x206)][_0x52e003(0x1fb)]()[_0x52e003(0x1f4)](()=>void 0x0);return;}this[_0x52e003(0x206)][_0x52e003(0x223)](_0x52e003(0x212)),await this['logger'][_0x52e003(0x1fb)](),await this[_0x52e003(0x201)][_0x52e003(0x1f5)](_0x2340b7['syncID'])[_0x52e003(0x1f4)](()=>null);}};FlosumSyncJob=FlosumSyncJob_1=__decorate([(0x0,typedi_1[a148_0x8df210(0x213)])({'transient':!![]}),__metadata(a148_0x8df210(0x1d6),[salesforce_service_1[a148_0x8df210(0x1e0)],salesforce_sync_service_1[a148_0x8df210(0x204)],git_provider_manager_1[a148_0x8df210(0x200)]])],FlosumSyncJob),exports['FlosumSyncJob']=FlosumSyncJob;