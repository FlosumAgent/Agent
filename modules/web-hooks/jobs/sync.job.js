const a148_0x2d4773=a148_0x2895;(function(_0x5bf491,_0x3547ee){const _0x5a6530=a148_0x2895,_0x26e695=_0x5bf491();while(!![]){try{const _0x12107a=-parseInt(_0x5a6530(0x173))/0x1+parseInt(_0x5a6530(0x148))/0x2+parseInt(_0x5a6530(0x151))/0x3+parseInt(_0x5a6530(0x14b))/0x4+-parseInt(_0x5a6530(0x15f))/0x5*(parseInt(_0x5a6530(0x12e))/0x6)+-parseInt(_0x5a6530(0x13b))/0x7+parseInt(_0x5a6530(0x12a))/0x8*(parseInt(_0x5a6530(0x172))/0x9);if(_0x12107a===_0x3547ee)break;else _0x26e695['push'](_0x26e695['shift']());}catch(_0x4c7037){_0x26e695['push'](_0x26e695['shift']());}}}(a148_0x302c,0x1b7c1));const a148_0x577d6b=function(){let _0x253cbb=!![];return function(_0x36a8cc,_0x457418){const _0x5df06a=_0x253cbb?function(){const _0x68b60d=a148_0x2895;if(_0x457418){const _0x29ef5b=_0x457418[_0x68b60d(0x12d)](_0x36a8cc,arguments);return _0x457418=null,_0x29ef5b;}}:function(){};return _0x253cbb=![],_0x5df06a;};}(),a148_0x1e43e4=a148_0x577d6b(this,function(){const _0xca259d=a148_0x2895;return a148_0x1e43e4['toString']()[_0xca259d(0x15e)]('(((.+)+)+)+$')[_0xca259d(0x137)]()[_0xca259d(0x178)](a148_0x1e43e4)[_0xca259d(0x15e)]('(((.+)+)+)+$');});a148_0x1e43e4();'use strict';function a148_0x302c(){const _0x1b33a0=['branches','../../salesforce/services/salesforce.service','message','Completed','sha','search','5TefrPJ','user',']\x20[Branch:\x20','repoService','repo','provider','branch','components','function','name','send','getComponentIds','__decorate','SalesforceSyncService','DEFAULT_GIT_USER_NAME','decorate','length','repository','remoteStateAttachmentId','657xgWimL','210840LoJqaQ','Service','create','[SYNC]\x20[','encodeBase64','constructor','../../../constants','getComponentsFromRepository','__metadata','[INFO]\x20Sync\x20job\x20done.','checkSyncStatus','__esModule','object','then','parse','gitUrl','CommitComponentsDto','SalesforceRetrieverService','17048HLukab','getOne','convertToSFDX','apply','864990aeHhth','Attachment','createBranchIfNotExists','SalesforceService','defineProperty','commitJob','getOwnPropertyDescriptor','GitProviderManager','repositoryId','toString','createRepositoryIfNotExists','stringify','../../salesforce/services/salesforce-retriever.service','476777TPwUUQ',']\x20[Repository:\x20','getBranchComponents','setStatus','[INFO]\x20Start\x20sync\x20job','getCommitDto','remoteState','logger','flosumSync','SyncJob','catch','Sync\x20repository','salesforceService','348968oieatU','typedi','branchName','738300fVXpKa','getComponents','log','In\x20Progress','DEFAULT_GIT_USER_EMAIL','../../salesforce/services/salesforce-sync.service','63213XVsWAO','syncData','run','patchObject','retrieveAttachment','gitManager','force','[INFO]\x20Branch\x20synchronized.\x20Skip'];a148_0x302c=function(){return _0x1b33a0;};return a148_0x302c();}function a148_0x2895(_0x1adb5d,_0x3e00bf){const _0x541e4b=a148_0x302c();return a148_0x2895=function(_0x1e43e4,_0x577d6b){_0x1e43e4=_0x1e43e4-0x12a;let _0x302c1a=_0x541e4b[_0x1e43e4];return _0x302c1a;},a148_0x2895(_0x1adb5d,_0x3e00bf);}var __decorate=this&&this[a148_0x2d4773(0x16b)]||function(_0x17ff5c,_0x2af765,_0x1c6e6a,_0x3c0b0c){const _0x13296c=a148_0x2d4773;var _0x1b583c=arguments['length'],_0x5915ec=_0x1b583c<0x3?_0x2af765:_0x3c0b0c===null?_0x3c0b0c=Object[_0x13296c(0x134)](_0x2af765,_0x1c6e6a):_0x3c0b0c,_0x508c2f;if(typeof Reflect===_0x13296c(0x17f)&&typeof Reflect['decorate']===_0x13296c(0x167))_0x5915ec=Reflect[_0x13296c(0x16e)](_0x17ff5c,_0x2af765,_0x1c6e6a,_0x3c0b0c);else{for(var _0x52f54b=_0x17ff5c[_0x13296c(0x16f)]-0x1;_0x52f54b>=0x0;_0x52f54b--)if(_0x508c2f=_0x17ff5c[_0x52f54b])_0x5915ec=(_0x1b583c<0x3?_0x508c2f(_0x5915ec):_0x1b583c>0x3?_0x508c2f(_0x2af765,_0x1c6e6a,_0x5915ec):_0x508c2f(_0x2af765,_0x1c6e6a))||_0x5915ec;}return _0x1b583c>0x3&&_0x5915ec&&Object['defineProperty'](_0x2af765,_0x1c6e6a,_0x5915ec),_0x5915ec;},__metadata=this&&this[a148_0x2d4773(0x17b)]||function(_0x29b382,_0x193302){const _0x2f74a5=a148_0x2d4773;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x2f74a5(0x167))return Reflect['metadata'](_0x29b382,_0x193302);};Object[a148_0x2d4773(0x132)](exports,a148_0x2d4773(0x17e),{'value':!![]}),exports[a148_0x2d4773(0x144)]=void 0x0;const typedi_1=require(a148_0x2d4773(0x149)),constants_1=require(a148_0x2d4773(0x179)),salesforce_retriever_service_1=require(a148_0x2d4773(0x13a)),salesforce_sync_service_1=require(a148_0x2d4773(0x150)),salesforce_service_1=require(a148_0x2d4773(0x15a)),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require('../../shared/utils'),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job');let SyncJob=class SyncJob{constructor(_0x16004f,_0x2d5a62,_0x33277e,_0x49f9b1){const _0x189a9f=a148_0x2d4773;this[_0x189a9f(0x156)]=_0x16004f,this['flosumSync']=_0x2d5a62,this[_0x189a9f(0x147)]=_0x33277e,this[_0x189a9f(0x133)]=_0x49f9b1,this[_0x189a9f(0x162)]=this[_0x189a9f(0x156)]['getRepoService']();}async[a148_0x2d4773(0x14d)](_0x2eafa4){const _0x54e705=a148_0x2d4773;return this[_0x54e705(0x142)][_0x54e705(0x14d)](_0x54e705(0x176)+this[_0x54e705(0x156)][_0x54e705(0x164)]['toUpperCase']()+_0x54e705(0x13c)+this[_0x54e705(0x152)]['repositoryName']+_0x54e705(0x161)+this[_0x54e705(0x152)][_0x54e705(0x14a)]+']\x20'+_0x2eafa4);}async[a148_0x2d4773(0x138)](){const _0x2ba47e=a148_0x2d4773;!this[_0x2ba47e(0x170)]&&(this[_0x2ba47e(0x170)]=await this[_0x2ba47e(0x162)][_0x2ba47e(0x175)]({'name':this[_0x2ba47e(0x152)]['repositoryName'],'autoInit':!![],'defaultBranch':this['syncData'][_0x2ba47e(0x14a)],'private':!![]}));}async[a148_0x2d4773(0x130)](){const _0x1e7955=a148_0x2d4773;let _0x36cdea=await this[_0x1e7955(0x170)]['branches']['getOne'](this[_0x1e7955(0x152)][_0x1e7955(0x14a)])[_0x1e7955(0x145)](()=>null);!_0x36cdea&&(_0x36cdea=await this[_0x1e7955(0x170)][_0x1e7955(0x159)][_0x1e7955(0x175)]({'name':this[_0x1e7955(0x152)][_0x1e7955(0x14a)]})),this[_0x1e7955(0x165)]=_0x36cdea;}async[a148_0x2d4773(0x16a)](){const _0x9ed489=a148_0x2d4773;return this[_0x9ed489(0x152)][_0x9ed489(0x136)]?this['flosumSync'][_0x9ed489(0x17a)](this[_0x9ed489(0x152)]['repositoryId']):this[_0x9ed489(0x143)][_0x9ed489(0x13d)](this[_0x9ed489(0x152)]['branchId']);}async[a148_0x2d4773(0x14c)](){const _0x23ae1b=a148_0x2d4773,_0x2c3e49=await this['getComponentIds'](),_0x1f5b00=new salesforce_retriever_service_1[(_0x23ae1b(0x184))](this[_0x23ae1b(0x147)]),_0x5e895d=await _0x1f5b00['run'](_0x2c3e49);return _0x5e895d;}async[a148_0x2d4773(0x140)](_0x3bc6ad){const _0x186465=a148_0x2d4773,_0xf8c375=new commit_components_dto_1[(_0x186465(0x183))]();return _0xf8c375[_0x186465(0x15b)]=_0x186465(0x146),_0xf8c375[_0x186465(0x160)]={'name':constants_1[_0x186465(0x16d)],'email':constants_1[_0x186465(0x14f)]},_0xf8c375[_0x186465(0x166)]={'writed':await this[_0x186465(0x14c)]()},_0xf8c375[_0x186465(0x12c)]=_0x3bc6ad,_0xf8c375[_0x186465(0x163)]=this[_0x186465(0x170)],_0xf8c375[_0x186465(0x165)]=this['branch'],_0xf8c375[_0x186465(0x157)]=!![],_0xf8c375;}async[a148_0x2d4773(0x17d)](){const _0x101cee=a148_0x2d4773;this['remoteStateAttachmentId']=await this['flosumSync']['getAttachmentId'](this['syncData']),this[_0x101cee(0x141)]=await this[_0x101cee(0x147)][_0x101cee(0x155)](this[_0x101cee(0x171)])[_0x101cee(0x180)](_0x11f891=>typeof _0x11f891===_0x101cee(0x17f)?_0x11f891:JSON[_0x101cee(0x181)](_0x11f891||'{}'))[_0x101cee(0x145)](()=>({}));if(this[_0x101cee(0x141)][this[_0x101cee(0x170)][_0x101cee(0x182)]]){if(this[_0x101cee(0x141)][this[_0x101cee(0x170)][_0x101cee(0x182)]]['lastCommit']===this['branch'][_0x101cee(0x15d)])return!![];}return![];}async['updateLastCommit'](){const _0x53d092=a148_0x2d4773,_0x5093f9=await this[_0x53d092(0x170)][_0x53d092(0x159)][_0x53d092(0x12b)](this[_0x53d092(0x165)][_0x53d092(0x168)]);await this[_0x53d092(0x14d)]('[INFO]\x20Update\x20remote\x20state.'),this[_0x53d092(0x141)]={[this[_0x53d092(0x170)][_0x53d092(0x182)]]:{'lastCommit':_0x5093f9['sha']}},await this['salesforceService'][_0x53d092(0x154)](_0x53d092(0x12f),this[_0x53d092(0x171)],{'Body':(0x0,utils_1[_0x53d092(0x177)])(JSON[_0x53d092(0x139)](this[_0x53d092(0x141)]))});}async[a148_0x2d4773(0x153)]({syncRecord:_0x5b40de,repository:_0x5b5576,loggerId:_0x1433a7,convertToSFDX:_0x489c57}){const _0x304746=a148_0x2d4773;this['syncData']=_0x5b40de,this['repository']=_0x5b5576,this['salesforceService']['setLoggerId'](_0x1433a7),this[_0x304746(0x142)]=this['salesforceService']['getLogger']();try{await this[_0x304746(0x143)][_0x304746(0x13e)](this['syncData'],_0x304746(0x14e)),await this[_0x304746(0x14d)](_0x304746(0x13f)),await this['createRepositoryIfNotExists'](),await this[_0x304746(0x130)]();const _0x355b13=await this[_0x304746(0x17d)]();if(_0x355b13){await this[_0x304746(0x143)][_0x304746(0x13e)](this[_0x304746(0x152)],_0x304746(0x15c)),await this['log'](_0x304746(0x158));return;}const _0x2dc271=await this[_0x304746(0x140)](_0x489c57);this[_0x304746(0x133)][_0x304746(0x142)]=this['logger'],await this[_0x304746(0x133)][_0x304746(0x153)](_0x2dc271),await this[_0x304746(0x143)][_0x304746(0x13e)](this[_0x304746(0x152)],_0x304746(0x15c)),await this['updateLastCommit'](),await this[_0x304746(0x14d)](_0x304746(0x17c));}catch(_0x233b78){throw _0x233b78;}finally{await this[_0x304746(0x142)][_0x304746(0x169)]();}}};SyncJob=__decorate([(0x0,typedi_1[a148_0x2d4773(0x174)])({'transient':!![]}),__metadata('design:paramtypes',[git_provider_manager_1[a148_0x2d4773(0x135)],salesforce_sync_service_1[a148_0x2d4773(0x16c)],salesforce_service_1[a148_0x2d4773(0x131)],commit_components_job_1['CommitComponentsJob']])],SyncJob),exports[a148_0x2d4773(0x144)]=SyncJob;