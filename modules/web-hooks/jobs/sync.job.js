const a147_0x7806=['create','Sync\x20repository','CommitComponentsDto','Completed','__metadata','metadata','getCommitDto','Service','provider','295737iwSvxg','Attachment','branches','1WDjGer','repositoryId','226795gIwfyI','catch','getRepoService','getComponentsFromRepository','defineProperty','flosumSync','gitManager','branchName','force','1045626eaFHFJ','1153081qcDJFn','../../salesforce/services/salesforce-sync.service','length','repo','setLoggerId','getLogger','51TRAYMX','name','getBranchComponents','473004rVeMcU','parse','updateLastCommit','constructor','run','salesforceService','SyncJob','__esModule','../../shared/utils','message','../dto/commit-components.dto','../../shared/git-provider.manager','repoService','decorate',']\x20[Branch:\x20','23969wxDZbN','retrieveAttachment','lastCommit','object','commitJob','checkSyncStatus','setStatus','createBranchIfNotExists','sha','gitUrl','getOne','SalesforceSyncService','function','45ZksFNC','remoteState','SalesforceService','createRepositoryIfNotExists','getAttachmentId','getComponents','repositoryName','248vgQdzT','branch','return\x20/\x22\x20+\x20this\x20+\x20\x22/','getComponentIds','[INFO]\x20Start\x20sync\x20job','../../../constants','log','In\x20Progress','then','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','getOwnPropertyDescriptor','__decorate','typedi','../../salesforce/services/salesforce-retriever.service','GitProviderManager','components','user','patchObject','repository','logger','syncData','[INFO]\x20Branch\x20synchronized.\x20Skip'];const a147_0x1d42d7=a147_0x9fd1;(function(_0x4c8ed6,_0x407e70){const _0x1d04c8=a147_0x9fd1;while(!![]){try{const _0x4fb636=-parseInt(_0x1d04c8(0x125))*-parseInt(_0x1d04c8(0xff))+-parseInt(_0x1d04c8(0xea))+-parseInt(_0x1d04c8(0xed))*-parseInt(_0x1d04c8(0xf9))+-parseInt(_0x1d04c8(0xf8))+parseInt(_0x1d04c8(0xef))+-parseInt(_0x1d04c8(0x102))+parseInt(_0x1d04c8(0x11e))*parseInt(_0x1d04c8(0x111));if(_0x4fb636===_0x407e70)break;else _0x4c8ed6['push'](_0x4c8ed6['shift']());}catch(_0x34f8fc){_0x4c8ed6['push'](_0x4c8ed6['shift']());}}}(a147_0x7806,0xa057a));const a147_0x5e715f=function(){let _0x37a240=!![];return function(_0x23f5a6,_0x2b174b){const _0x2312d2=_0x37a240?function(){if(_0x2b174b){const _0x23722e=_0x2b174b['apply'](_0x23f5a6,arguments);return _0x2b174b=null,_0x23722e;}}:function(){};return _0x37a240=![],_0x2312d2;};}(),a147_0x34f2e7=a147_0x5e715f(this,function(){const _0x3518a1=function(){const _0xde2057=a147_0x9fd1,_0x4b8511=_0x3518a1[_0xde2057(0x105)](_0xde2057(0x127))()[_0xde2057(0x105)](_0xde2057(0x12e));return!_0x4b8511['test'](a147_0x34f2e7);};return _0x3518a1();});a147_0x34f2e7();'use strict';function a147_0x9fd1(_0x10bdf6,_0x524f48){return a147_0x9fd1=function(_0x11452f,_0x34f2e7){_0x11452f=_0x11452f-0xd7;let _0x5e715f=a147_0x7806[_0x11452f];return _0x5e715f;},a147_0x9fd1(_0x10bdf6,_0x524f48);}var __decorate=this&&this[a147_0x1d42d7(0x130)]||function(_0x4d6222,_0x156452,_0x4a3ed2,_0x3ab073){const _0x32edee=a147_0x1d42d7;var _0x515c2c=arguments[_0x32edee(0xfb)],_0x3c1e4a=_0x515c2c<0x3?_0x156452:_0x3ab073===null?_0x3ab073=Object[_0x32edee(0x12f)](_0x156452,_0x4a3ed2):_0x3ab073,_0x2c63f2;if(typeof Reflect===_0x32edee(0x114)&&typeof Reflect[_0x32edee(0x10f)]===_0x32edee(0x11d))_0x3c1e4a=Reflect[_0x32edee(0x10f)](_0x4d6222,_0x156452,_0x4a3ed2,_0x3ab073);else{for(var _0x3d660c=_0x4d6222[_0x32edee(0xfb)]-0x1;_0x3d660c>=0x0;_0x3d660c--)if(_0x2c63f2=_0x4d6222[_0x3d660c])_0x3c1e4a=(_0x515c2c<0x3?_0x2c63f2(_0x3c1e4a):_0x515c2c>0x3?_0x2c63f2(_0x156452,_0x4a3ed2,_0x3c1e4a):_0x2c63f2(_0x156452,_0x4a3ed2))||_0x3c1e4a;}return _0x515c2c>0x3&&_0x3c1e4a&&Object[_0x32edee(0xf3)](_0x156452,_0x4a3ed2,_0x3c1e4a),_0x3c1e4a;},__metadata=this&&this[a147_0x1d42d7(0xe5)]||function(_0x5a0542,_0x1f4955){const _0x3e19dc=a147_0x1d42d7;if(typeof Reflect===_0x3e19dc(0x114)&&typeof Reflect[_0x3e19dc(0xe6)]===_0x3e19dc(0x11d))return Reflect[_0x3e19dc(0xe6)](_0x5a0542,_0x1f4955);};Object[a147_0x1d42d7(0xf3)](exports,a147_0x1d42d7(0x109),{'value':!![]}),exports[a147_0x1d42d7(0x108)]=void 0x0;const typedi_1=require(a147_0x1d42d7(0xd7)),constants_1=require(a147_0x1d42d7(0x12a)),salesforce_retriever_service_1=require(a147_0x1d42d7(0xd8)),salesforce_sync_service_1=require(a147_0x1d42d7(0xfa)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a147_0x1d42d7(0x10d)),utils_1=require(a147_0x1d42d7(0x10a)),commit_components_dto_1=require(a147_0x1d42d7(0x10c)),commit_components_job_1=require('./commit-components.job');let SyncJob=class SyncJob{constructor(_0x3d1209,_0x10792b,_0x57af50,_0x4280b7){const _0x35aed0=a147_0x1d42d7;this[_0x35aed0(0xf5)]=_0x3d1209,this[_0x35aed0(0xf4)]=_0x10792b,this[_0x35aed0(0x107)]=_0x57af50,this[_0x35aed0(0x115)]=_0x4280b7,this[_0x35aed0(0x10e)]=this['gitManager'][_0x35aed0(0xf1)]();}async[a147_0x1d42d7(0x12b)](_0x3c3175){const _0x140881=a147_0x1d42d7;return this['logger'][_0x140881(0x12b)]('[SYNC]\x20['+this[_0x140881(0xf5)][_0x140881(0xe9)]['toUpperCase']()+']\x20[Repository:\x20'+this[_0x140881(0xdf)][_0x140881(0x124)]+_0x140881(0x110)+this[_0x140881(0xdf)][_0x140881(0xf6)]+']\x20'+_0x3c3175);}async[a147_0x1d42d7(0x121)](){const _0x42fdbf=a147_0x1d42d7;let _0x2dc622=await this[_0x42fdbf(0x10e)][_0x42fdbf(0x11b)](this[_0x42fdbf(0xdf)][_0x42fdbf(0x124)])['catch'](()=>null);!_0x2dc622&&(_0x2dc622=await this['repoService'][_0x42fdbf(0xe1)]({'name':this['syncData'][_0x42fdbf(0x124)],'autoInit':!![],'defaultBranch':this[_0x42fdbf(0xdf)][_0x42fdbf(0xf6)],'private':!![]})),this[_0x42fdbf(0xdd)]=_0x2dc622;}async[a147_0x1d42d7(0x118)](){const _0x2ed238=a147_0x1d42d7;let _0x3f33c5=await this[_0x2ed238(0xdd)][_0x2ed238(0xec)][_0x2ed238(0x11b)](this[_0x2ed238(0xdf)][_0x2ed238(0xf6)])[_0x2ed238(0xf0)](()=>null);!_0x3f33c5&&(_0x3f33c5=await this['repository'][_0x2ed238(0xec)][_0x2ed238(0xe1)]({'name':this[_0x2ed238(0xdf)]['branchName']})),this['branch']=_0x3f33c5;}async['getComponentIds'](){const _0x497922=a147_0x1d42d7;return this[_0x497922(0xdf)][_0x497922(0xee)]?this[_0x497922(0xf4)][_0x497922(0xf2)](this[_0x497922(0xdf)][_0x497922(0xee)]):this[_0x497922(0xf4)][_0x497922(0x101)](this[_0x497922(0xdf)]['branchId']);}async['getComponents'](){const _0x50957c=a147_0x1d42d7,_0x27bfdf=await this[_0x50957c(0x128)](),_0x513449=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x50957c(0x107)]),_0x4ab11c=await _0x513449[_0x50957c(0x106)](_0x27bfdf);return _0x4ab11c;}async[a147_0x1d42d7(0xe7)](_0x115acc){const _0x3703d5=a147_0x1d42d7,_0x14eed8=new commit_components_dto_1[(_0x3703d5(0xe3))]();return _0x14eed8[_0x3703d5(0x10b)]=_0x3703d5(0xe2),_0x14eed8[_0x3703d5(0xdb)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x14eed8[_0x3703d5(0xda)]={'writed':await this[_0x3703d5(0x123)]()},_0x14eed8['convertToSFDX']=_0x115acc,_0x14eed8[_0x3703d5(0xfc)]=this[_0x3703d5(0xdd)],_0x14eed8[_0x3703d5(0x126)]=this[_0x3703d5(0x126)],_0x14eed8[_0x3703d5(0xf7)]=!![],_0x14eed8;}async[a147_0x1d42d7(0x116)](){const _0x448190=a147_0x1d42d7;this['remoteStateAttachmentId']=await this[_0x448190(0xf4)][_0x448190(0x122)](this['syncData']),this[_0x448190(0x11f)]=await this[_0x448190(0x107)][_0x448190(0x112)](this['remoteStateAttachmentId'])[_0x448190(0x12d)](_0x4e5ec0=>typeof _0x4e5ec0==='object'?_0x4e5ec0:JSON[_0x448190(0x103)](_0x4e5ec0||'{}'))[_0x448190(0xf0)](()=>({}));if(this[_0x448190(0x11f)][this['repository'][_0x448190(0x11a)]]){if(this[_0x448190(0x11f)][this[_0x448190(0xdd)][_0x448190(0x11a)]][_0x448190(0x113)]===this[_0x448190(0x126)][_0x448190(0x119)])return!![];}return![];}async[a147_0x1d42d7(0x104)](){const _0x2996b4=a147_0x1d42d7,_0x8935e1=await this['repository'][_0x2996b4(0xec)]['getOne'](this[_0x2996b4(0x126)][_0x2996b4(0x100)]);await this[_0x2996b4(0x12b)]('[INFO]\x20Update\x20remote\x20state.'),this[_0x2996b4(0x11f)]={[this[_0x2996b4(0xdd)][_0x2996b4(0x11a)]]:{'lastCommit':_0x8935e1[_0x2996b4(0x119)]}},await this[_0x2996b4(0x107)][_0x2996b4(0xdc)](_0x2996b4(0xeb),this['remoteStateAttachmentId'],{'Body':utils_1['encodeBase64'](JSON['stringify'](this['remoteState']))});}async[a147_0x1d42d7(0x106)](_0x5ca9ea,_0x425365,_0x579f3b){const _0x49e798=a147_0x1d42d7;this[_0x49e798(0xdf)]=_0x5ca9ea,this[_0x49e798(0x107)][_0x49e798(0xfd)](_0x425365),this[_0x49e798(0xde)]=this[_0x49e798(0x107)][_0x49e798(0xfe)]();try{await this[_0x49e798(0xf4)][_0x49e798(0x117)](this[_0x49e798(0xdf)],_0x49e798(0x12c)),await this[_0x49e798(0x12b)](_0x49e798(0x129)),await this['createRepositoryIfNotExists'](),await this['createBranchIfNotExists']();const _0x3e72bc=await this[_0x49e798(0x116)]();if(_0x3e72bc){await this['flosumSync'][_0x49e798(0x117)](this['syncData'],_0x49e798(0xe4)),await this[_0x49e798(0x12b)](_0x49e798(0xe0));return;}const _0x24f5b6=await this[_0x49e798(0xe7)](_0x579f3b);this[_0x49e798(0x115)][_0x49e798(0xde)]=this['logger'],await this[_0x49e798(0x115)][_0x49e798(0x106)](_0x24f5b6),await this['flosumSync'][_0x49e798(0x117)](this[_0x49e798(0xdf)],_0x49e798(0xe4)),await this[_0x49e798(0x104)](),await this['log']('[INFO]\x20Sync\x20job\x20done.');}catch(_0x1d411b){throw _0x1d411b;}finally{await this[_0x49e798(0xde)]['send']();}}};SyncJob=__decorate([typedi_1[a147_0x1d42d7(0xe8)]({'transient':!![]}),__metadata('design:paramtypes',[git_provider_manager_1[a147_0x1d42d7(0xd9)],salesforce_sync_service_1[a147_0x1d42d7(0x11c)],salesforce_service_1[a147_0x1d42d7(0x120)],commit_components_job_1['CommitComponentsJob']])],SyncJob),exports[a147_0x1d42d7(0x108)]=SyncJob;