const a145_0x449b=['catch','Completed','retrieveAttachment','245032NZeSCi','CommitComponentsJob','decorate','GitProviderManager',']\x20[Branch:\x20','lastCommit','__metadata','repoService','7piRLnh','logger','SalesforceRetrieverService','CommitComponentsDto','getLogger','../../../constants','components','In\x20Progress','send','createRepositoryIfNotExists','stringify','test','remoteState','run','apply','branch','DEFAULT_GIT_USER_NAME','typedi','branchName','gitManager','getOne','5539zcKgPH','defineProperty','repositoryName','SyncJob','setStatus','design:paramtypes','83TotlZv','repository','./commit-components.job','checkSyncStatus','Sync\x20repository','message','updateLastCommit','parse','../../shared/git-provider.manager','convertToSFDX','object','getComponentIds','salesforceService','[INFO]\x20Update\x20remote\x20state.','gitUrl','[INFO]\x20Branch\x20synchronized.\x20Skip','repositoryId','[INFO]\x20Start\x20sync\x20job','length','getRepoService','encodeBase64','7468PgsEKL','log','function','../../salesforce/services/salesforce-sync.service','flosumSync','getBranchComponents','getComponents','syncData','../../shared/utils',']\x20[Repository:\x20','getOwnPropertyDescriptor','../dto/commit-components.dto','1017544MhLeFP','patchObject','Service','repo','commitJob','__esModule','90096BfxfJX','create','getCommitDto','name','[INFO]\x20Sync\x20job\x20done.','remoteStateAttachmentId','setLoggerId','branches','force','2578845zOcPee','createBranchIfNotExists','constructor','toUpperCase','then','291JfBJsU','getAttachmentId','223722KbuUWI','metadata','sha'];const a145_0x25a276=a145_0x13c7;(function(_0x54a209,_0x26ddcb){const _0xe6fc03=a145_0x13c7;while(!![]){try{const _0x33e545=parseInt(_0xe6fc03(0xe5))+parseInt(_0xe6fc03(0xf3))*-parseInt(_0xe6fc03(0xb8))+-parseInt(_0xe6fc03(0xbe))*parseInt(_0xe6fc03(0xd3))+-parseInt(_0xe6fc03(0xf5))+-parseInt(_0xe6fc03(0x103))*-parseInt(_0xe6fc03(0xfb))+-parseInt(_0xe6fc03(0xdf))+parseInt(_0xe6fc03(0xee));if(_0x33e545===_0x26ddcb)break;else _0x54a209['push'](_0x54a209['shift']());}catch(_0x2eca8d){_0x54a209['push'](_0x54a209['shift']());}}}(a145_0x449b,0xde766));function a145_0x13c7(_0x33a21a,_0x3ce114){return a145_0x13c7=function(_0xa18395,_0x4786df){_0xa18395=_0xa18395-0xb7;let _0x44cae9=a145_0x449b[_0xa18395];return _0x44cae9;},a145_0x13c7(_0x33a21a,_0x3ce114);}const a145_0x44cae9=function(){let _0x4934f2=!![];return function(_0x34b851,_0x39f4b){const _0x2ab6ed=_0x4934f2?function(){const _0x34b951=a145_0x13c7;if(_0x39f4b){const _0x38b696=_0x39f4b[_0x34b951(0x111)](_0x34b851,arguments);return _0x39f4b=null,_0x38b696;}}:function(){};return _0x4934f2=![],_0x2ab6ed;};}(),a145_0x4786df=a145_0x44cae9(this,function(){const _0x4b1560=function(){const _0x4429de=a145_0x13c7,_0x38e9c5=_0x4b1560[_0x4429de(0xf0)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x4429de(0xf0)]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x38e9c5[_0x4429de(0x10e)](a145_0x4786df);};return _0x4b1560();});a145_0x4786df();'use strict';var __decorate=this&&this['__decorate']||function(_0x19197b,_0x50958f,_0x4d693c,_0x1d2ee3){const _0x529f85=a145_0x13c7;var _0x3b64da=arguments[_0x529f85(0xd0)],_0x315767=_0x3b64da<0x3?_0x50958f:_0x1d2ee3===null?_0x1d2ee3=Object[_0x529f85(0xdd)](_0x50958f,_0x4d693c):_0x1d2ee3,_0x45a94e;if(typeof Reflect==='object'&&typeof Reflect['decorate']===_0x529f85(0xd5))_0x315767=Reflect[_0x529f85(0xfd)](_0x19197b,_0x50958f,_0x4d693c,_0x1d2ee3);else{for(var _0x180e58=_0x19197b[_0x529f85(0xd0)]-0x1;_0x180e58>=0x0;_0x180e58--)if(_0x45a94e=_0x19197b[_0x180e58])_0x315767=(_0x3b64da<0x3?_0x45a94e(_0x315767):_0x3b64da>0x3?_0x45a94e(_0x50958f,_0x4d693c,_0x315767):_0x45a94e(_0x50958f,_0x4d693c))||_0x315767;}return _0x3b64da>0x3&&_0x315767&&Object[_0x529f85(0xb9)](_0x50958f,_0x4d693c,_0x315767),_0x315767;},__metadata=this&&this[a145_0x25a276(0x101)]||function(_0x3adbb2,_0x2634ac){const _0x337e4a=a145_0x25a276;if(typeof Reflect===_0x337e4a(0xc8)&&typeof Reflect[_0x337e4a(0xf6)]===_0x337e4a(0xd5))return Reflect['metadata'](_0x3adbb2,_0x2634ac);};Object['defineProperty'](exports,a145_0x25a276(0xe4),{'value':!![]}),exports[a145_0x25a276(0xbb)]=void 0x0;const typedi_1=require(a145_0x25a276(0x114)),constants_1=require(a145_0x25a276(0x108)),salesforce_retriever_service_1=require('../../salesforce/services/salesforce-retriever.service'),salesforce_sync_service_1=require(a145_0x25a276(0xd6)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a145_0x25a276(0xc6)),utils_1=require(a145_0x25a276(0xdb)),commit_components_dto_1=require(a145_0x25a276(0xde)),commit_components_job_1=require(a145_0x25a276(0xc0));let SyncJob=class SyncJob{constructor(_0x1dfefd,_0x2ee518,_0xc7ecbe,_0x183b67){const _0x10f2e7=a145_0x25a276;this[_0x10f2e7(0x116)]=_0x1dfefd,this[_0x10f2e7(0xd7)]=_0x2ee518,this[_0x10f2e7(0xca)]=_0xc7ecbe,this[_0x10f2e7(0xe3)]=_0x183b67,this['repoService']=this['gitManager'][_0x10f2e7(0xd1)]();}async[a145_0x25a276(0xd4)](_0x10161e){const _0x575e1c=a145_0x25a276;return this[_0x575e1c(0x104)][_0x575e1c(0xd4)]('[SYNC]\x20['+this[_0x575e1c(0x116)]['provider'][_0x575e1c(0xf1)]()+_0x575e1c(0xdc)+this[_0x575e1c(0xda)][_0x575e1c(0xba)]+_0x575e1c(0xff)+this[_0x575e1c(0xda)][_0x575e1c(0x115)]+']\x20'+_0x10161e);}async['createRepositoryIfNotExists'](){const _0x427e78=a145_0x25a276;let _0x16de8c=await this[_0x427e78(0x102)][_0x427e78(0xb7)](this['syncData'][_0x427e78(0xba)])[_0x427e78(0xf8)](()=>null);!_0x16de8c&&(_0x16de8c=await this[_0x427e78(0x102)][_0x427e78(0xe6)]({'name':this[_0x427e78(0xda)][_0x427e78(0xba)],'autoInit':!![],'defaultBranch':this['syncData']['branchName'],'private':!![]})),this['repository']=_0x16de8c;}async[a145_0x25a276(0xef)](){const _0x4b5e28=a145_0x25a276;let _0x59f4e1=await this['repository']['branches'][_0x4b5e28(0xb7)](this[_0x4b5e28(0xda)][_0x4b5e28(0x115)])[_0x4b5e28(0xf8)](()=>null);!_0x59f4e1&&(_0x59f4e1=await this[_0x4b5e28(0xbf)]['branches'][_0x4b5e28(0xe6)]({'name':this[_0x4b5e28(0xda)][_0x4b5e28(0x115)]})),this[_0x4b5e28(0x112)]=_0x59f4e1;}async[a145_0x25a276(0xc9)](){const _0x1a350e=a145_0x25a276;return this['syncData'][_0x1a350e(0xce)]?this[_0x1a350e(0xd7)]['getComponentsFromRepository'](this['syncData'][_0x1a350e(0xce)]):this['flosumSync'][_0x1a350e(0xd8)](this[_0x1a350e(0xda)]['branchId']);}async[a145_0x25a276(0xd9)](){const _0x5ede72=a145_0x25a276,_0x51e38e=await this[_0x5ede72(0xc9)](),_0x6143ff=new salesforce_retriever_service_1[(_0x5ede72(0x105))](this['salesforceService']),_0x3c8cde=await _0x6143ff[_0x5ede72(0x110)](_0x51e38e);return _0x3c8cde;}async['getCommitDto'](_0x49ed3c){const _0x4e3706=a145_0x25a276,_0xca2ad9=new commit_components_dto_1[(_0x4e3706(0x106))]();return _0xca2ad9[_0x4e3706(0xc3)]=_0x4e3706(0xc2),_0xca2ad9['user']={'name':constants_1[_0x4e3706(0x113)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0xca2ad9[_0x4e3706(0x109)]={'writed':await this[_0x4e3706(0xd9)]()},_0xca2ad9[_0x4e3706(0xc7)]=_0x49ed3c,_0xca2ad9[_0x4e3706(0xe2)]=this[_0x4e3706(0xbf)],_0xca2ad9[_0x4e3706(0x112)]=this[_0x4e3706(0x112)],_0xca2ad9[_0x4e3706(0xed)]=!![],_0xca2ad9;}async[a145_0x25a276(0xc1)](){const _0x5e39fb=a145_0x25a276;this[_0x5e39fb(0xea)]=await this[_0x5e39fb(0xd7)][_0x5e39fb(0xf4)](this[_0x5e39fb(0xda)]),this['remoteState']=await this[_0x5e39fb(0xca)][_0x5e39fb(0xfa)](this[_0x5e39fb(0xea)])[_0x5e39fb(0xf2)](_0x587049=>typeof _0x587049===_0x5e39fb(0xc8)?_0x587049:JSON[_0x5e39fb(0xc5)](_0x587049||'{}'))[_0x5e39fb(0xf8)](()=>({}));if(this[_0x5e39fb(0x10f)][this['repository'][_0x5e39fb(0xcc)]]){if(this['remoteState'][this[_0x5e39fb(0xbf)]['gitUrl']][_0x5e39fb(0x100)]===this['branch']['sha'])return!![];}return![];}async[a145_0x25a276(0xc4)](){const _0x3e4ec4=a145_0x25a276,_0x22edb3=await this['repository'][_0x3e4ec4(0xec)][_0x3e4ec4(0xb7)](this['branch'][_0x3e4ec4(0xe8)]);await this[_0x3e4ec4(0xd4)](_0x3e4ec4(0xcb)),this[_0x3e4ec4(0x10f)]={[this['repository'][_0x3e4ec4(0xcc)]]:{'lastCommit':_0x22edb3[_0x3e4ec4(0xf7)]}},await this[_0x3e4ec4(0xca)][_0x3e4ec4(0xe0)]('Attachment',this['remoteStateAttachmentId'],{'Body':utils_1[_0x3e4ec4(0xd2)](JSON[_0x3e4ec4(0x10d)](this['remoteState']))});}async[a145_0x25a276(0x110)](_0x1b6d59,_0x2e9683,_0x36d588){const _0x43d69e=a145_0x25a276;this['syncData']=_0x1b6d59,this[_0x43d69e(0xca)][_0x43d69e(0xeb)](_0x2e9683),this['logger']=this[_0x43d69e(0xca)][_0x43d69e(0x107)]();try{await this[_0x43d69e(0xd7)]['setStatus'](this[_0x43d69e(0xda)],_0x43d69e(0x10a)),await this[_0x43d69e(0xd4)](_0x43d69e(0xcf)),await this[_0x43d69e(0x10c)](),await this[_0x43d69e(0xef)]();const _0x2be92e=await this[_0x43d69e(0xc1)]();if(_0x2be92e){await this[_0x43d69e(0xd7)][_0x43d69e(0xbc)](this[_0x43d69e(0xda)],'Completed'),await this[_0x43d69e(0xd4)](_0x43d69e(0xcd));return;}const _0x397e19=await this[_0x43d69e(0xe7)](_0x36d588);this[_0x43d69e(0xe3)][_0x43d69e(0x104)]=this[_0x43d69e(0x104)],await this[_0x43d69e(0xe3)]['run'](_0x397e19),await this[_0x43d69e(0xd7)][_0x43d69e(0xbc)](this[_0x43d69e(0xda)],_0x43d69e(0xf9)),await this['updateLastCommit'](),await this[_0x43d69e(0xd4)](_0x43d69e(0xe9));}catch(_0x2c7dd8){throw _0x2c7dd8;}finally{await this[_0x43d69e(0x104)][_0x43d69e(0x10b)]();}}};SyncJob=__decorate([typedi_1[a145_0x25a276(0xe1)]({'transient':!![]}),__metadata(a145_0x25a276(0xbd),[git_provider_manager_1[a145_0x25a276(0xfe)],salesforce_sync_service_1['SalesforceSyncService'],salesforce_service_1['SalesforceService'],commit_components_job_1[a145_0x25a276(0xfc)]])],SyncJob),exports[a145_0x25a276(0xbb)]=SyncJob;