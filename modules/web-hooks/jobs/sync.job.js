const a147_0x3f61d=a147_0x548b;function a147_0x4b23(){const _0x7e553d=['parse','[INFO]\x20Update\x20remote\x20state.','stringify','retrieveAttachment','send','Sync\x20repository','user','branches','../../shared/git-provider.manager','decorate','repo','[INFO]\x20Branch\x20synchronized.\x20Skip','../../shared/utils','message','remoteStateAttachmentId','salesforceService','[SYNC]\x20[','2638860wwCivn','Completed','../../salesforce/services/salesforce-sync.service','syncData','metadata','getComponentIds','object','name','checkSyncStatus',']\x20[Branch:\x20','../../salesforce/services/salesforce.service','function','force','branchId','flosumSync','search','118603JmsJgN','getRepoService','convertToSFDX','[INFO]\x20Sync\x20job\x20done.','4ElAmNi','15246450ezHXXh','catch','(((.+)+)+)+$','1159304CBWWQc','GitProviderManager','commitJob','logger','getLogger',']\x20[Repository:\x20','getOne','__decorate','constructor','../../salesforce/services/salesforce-retriever.service','gitUrl','4vSvkzk','18tfplHZ','repoService','log','./commit-components.job','defineProperty','sha','Service','create','setStatus','updateLastCommit','toString','repository','branchName','getOwnPropertyDescriptor','repositoryName','typedi','run','encodeBase64','getComponents','length','SalesforceSyncService','Attachment','3502899CMzeEb','patchObject','remoteState','repositoryId','SalesforceRetrieverService','4044455QAMlou','../../../constants','createBranchIfNotExists','1862875Zdhzzz','getBranchComponents','getComponentsFromRepository','SyncJob','CommitComponentsJob','branch','__esModule','setLoggerId'];a147_0x4b23=function(){return _0x7e553d;};return a147_0x4b23();}(function(_0x474c98,_0x19d9ec){const _0x27c244=a147_0x548b,_0x502468=_0x474c98();while(!![]){try{const _0x29e210=-parseInt(_0x27c244(0x1cc))/0x1*(-parseInt(_0x27c244(0x175))/0x2)+-parseInt(_0x27c244(0x1bc))/0x3*(-parseInt(_0x27c244(0x184))/0x4)+-parseInt(_0x27c244(0x1a0))/0x5+parseInt(_0x27c244(0x185))/0x6*(-parseInt(_0x27c244(0x1a3))/0x7)+parseInt(_0x27c244(0x179))/0x8+-parseInt(_0x27c244(0x19b))/0x9+parseInt(_0x27c244(0x176))/0xa;if(_0x29e210===_0x19d9ec)break;else _0x502468['push'](_0x502468['shift']());}catch(_0x2ba7c9){_0x502468['push'](_0x502468['shift']());}}}(a147_0x4b23,0xc0d93));function a147_0x548b(_0x15af1e,_0x317456){const _0x57b2ec=a147_0x4b23();return a147_0x548b=function(_0x47dfce,_0x96d333){_0x47dfce=_0x47dfce-0x173;let _0x4b2385=_0x57b2ec[_0x47dfce];return _0x4b2385;},a147_0x548b(_0x15af1e,_0x317456);}const a147_0x96d333=function(){let _0x5bdf2e=!![];return function(_0x1be163,_0x303ec0){const _0x413097=_0x5bdf2e?function(){if(_0x303ec0){const _0x6f031d=_0x303ec0['apply'](_0x1be163,arguments);return _0x303ec0=null,_0x6f031d;}}:function(){};return _0x5bdf2e=![],_0x413097;};}(),a147_0x47dfce=a147_0x96d333(this,function(){const _0x4c9685=a147_0x548b;return a147_0x47dfce[_0x4c9685(0x18f)]()['search'](_0x4c9685(0x178))[_0x4c9685(0x18f)]()[_0x4c9685(0x181)](a147_0x47dfce)[_0x4c9685(0x1cb)](_0x4c9685(0x178));});a147_0x47dfce();'use strict';var __decorate=this&&this[a147_0x3f61d(0x180)]||function(_0x3381ca,_0x456f93,_0x2c9655,_0x500a0a){const _0x11365c=a147_0x3f61d;var _0x447d74=arguments['length'],_0x98ae3b=_0x447d74<0x3?_0x456f93:_0x500a0a===null?_0x500a0a=Object[_0x11365c(0x192)](_0x456f93,_0x2c9655):_0x500a0a,_0x57ce36;if(typeof Reflect===_0x11365c(0x1c2)&&typeof Reflect[_0x11365c(0x1b4)]===_0x11365c(0x1c7))_0x98ae3b=Reflect[_0x11365c(0x1b4)](_0x3381ca,_0x456f93,_0x2c9655,_0x500a0a);else{for(var _0x55fccb=_0x3381ca[_0x11365c(0x198)]-0x1;_0x55fccb>=0x0;_0x55fccb--)if(_0x57ce36=_0x3381ca[_0x55fccb])_0x98ae3b=(_0x447d74<0x3?_0x57ce36(_0x98ae3b):_0x447d74>0x3?_0x57ce36(_0x456f93,_0x2c9655,_0x98ae3b):_0x57ce36(_0x456f93,_0x2c9655))||_0x98ae3b;}return _0x447d74>0x3&&_0x98ae3b&&Object[_0x11365c(0x189)](_0x456f93,_0x2c9655,_0x98ae3b),_0x98ae3b;},__metadata=this&&this['__metadata']||function(_0x43c1a7,_0x1a9349){const _0x3ebaa8=a147_0x3f61d;if(typeof Reflect===_0x3ebaa8(0x1c2)&&typeof Reflect[_0x3ebaa8(0x1c0)]==='function')return Reflect[_0x3ebaa8(0x1c0)](_0x43c1a7,_0x1a9349);};Object[a147_0x3f61d(0x189)](exports,a147_0x3f61d(0x1a9),{'value':!![]}),exports['SyncJob']=void 0x0;const typedi_1=require(a147_0x3f61d(0x194)),constants_1=require(a147_0x3f61d(0x1a1)),salesforce_retriever_service_1=require(a147_0x3f61d(0x182)),salesforce_sync_service_1=require(a147_0x3f61d(0x1be)),salesforce_service_1=require(a147_0x3f61d(0x1c6)),git_provider_manager_1=require(a147_0x3f61d(0x1b3)),utils_1=require(a147_0x3f61d(0x1b7)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a147_0x3f61d(0x188));let SyncJob=class SyncJob{constructor(_0x455371,_0x5278d7,_0x2e8651,_0x1cb431){const _0x41840b=a147_0x3f61d;this['gitManager']=_0x455371,this[_0x41840b(0x1ca)]=_0x5278d7,this['salesforceService']=_0x2e8651,this[_0x41840b(0x17b)]=_0x1cb431,this[_0x41840b(0x186)]=this['gitManager'][_0x41840b(0x1cd)]();}async[a147_0x3f61d(0x187)](_0xdbc14c){const _0x57bd59=a147_0x3f61d;return this[_0x57bd59(0x17c)]['log'](_0x57bd59(0x1bb)+this['gitManager']['provider']['toUpperCase']()+_0x57bd59(0x17e)+this[_0x57bd59(0x1bf)][_0x57bd59(0x193)]+_0x57bd59(0x1c5)+this[_0x57bd59(0x1bf)]['branchName']+']\x20'+_0xdbc14c);}async['createRepositoryIfNotExists'](){const _0x41829a=a147_0x3f61d;let _0x270eec=await this[_0x41829a(0x186)]['getOne'](this[_0x41829a(0x1bf)]['repositoryName'])['catch'](()=>null);!_0x270eec&&(_0x270eec=await this[_0x41829a(0x186)][_0x41829a(0x18c)]({'name':this[_0x41829a(0x1bf)]['repositoryName'],'autoInit':!![],'defaultBranch':this['syncData'][_0x41829a(0x191)],'private':!![]})),this[_0x41829a(0x190)]=_0x270eec;}async[a147_0x3f61d(0x1a2)](){const _0x1a747e=a147_0x3f61d;let _0x459028=await this['repository']['branches'][_0x1a747e(0x17f)](this[_0x1a747e(0x1bf)]['branchName'])[_0x1a747e(0x177)](()=>null);!_0x459028&&(_0x459028=await this['repository'][_0x1a747e(0x1b2)][_0x1a747e(0x18c)]({'name':this['syncData'][_0x1a747e(0x191)]})),this[_0x1a747e(0x1a8)]=_0x459028;}async[a147_0x3f61d(0x1c1)](){const _0x30a2ff=a147_0x3f61d;return this[_0x30a2ff(0x1bf)][_0x30a2ff(0x19e)]?this[_0x30a2ff(0x1ca)][_0x30a2ff(0x1a5)](this[_0x30a2ff(0x1bf)][_0x30a2ff(0x19e)]):this['flosumSync'][_0x30a2ff(0x1a4)](this['syncData'][_0x30a2ff(0x1c9)]);}async[a147_0x3f61d(0x197)](){const _0x37fb0d=a147_0x3f61d,_0x1b7c3d=await this[_0x37fb0d(0x1c1)](),_0x130067=new salesforce_retriever_service_1[(_0x37fb0d(0x19f))](this['salesforceService']),_0xffc94a=await _0x130067[_0x37fb0d(0x195)](_0x1b7c3d);return _0xffc94a;}async['getCommitDto'](_0x463548){const _0x5889d7=a147_0x3f61d,_0x5dc684=new commit_components_dto_1['CommitComponentsDto']();return _0x5dc684[_0x5889d7(0x1b8)]=_0x5889d7(0x1b0),_0x5dc684[_0x5889d7(0x1b1)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x5dc684['components']={'writed':await this['getComponents']()},_0x5dc684[_0x5889d7(0x173)]=_0x463548,_0x5dc684[_0x5889d7(0x1b5)]=this[_0x5889d7(0x190)],_0x5dc684[_0x5889d7(0x1a8)]=this[_0x5889d7(0x1a8)],_0x5dc684[_0x5889d7(0x1c8)]=!![],_0x5dc684;}async[a147_0x3f61d(0x1c4)](){const _0x2862ea=a147_0x3f61d;this['remoteStateAttachmentId']=await this[_0x2862ea(0x1ca)]['getAttachmentId'](this['syncData']),this['remoteState']=await this[_0x2862ea(0x1ba)][_0x2862ea(0x1ae)](this[_0x2862ea(0x1b9)])['then'](_0x61d355=>typeof _0x61d355===_0x2862ea(0x1c2)?_0x61d355:JSON[_0x2862ea(0x1ab)](_0x61d355||'{}'))[_0x2862ea(0x177)](()=>({}));if(this[_0x2862ea(0x19d)][this[_0x2862ea(0x190)]['gitUrl']]){if(this[_0x2862ea(0x19d)][this[_0x2862ea(0x190)][_0x2862ea(0x183)]]['lastCommit']===this[_0x2862ea(0x1a8)]['sha'])return!![];}return![];}async[a147_0x3f61d(0x18e)](){const _0x3845ad=a147_0x3f61d,_0x5ad05e=await this['repository'][_0x3845ad(0x1b2)][_0x3845ad(0x17f)](this[_0x3845ad(0x1a8)][_0x3845ad(0x1c3)]);await this[_0x3845ad(0x187)](_0x3845ad(0x1ac)),this['remoteState']={[this[_0x3845ad(0x190)][_0x3845ad(0x183)]]:{'lastCommit':_0x5ad05e[_0x3845ad(0x18a)]}},await this[_0x3845ad(0x1ba)][_0x3845ad(0x19c)](_0x3845ad(0x19a),this[_0x3845ad(0x1b9)],{'Body':(0x0,utils_1[_0x3845ad(0x196)])(JSON[_0x3845ad(0x1ad)](this[_0x3845ad(0x19d)]))});}async[a147_0x3f61d(0x195)](_0x2bf71e,_0x539cfa,_0xb78011){const _0x98db66=a147_0x3f61d;this['syncData']=_0x2bf71e,this['salesforceService'][_0x98db66(0x1aa)](_0x539cfa),this[_0x98db66(0x17c)]=this[_0x98db66(0x1ba)][_0x98db66(0x17d)]();try{await this['flosumSync'][_0x98db66(0x18d)](this[_0x98db66(0x1bf)],'In\x20Progress'),await this[_0x98db66(0x187)]('[INFO]\x20Start\x20sync\x20job'),await this['createRepositoryIfNotExists'](),await this[_0x98db66(0x1a2)]();const _0x5217a2=await this[_0x98db66(0x1c4)]();if(_0x5217a2){await this['flosumSync'][_0x98db66(0x18d)](this[_0x98db66(0x1bf)],_0x98db66(0x1bd)),await this['log'](_0x98db66(0x1b6));return;}const _0x2876d8=await this['getCommitDto'](_0xb78011);this[_0x98db66(0x17b)][_0x98db66(0x17c)]=this[_0x98db66(0x17c)],await this[_0x98db66(0x17b)][_0x98db66(0x195)](_0x2876d8),await this['flosumSync'][_0x98db66(0x18d)](this['syncData'],_0x98db66(0x1bd)),await this['updateLastCommit'](),await this[_0x98db66(0x187)](_0x98db66(0x174));}catch(_0x3769ab){throw _0x3769ab;}finally{await this[_0x98db66(0x17c)][_0x98db66(0x1af)]();}}};SyncJob=__decorate([(0x0,typedi_1[a147_0x3f61d(0x18b)])({'transient':!![]}),__metadata('design:paramtypes',[git_provider_manager_1[a147_0x3f61d(0x17a)],salesforce_sync_service_1[a147_0x3f61d(0x199)],salesforce_service_1['SalesforceService'],commit_components_job_1[a147_0x3f61d(0x1a7)]])],SyncJob),exports[a147_0x3f61d(0x1a6)]=SyncJob;