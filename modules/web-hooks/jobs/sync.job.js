const a147_0x418f=['788985yUlGgO','SalesforceRetrieverService','log','flosumSync','encodeBase64','138213nDkLfk','CommitComponentsJob','37jXIaBT','../../salesforce/services/salesforce.service','Completed','createBranchIfNotExists','length','run','apply','repository','[INFO]\x20Branch\x20synchronized.\x20Skip','../../salesforce/services/salesforce-retriever.service','user','logger','SalesforceSyncService','design:paramtypes','Service','name','convertToSFDX','salesforceService','function','getComponentIds','[INFO]\x20Start\x20sync\x20job','decorate','then','remoteState','checkSyncStatus','sha','setLoggerId','create','remoteStateAttachmentId','patchObject','force','repositoryId','constructor','__metadata','1UOSWlq','branchName','stringify','../../../constants','getLogger','../../shared/utils','metadata','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','[SYNC]\x20[','gitUrl','DEFAULT_GIT_USER_NAME','getComponents','getOne','../dto/commit-components.dto','repoService','getCommitDto','gitManager','__esModule','updateLastCommit','[INFO]\x20Sync\x20job\x20done.','catch','146873gEZTvn','setStatus','getBranchComponents','createRepositoryIfNotExists','repositoryName','syncData','307098cVzkVu','getComponentsFromRepository','49137ctWilq','branch','GitProviderManager','SyncJob','message','components','./commit-components.job','object','117442uYvgzq','defineProperty','commitJob',']\x20[Repository:\x20','getAttachmentId','toUpperCase','2098hiFgTp','[INFO]\x20Update\x20remote\x20state.','branches'];const a147_0x41b2b1=a147_0x2edc;(function(_0x526f37,_0x17296b){const _0x1be2c0=a147_0x2edc;while(!![]){try{const _0x554ce6=parseInt(_0x1be2c0(0x1de))*parseInt(_0x1be2c0(0x1d4))+-parseInt(_0x1be2c0(0x1c4))+parseInt(_0x1be2c0(0x1c6))+parseInt(_0x1be2c0(0x1be))*-parseInt(_0x1be2c0(0x1a9))+-parseInt(_0x1be2c0(0x1ce))+-parseInt(_0x1be2c0(0x1dc))+parseInt(_0x1be2c0(0x1d7));if(_0x554ce6===_0x17296b)break;else _0x526f37['push'](_0x526f37['shift']());}catch(_0x1839c1){_0x526f37['push'](_0x526f37['shift']());}}}(a147_0x418f,0x3252a));const a147_0x532cea=function(){let _0x400927=!![];return function(_0x566bc7,_0x17a670){const _0x352d90=_0x400927?function(){const _0x1db1f7=a147_0x2edc;if(_0x17a670){const _0x537faf=_0x17a670[_0x1db1f7(0x1e4)](_0x566bc7,arguments);return _0x17a670=null,_0x537faf;}}:function(){};return _0x400927=![],_0x352d90;};}(),a147_0xac6a0e=a147_0x532cea(this,function(){const _0x49f417=function(){const _0x408edd=a147_0x2edc,_0x2a60ae=_0x49f417[_0x408edd(0x1a7)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x408edd(0x1a7)](_0x408edd(0x1b0));return!_0x2a60ae['test'](a147_0xac6a0e);};return _0x49f417();});a147_0xac6a0e();'use strict';function a147_0x2edc(_0xf73e7a,_0x381a96){return a147_0x2edc=function(_0x287274,_0xac6a0e){_0x287274=_0x287274-0x196;let _0x532cea=a147_0x418f[_0x287274];return _0x532cea;},a147_0x2edc(_0xf73e7a,_0x381a96);}var __decorate=this&&this['__decorate']||function(_0x3ea21d,_0x36a5d8,_0x2a854b,_0x16f4a4){const _0x184ca3=a147_0x2edc;var _0x6b99c0=arguments[_0x184ca3(0x1e2)],_0x20055c=_0x6b99c0<0x3?_0x36a5d8:_0x16f4a4===null?_0x16f4a4=Object['getOwnPropertyDescriptor'](_0x36a5d8,_0x2a854b):_0x16f4a4,_0x3a848e;if(typeof Reflect==='object'&&typeof Reflect[_0x184ca3(0x19c)]===_0x184ca3(0x199))_0x20055c=Reflect['decorate'](_0x3ea21d,_0x36a5d8,_0x2a854b,_0x16f4a4);else{for(var _0x5ade61=_0x3ea21d[_0x184ca3(0x1e2)]-0x1;_0x5ade61>=0x0;_0x5ade61--)if(_0x3a848e=_0x3ea21d[_0x5ade61])_0x20055c=(_0x6b99c0<0x3?_0x3a848e(_0x20055c):_0x6b99c0>0x3?_0x3a848e(_0x36a5d8,_0x2a854b,_0x20055c):_0x3a848e(_0x36a5d8,_0x2a854b))||_0x20055c;}return _0x6b99c0>0x3&&_0x20055c&&Object[_0x184ca3(0x1cf)](_0x36a5d8,_0x2a854b,_0x20055c),_0x20055c;},__metadata=this&&this[a147_0x41b2b1(0x1a8)]||function(_0x278201,_0x328f21){const _0x25cf11=a147_0x41b2b1;if(typeof Reflect===_0x25cf11(0x1cd)&&typeof Reflect[_0x25cf11(0x1af)]===_0x25cf11(0x199))return Reflect[_0x25cf11(0x1af)](_0x278201,_0x328f21);};Object[a147_0x41b2b1(0x1cf)](exports,a147_0x41b2b1(0x1ba),{'value':!![]}),exports[a147_0x41b2b1(0x1c9)]=void 0x0;const typedi_1=require('typedi'),constants_1=require(a147_0x41b2b1(0x1ac)),salesforce_retriever_service_1=require(a147_0x41b2b1(0x1e7)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a147_0x41b2b1(0x1df)),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a147_0x41b2b1(0x1ae)),commit_components_dto_1=require(a147_0x41b2b1(0x1b6)),commit_components_job_1=require(a147_0x41b2b1(0x1cc));let SyncJob=class SyncJob{constructor(_0x32bfc6,_0x53d58f,_0x19ff74,_0x2fe074){const _0x4bc267=a147_0x41b2b1;this[_0x4bc267(0x1b9)]=_0x32bfc6,this[_0x4bc267(0x1da)]=_0x53d58f,this['salesforceService']=_0x19ff74,this['commitJob']=_0x2fe074,this[_0x4bc267(0x1b7)]=this['gitManager']['getRepoService']();}async[a147_0x41b2b1(0x1d9)](_0x26e7d8){const _0xdfb120=a147_0x41b2b1;return this[_0xdfb120(0x1e9)][_0xdfb120(0x1d9)](_0xdfb120(0x1b1)+this[_0xdfb120(0x1b9)]['provider'][_0xdfb120(0x1d3)]()+_0xdfb120(0x1d1)+this[_0xdfb120(0x1c3)][_0xdfb120(0x1c2)]+']\x20[Branch:\x20'+this[_0xdfb120(0x1c3)][_0xdfb120(0x1aa)]+']\x20'+_0x26e7d8);}async[a147_0x41b2b1(0x1c1)](){const _0x4c13e8=a147_0x41b2b1;let _0x489b93=await this[_0x4c13e8(0x1b7)]['getOne'](this[_0x4c13e8(0x1c3)][_0x4c13e8(0x1c2)])[_0x4c13e8(0x1bd)](()=>null);!_0x489b93&&(_0x489b93=await this[_0x4c13e8(0x1b7)][_0x4c13e8(0x1a2)]({'name':this[_0x4c13e8(0x1c3)]['repositoryName'],'autoInit':!![],'defaultBranch':this['syncData'][_0x4c13e8(0x1aa)],'private':!![]})),this[_0x4c13e8(0x1e5)]=_0x489b93;}async[a147_0x41b2b1(0x1e1)](){const _0x30a17e=a147_0x41b2b1;let _0x2ce24b=await this[_0x30a17e(0x1e5)][_0x30a17e(0x1d6)][_0x30a17e(0x1b5)](this[_0x30a17e(0x1c3)][_0x30a17e(0x1aa)])[_0x30a17e(0x1bd)](()=>null);!_0x2ce24b&&(_0x2ce24b=await this[_0x30a17e(0x1e5)][_0x30a17e(0x1d6)][_0x30a17e(0x1a2)]({'name':this[_0x30a17e(0x1c3)][_0x30a17e(0x1aa)]})),this[_0x30a17e(0x1c7)]=_0x2ce24b;}async['getComponentIds'](){const _0x29881a=a147_0x41b2b1;return this[_0x29881a(0x1c3)][_0x29881a(0x1a6)]?this[_0x29881a(0x1da)][_0x29881a(0x1c5)](this[_0x29881a(0x1c3)][_0x29881a(0x1a6)]):this[_0x29881a(0x1da)][_0x29881a(0x1c0)](this['syncData']['branchId']);}async[a147_0x41b2b1(0x1b4)](){const _0x554c38=a147_0x41b2b1,_0x38aa82=await this[_0x554c38(0x19a)](),_0x4fd630=new salesforce_retriever_service_1[(_0x554c38(0x1d8))](this[_0x554c38(0x198)]),_0x23225c=await _0x4fd630[_0x554c38(0x1e3)](_0x38aa82);return _0x23225c;}async['getCommitDto'](_0x281d09){const _0x2c8708=a147_0x41b2b1,_0x49c54d=new commit_components_dto_1['CommitComponentsDto']();return _0x49c54d[_0x2c8708(0x1ca)]='Sync\x20repository',_0x49c54d[_0x2c8708(0x1e8)]={'name':constants_1[_0x2c8708(0x1b3)],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0x49c54d[_0x2c8708(0x1cb)]={'writed':await this['getComponents']()},_0x49c54d[_0x2c8708(0x197)]=_0x281d09,_0x49c54d['repo']=this['repository'],_0x49c54d[_0x2c8708(0x1c7)]=this['branch'],_0x49c54d[_0x2c8708(0x1a5)]=!![],_0x49c54d;}async[a147_0x41b2b1(0x19f)](){const _0x4ca0c5=a147_0x41b2b1;this[_0x4ca0c5(0x1a3)]=await this[_0x4ca0c5(0x1da)][_0x4ca0c5(0x1d2)](this[_0x4ca0c5(0x1c3)]),this[_0x4ca0c5(0x19e)]=await this[_0x4ca0c5(0x198)]['retrieveAttachment'](this[_0x4ca0c5(0x1a3)])[_0x4ca0c5(0x19d)](_0x31abaa=>typeof _0x31abaa===_0x4ca0c5(0x1cd)?_0x31abaa:JSON['parse'](_0x31abaa||'{}'))['catch'](()=>({}));if(this[_0x4ca0c5(0x19e)][this['repository'][_0x4ca0c5(0x1b2)]]){if(this[_0x4ca0c5(0x19e)][this['repository'][_0x4ca0c5(0x1b2)]]['lastCommit']===this[_0x4ca0c5(0x1c7)][_0x4ca0c5(0x1a0)])return!![];}return![];}async[a147_0x41b2b1(0x1bb)](){const _0x4892d5=a147_0x41b2b1,_0x54aef6=await this[_0x4892d5(0x1e5)][_0x4892d5(0x1d6)][_0x4892d5(0x1b5)](this[_0x4892d5(0x1c7)][_0x4892d5(0x196)]);await this[_0x4892d5(0x1d9)](_0x4892d5(0x1d5)),this[_0x4892d5(0x19e)]={[this[_0x4892d5(0x1e5)]['gitUrl']]:{'lastCommit':_0x54aef6[_0x4892d5(0x1a0)]}},await this['salesforceService'][_0x4892d5(0x1a4)]('Attachment',this[_0x4892d5(0x1a3)],{'Body':utils_1[_0x4892d5(0x1db)](JSON[_0x4892d5(0x1ab)](this[_0x4892d5(0x19e)]))});}async[a147_0x41b2b1(0x1e3)](_0x5d3206,_0x310e1d,_0x421ebb){const _0x2e74e8=a147_0x41b2b1;this[_0x2e74e8(0x1c3)]=_0x5d3206,this[_0x2e74e8(0x198)][_0x2e74e8(0x1a1)](_0x310e1d),this[_0x2e74e8(0x1e9)]=this['salesforceService'][_0x2e74e8(0x1ad)]();try{await this[_0x2e74e8(0x1da)][_0x2e74e8(0x1bf)](this[_0x2e74e8(0x1c3)],'In\x20Progress'),await this[_0x2e74e8(0x1d9)](_0x2e74e8(0x19b)),await this[_0x2e74e8(0x1c1)](),await this[_0x2e74e8(0x1e1)]();const _0x8c2df1=await this['checkSyncStatus']();if(_0x8c2df1){await this[_0x2e74e8(0x1da)][_0x2e74e8(0x1bf)](this[_0x2e74e8(0x1c3)],_0x2e74e8(0x1e0)),await this[_0x2e74e8(0x1d9)](_0x2e74e8(0x1e6));return;}const _0xef0c5a=await this[_0x2e74e8(0x1b8)](_0x421ebb);this['commitJob'][_0x2e74e8(0x1e9)]=this[_0x2e74e8(0x1e9)],await this[_0x2e74e8(0x1d0)]['run'](_0xef0c5a),await this[_0x2e74e8(0x1da)][_0x2e74e8(0x1bf)](this[_0x2e74e8(0x1c3)],_0x2e74e8(0x1e0)),await this[_0x2e74e8(0x1bb)](),await this[_0x2e74e8(0x1d9)](_0x2e74e8(0x1bc));}catch(_0x30374c){throw _0x30374c;}finally{await this[_0x2e74e8(0x1e9)]['send']();}}};SyncJob=__decorate([typedi_1[a147_0x41b2b1(0x1ec)]({'transient':!![]}),__metadata(a147_0x41b2b1(0x1eb),[git_provider_manager_1[a147_0x41b2b1(0x1c8)],salesforce_sync_service_1[a147_0x41b2b1(0x1ea)],salesforce_service_1['SalesforceService'],commit_components_job_1[a147_0x41b2b1(0x1dd)]])],SyncJob),exports[a147_0x41b2b1(0x1c9)]=SyncJob;