const a145_0x2a3c=['GitProviderManager','../dto/commit-components.dto','../../shared/git-provider.manager','branchId','repoService','__decorate','syncData','checkSyncStatus','provider','600005JmCfsE','typedi','setLoggerId','convertToSFDX','[INFO]\x20Branch\x20synchronized.\x20Skip','29MojJgw','gitManager','DEFAULT_GIT_USER_EMAIL','logger','22171FQcXyf','repository','remoteStateAttachmentId','SalesforceService','remoteState','branches','repositoryId','gitUrl','getOwnPropertyDescriptor','updateLastCommit','In\x20Progress','object','setStatus','CommitComponentsJob','getComponentIds','lastCommit','run','metadata','getLogger','force','[SYNC]\x20[','Service','branch','SalesforceRetrieverService','repositoryName','3aywjhC','salesforceService','commitJob','defineProperty','Completed','getBranchComponents','length','user','catch','decorate','createRepositoryIfNotExists','encodeBase64','constructor','89nuRUlI','1llgZBh','SalesforceSyncService','log','Sync\x20repository','CommitComponentsDto','__metadata','49421BigsOX','[INFO]\x20Update\x20remote\x20state.','create','DEFAULT_GIT_USER_NAME','toUpperCase','../../salesforce/services/salesforce-sync.service','279025iVDddV','600087fJxRBB','../../shared/utils',']\x20[Repository:\x20','design:paramtypes','4001IOXGRc','__esModule','flosumSync','101344xSQkPJ','../../salesforce/services/salesforce-retriever.service','then','Attachment','createBranchIfNotExists','stringify','function','getComponents','SyncJob','./commit-components.job','[INFO]\x20Start\x20sync\x20job','getOne','branchName','repo','patchObject','getCommitDto','getAttachmentId'];const a145_0x52ad51=a145_0x3fb7;(function(_0x34cbd8,_0x35f837){const _0x28049c=a145_0x3fb7;while(!![]){try{const _0x35b348=parseInt(_0x28049c(0x19b))+-parseInt(_0x28049c(0x1a0))*-parseInt(_0x28049c(0x18e))+-parseInt(_0x28049c(0x1c6))*parseInt(_0x28049c(0x1c2))+parseInt(_0x28049c(0x1bd))+parseInt(_0x28049c(0x18f))*parseInt(_0x28049c(0x195))+-parseInt(_0x28049c(0x19c))+-parseInt(_0x28049c(0x1a3))*-parseInt(_0x28049c(0x1df));if(_0x35b348===_0x35f837)break;else _0x34cbd8['push'](_0x34cbd8['shift']());}catch(_0xf5ac3a){_0x34cbd8['push'](_0x34cbd8['shift']());}}}(a145_0x2a3c,0x545b6));const a145_0x1ed02d=function(){let _0xfbdc14=!![];return function(_0x5ab2d9,_0x4fabe2){const _0x21a0d0=_0xfbdc14?function(){if(_0x4fabe2){const _0x3966b2=_0x4fabe2['apply'](_0x5ab2d9,arguments);return _0x4fabe2=null,_0x3966b2;}}:function(){};return _0xfbdc14=![],_0x21a0d0;};}(),a145_0x6af8a1=a145_0x1ed02d(this,function(){const _0x2de902=function(){const _0x50a8b5=a145_0x3fb7,_0x5c5a98=_0x2de902[_0x50a8b5(0x18d)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor']('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x5c5a98['test'](a145_0x6af8a1);};return _0x2de902();});a145_0x6af8a1();'use strict';var __decorate=this&&this[a145_0x52ad51(0x1b9)]||function(_0x5749d3,_0x327e79,_0x3e1236,_0xa6745d){const _0x1a4144=a145_0x52ad51;var _0x2e7d2b=arguments[_0x1a4144(0x1e5)],_0x4d7c38=_0x2e7d2b<0x3?_0x327e79:_0xa6745d===null?_0xa6745d=Object[_0x1a4144(0x1ce)](_0x327e79,_0x3e1236):_0xa6745d,_0x5881b0;if(typeof Reflect===_0x1a4144(0x1d1)&&typeof Reflect['decorate']===_0x1a4144(0x1a9))_0x4d7c38=Reflect[_0x1a4144(0x1e8)](_0x5749d3,_0x327e79,_0x3e1236,_0xa6745d);else{for(var _0x23e3ea=_0x5749d3[_0x1a4144(0x1e5)]-0x1;_0x23e3ea>=0x0;_0x23e3ea--)if(_0x5881b0=_0x5749d3[_0x23e3ea])_0x4d7c38=(_0x2e7d2b<0x3?_0x5881b0(_0x4d7c38):_0x2e7d2b>0x3?_0x5881b0(_0x327e79,_0x3e1236,_0x4d7c38):_0x5881b0(_0x327e79,_0x3e1236))||_0x4d7c38;}return _0x2e7d2b>0x3&&_0x4d7c38&&Object[_0x1a4144(0x1e2)](_0x327e79,_0x3e1236,_0x4d7c38),_0x4d7c38;},__metadata=this&&this[a145_0x52ad51(0x194)]||function(_0x12115a,_0x323630){const _0x51cf39=a145_0x52ad51;if(typeof Reflect==='object'&&typeof Reflect['metadata']==='function')return Reflect[_0x51cf39(0x1d7)](_0x12115a,_0x323630);};Object[a145_0x52ad51(0x1e2)](exports,a145_0x52ad51(0x1a1),{'value':!![]}),exports[a145_0x52ad51(0x1ab)]=void 0x0;const typedi_1=require(a145_0x52ad51(0x1be)),constants_1=require('../../../constants'),salesforce_retriever_service_1=require(a145_0x52ad51(0x1a4)),salesforce_sync_service_1=require(a145_0x52ad51(0x19a)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a145_0x52ad51(0x1b6)),utils_1=require(a145_0x52ad51(0x19d)),commit_components_dto_1=require(a145_0x52ad51(0x1b5)),commit_components_job_1=require(a145_0x52ad51(0x1ac));function a145_0x3fb7(_0x571511,_0x47b742){return a145_0x3fb7=function(_0x243235,_0x6af8a1){_0x243235=_0x243235-0x18d;let _0x1ed02d=a145_0x2a3c[_0x243235];return _0x1ed02d;},a145_0x3fb7(_0x571511,_0x47b742);}let SyncJob=class SyncJob{constructor(_0x287b5e,_0xe1acc5,_0x579451,_0x2ac0e3){const _0x3e2cd1=a145_0x52ad51;this['gitManager']=_0x287b5e,this[_0x3e2cd1(0x1a2)]=_0xe1acc5,this[_0x3e2cd1(0x1e0)]=_0x579451,this[_0x3e2cd1(0x1e1)]=_0x2ac0e3,this[_0x3e2cd1(0x1b8)]=this[_0x3e2cd1(0x1c3)]['getRepoService']();}async[a145_0x52ad51(0x191)](_0xaa82e3){const _0x5300b7=a145_0x52ad51;return this[_0x5300b7(0x1c5)][_0x5300b7(0x191)](_0x5300b7(0x1da)+this[_0x5300b7(0x1c3)][_0x5300b7(0x1bc)][_0x5300b7(0x199)]()+_0x5300b7(0x19e)+this[_0x5300b7(0x1ba)][_0x5300b7(0x1de)]+']\x20[Branch:\x20'+this['syncData'][_0x5300b7(0x1af)]+']\x20'+_0xaa82e3);}async[a145_0x52ad51(0x1e9)](){const _0x4334ab=a145_0x52ad51;let _0x21ad56=await this[_0x4334ab(0x1b8)][_0x4334ab(0x1ae)](this[_0x4334ab(0x1ba)][_0x4334ab(0x1de)])[_0x4334ab(0x1e7)](()=>null);!_0x21ad56&&(_0x21ad56=await this[_0x4334ab(0x1b8)]['create']({'name':this['syncData'][_0x4334ab(0x1de)],'autoInit':!![],'defaultBranch':this[_0x4334ab(0x1ba)][_0x4334ab(0x1af)],'private':!![]})),this[_0x4334ab(0x1c7)]=_0x21ad56;}async[a145_0x52ad51(0x1a7)](){const _0x1907d0=a145_0x52ad51;let _0x3f7ad0=await this[_0x1907d0(0x1c7)][_0x1907d0(0x1cb)][_0x1907d0(0x1ae)](this[_0x1907d0(0x1ba)][_0x1907d0(0x1af)])[_0x1907d0(0x1e7)](()=>null);!_0x3f7ad0&&(_0x3f7ad0=await this[_0x1907d0(0x1c7)][_0x1907d0(0x1cb)][_0x1907d0(0x197)]({'name':this[_0x1907d0(0x1ba)][_0x1907d0(0x1af)]})),this[_0x1907d0(0x1dc)]=_0x3f7ad0;}async['getComponentIds'](){const _0x21a30e=a145_0x52ad51;return this[_0x21a30e(0x1ba)]['repositoryId']?this[_0x21a30e(0x1a2)]['getComponentsFromRepository'](this[_0x21a30e(0x1ba)][_0x21a30e(0x1cc)]):this[_0x21a30e(0x1a2)][_0x21a30e(0x1e4)](this[_0x21a30e(0x1ba)][_0x21a30e(0x1b7)]);}async[a145_0x52ad51(0x1aa)](){const _0x3168fa=a145_0x52ad51,_0xc9e2e1=await this[_0x3168fa(0x1d4)](),_0x3a706d=new salesforce_retriever_service_1[(_0x3168fa(0x1dd))](this[_0x3168fa(0x1e0)]),_0x276985=await _0x3a706d[_0x3168fa(0x1d6)](_0xc9e2e1);return _0x276985;}async[a145_0x52ad51(0x1b2)](_0x517588){const _0x32c921=a145_0x52ad51,_0x3c7d06=new commit_components_dto_1[(_0x32c921(0x193))]();return _0x3c7d06['message']=_0x32c921(0x192),_0x3c7d06[_0x32c921(0x1e6)]={'name':constants_1[_0x32c921(0x198)],'email':constants_1[_0x32c921(0x1c4)]},_0x3c7d06['components']={'writed':await this['getComponents']()},_0x3c7d06[_0x32c921(0x1c0)]=_0x517588,_0x3c7d06[_0x32c921(0x1b0)]=this[_0x32c921(0x1c7)],_0x3c7d06[_0x32c921(0x1dc)]=this['branch'],_0x3c7d06[_0x32c921(0x1d9)]=!![],_0x3c7d06;}async[a145_0x52ad51(0x1bb)](){const _0x6c0a39=a145_0x52ad51;this['remoteStateAttachmentId']=await this[_0x6c0a39(0x1a2)][_0x6c0a39(0x1b3)](this['syncData']),this[_0x6c0a39(0x1ca)]=await this['salesforceService']['retrieveAttachment'](this[_0x6c0a39(0x1c8)])[_0x6c0a39(0x1a5)](_0x56adea=>typeof _0x56adea===_0x6c0a39(0x1d1)?_0x56adea:JSON['parse'](_0x56adea||'{}'))[_0x6c0a39(0x1e7)](()=>({}));if(this['remoteState'][this['repository'][_0x6c0a39(0x1cd)]]){if(this[_0x6c0a39(0x1ca)][this[_0x6c0a39(0x1c7)]['gitUrl']][_0x6c0a39(0x1d5)]===this[_0x6c0a39(0x1dc)]['sha'])return!![];}return![];}async[a145_0x52ad51(0x1cf)](){const _0x16de4f=a145_0x52ad51,_0x36123d=await this[_0x16de4f(0x1c7)]['branches'][_0x16de4f(0x1ae)](this[_0x16de4f(0x1dc)]['name']);await this[_0x16de4f(0x191)](_0x16de4f(0x196)),this[_0x16de4f(0x1ca)]={[this[_0x16de4f(0x1c7)][_0x16de4f(0x1cd)]]:{'lastCommit':_0x36123d['sha']}},await this[_0x16de4f(0x1e0)][_0x16de4f(0x1b1)](_0x16de4f(0x1a6),this[_0x16de4f(0x1c8)],{'Body':utils_1[_0x16de4f(0x1ea)](JSON[_0x16de4f(0x1a8)](this[_0x16de4f(0x1ca)]))});}async[a145_0x52ad51(0x1d6)](_0x380565,_0x41a639,_0x38284c){const _0xa18c09=a145_0x52ad51;this['syncData']=_0x380565,this[_0xa18c09(0x1e0)][_0xa18c09(0x1bf)](_0x41a639),this[_0xa18c09(0x1c5)]=this[_0xa18c09(0x1e0)][_0xa18c09(0x1d8)]();try{await this['flosumSync']['setStatus'](this['syncData'],_0xa18c09(0x1d0)),await this[_0xa18c09(0x191)](_0xa18c09(0x1ad)),await this[_0xa18c09(0x1e9)](),await this[_0xa18c09(0x1a7)]();const _0x4a529b=await this['checkSyncStatus']();if(_0x4a529b){await this[_0xa18c09(0x1a2)][_0xa18c09(0x1d2)](this[_0xa18c09(0x1ba)],_0xa18c09(0x1e3)),await this[_0xa18c09(0x191)](_0xa18c09(0x1c1));return;}const _0x5686f9=await this['getCommitDto'](_0x38284c);this[_0xa18c09(0x1e1)]['logger']=this[_0xa18c09(0x1c5)],await this[_0xa18c09(0x1e1)]['run'](_0x5686f9),await this[_0xa18c09(0x1a2)][_0xa18c09(0x1d2)](this['syncData'],_0xa18c09(0x1e3)),await this['updateLastCommit'](),await this[_0xa18c09(0x191)]('[INFO]\x20Sync\x20job\x20done.');}catch(_0x3b00ed){throw _0x3b00ed;}finally{await this[_0xa18c09(0x1c5)]['send']();}}};SyncJob=__decorate([typedi_1[a145_0x52ad51(0x1db)]({'transient':!![]}),__metadata(a145_0x52ad51(0x19f),[git_provider_manager_1[a145_0x52ad51(0x1b4)],salesforce_sync_service_1[a145_0x52ad51(0x190)],salesforce_service_1[a145_0x52ad51(0x1c9)],commit_components_job_1[a145_0x52ad51(0x1d3)]])],SyncJob),exports[a145_0x52ad51(0x1ab)]=SyncJob;