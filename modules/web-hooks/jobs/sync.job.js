const a147_0x33cc5f=a147_0x2b2f;(function(_0x2de5cc,_0xb4bf1a){const _0x4f3969=a147_0x2b2f,_0x1c1045=_0x2de5cc();while(!![]){try{const _0x1c1780=-parseInt(_0x4f3969(0xac))/0x1*(parseInt(_0x4f3969(0xf1))/0x2)+-parseInt(_0x4f3969(0xba))/0x3+-parseInt(_0x4f3969(0x104))/0x4*(parseInt(_0x4f3969(0xb6))/0x5)+-parseInt(_0x4f3969(0xaf))/0x6*(-parseInt(_0x4f3969(0xd4))/0x7)+-parseInt(_0x4f3969(0x10b))/0x8+parseInt(_0x4f3969(0xd8))/0x9*(parseInt(_0x4f3969(0xe0))/0xa)+parseInt(_0x4f3969(0xe5))/0xb;if(_0x1c1780===_0xb4bf1a)break;else _0x1c1045['push'](_0x1c1045['shift']());}catch(_0x42827c){_0x1c1045['push'](_0x1c1045['shift']());}}}(a147_0x1f7e,0xd5362));function a147_0x2b2f(_0x53884,_0x39746a){const _0x47c5dd=a147_0x1f7e();return a147_0x2b2f=function(_0x367482,_0x1e6b0c){_0x367482=_0x367482-0xac;let _0x1f7ef1=_0x47c5dd[_0x367482];return _0x1f7ef1;},a147_0x2b2f(_0x53884,_0x39746a);}const a147_0x1e6b0c=function(){let _0x298191=!![];return function(_0x371bee,_0x4db68f){const _0x2fcfcb=_0x298191?function(){const _0x279f19=a147_0x2b2f;if(_0x4db68f){const _0x25aecd=_0x4db68f[_0x279f19(0xf6)](_0x371bee,arguments);return _0x4db68f=null,_0x25aecd;}}:function(){};return _0x298191=![],_0x2fcfcb;};}(),a147_0x367482=a147_0x1e6b0c(this,function(){const _0x30b6fa=a147_0x2b2f;return a147_0x367482[_0x30b6fa(0xc6)]()[_0x30b6fa(0x10d)](_0x30b6fa(0xe6))[_0x30b6fa(0xc6)]()[_0x30b6fa(0x10c)](a147_0x367482)[_0x30b6fa(0x10d)](_0x30b6fa(0xe6));});a147_0x367482();'use strict';var __decorate=this&&this[a147_0x33cc5f(0xe1)]||function(_0x16769d,_0x303c8e,_0x3d8d96,_0x615bcd){const _0x5e9147=a147_0x33cc5f;var _0x310bfd=arguments[_0x5e9147(0x102)],_0x3a1377=_0x310bfd<0x3?_0x303c8e:_0x615bcd===null?_0x615bcd=Object[_0x5e9147(0xae)](_0x303c8e,_0x3d8d96):_0x615bcd,_0x3a453a;if(typeof Reflect===_0x5e9147(0xe7)&&typeof Reflect['decorate']===_0x5e9147(0xd0))_0x3a1377=Reflect['decorate'](_0x16769d,_0x303c8e,_0x3d8d96,_0x615bcd);else{for(var _0x51e7b2=_0x16769d[_0x5e9147(0x102)]-0x1;_0x51e7b2>=0x0;_0x51e7b2--)if(_0x3a453a=_0x16769d[_0x51e7b2])_0x3a1377=(_0x310bfd<0x3?_0x3a453a(_0x3a1377):_0x310bfd>0x3?_0x3a453a(_0x303c8e,_0x3d8d96,_0x3a1377):_0x3a453a(_0x303c8e,_0x3d8d96))||_0x3a1377;}return _0x310bfd>0x3&&_0x3a1377&&Object['defineProperty'](_0x303c8e,_0x3d8d96,_0x3a1377),_0x3a1377;},__metadata=this&&this[a147_0x33cc5f(0x105)]||function(_0x24287a,_0x189c2e){const _0x555bd5=a147_0x33cc5f;if(typeof Reflect==='object'&&typeof Reflect[_0x555bd5(0xca)]==='function')return Reflect[_0x555bd5(0xca)](_0x24287a,_0x189c2e);};Object[a147_0x33cc5f(0x110)](exports,a147_0x33cc5f(0xd6),{'value':!![]}),exports[a147_0x33cc5f(0xdb)]=void 0x0;const typedi_1=require(a147_0x33cc5f(0xcd)),constants_1=require('../../../constants'),salesforce_retriever_service_1=require(a147_0x33cc5f(0xc1)),salesforce_sync_service_1=require(a147_0x33cc5f(0xdf)),salesforce_service_1=require(a147_0x33cc5f(0xc3)),git_provider_manager_1=require(a147_0x33cc5f(0xfd)),utils_1=require(a147_0x33cc5f(0xc7)),commit_components_dto_1=require(a147_0x33cc5f(0xd1)),commit_components_job_1=require(a147_0x33cc5f(0xdc));function a147_0x1f7e(){const _0x3a447a=['length','getComponents','16OAAqKQ','__metadata','[INFO]\x20Branch\x20synchronized.\x20Skip','components','setLoggerId','SalesforceSyncService','stringify','4936208XMvTkl','constructor','search','repositoryId','createRepositoryIfNotExists','defineProperty','2eCOBvI','getRepoService','getOwnPropertyDescriptor','523374EWTVwc','repo','toUpperCase','repoService','user','force','send','898615MyoiGv','[INFO]\x20Sync\x20job\x20done.','remoteState','message','3176679gpnill','logger','SalesforceService','remoteStateAttachmentId','provider','CommitComponentsDto','checkSyncStatus','../../salesforce/services/salesforce-retriever.service','GitProviderManager','../../salesforce/services/salesforce.service','commitJob','getLogger','toString','../../shared/utils','sha','getComponentIds','metadata','log','flosumSync','typedi','patchObject','syncData','function','../dto/commit-components.dto','run','name','7EHMPHJ','[SYNC]\x20[','__esModule','SalesforceRetrieverService','5652rtXkhD','Completed',']\x20[Repository:\x20','SyncJob','./commit-components.job','updateLastCommit','getAttachmentId','../../salesforce/services/salesforce-sync.service','1730FpeXpx','__decorate','branch','DEFAULT_GIT_USER_EMAIL','gitManager','36335860lBgCrR','(((.+)+)+)+$','object','getBranchComponents','Sync\x20repository','create','getOne','In\x20Progress','branchId','catch','lastCommit','[INFO]\x20Start\x20sync\x20job','231008VBejZw','encodeBase64','branches','salesforceService','createBranchIfNotExists','apply','setStatus','branchName','then','repositoryName','convertToSFDX','repository','../../shared/git-provider.manager','getComponentsFromRepository','Service','getCommitDto','gitUrl'];a147_0x1f7e=function(){return _0x3a447a;};return a147_0x1f7e();}let SyncJob=class SyncJob{constructor(_0x395ef2,_0x2d55ac,_0x1e61d4,_0x1c83ea){const _0x4d54a2=a147_0x33cc5f;this[_0x4d54a2(0xe4)]=_0x395ef2,this['flosumSync']=_0x2d55ac,this[_0x4d54a2(0xf4)]=_0x1e61d4,this[_0x4d54a2(0xc4)]=_0x1c83ea,this[_0x4d54a2(0xb2)]=this[_0x4d54a2(0xe4)][_0x4d54a2(0xad)]();}async[a147_0x33cc5f(0xcb)](_0x492ed5){const _0x58b211=a147_0x33cc5f;return this[_0x58b211(0xbb)][_0x58b211(0xcb)](_0x58b211(0xd5)+this[_0x58b211(0xe4)][_0x58b211(0xbe)][_0x58b211(0xb1)]()+_0x58b211(0xda)+this[_0x58b211(0xcf)][_0x58b211(0xfa)]+']\x20[Branch:\x20'+this[_0x58b211(0xcf)][_0x58b211(0xf8)]+']\x20'+_0x492ed5);}async[a147_0x33cc5f(0x10f)](){const _0x4f0080=a147_0x33cc5f;let _0x8fc11=await this[_0x4f0080(0xb2)][_0x4f0080(0xeb)](this['syncData'][_0x4f0080(0xfa)])[_0x4f0080(0xee)](()=>null);!_0x8fc11&&(_0x8fc11=await this[_0x4f0080(0xb2)][_0x4f0080(0xea)]({'name':this['syncData'][_0x4f0080(0xfa)],'autoInit':!![],'defaultBranch':this[_0x4f0080(0xcf)][_0x4f0080(0xf8)],'private':!![]})),this[_0x4f0080(0xfc)]=_0x8fc11;}async[a147_0x33cc5f(0xf5)](){const _0x19c538=a147_0x33cc5f;let _0x55e2a7=await this[_0x19c538(0xfc)][_0x19c538(0xf3)][_0x19c538(0xeb)](this[_0x19c538(0xcf)][_0x19c538(0xf8)])['catch'](()=>null);!_0x55e2a7&&(_0x55e2a7=await this[_0x19c538(0xfc)][_0x19c538(0xf3)][_0x19c538(0xea)]({'name':this['syncData'][_0x19c538(0xf8)]})),this[_0x19c538(0xe2)]=_0x55e2a7;}async[a147_0x33cc5f(0xc9)](){const _0x5eaff6=a147_0x33cc5f;return this[_0x5eaff6(0xcf)]['repositoryId']?this['flosumSync'][_0x5eaff6(0xfe)](this[_0x5eaff6(0xcf)][_0x5eaff6(0x10e)]):this['flosumSync'][_0x5eaff6(0xe8)](this['syncData'][_0x5eaff6(0xed)]);}async[a147_0x33cc5f(0x103)](){const _0x4f2652=a147_0x33cc5f,_0x577367=await this[_0x4f2652(0xc9)](),_0x3d71b3=new salesforce_retriever_service_1[(_0x4f2652(0xd7))](this[_0x4f2652(0xf4)]),_0x3ae5ad=await _0x3d71b3[_0x4f2652(0xd2)](_0x577367);return _0x3ae5ad;}async[a147_0x33cc5f(0x100)](_0x8b682d){const _0x40110=a147_0x33cc5f,_0x1aeb4c=new commit_components_dto_1[(_0x40110(0xbf))]();return _0x1aeb4c[_0x40110(0xb9)]=_0x40110(0xe9),_0x1aeb4c[_0x40110(0xb3)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1[_0x40110(0xe3)]},_0x1aeb4c[_0x40110(0x107)]={'writed':await this['getComponents']()},_0x1aeb4c[_0x40110(0xfb)]=_0x8b682d,_0x1aeb4c[_0x40110(0xb0)]=this['repository'],_0x1aeb4c[_0x40110(0xe2)]=this[_0x40110(0xe2)],_0x1aeb4c[_0x40110(0xb4)]=!![],_0x1aeb4c;}async[a147_0x33cc5f(0xc0)](){const _0x316973=a147_0x33cc5f;this[_0x316973(0xbd)]=await this['flosumSync'][_0x316973(0xde)](this['syncData']),this[_0x316973(0xb8)]=await this['salesforceService']['retrieveAttachment'](this[_0x316973(0xbd)])[_0x316973(0xf9)](_0xc5f45=>typeof _0xc5f45===_0x316973(0xe7)?_0xc5f45:JSON['parse'](_0xc5f45||'{}'))[_0x316973(0xee)](()=>({}));if(this[_0x316973(0xb8)][this[_0x316973(0xfc)][_0x316973(0x101)]]){if(this['remoteState'][this[_0x316973(0xfc)]['gitUrl']][_0x316973(0xef)]===this['branch'][_0x316973(0xc8)])return!![];}return![];}async[a147_0x33cc5f(0xdd)](){const _0x1583e5=a147_0x33cc5f,_0x1a896e=await this['repository'][_0x1583e5(0xf3)][_0x1583e5(0xeb)](this[_0x1583e5(0xe2)][_0x1583e5(0xd3)]);await this[_0x1583e5(0xcb)]('[INFO]\x20Update\x20remote\x20state.'),this['remoteState']={[this['repository'][_0x1583e5(0x101)]]:{'lastCommit':_0x1a896e[_0x1583e5(0xc8)]}},await this[_0x1583e5(0xf4)][_0x1583e5(0xce)]('Attachment',this[_0x1583e5(0xbd)],{'Body':(0x0,utils_1[_0x1583e5(0xf2)])(JSON[_0x1583e5(0x10a)](this[_0x1583e5(0xb8)]))});}async[a147_0x33cc5f(0xd2)](_0x4d7bf7,_0x358c28,_0x305312){const _0x445fd4=a147_0x33cc5f;this[_0x445fd4(0xcf)]=_0x4d7bf7,this[_0x445fd4(0xf4)][_0x445fd4(0x108)](_0x358c28),this['logger']=this['salesforceService'][_0x445fd4(0xc5)]();try{await this[_0x445fd4(0xcc)][_0x445fd4(0xf7)](this[_0x445fd4(0xcf)],_0x445fd4(0xec)),await this['log'](_0x445fd4(0xf0)),await this[_0x445fd4(0x10f)](),await this[_0x445fd4(0xf5)]();const _0x18d9df=await this[_0x445fd4(0xc0)]();if(_0x18d9df){await this['flosumSync'][_0x445fd4(0xf7)](this[_0x445fd4(0xcf)],'Completed'),await this[_0x445fd4(0xcb)](_0x445fd4(0x106));return;}const _0x2ada78=await this['getCommitDto'](_0x305312);this[_0x445fd4(0xc4)]['logger']=this[_0x445fd4(0xbb)],await this[_0x445fd4(0xc4)][_0x445fd4(0xd2)](_0x2ada78),await this[_0x445fd4(0xcc)][_0x445fd4(0xf7)](this[_0x445fd4(0xcf)],_0x445fd4(0xd9)),await this['updateLastCommit'](),await this[_0x445fd4(0xcb)](_0x445fd4(0xb7));}catch(_0x11dfcb){throw _0x11dfcb;}finally{await this[_0x445fd4(0xbb)][_0x445fd4(0xb5)]();}}};SyncJob=__decorate([(0x0,typedi_1[a147_0x33cc5f(0xff)])({'transient':!![]}),__metadata('design:paramtypes',[git_provider_manager_1[a147_0x33cc5f(0xc2)],salesforce_sync_service_1[a147_0x33cc5f(0x109)],salesforce_service_1[a147_0x33cc5f(0xbc)],commit_components_job_1['CommitComponentsJob']])],SyncJob),exports[a147_0x33cc5f(0xdb)]=SyncJob;