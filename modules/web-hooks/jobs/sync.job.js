const a147_0x4ec0=['convertToSFDX','logger','sha','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','user','length','1dHmBVf','then','[SYNC]\x20[','setStatus','flosumSync','create','12391EjdJQY','166589JfsaMi','Attachment',']\x20[Branch:\x20','DEFAULT_GIT_USER_EMAIL','GitProviderManager','encodeBase64','name','[INFO]\x20Start\x20sync\x20job','__decorate','salesforceService','return\x20/\x22\x20+\x20this\x20+\x20\x22/','components','branchId','message','getOne','Completed','getCommitDto','../../salesforce/services/salesforce-sync.service','object','design:paramtypes','SalesforceRetrieverService','metadata','../../salesforce/services/salesforce-retriever.service','gitUrl','275CppYYG','CommitComponentsJob','gitManager','repo','17126vWLnVB','function','../dto/commit-components.dto','../../shared/git-provider.manager','defineProperty','SalesforceSyncService','../../shared/utils','repositoryName','branchName','stringify','parse','repository','repoService','createRepositoryIfNotExists','getComponentsFromRepository','catch','DEFAULT_GIT_USER_NAME','getOwnPropertyDescriptor','apply','241vhTQhf','[INFO]\x20Update\x20remote\x20state.','run','branch','138122YwaZGv','setLoggerId','__esModule','Sync\x20repository','../../salesforce/services/salesforce.service','__metadata','SalesforceService','20GDMNPi','remoteStateAttachmentId','test','repositoryId','SyncJob','529oGtOOL','syncData','branches','../../../constants','1131szVxJU','getComponents','getComponentIds','[INFO]\x20Branch\x20synchronized.\x20Skip','remoteState','In\x20Progress','CommitComponentsDto','14737lIlbgX','decorate','getAttachmentId','log','checkSyncStatus','commitJob','constructor','getRepoService','createBranchIfNotExists'];const a147_0x49801a=a147_0x3d4c;(function(_0x49e887,_0x56076e){const _0x48b578=a147_0x3d4c;while(!![]){try{const _0x3c6e9d=parseInt(_0x48b578(0x223))*parseInt(_0x48b578(0x237))+-parseInt(_0x48b578(0x22e))*parseInt(_0x48b578(0x1f3))+-parseInt(_0x48b578(0x1f4))*parseInt(_0x48b578(0x24d))+parseInt(_0x48b578(0x210))+parseInt(_0x48b578(0x227))+-parseInt(_0x48b578(0x20c))*-parseInt(_0x48b578(0x233))+parseInt(_0x48b578(0x23e));if(_0x3c6e9d===_0x56076e)break;else _0x49e887['push'](_0x49e887['shift']());}catch(_0x504c2e){_0x49e887['push'](_0x49e887['shift']());}}}(a147_0x4ec0,0x2a636));const a147_0x335746=function(){let _0x335053=!![];return function(_0x2b8b8e,_0x1398c8){const _0x59d1bf=_0x335053?function(){const _0x448edb=a147_0x3d4c;if(_0x1398c8){const _0x449c10=_0x1398c8[_0x448edb(0x222)](_0x2b8b8e,arguments);return _0x1398c8=null,_0x449c10;}}:function(){};return _0x335053=![],_0x59d1bf;};}(),a147_0x44c734=a147_0x335746(this,function(){const _0x17fab1=function(){const _0xd034ec=a147_0x3d4c,_0x2d1d21=_0x17fab1[_0xd034ec(0x244)](_0xd034ec(0x1fe))()[_0xd034ec(0x244)](_0xd034ec(0x24a));return!_0x2d1d21[_0xd034ec(0x230)](a147_0x44c734);};return _0x17fab1();});a147_0x44c734();'use strict';var __decorate=this&&this[a147_0x49801a(0x1fc)]||function(_0x5058f9,_0x1ea369,_0x51729d,_0x15ad6f){const _0x157d30=a147_0x49801a;var _0xc0c838=arguments['length'],_0x422d61=_0xc0c838<0x3?_0x1ea369:_0x15ad6f===null?_0x15ad6f=Object[_0x157d30(0x221)](_0x1ea369,_0x51729d):_0x15ad6f,_0x1ea092;if(typeof Reflect===_0x157d30(0x206)&&typeof Reflect[_0x157d30(0x23f)]===_0x157d30(0x211))_0x422d61=Reflect[_0x157d30(0x23f)](_0x5058f9,_0x1ea369,_0x51729d,_0x15ad6f);else{for(var _0x35431f=_0x5058f9[_0x157d30(0x24c)]-0x1;_0x35431f>=0x0;_0x35431f--)if(_0x1ea092=_0x5058f9[_0x35431f])_0x422d61=(_0xc0c838<0x3?_0x1ea092(_0x422d61):_0xc0c838>0x3?_0x1ea092(_0x1ea369,_0x51729d,_0x422d61):_0x1ea092(_0x1ea369,_0x51729d))||_0x422d61;}return _0xc0c838>0x3&&_0x422d61&&Object[_0x157d30(0x214)](_0x1ea369,_0x51729d,_0x422d61),_0x422d61;},__metadata=this&&this[a147_0x49801a(0x22c)]||function(_0x3f2af1,_0x10a217){const _0x262e80=a147_0x49801a;if(typeof Reflect===_0x262e80(0x206)&&typeof Reflect[_0x262e80(0x209)]==='function')return Reflect[_0x262e80(0x209)](_0x3f2af1,_0x10a217);};Object[a147_0x49801a(0x214)](exports,a147_0x49801a(0x229),{'value':!![]}),exports[a147_0x49801a(0x232)]=void 0x0;const typedi_1=require('typedi'),constants_1=require(a147_0x49801a(0x236)),salesforce_retriever_service_1=require(a147_0x49801a(0x20a)),salesforce_sync_service_1=require(a147_0x49801a(0x205)),salesforce_service_1=require(a147_0x49801a(0x22b)),git_provider_manager_1=require(a147_0x49801a(0x213)),utils_1=require(a147_0x49801a(0x216)),commit_components_dto_1=require(a147_0x49801a(0x212)),commit_components_job_1=require('./commit-components.job');function a147_0x3d4c(_0x2d7df1,_0x145022){return a147_0x3d4c=function(_0x485739,_0x44c734){_0x485739=_0x485739-0x1f2;let _0x335746=a147_0x4ec0[_0x485739];return _0x335746;},a147_0x3d4c(_0x2d7df1,_0x145022);}let SyncJob=class SyncJob{constructor(_0x7971de,_0x34a609,_0x5a0bef,_0x1aec21){const _0x17efca=a147_0x49801a;this['gitManager']=_0x7971de,this['flosumSync']=_0x34a609,this[_0x17efca(0x1fd)]=_0x5a0bef,this['commitJob']=_0x1aec21,this['repoService']=this[_0x17efca(0x20e)][_0x17efca(0x245)]();}async[a147_0x49801a(0x241)](_0x1c503c){const _0x39368d=a147_0x49801a;return this[_0x39368d(0x248)][_0x39368d(0x241)](_0x39368d(0x24f)+this[_0x39368d(0x20e)]['provider']['toUpperCase']()+']\x20[Repository:\x20'+this[_0x39368d(0x234)][_0x39368d(0x217)]+_0x39368d(0x1f6)+this['syncData']['branchName']+']\x20'+_0x1c503c);}async[a147_0x49801a(0x21d)](){const _0x4b68c3=a147_0x49801a;let _0x70b31a=await this[_0x4b68c3(0x21c)][_0x4b68c3(0x202)](this[_0x4b68c3(0x234)][_0x4b68c3(0x217)])['catch'](()=>null);!_0x70b31a&&(_0x70b31a=await this[_0x4b68c3(0x21c)][_0x4b68c3(0x1f2)]({'name':this[_0x4b68c3(0x234)]['repositoryName'],'autoInit':!![],'defaultBranch':this['syncData'][_0x4b68c3(0x218)],'private':!![]})),this['repository']=_0x70b31a;}async[a147_0x49801a(0x246)](){const _0x4b2ab4=a147_0x49801a;let _0x429ae8=await this[_0x4b2ab4(0x21b)][_0x4b2ab4(0x235)][_0x4b2ab4(0x202)](this['syncData'][_0x4b2ab4(0x218)])[_0x4b2ab4(0x21f)](()=>null);!_0x429ae8&&(_0x429ae8=await this[_0x4b2ab4(0x21b)]['branches']['create']({'name':this[_0x4b2ab4(0x234)][_0x4b2ab4(0x218)]})),this[_0x4b2ab4(0x226)]=_0x429ae8;}async['getComponentIds'](){const _0xa8f57d=a147_0x49801a;return this[_0xa8f57d(0x234)][_0xa8f57d(0x231)]?this['flosumSync'][_0xa8f57d(0x21e)](this[_0xa8f57d(0x234)][_0xa8f57d(0x231)]):this[_0xa8f57d(0x251)]['getBranchComponents'](this['syncData'][_0xa8f57d(0x200)]);}async[a147_0x49801a(0x238)](){const _0x48fe2b=a147_0x49801a,_0x5e7486=await this[_0x48fe2b(0x239)](),_0x150b0d=new salesforce_retriever_service_1[(_0x48fe2b(0x208))](this['salesforceService']),_0x537a6d=await _0x150b0d['run'](_0x5e7486);return _0x537a6d;}async[a147_0x49801a(0x204)](_0x5ecb5b){const _0x1e0293=a147_0x49801a,_0x119f6a=new commit_components_dto_1[(_0x1e0293(0x23d))]();return _0x119f6a[_0x1e0293(0x201)]=_0x1e0293(0x22a),_0x119f6a[_0x1e0293(0x24b)]={'name':constants_1[_0x1e0293(0x220)],'email':constants_1[_0x1e0293(0x1f7)]},_0x119f6a[_0x1e0293(0x1ff)]={'writed':await this[_0x1e0293(0x238)]()},_0x119f6a[_0x1e0293(0x247)]=_0x5ecb5b,_0x119f6a[_0x1e0293(0x20f)]=this[_0x1e0293(0x21b)],_0x119f6a[_0x1e0293(0x226)]=this[_0x1e0293(0x226)],_0x119f6a['force']=!![],_0x119f6a;}async[a147_0x49801a(0x242)](){const _0x55f3cb=a147_0x49801a;this[_0x55f3cb(0x22f)]=await this[_0x55f3cb(0x251)][_0x55f3cb(0x240)](this[_0x55f3cb(0x234)]),this[_0x55f3cb(0x23b)]=await this[_0x55f3cb(0x1fd)]['retrieveAttachment'](this['remoteStateAttachmentId'])[_0x55f3cb(0x24e)](_0x507040=>typeof _0x507040===_0x55f3cb(0x206)?_0x507040:JSON[_0x55f3cb(0x21a)](_0x507040||'{}'))[_0x55f3cb(0x21f)](()=>({}));if(this[_0x55f3cb(0x23b)][this[_0x55f3cb(0x21b)][_0x55f3cb(0x20b)]]){if(this['remoteState'][this['repository'][_0x55f3cb(0x20b)]]['lastCommit']===this[_0x55f3cb(0x226)][_0x55f3cb(0x249)])return!![];}return![];}async['updateLastCommit'](){const _0x4f7f05=a147_0x49801a,_0x1ac7fe=await this[_0x4f7f05(0x21b)][_0x4f7f05(0x235)][_0x4f7f05(0x202)](this[_0x4f7f05(0x226)][_0x4f7f05(0x1fa)]);await this[_0x4f7f05(0x241)](_0x4f7f05(0x224)),this[_0x4f7f05(0x23b)]={[this['repository'][_0x4f7f05(0x20b)]]:{'lastCommit':_0x1ac7fe[_0x4f7f05(0x249)]}},await this['salesforceService']['patchObject'](_0x4f7f05(0x1f5),this[_0x4f7f05(0x22f)],{'Body':utils_1[_0x4f7f05(0x1f9)](JSON[_0x4f7f05(0x219)](this['remoteState']))});}async[a147_0x49801a(0x225)](_0x1ec41a,_0x9daa31,_0x2c5303){const _0x1ed05b=a147_0x49801a;this[_0x1ed05b(0x234)]=_0x1ec41a,this[_0x1ed05b(0x1fd)][_0x1ed05b(0x228)](_0x9daa31),this['logger']=this[_0x1ed05b(0x1fd)]['getLogger']();try{await this[_0x1ed05b(0x251)][_0x1ed05b(0x250)](this['syncData'],_0x1ed05b(0x23c)),await this[_0x1ed05b(0x241)](_0x1ed05b(0x1fb)),await this[_0x1ed05b(0x21d)](),await this['createBranchIfNotExists']();const _0x597bdc=await this[_0x1ed05b(0x242)]();if(_0x597bdc){await this[_0x1ed05b(0x251)][_0x1ed05b(0x250)](this[_0x1ed05b(0x234)],'Completed'),await this[_0x1ed05b(0x241)](_0x1ed05b(0x23a));return;}const _0x45be0c=await this[_0x1ed05b(0x204)](_0x2c5303);this[_0x1ed05b(0x243)]['logger']=this['logger'],await this['commitJob'][_0x1ed05b(0x225)](_0x45be0c),await this['flosumSync'][_0x1ed05b(0x250)](this['syncData'],_0x1ed05b(0x203)),await this['updateLastCommit'](),await this[_0x1ed05b(0x241)]('[INFO]\x20Sync\x20job\x20done.');}catch(_0x370506){throw _0x370506;}finally{await this[_0x1ed05b(0x248)]['send']();}}};SyncJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a147_0x49801a(0x207),[git_provider_manager_1[a147_0x49801a(0x1f8)],salesforce_sync_service_1[a147_0x49801a(0x215)],salesforce_service_1[a147_0x49801a(0x22d)],commit_components_job_1[a147_0x49801a(0x20d)]])],SyncJob),exports[a147_0x49801a(0x232)]=SyncJob;