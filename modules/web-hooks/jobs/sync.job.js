const a139_0x5352=['getAttachmentIdByParent','setLoggerId','message','create','remoteState','289420WyKQCp','parse','remoteStateAttachmentId','then','salesforceService','../../salesforce/services/salesforce-retriever.service','789609XtOpbZ','commitJob','convertToSFDX','test','repositoryName','repositoryId','[INFO]\x20Start\x20sync\x20job','../dto/commit-components.dto','setStatus','sfLogger','SalesforceSyncService','316jpRkyL','getComponentsFromRepository','run','SyncJob','../../shared/utils','gitUrl','getOwnPropertyDescriptor','SalesforceService','gitManager','__decorate','getCommitDto','branchName','retriever','getOne','[INFO]\x20Update\x20remote\x20state.','design:paramtypes','[SYNC]\x20[Repository:\x20','../../shared/git-provider.manager','getComponentIds','force','./commit-components.job','repository','517762KeAICz','415088hVKEmy','SalesforceRetrieverService','Attachment','user','decorate','repoService','defineProperty','length','flosumSync','getRepoService','1UJCQWv','name','syncData','[INFO]\x20Branch\x20synchronized.\x20Skip','[INFO]\x20Sync\x20job\x20done.','retrieveAttachment','objectId','function','lastCommit','updateLastCommit',']\x20[Branch:\x20','281623UolBhO','encodeBase64','287102NFtKCO','In\x20Progress','sendLog','branch','2441HVUXpE','Completed','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','sha','4KnROUr','createRepositoryIfNotExists','../../../constants','branches','metadata','object','catch','patchObject','checkSyncStatus'];const a139_0xf26247=a139_0x5ea0;(function(_0x465de9,_0x2edbf9){const _0x49d21b=a139_0x5ea0;while(!![]){try{const _0x4f6fcd=parseInt(_0x49d21b(0x183))+-parseInt(_0x49d21b(0x16c))*parseInt(_0x49d21b(0x19e))+parseInt(_0x49d21b(0x161))+-parseInt(_0x49d21b(0x198))*parseInt(_0x49d21b(0x18d))+-parseInt(_0x49d21b(0x15b))+-parseInt(_0x49d21b(0x182))+parseInt(_0x49d21b(0x19a))*parseInt(_0x49d21b(0x14d));if(_0x4f6fcd===_0x2edbf9)break;else _0x465de9['push'](_0x465de9['shift']());}catch(_0x5bfbea){_0x465de9['push'](_0x465de9['shift']());}}}(a139_0x5352,0x78590));const a139_0x5ba816=function(){let _0x13decb=!![];return function(_0x6b685c,_0x56b430){const _0x979d55=_0x13decb?function(){if(_0x56b430){const _0x43f9bb=_0x56b430['apply'](_0x6b685c,arguments);return _0x56b430=null,_0x43f9bb;}}:function(){};return _0x13decb=![],_0x979d55;};}(),a139_0x416847=a139_0x5ba816(this,function(){const _0x402f76=function(){const _0x4b5e3a=a139_0x5ea0,_0x559720=_0x402f76['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](_0x4b5e3a(0x1a0));return!_0x559720[_0x4b5e3a(0x164)](a139_0x416847);};return _0x402f76();});a139_0x416847();'use strict';function a139_0x5ea0(_0xbb1352,_0x4b4d09){return a139_0x5ea0=function(_0x29ad8b,_0x416847){_0x29ad8b=_0x29ad8b-0x14d;let _0x5ba816=a139_0x5352[_0x29ad8b];return _0x5ba816;},a139_0x5ea0(_0xbb1352,_0x4b4d09);}var __decorate=this&&this[a139_0xf26247(0x175)]||function(_0x4b0961,_0x5a5826,_0x2d6557,_0x16b1b2){const _0x1e60a5=a139_0xf26247;var _0x1253eb=arguments[_0x1e60a5(0x18a)],_0x44a76b=_0x1253eb<0x3?_0x5a5826:_0x16b1b2===null?_0x16b1b2=Object[_0x1e60a5(0x172)](_0x5a5826,_0x2d6557):_0x16b1b2,_0x474e9d;if(typeof Reflect===_0x1e60a5(0x152)&&typeof Reflect[_0x1e60a5(0x187)]==='function')_0x44a76b=Reflect[_0x1e60a5(0x187)](_0x4b0961,_0x5a5826,_0x2d6557,_0x16b1b2);else{for(var _0x1c9b84=_0x4b0961[_0x1e60a5(0x18a)]-0x1;_0x1c9b84>=0x0;_0x1c9b84--)if(_0x474e9d=_0x4b0961[_0x1c9b84])_0x44a76b=(_0x1253eb<0x3?_0x474e9d(_0x44a76b):_0x1253eb>0x3?_0x474e9d(_0x5a5826,_0x2d6557,_0x44a76b):_0x474e9d(_0x5a5826,_0x2d6557))||_0x44a76b;}return _0x1253eb>0x3&&_0x44a76b&&Object[_0x1e60a5(0x189)](_0x5a5826,_0x2d6557,_0x44a76b),_0x44a76b;},__metadata=this&&this['__metadata']||function(_0x3fabcf,_0x312379){const _0x511608=a139_0xf26247;if(typeof Reflect==='object'&&typeof Reflect[_0x511608(0x151)]===_0x511608(0x194))return Reflect[_0x511608(0x151)](_0x3fabcf,_0x312379);};Object[a139_0xf26247(0x189)](exports,'__esModule',{'value':!![]}),exports[a139_0xf26247(0x16f)]=void 0x0;const typedi_1=require('typedi'),constants_1=require(a139_0xf26247(0x14f)),salesforce_retriever_service_1=require(a139_0xf26247(0x160)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a139_0xf26247(0x17d)),utils_1=require(a139_0xf26247(0x170)),commit_components_dto_1=require(a139_0xf26247(0x168)),commit_components_job_1=require(a139_0xf26247(0x180));let SyncJob=class SyncJob{constructor(_0x400807,_0x141f41,_0x5d86e2,_0x45e16a){const _0x444ac2=a139_0xf26247;this[_0x444ac2(0x174)]=_0x400807,this[_0x444ac2(0x18b)]=_0x141f41,this[_0x444ac2(0x15f)]=_0x5d86e2,this['commitJob']=_0x45e16a,this[_0x444ac2(0x188)]=this[_0x444ac2(0x174)][_0x444ac2(0x18c)](),_0x45e16a[_0x444ac2(0x178)]=new salesforce_retriever_service_1[(_0x444ac2(0x184))](this[_0x444ac2(0x15f)]),_0x45e16a['on']('log',_0x734d45=>this[_0x444ac2(0x16a)](_0x734d45));}async[a139_0xf26247(0x16a)](_0x1b1fc4){const _0x491584=a139_0xf26247;return this['salesforceService'][_0x491584(0x19c)](_0x491584(0x17c)+this[_0x491584(0x18f)][_0x491584(0x165)]+_0x491584(0x197)+this[_0x491584(0x18f)][_0x491584(0x177)]+']\x20'+_0x1b1fc4);}async['createRepositoryIfNotExists'](){const _0x1d026d=a139_0xf26247;let _0x37df18=await this['repoService']['getOne'](this['syncData'][_0x1d026d(0x165)])[_0x1d026d(0x153)](()=>null);!_0x37df18&&(_0x37df18=await this[_0x1d026d(0x188)]['create']({'name':this[_0x1d026d(0x18f)]['repositoryName'],'autoInit':!![],'defaultBranch':this[_0x1d026d(0x18f)]['branchName'],'private':!![]})),this[_0x1d026d(0x181)]=_0x37df18;}async['createBranchIfNotExists'](){const _0x170416=a139_0xf26247;let _0x4ae0c8=await this[_0x170416(0x181)][_0x170416(0x150)][_0x170416(0x179)](this[_0x170416(0x18f)][_0x170416(0x177)])[_0x170416(0x153)](()=>null);!_0x4ae0c8&&(_0x4ae0c8=await this['repository'][_0x170416(0x150)][_0x170416(0x159)]({'name':this['syncData'][_0x170416(0x177)]})),this[_0x170416(0x19d)]=_0x4ae0c8;}async['getComponentIds'](){const _0x378e1b=a139_0xf26247;return this[_0x378e1b(0x18f)][_0x378e1b(0x166)]?this[_0x378e1b(0x18b)][_0x378e1b(0x16d)](this[_0x378e1b(0x18f)][_0x378e1b(0x166)]):this[_0x378e1b(0x18b)]['getBranchComponents'](this['syncData']['branchId']);}async['getCommitDto'](_0x4728a1){const _0x51602f=a139_0xf26247,_0xe04089=new commit_components_dto_1['CommitComponentsDto']();return _0xe04089[_0x51602f(0x158)]='Sync\x20repository',_0xe04089[_0x51602f(0x186)]={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1['DEFAULT_GIT_USER_EMAIL']},_0xe04089['componentsIds']=await this[_0x51602f(0x17e)](),_0xe04089[_0x51602f(0x163)]=_0x4728a1,_0xe04089['repo']=this[_0x51602f(0x181)],_0xe04089[_0x51602f(0x19d)]=this['branch'],_0xe04089[_0x51602f(0x17f)]=!![],_0xe04089;}async['checkSyncStatus'](){const _0x5cb9ef=a139_0xf26247;this[_0x5cb9ef(0x15d)]=await this[_0x5cb9ef(0x18b)][_0x5cb9ef(0x156)](this[_0x5cb9ef(0x18f)][_0x5cb9ef(0x193)]),this[_0x5cb9ef(0x15a)]=await this['salesforceService'][_0x5cb9ef(0x192)](this[_0x5cb9ef(0x15d)])[_0x5cb9ef(0x15e)](_0x50b54c=>typeof _0x50b54c===_0x5cb9ef(0x152)?_0x50b54c:JSON[_0x5cb9ef(0x15c)](_0x50b54c||'{}'))[_0x5cb9ef(0x153)](()=>({}));if(this[_0x5cb9ef(0x15a)][this[_0x5cb9ef(0x181)][_0x5cb9ef(0x171)]]){if(this['remoteState'][this['repository']['gitUrl']][_0x5cb9ef(0x195)]===this[_0x5cb9ef(0x19d)][_0x5cb9ef(0x1a1)])return!![];}return![];}async[a139_0xf26247(0x196)](){const _0x3784b7=a139_0xf26247,_0x2539e8=await this['repository']['branches'][_0x3784b7(0x179)](this['branch'][_0x3784b7(0x18e)]);await this[_0x3784b7(0x16a)](_0x3784b7(0x17a)),this[_0x3784b7(0x15a)]={[this['repository'][_0x3784b7(0x171)]]:{'lastCommit':_0x2539e8['sha']}},await this['salesforceService'][_0x3784b7(0x154)](_0x3784b7(0x185),this[_0x3784b7(0x15d)],{'Body':utils_1[_0x3784b7(0x199)](JSON['stringify'](this[_0x3784b7(0x15a)]))});}async[a139_0xf26247(0x16e)](_0x55ff39,_0x44df29,_0x142774){const _0x1f440b=a139_0xf26247;this[_0x1f440b(0x18f)]=_0x55ff39,this[_0x1f440b(0x15f)][_0x1f440b(0x157)](_0x44df29),await this[_0x1f440b(0x18b)][_0x1f440b(0x169)](this[_0x1f440b(0x18f)],_0x1f440b(0x19b)),await this[_0x1f440b(0x16a)](_0x1f440b(0x167)),await this[_0x1f440b(0x14e)](),await this['createBranchIfNotExists']();const _0x26892c=await this[_0x1f440b(0x155)]();if(_0x26892c){await this[_0x1f440b(0x18b)][_0x1f440b(0x169)](this[_0x1f440b(0x18f)],'Completed'),await this[_0x1f440b(0x16a)](_0x1f440b(0x190));return;}const _0x5ade1f=await this[_0x1f440b(0x176)](_0x142774);await this[_0x1f440b(0x162)][_0x1f440b(0x16e)](_0x5ade1f),await this['flosumSync'][_0x1f440b(0x169)](this[_0x1f440b(0x18f)],_0x1f440b(0x19f)),await this['updateLastCommit'](),await this['sfLogger'](_0x1f440b(0x191));}};SyncJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a139_0xf26247(0x17b),[git_provider_manager_1['GitProviderManager'],salesforce_sync_service_1[a139_0xf26247(0x16b)],salesforce_service_1[a139_0xf26247(0x173)],commit_components_job_1['CommitComponentsJob']])],SyncJob),exports[a139_0xf26247(0x16f)]=SyncJob;