const a147_0x3759=['log','function','getBranchComponents','145580mKSWtb','../../shared/git-provider.manager','../../../constants','repositoryName','getComponents','repoService','lastCommit','560297YYwOIS','repositoryId','1UfTwWy','getLogger','commitJob','../../salesforce/services/salesforce-retriever.service','flosumSync','updateLastCommit','checkSyncStatus',']\x20[Branch:\x20','createBranchIfNotExists','SalesforceRetrieverService','24784gPdgZD','SyncJob','apply','__metadata','repository','syncData','getComponentIds','send','branch','23fjUyUz','constructor','../dto/commit-components.dto','getOne','decorate','1jLrSMJ','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','getComponentsFromRepository','../../salesforce/services/salesforce.service','DEFAULT_GIT_USER_NAME','name','object','getCommitDto','run','repo','patchObject','241fFbpQZ','then','remoteState','../../shared/utils','branches','branchName','[INFO]\x20Branch\x20synchronized.\x20Skip','catch','gitManager','metadata','DEFAULT_GIT_USER_EMAIL','test','Attachment','Service','[INFO]\x20Update\x20remote\x20state.','757njwnbu','388876EzxAtz','provider','logger','branchId','1iRRXYp','67lkpvhI','getRepoService','Completed','createRepositoryIfNotExists','__decorate','create','In\x20Progress','defineProperty','setLoggerId','toUpperCase','1338dJMiVa','841970axymki','CommitComponentsJob','convertToSFDX','./commit-components.job','[SYNC]\x20[','GitProviderManager','remoteStateAttachmentId','design:paramtypes','../../salesforce/services/salesforce-sync.service','setStatus','SalesforceSyncService','sha','[INFO]\x20Start\x20sync\x20job','salesforceService','parse','retrieveAttachment'];const a147_0x3210d5=a147_0x42b2;(function(_0x5cd518,_0x431242){const _0x4c9a63=a147_0x42b2;while(!![]){try{const _0x16127c=parseInt(_0x4c9a63(0x1f5))*parseInt(_0x4c9a63(0x1f9))+parseInt(_0x4c9a63(0x221))*-parseInt(_0x4c9a63(0x21f))+-parseInt(_0x4c9a63(0x218))*parseInt(_0x4c9a63(0x1da))+parseInt(_0x4c9a63(0x1fa))*parseInt(_0x4c9a63(0x1e5))+parseInt(_0x4c9a63(0x1d5))*parseInt(_0x4c9a63(0x22b))+-parseInt(_0x4c9a63(0x205))+parseInt(_0x4c9a63(0x1f4))*parseInt(_0x4c9a63(0x204));if(_0x16127c===_0x431242)break;else _0x5cd518['push'](_0x5cd518['shift']());}catch(_0x511f74){_0x5cd518['push'](_0x5cd518['shift']());}}}(a147_0x3759,0x6b70a));function a147_0x42b2(_0x515a72,_0x4ce7ea){return a147_0x42b2=function(_0x3c4073,_0x1a0b55){_0x3c4073=_0x3c4073-0x1d5;let _0x5a6bad=a147_0x3759[_0x3c4073];return _0x5a6bad;},a147_0x42b2(_0x515a72,_0x4ce7ea);}const a147_0x5a6bad=function(){let _0x42bd4b=!![];return function(_0x26a9d3,_0x2d8199){const _0x14bc39=_0x42bd4b?function(){const _0x24cea4=a147_0x42b2;if(_0x2d8199){const _0x20ac4a=_0x2d8199[_0x24cea4(0x22d)](_0x26a9d3,arguments);return _0x2d8199=null,_0x20ac4a;}}:function(){};return _0x42bd4b=![],_0x14bc39;};}(),a147_0x1a0b55=a147_0x5a6bad(this,function(){const _0x359789=function(){const _0x5d2187=a147_0x42b2,_0x293d62=_0x359789[_0x5d2187(0x1d6)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x5d2187(0x1d6)](_0x5d2187(0x1db));return!_0x293d62[_0x5d2187(0x1f0)](a147_0x1a0b55);};return _0x359789();});a147_0x1a0b55();'use strict';var __decorate=this&&this[a147_0x3210d5(0x1fe)]||function(_0x50fcac,_0x2e1f50,_0x332834,_0x3344ca){const _0x3b3579=a147_0x3210d5;var _0x1e3cf3=arguments['length'],_0x4e6d4c=_0x1e3cf3<0x3?_0x2e1f50:_0x3344ca===null?_0x3344ca=Object['getOwnPropertyDescriptor'](_0x2e1f50,_0x332834):_0x3344ca,_0x52d0c6;if(typeof Reflect===_0x3b3579(0x1e0)&&typeof Reflect['decorate']===_0x3b3579(0x216))_0x4e6d4c=Reflect[_0x3b3579(0x1d9)](_0x50fcac,_0x2e1f50,_0x332834,_0x3344ca);else{for(var _0x52f538=_0x50fcac['length']-0x1;_0x52f538>=0x0;_0x52f538--)if(_0x52d0c6=_0x50fcac[_0x52f538])_0x4e6d4c=(_0x1e3cf3<0x3?_0x52d0c6(_0x4e6d4c):_0x1e3cf3>0x3?_0x52d0c6(_0x2e1f50,_0x332834,_0x4e6d4c):_0x52d0c6(_0x2e1f50,_0x332834))||_0x4e6d4c;}return _0x1e3cf3>0x3&&_0x4e6d4c&&Object[_0x3b3579(0x201)](_0x2e1f50,_0x332834,_0x4e6d4c),_0x4e6d4c;},__metadata=this&&this[a147_0x3210d5(0x22e)]||function(_0x43bfd1,_0x57f0d1){const _0x47a43c=a147_0x3210d5;if(typeof Reflect===_0x47a43c(0x1e0)&&typeof Reflect[_0x47a43c(0x1ee)]===_0x47a43c(0x216))return Reflect[_0x47a43c(0x1ee)](_0x43bfd1,_0x57f0d1);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports['SyncJob']=void 0x0;const typedi_1=require('typedi'),constants_1=require(a147_0x3210d5(0x21a)),salesforce_retriever_service_1=require(a147_0x3210d5(0x224)),salesforce_sync_service_1=require(a147_0x3210d5(0x20d)),salesforce_service_1=require(a147_0x3210d5(0x1dd)),git_provider_manager_1=require(a147_0x3210d5(0x219)),utils_1=require(a147_0x3210d5(0x1e8)),commit_components_dto_1=require(a147_0x3210d5(0x1d7)),commit_components_job_1=require(a147_0x3210d5(0x208));let SyncJob=class SyncJob{constructor(_0x47a458,_0x138d51,_0x5b165e,_0x3f90fe){const _0x40ad95=a147_0x3210d5;this['gitManager']=_0x47a458,this[_0x40ad95(0x225)]=_0x138d51,this[_0x40ad95(0x212)]=_0x5b165e,this[_0x40ad95(0x223)]=_0x3f90fe,this[_0x40ad95(0x21d)]=this[_0x40ad95(0x1ed)][_0x40ad95(0x1fb)]();}async[a147_0x3210d5(0x215)](_0x23a0b9){const _0x111549=a147_0x3210d5;return this[_0x111549(0x1f7)][_0x111549(0x215)](_0x111549(0x209)+this['gitManager'][_0x111549(0x1f6)][_0x111549(0x203)]()+']\x20[Repository:\x20'+this[_0x111549(0x230)][_0x111549(0x21b)]+_0x111549(0x228)+this[_0x111549(0x230)][_0x111549(0x1ea)]+']\x20'+_0x23a0b9);}async[a147_0x3210d5(0x1fd)](){const _0x548f6c=a147_0x3210d5;let _0x423110=await this[_0x548f6c(0x21d)][_0x548f6c(0x1d8)](this['syncData']['repositoryName'])[_0x548f6c(0x1ec)](()=>null);!_0x423110&&(_0x423110=await this[_0x548f6c(0x21d)][_0x548f6c(0x1ff)]({'name':this[_0x548f6c(0x230)][_0x548f6c(0x21b)],'autoInit':!![],'defaultBranch':this[_0x548f6c(0x230)][_0x548f6c(0x1ea)],'private':!![]})),this[_0x548f6c(0x22f)]=_0x423110;}async[a147_0x3210d5(0x229)](){const _0x416093=a147_0x3210d5;let _0x19187a=await this[_0x416093(0x22f)][_0x416093(0x1e9)][_0x416093(0x1d8)](this[_0x416093(0x230)][_0x416093(0x1ea)])[_0x416093(0x1ec)](()=>null);!_0x19187a&&(_0x19187a=await this[_0x416093(0x22f)]['branches'][_0x416093(0x1ff)]({'name':this[_0x416093(0x230)][_0x416093(0x1ea)]})),this[_0x416093(0x233)]=_0x19187a;}async[a147_0x3210d5(0x231)](){const _0x4d3c69=a147_0x3210d5;return this[_0x4d3c69(0x230)][_0x4d3c69(0x220)]?this['flosumSync'][_0x4d3c69(0x1dc)](this['syncData']['repositoryId']):this['flosumSync'][_0x4d3c69(0x217)](this['syncData'][_0x4d3c69(0x1f8)]);}async[a147_0x3210d5(0x21c)](){const _0x1a25c5=a147_0x3210d5,_0x3f661d=await this['getComponentIds'](),_0x4a8081=new salesforce_retriever_service_1[(_0x1a25c5(0x22a))](this[_0x1a25c5(0x212)]),_0x387bc0=await _0x4a8081['run'](_0x3f661d);return _0x387bc0;}async[a147_0x3210d5(0x1e1)](_0x206e24){const _0x49e72f=a147_0x3210d5,_0x33dbb9=new commit_components_dto_1['CommitComponentsDto']();return _0x33dbb9['message']='Sync\x20repository',_0x33dbb9['user']={'name':constants_1[_0x49e72f(0x1de)],'email':constants_1[_0x49e72f(0x1ef)]},_0x33dbb9['components']={'writed':await this[_0x49e72f(0x21c)]()},_0x33dbb9[_0x49e72f(0x207)]=_0x206e24,_0x33dbb9[_0x49e72f(0x1e3)]=this['repository'],_0x33dbb9['branch']=this['branch'],_0x33dbb9['force']=!![],_0x33dbb9;}async['checkSyncStatus'](){const _0x3fc950=a147_0x3210d5;this[_0x3fc950(0x20b)]=await this[_0x3fc950(0x225)]['getAttachmentId'](this[_0x3fc950(0x230)]),this['remoteState']=await this['salesforceService'][_0x3fc950(0x214)](this[_0x3fc950(0x20b)])[_0x3fc950(0x1e6)](_0x53d367=>typeof _0x53d367===_0x3fc950(0x1e0)?_0x53d367:JSON[_0x3fc950(0x213)](_0x53d367||'{}'))[_0x3fc950(0x1ec)](()=>({}));if(this[_0x3fc950(0x1e7)][this['repository']['gitUrl']]){if(this['remoteState'][this[_0x3fc950(0x22f)]['gitUrl']][_0x3fc950(0x21e)]===this[_0x3fc950(0x233)][_0x3fc950(0x210)])return!![];}return![];}async['updateLastCommit'](){const _0x373450=a147_0x3210d5,_0x274616=await this[_0x373450(0x22f)][_0x373450(0x1e9)][_0x373450(0x1d8)](this[_0x373450(0x233)][_0x373450(0x1df)]);await this['log'](_0x373450(0x1f3)),this[_0x373450(0x1e7)]={[this['repository']['gitUrl']]:{'lastCommit':_0x274616[_0x373450(0x210)]}},await this[_0x373450(0x212)][_0x373450(0x1e4)](_0x373450(0x1f1),this['remoteStateAttachmentId'],{'Body':utils_1['encodeBase64'](JSON['stringify'](this[_0x373450(0x1e7)]))});}async[a147_0x3210d5(0x1e2)](_0x5a9cd8,_0x47ba95,_0x1f4c1b){const _0xfa4f18=a147_0x3210d5;this['syncData']=_0x5a9cd8,this[_0xfa4f18(0x212)][_0xfa4f18(0x202)](_0x47ba95),this[_0xfa4f18(0x1f7)]=this[_0xfa4f18(0x212)][_0xfa4f18(0x222)]();try{await this[_0xfa4f18(0x225)][_0xfa4f18(0x20e)](this[_0xfa4f18(0x230)],_0xfa4f18(0x200)),await this[_0xfa4f18(0x215)](_0xfa4f18(0x211)),await this['createRepositoryIfNotExists'](),await this[_0xfa4f18(0x229)]();const _0xac0d52=await this[_0xfa4f18(0x227)]();if(_0xac0d52){await this['flosumSync'][_0xfa4f18(0x20e)](this[_0xfa4f18(0x230)],_0xfa4f18(0x1fc)),await this[_0xfa4f18(0x215)](_0xfa4f18(0x1eb));return;}const _0x282c06=await this[_0xfa4f18(0x1e1)](_0x1f4c1b);this['commitJob'][_0xfa4f18(0x1f7)]=this['logger'],await this['commitJob'][_0xfa4f18(0x1e2)](_0x282c06),await this['flosumSync'][_0xfa4f18(0x20e)](this['syncData'],_0xfa4f18(0x1fc)),await this[_0xfa4f18(0x226)](),await this['log']('[INFO]\x20Sync\x20job\x20done.');}catch(_0x36104f){throw _0x36104f;}finally{await this[_0xfa4f18(0x1f7)][_0xfa4f18(0x232)]();}}};SyncJob=__decorate([typedi_1[a147_0x3210d5(0x1f2)]({'transient':!![]}),__metadata(a147_0x3210d5(0x20c),[git_provider_manager_1[a147_0x3210d5(0x20a)],salesforce_sync_service_1[a147_0x3210d5(0x20f)],salesforce_service_1['SalesforceService'],commit_components_job_1[a147_0x3210d5(0x206)]])],SyncJob),exports[a147_0x3210d5(0x22c)]=SyncJob;