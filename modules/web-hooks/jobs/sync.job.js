const a147_0x50ce=['getOne','41HJHfVP','length','retrieveAttachment','updateLastCommit','getComponents','defineProperty','SyncJob','logger','../../salesforce/services/salesforce-sync.service','patchObject','createRepositoryIfNotExists','send','flosumSync',']\x20[Repository:\x20','lastCommit','stringify','components','97fdbEqV','gitUrl','getComponentIds','[INFO]\x20Branch\x20synchronized.\x20Skip','1137238yUODBV','syncData','repoService','gitManager','7244FQVdhI','provider','getOwnPropertyDescriptor','getBranchComponents','remoteState','repo','branch','SalesforceService','75706VkejYd','Completed','toUpperCase','15YBPhdv','171521GOkorf','encodeBase64','repositoryId','user','function','../../salesforce/services/salesforce-retriever.service','setStatus','repositoryName','getRepoService','repository','GitProviderManager','typedi','decorate','message','object','../../salesforce/services/salesforce.service','CommitComponentsDto','test','[INFO]\x20Start\x20sync\x20job','branchName','__decorate','../../shared/git-provider.manager','getCommitDto','force','run','createBranchIfNotExists','CommitComponentsJob','remoteStateAttachmentId','log','Sync\x20repository','774DxgFjF','4afxdaq','design:paramtypes','salesforceService','parse','checkSyncStatus','../../shared/utils','4RzsKVl','[INFO]\x20Sync\x20job\x20done.','DEFAULT_GIT_USER_NAME','then','name','return\x20/\x22\x20+\x20this\x20+\x20\x22/','55393KmzUeX','catch','DEFAULT_GIT_USER_EMAIL','metadata','constructor','SalesforceSyncService','create','115488AIjXlb','commitJob','sha','branches','463LWEfiC'];const a147_0x5b1c19=a147_0x49c9;(function(_0x44e89b,_0xdcb953){const _0x2a2f04=a147_0x49c9;while(!![]){try{const _0x76b1ec=parseInt(_0x2a2f04(0x1c8))+-parseInt(_0x2a2f04(0x1f6))*-parseInt(_0x2a2f04(0x20e))+parseInt(_0x2a2f04(0x1fd))*-parseInt(_0x2a2f04(0x1d8))+parseInt(_0x2a2f04(0x1f7))*parseInt(_0x2a2f04(0x1d4))+parseInt(_0x2a2f04(0x20a))*-parseInt(_0x2a2f04(0x1d7))+parseInt(_0x2a2f04(0x1c4))*-parseInt(_0x2a2f04(0x1cc))+-parseInt(_0x2a2f04(0x210))*-parseInt(_0x2a2f04(0x203));if(_0x76b1ec===_0xdcb953)break;else _0x44e89b['push'](_0x44e89b['shift']());}catch(_0x2bf9d5){_0x44e89b['push'](_0x44e89b['shift']());}}}(a147_0x50ce,0xe78f1));const a147_0x1e3875=function(){let _0x5b93c4=!![];return function(_0x4253ed,_0x2585e4){const _0x242342=_0x5b93c4?function(){if(_0x2585e4){const _0x166a0a=_0x2585e4['apply'](_0x4253ed,arguments);return _0x2585e4=null,_0x166a0a;}}:function(){};return _0x5b93c4=![],_0x242342;};}(),a147_0x2f21c2=a147_0x1e3875(this,function(){const _0x31fc6b=function(){const _0x40d2d4=a147_0x49c9,_0x15e212=_0x31fc6b[_0x40d2d4(0x207)](_0x40d2d4(0x202))()[_0x40d2d4(0x207)]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x15e212[_0x40d2d4(0x1e9)](a147_0x2f21c2);};return _0x31fc6b();});function a147_0x49c9(_0x4494ed,_0x6ac66b){return a147_0x49c9=function(_0x487e20,_0x2f21c2){_0x487e20=_0x487e20-0x1be;let _0x1e3875=a147_0x50ce[_0x487e20];return _0x1e3875;},a147_0x49c9(_0x4494ed,_0x6ac66b);}a147_0x2f21c2();'use strict';var __decorate=this&&this[a147_0x5b1c19(0x1ec)]||function(_0x3a60d8,_0x119c76,_0x35e6dc,_0x256f52){const _0x39ac86=a147_0x5b1c19;var _0x47dfc3=arguments[_0x39ac86(0x211)],_0x282f98=_0x47dfc3<0x3?_0x119c76:_0x256f52===null?_0x256f52=Object[_0x39ac86(0x1ce)](_0x119c76,_0x35e6dc):_0x256f52,_0x7cecd2;if(typeof Reflect===_0x39ac86(0x1e6)&&typeof Reflect[_0x39ac86(0x1e4)]===_0x39ac86(0x1dc))_0x282f98=Reflect['decorate'](_0x3a60d8,_0x119c76,_0x35e6dc,_0x256f52);else{for(var _0x2b1d5a=_0x3a60d8[_0x39ac86(0x211)]-0x1;_0x2b1d5a>=0x0;_0x2b1d5a--)if(_0x7cecd2=_0x3a60d8[_0x2b1d5a])_0x282f98=(_0x47dfc3<0x3?_0x7cecd2(_0x282f98):_0x47dfc3>0x3?_0x7cecd2(_0x119c76,_0x35e6dc,_0x282f98):_0x7cecd2(_0x119c76,_0x35e6dc))||_0x282f98;}return _0x47dfc3>0x3&&_0x282f98&&Object['defineProperty'](_0x119c76,_0x35e6dc,_0x282f98),_0x282f98;},__metadata=this&&this['__metadata']||function(_0x125378,_0xfa25d4){const _0x43479f=a147_0x5b1c19;if(typeof Reflect==='object'&&typeof Reflect[_0x43479f(0x206)]==='function')return Reflect['metadata'](_0x125378,_0xfa25d4);};Object[a147_0x5b1c19(0x215)](exports,'__esModule',{'value':!![]}),exports[a147_0x5b1c19(0x216)]=void 0x0;const typedi_1=require(a147_0x5b1c19(0x1e3)),constants_1=require('../../../constants'),salesforce_retriever_service_1=require(a147_0x5b1c19(0x1dd)),salesforce_sync_service_1=require(a147_0x5b1c19(0x218)),salesforce_service_1=require(a147_0x5b1c19(0x1e7)),git_provider_manager_1=require(a147_0x5b1c19(0x1ed)),utils_1=require(a147_0x5b1c19(0x1fc)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job');let SyncJob=class SyncJob{constructor(_0x36805f,_0x2154a7,_0x1fceae,_0xc7b9fe){const _0x2df7a2=a147_0x5b1c19;this['gitManager']=_0x36805f,this[_0x2df7a2(0x1bf)]=_0x2154a7,this[_0x2df7a2(0x1f9)]=_0x1fceae,this['commitJob']=_0xc7b9fe,this[_0x2df7a2(0x1ca)]=this[_0x2df7a2(0x1cb)][_0x2df7a2(0x1e0)]();}async['log'](_0x25b04b){const _0x42caef=a147_0x5b1c19;return this[_0x42caef(0x217)][_0x42caef(0x1f4)]('[SYNC]\x20['+this[_0x42caef(0x1cb)][_0x42caef(0x1cd)][_0x42caef(0x1d6)]()+_0x42caef(0x1c0)+this[_0x42caef(0x1c9)]['repositoryName']+']\x20[Branch:\x20'+this[_0x42caef(0x1c9)]['branchName']+']\x20'+_0x25b04b);}async[a147_0x5b1c19(0x21a)](){const _0x16115a=a147_0x5b1c19;let _0x2be2ee=await this[_0x16115a(0x1ca)][_0x16115a(0x20f)](this[_0x16115a(0x1c9)]['repositoryName'])[_0x16115a(0x204)](()=>null);!_0x2be2ee&&(_0x2be2ee=await this['repoService'][_0x16115a(0x209)]({'name':this['syncData'][_0x16115a(0x1df)],'autoInit':!![],'defaultBranch':this[_0x16115a(0x1c9)][_0x16115a(0x1eb)],'private':!![]})),this[_0x16115a(0x1e1)]=_0x2be2ee;}async[a147_0x5b1c19(0x1f1)](){const _0x30b52f=a147_0x5b1c19;let _0x595fcf=await this[_0x30b52f(0x1e1)][_0x30b52f(0x20d)][_0x30b52f(0x20f)](this['syncData'][_0x30b52f(0x1eb)])[_0x30b52f(0x204)](()=>null);!_0x595fcf&&(_0x595fcf=await this[_0x30b52f(0x1e1)][_0x30b52f(0x20d)][_0x30b52f(0x209)]({'name':this['syncData'][_0x30b52f(0x1eb)]})),this[_0x30b52f(0x1d2)]=_0x595fcf;}async[a147_0x5b1c19(0x1c6)](){const _0x593d07=a147_0x5b1c19;return this['syncData'][_0x593d07(0x1da)]?this['flosumSync']['getComponentsFromRepository'](this[_0x593d07(0x1c9)][_0x593d07(0x1da)]):this[_0x593d07(0x1bf)][_0x593d07(0x1cf)](this['syncData']['branchId']);}async[a147_0x5b1c19(0x214)](){const _0x49575f=a147_0x5b1c19,_0x6f9921=await this[_0x49575f(0x1c6)](),_0x281a72=new salesforce_retriever_service_1['SalesforceRetrieverService'](this[_0x49575f(0x1f9)]),_0x1bfd03=await _0x281a72[_0x49575f(0x1f0)](_0x6f9921);return _0x1bfd03;}async[a147_0x5b1c19(0x1ee)](_0x5ab40a){const _0x41cab3=a147_0x5b1c19,_0x18babd=new commit_components_dto_1[(_0x41cab3(0x1e8))]();return _0x18babd[_0x41cab3(0x1e5)]=_0x41cab3(0x1f5),_0x18babd[_0x41cab3(0x1db)]={'name':constants_1[_0x41cab3(0x1ff)],'email':constants_1[_0x41cab3(0x205)]},_0x18babd[_0x41cab3(0x1c3)]={'writed':await this[_0x41cab3(0x214)]()},_0x18babd['convertToSFDX']=_0x5ab40a,_0x18babd[_0x41cab3(0x1d1)]=this[_0x41cab3(0x1e1)],_0x18babd[_0x41cab3(0x1d2)]=this['branch'],_0x18babd[_0x41cab3(0x1ef)]=!![],_0x18babd;}async[a147_0x5b1c19(0x1fb)](){const _0x1eb983=a147_0x5b1c19;this[_0x1eb983(0x1f3)]=await this[_0x1eb983(0x1bf)]['getAttachmentId'](this[_0x1eb983(0x1c9)]),this[_0x1eb983(0x1d0)]=await this[_0x1eb983(0x1f9)][_0x1eb983(0x212)](this['remoteStateAttachmentId'])[_0x1eb983(0x200)](_0x7a5e43=>typeof _0x7a5e43===_0x1eb983(0x1e6)?_0x7a5e43:JSON[_0x1eb983(0x1fa)](_0x7a5e43||'{}'))[_0x1eb983(0x204)](()=>({}));if(this[_0x1eb983(0x1d0)][this['repository'][_0x1eb983(0x1c5)]]){if(this[_0x1eb983(0x1d0)][this[_0x1eb983(0x1e1)][_0x1eb983(0x1c5)]][_0x1eb983(0x1c1)]===this['branch']['sha'])return!![];}return![];}async[a147_0x5b1c19(0x213)](){const _0x111309=a147_0x5b1c19,_0x436690=await this[_0x111309(0x1e1)][_0x111309(0x20d)]['getOne'](this[_0x111309(0x1d2)][_0x111309(0x201)]);await this[_0x111309(0x1f4)]('[INFO]\x20Update\x20remote\x20state.'),this[_0x111309(0x1d0)]={[this[_0x111309(0x1e1)][_0x111309(0x1c5)]]:{'lastCommit':_0x436690[_0x111309(0x20c)]}},await this[_0x111309(0x1f9)][_0x111309(0x219)]('Attachment',this[_0x111309(0x1f3)],{'Body':utils_1[_0x111309(0x1d9)](JSON[_0x111309(0x1c2)](this[_0x111309(0x1d0)]))});}async[a147_0x5b1c19(0x1f0)](_0x382358,_0x4a4e69,_0x28a974){const _0xe909c2=a147_0x5b1c19;this[_0xe909c2(0x1c9)]=_0x382358,this[_0xe909c2(0x1f9)]['setLoggerId'](_0x4a4e69),this[_0xe909c2(0x217)]=this['salesforceService']['getLogger']();try{await this[_0xe909c2(0x1bf)][_0xe909c2(0x1de)](this[_0xe909c2(0x1c9)],'In\x20Progress'),await this[_0xe909c2(0x1f4)](_0xe909c2(0x1ea)),await this[_0xe909c2(0x21a)](),await this[_0xe909c2(0x1f1)]();const _0x55cf90=await this['checkSyncStatus']();if(_0x55cf90){await this[_0xe909c2(0x1bf)][_0xe909c2(0x1de)](this[_0xe909c2(0x1c9)],'Completed'),await this[_0xe909c2(0x1f4)](_0xe909c2(0x1c7));return;}const _0x5e197=await this[_0xe909c2(0x1ee)](_0x28a974);this[_0xe909c2(0x20b)][_0xe909c2(0x217)]=this[_0xe909c2(0x217)],await this[_0xe909c2(0x20b)]['run'](_0x5e197),await this['flosumSync'][_0xe909c2(0x1de)](this[_0xe909c2(0x1c9)],_0xe909c2(0x1d5)),await this['updateLastCommit'](),await this[_0xe909c2(0x1f4)](_0xe909c2(0x1fe));}catch(_0x342e76){throw _0x342e76;}finally{await this[_0xe909c2(0x217)][_0xe909c2(0x1be)]();}}};SyncJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a147_0x5b1c19(0x1f8),[git_provider_manager_1[a147_0x5b1c19(0x1e2)],salesforce_sync_service_1[a147_0x5b1c19(0x208)],salesforce_service_1[a147_0x5b1c19(0x1d3)],commit_components_job_1[a147_0x5b1c19(0x1f2)]])],SyncJob),exports[a147_0x5b1c19(0x216)]=SyncJob;