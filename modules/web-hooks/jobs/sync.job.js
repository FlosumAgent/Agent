const a139_0x24fe=['408516pbXJbP','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','[SYNC]\x20[Repository:\x20','branchId','defineProperty','getCommitDto','[INFO]\x20Sync\x20job\x20done.','__esModule','CommitComponentsJob','encodeBase64','SalesforceService','test','catch','getOne',']\x20[Branch:\x20','length','175069VMSRfp','SyncJob','salesforceService','getBranchComponents','branches','lastCommit','../../../constants','259425DGLkVx','setStatus','design:paramtypes','[INFO]\x20Start\x20sync\x20job','gitUrl','repo','decorate','convertToSFDX','../../shared/utils','patchObject','object','[INFO]\x20Branch\x20synchronized.\x20Skip','../../shared/git-provider.manager','../../salesforce/services/salesforce-retriever.service','message','repositoryName','1ntHavn','branch','branchName','force','log','1AtbCVn','apply','run','commitJob','flosumSync','repository','updateLastCommit','./commit-components.job','typedi','DEFAULT_GIT_USER_NAME','getRepoService','sfLogger','checkSyncStatus','retriever','stringify','gitManager','syncData','getAttachmentIdByParent','311pcdbHT','remoteState','sha','getComponentsFromRepository','Attachment','remoteStateAttachmentId','function','constructor','create','repoService','getComponentIds','../../salesforce/services/salesforce-sync.service','setLoggerId','929enJdWW','155DuKNVu','In\x20Progress','Completed','createBranchIfNotExists','343304kfqMXm','767tvrvti','DEFAULT_GIT_USER_EMAIL','SalesforceRetrieverService','metadata','192822sLrSzQ','GitProviderManager','__metadata','objectId','createRepositoryIfNotExists'];const a139_0x2e02cf=a139_0x2674;(function(_0x3dfa70,_0x117c65){const _0x2a408d=a139_0x2674;while(!![]){try{const _0x29d054=-parseInt(_0x2a408d(0xbe))*-parseInt(_0x2a408d(0xea))+-parseInt(_0x2a408d(0xb5))*parseInt(_0x2a408d(0xba))+-parseInt(_0x2a408d(0xda))+-parseInt(_0x2a408d(0xc3))+parseInt(_0x2a408d(0xd3))+-parseInt(_0x2a408d(0xb4))*-parseInt(_0x2a408d(0x101))+parseInt(_0x2a408d(0xb9))*parseInt(_0x2a408d(0xef));if(_0x29d054===_0x117c65)break;else _0x3dfa70['push'](_0x3dfa70['shift']());}catch(_0x5178f7){_0x3dfa70['push'](_0x3dfa70['shift']());}}}(a139_0x24fe,0x34128));const a139_0x5980c3=function(){let _0x2af5a4=!![];return function(_0x14e994,_0x2feede){const _0x3bdb52=_0x2af5a4?function(){const _0x3b200a=a139_0x2674;if(_0x2feede){const _0x2e4199=_0x2feede[_0x3b200a(0xf0)](_0x14e994,arguments);return _0x2feede=null,_0x2e4199;}}:function(){};return _0x2af5a4=![],_0x3bdb52;};}(),a139_0x1059aa=a139_0x5980c3(this,function(){const _0x287975=function(){const _0x237337=a139_0x2674,_0x42c41b=_0x287975[_0x237337(0x108)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x237337(0x108)](_0x237337(0xc4));return!_0x42c41b[_0x237337(0xce)](a139_0x1059aa);};return _0x287975();});function a139_0x2674(_0x46db61,_0x1df772){return a139_0x2674=function(_0x31d3a2,_0x1059aa){_0x31d3a2=_0x31d3a2-0xaf;let _0x5980c3=a139_0x24fe[_0x31d3a2];return _0x5980c3;},a139_0x2674(_0x46db61,_0x1df772);}a139_0x1059aa();'use strict';var __decorate=this&&this['__decorate']||function(_0x30c453,_0x541f93,_0x5698ba,_0x4f253a){const _0x332a0d=a139_0x2674;var _0x5887ab=arguments[_0x332a0d(0xd2)],_0x1af729=_0x5887ab<0x3?_0x541f93:_0x4f253a===null?_0x4f253a=Object['getOwnPropertyDescriptor'](_0x541f93,_0x5698ba):_0x4f253a,_0x562530;if(typeof Reflect===_0x332a0d(0xe4)&&typeof Reflect[_0x332a0d(0xe0)]==='function')_0x1af729=Reflect[_0x332a0d(0xe0)](_0x30c453,_0x541f93,_0x5698ba,_0x4f253a);else{for(var _0x2c8c65=_0x30c453[_0x332a0d(0xd2)]-0x1;_0x2c8c65>=0x0;_0x2c8c65--)if(_0x562530=_0x30c453[_0x2c8c65])_0x1af729=(_0x5887ab<0x3?_0x562530(_0x1af729):_0x5887ab>0x3?_0x562530(_0x541f93,_0x5698ba,_0x1af729):_0x562530(_0x541f93,_0x5698ba))||_0x1af729;}return _0x5887ab>0x3&&_0x1af729&&Object[_0x332a0d(0xc7)](_0x541f93,_0x5698ba,_0x1af729),_0x1af729;},__metadata=this&&this[a139_0x2e02cf(0xc0)]||function(_0x173c54,_0x37e9a4){const _0x391452=a139_0x2e02cf;if(typeof Reflect==='object'&&typeof Reflect[_0x391452(0xbd)]===_0x391452(0x107))return Reflect[_0x391452(0xbd)](_0x173c54,_0x37e9a4);};Object['defineProperty'](exports,a139_0x2e02cf(0xca),{'value':!![]}),exports[a139_0x2e02cf(0xd4)]=void 0x0;const typedi_1=require(a139_0x2e02cf(0xf7)),constants_1=require(a139_0x2e02cf(0xd9)),salesforce_retriever_service_1=require(a139_0x2e02cf(0xe7)),salesforce_sync_service_1=require(a139_0x2e02cf(0xb2)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a139_0x2e02cf(0xe6)),utils_1=require(a139_0x2e02cf(0xe2)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require(a139_0x2e02cf(0xf6));let SyncJob=class SyncJob{constructor(_0x5b627b,_0x2912dd,_0x83881,_0x1a44dd){const _0x4e5927=a139_0x2e02cf;this[_0x4e5927(0xfe)]=_0x5b627b,this['flosumSync']=_0x2912dd,this['salesforceService']=_0x83881,this[_0x4e5927(0xf2)]=_0x1a44dd,this[_0x4e5927(0xb0)]=this['gitManager'][_0x4e5927(0xf9)](),_0x1a44dd[_0x4e5927(0xfc)]=new salesforce_retriever_service_1[(_0x4e5927(0xbc))](this[_0x4e5927(0xd5)]),_0x1a44dd['on'](_0x4e5927(0xee),_0xf38c6e=>this[_0x4e5927(0xfa)](_0xf38c6e));}async[a139_0x2e02cf(0xfa)](_0x52e1aa){const _0x1dfc74=a139_0x2e02cf;return this[_0x1dfc74(0xd5)]['sendLog'](_0x1dfc74(0xc5)+this[_0x1dfc74(0xff)][_0x1dfc74(0xe9)]+_0x1dfc74(0xd1)+this['syncData']['branchName']+']\x20'+_0x52e1aa);}async[a139_0x2e02cf(0xc2)](){const _0x53f616=a139_0x2e02cf;let _0x332840=await this['repoService'][_0x53f616(0xd0)](this[_0x53f616(0xff)]['repositoryName'])['catch'](()=>null);!_0x332840&&(_0x332840=await this['repoService'][_0x53f616(0xaf)]({'name':this['syncData'][_0x53f616(0xe9)],'autoInit':!![],'defaultBranch':this[_0x53f616(0xff)]['branchName'],'private':!![]})),this[_0x53f616(0xf4)]=_0x332840;}async[a139_0x2e02cf(0xb8)](){const _0x36c97a=a139_0x2e02cf;let _0xdccde0=await this[_0x36c97a(0xf4)]['branches']['getOne'](this[_0x36c97a(0xff)]['branchName'])[_0x36c97a(0xcf)](()=>null);!_0xdccde0&&(_0xdccde0=await this[_0x36c97a(0xf4)][_0x36c97a(0xd7)][_0x36c97a(0xaf)]({'name':this[_0x36c97a(0xff)][_0x36c97a(0xec)]})),this['branch']=_0xdccde0;}async[a139_0x2e02cf(0xb1)](){const _0x5cb61d=a139_0x2e02cf;return this[_0x5cb61d(0xff)]['repositoryId']?this['flosumSync'][_0x5cb61d(0x104)](this[_0x5cb61d(0xff)]['repositoryId']):this[_0x5cb61d(0xf3)][_0x5cb61d(0xd6)](this[_0x5cb61d(0xff)][_0x5cb61d(0xc6)]);}async[a139_0x2e02cf(0xc8)](_0x4a71f1){const _0xe89c7f=a139_0x2e02cf,_0x1d3c89=new commit_components_dto_1['CommitComponentsDto']();return _0x1d3c89[_0xe89c7f(0xe8)]='Sync\x20repository',_0x1d3c89['user']={'name':constants_1[_0xe89c7f(0xf8)],'email':constants_1[_0xe89c7f(0xbb)]},_0x1d3c89['componentsIds']=await this[_0xe89c7f(0xb1)](),_0x1d3c89[_0xe89c7f(0xe1)]=_0x4a71f1,_0x1d3c89[_0xe89c7f(0xdf)]=this['repository'],_0x1d3c89['branch']=this[_0xe89c7f(0xeb)],_0x1d3c89[_0xe89c7f(0xed)]=!![],_0x1d3c89;}async[a139_0x2e02cf(0xfb)](){const _0xc0c304=a139_0x2e02cf;this[_0xc0c304(0x106)]=await this['flosumSync'][_0xc0c304(0x100)](this[_0xc0c304(0xff)][_0xc0c304(0xc1)]),this[_0xc0c304(0x102)]=await this[_0xc0c304(0xd5)]['retrieveAttachment'](this[_0xc0c304(0x106)])['then'](_0x26a709=>typeof _0x26a709===_0xc0c304(0xe4)?_0x26a709:JSON['parse'](_0x26a709||'{}'))[_0xc0c304(0xcf)](()=>({}));if(this['remoteState'][this[_0xc0c304(0xf4)][_0xc0c304(0xde)]]){if(this[_0xc0c304(0x102)][this[_0xc0c304(0xf4)][_0xc0c304(0xde)]][_0xc0c304(0xd8)]===this['branch'][_0xc0c304(0x103)])return!![];}return![];}async[a139_0x2e02cf(0xf5)](){const _0x130e29=a139_0x2e02cf;var _0x108a09,_0x208875;const _0x4a639d=await this[_0x130e29(0xf4)]['branches'][_0x130e29(0xd0)](this[_0x130e29(0xeb)]['name']);await this['sfLogger']('[INFO]\x20Update\x20remote\x20state.'),(_0x108a09=this[_0x130e29(0x102)])[_0x208875=this[_0x130e29(0xf4)][_0x130e29(0xde)]]||(_0x108a09[_0x208875]={'lastCommit':''}),this['remoteState'][this[_0x130e29(0xf4)][_0x130e29(0xde)]]['lastCommit']=_0x4a639d[_0x130e29(0x103)],await this[_0x130e29(0xd5)][_0x130e29(0xe3)](_0x130e29(0x105),this[_0x130e29(0x106)],{'Body':utils_1[_0x130e29(0xcc)](JSON[_0x130e29(0xfd)](this[_0x130e29(0x102)]))});}async[a139_0x2e02cf(0xf1)](_0x3966b0,_0x30aedf,_0x5d2a55){const _0x5113d1=a139_0x2e02cf;this[_0x5113d1(0xff)]=_0x3966b0,this[_0x5113d1(0xd5)][_0x5113d1(0xb3)](_0x30aedf),await this[_0x5113d1(0xf3)][_0x5113d1(0xdb)](this['syncData'],_0x5113d1(0xb6)),await this['sfLogger'](_0x5113d1(0xdd)),await this['createRepositoryIfNotExists'](),await this[_0x5113d1(0xb8)]();const _0x5aa403=await this[_0x5113d1(0xfb)]();if(_0x5aa403){await this[_0x5113d1(0xf3)][_0x5113d1(0xdb)](this[_0x5113d1(0xff)],_0x5113d1(0xb7)),await this['sfLogger'](_0x5113d1(0xe5));return;}const _0x1767c2=await this['getCommitDto'](_0x5d2a55);await this['commitJob'][_0x5113d1(0xf1)](_0x1767c2),await this[_0x5113d1(0xf3)][_0x5113d1(0xdb)](this[_0x5113d1(0xff)],'Completed'),await this['updateLastCommit'](),await this[_0x5113d1(0xfa)](_0x5113d1(0xc9));}};SyncJob=__decorate([typedi_1['Service']({'transient':!![]}),__metadata(a139_0x2e02cf(0xdc),[git_provider_manager_1[a139_0x2e02cf(0xbf)],salesforce_sync_service_1['SalesforceSyncService'],salesforce_service_1[a139_0x2e02cf(0xcd)],commit_components_job_1[a139_0x2e02cf(0xcb)]])],SyncJob),exports[a139_0x2e02cf(0xd4)]=SyncJob;