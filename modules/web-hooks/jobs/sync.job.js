const a147_0x2d4b=['Attachment','message','parse','logger','6wQQLRC','1680189QfRfoi','length','../../shared/git-provider.manager','22622YNWNAu','getOwnPropertyDescriptor','name','repository','remoteState','remoteStateAttachmentId','create','design:paramtypes','run','Completed','getRepoService','repositoryName','syncData','../../shared/utils','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','getComponentIds','2571131esImbo','repoService','createBranchIfNotExists','checkSyncStatus','Service','typedi','getAttachmentId','then','return\x20/\x22\x20+\x20this\x20+\x20\x22/','__decorate','484333BRxYQf','SyncJob','1490492GUMRwu','object','615128fnoQCn','send','gitUrl','branch','../../salesforce/services/salesforce-sync.service','[INFO]\x20Sync\x20job\x20done.','1209277YQcPYV','__metadata','defineProperty','createRepositoryIfNotExists','commitJob','catch','getBranchComponents','1YtKzww','getComponents','force',']\x20[Branch:\x20','SalesforceRetrieverService','getOne','test','setStatus','components',']\x20[Repository:\x20','CommitComponentsDto','flosumSync','DEFAULT_GIT_USER_EMAIL','retrieveAttachment','provider','getLogger','function','branches','../../salesforce/services/salesforce-retriever.service','log','salesforceService','1BYkCSE','getComponentsFromRepository','../../../constants','convertToSFDX','getCommitDto','constructor','branchName','decorate','sha','updateLastCommit','SalesforceSyncService','CommitComponentsJob','SalesforceService','1FXGXFb','branchId','stringify','metadata','In\x20Progress'];const a147_0x3b59df=a147_0x58c9;(function(_0x53195d,_0x4a96a9){const _0x14e0b1=a147_0x58c9;while(!![]){try{const _0x4c1ab8=-parseInt(_0x14e0b1(0x1f6))+parseInt(_0x14e0b1(0x215))+-parseInt(_0x14e0b1(0x1f5))*parseInt(_0x14e0b1(0x1f9))+-parseInt(_0x14e0b1(0x21d))*parseInt(_0x14e0b1(0x1ec))+-parseInt(_0x14e0b1(0x1ca))*parseInt(_0x14e0b1(0x217))+-parseInt(_0x14e0b1(0x1df))*-parseInt(_0x14e0b1(0x213))+parseInt(_0x14e0b1(0x209));if(_0x4c1ab8===_0x4a96a9)break;else _0x53195d['push'](_0x53195d['shift']());}catch(_0x1ecbbe){_0x53195d['push'](_0x53195d['shift']());}}}(a147_0x2d4b,0xdd19e));const a147_0x514880=function(){let _0x412939=!![];return function(_0x319142,_0x2f3da5){const _0x225024=_0x412939?function(){if(_0x2f3da5){const _0x33ee9d=_0x2f3da5['apply'](_0x319142,arguments);return _0x2f3da5=null,_0x33ee9d;}}:function(){};return _0x412939=![],_0x225024;};}(),a147_0x13afbd=a147_0x514880(this,function(){const _0x5746a8=function(){const _0x1bdef4=a147_0x58c9,_0x31ca2b=_0x5746a8[_0x1bdef4(0x1e4)](_0x1bdef4(0x211))()[_0x1bdef4(0x1e4)](_0x1bdef4(0x207));return!_0x31ca2b[_0x1bdef4(0x1d0)](a147_0x13afbd);};return _0x5746a8();});a147_0x13afbd();'use strict';var __decorate=this&&this[a147_0x3b59df(0x212)]||function(_0x3fb36f,_0x534c78,_0x1d1d7b,_0x3f1bbc){const _0x5e1e52=a147_0x3b59df;var _0x362058=arguments[_0x5e1e52(0x1f7)],_0x36b3b9=_0x362058<0x3?_0x534c78:_0x3f1bbc===null?_0x3f1bbc=Object[_0x5e1e52(0x1fa)](_0x534c78,_0x1d1d7b):_0x3f1bbc,_0x4fd112;if(typeof Reflect===_0x5e1e52(0x216)&&typeof Reflect[_0x5e1e52(0x1e6)]===_0x5e1e52(0x1da))_0x36b3b9=Reflect['decorate'](_0x3fb36f,_0x534c78,_0x1d1d7b,_0x3f1bbc);else{for(var _0x5ca5b0=_0x3fb36f[_0x5e1e52(0x1f7)]-0x1;_0x5ca5b0>=0x0;_0x5ca5b0--)if(_0x4fd112=_0x3fb36f[_0x5ca5b0])_0x36b3b9=(_0x362058<0x3?_0x4fd112(_0x36b3b9):_0x362058>0x3?_0x4fd112(_0x534c78,_0x1d1d7b,_0x36b3b9):_0x4fd112(_0x534c78,_0x1d1d7b))||_0x36b3b9;}return _0x362058>0x3&&_0x36b3b9&&Object[_0x5e1e52(0x1c5)](_0x534c78,_0x1d1d7b,_0x36b3b9),_0x36b3b9;},__metadata=this&&this[a147_0x3b59df(0x1c4)]||function(_0x440ea1,_0x3727f1){const _0x5ac1c3=a147_0x3b59df;if(typeof Reflect===_0x5ac1c3(0x216)&&typeof Reflect[_0x5ac1c3(0x1ef)]==='function')return Reflect[_0x5ac1c3(0x1ef)](_0x440ea1,_0x3727f1);};Object['defineProperty'](exports,'__esModule',{'value':!![]}),exports[a147_0x3b59df(0x214)]=void 0x0;const typedi_1=require(a147_0x3b59df(0x20e)),constants_1=require(a147_0x3b59df(0x1e1)),salesforce_retriever_service_1=require(a147_0x3b59df(0x1dc)),salesforce_sync_service_1=require(a147_0x3b59df(0x21b)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a147_0x3b59df(0x1f8)),utils_1=require(a147_0x3b59df(0x206)),commit_components_dto_1=require('../dto/commit-components.dto'),commit_components_job_1=require('./commit-components.job');let SyncJob=class SyncJob{constructor(_0x16c9f0,_0x38b703,_0x1639d0,_0x4b5753){const _0x3733e1=a147_0x3b59df;this['gitManager']=_0x16c9f0,this[_0x3733e1(0x1d5)]=_0x38b703,this[_0x3733e1(0x1de)]=_0x1639d0,this[_0x3733e1(0x1c7)]=_0x4b5753,this['repoService']=this['gitManager'][_0x3733e1(0x203)]();}async['log'](_0x345dca){const _0x5eeccf=a147_0x3b59df;return this[_0x5eeccf(0x1f4)][_0x5eeccf(0x1dd)]('[SYNC]\x20['+this['gitManager'][_0x5eeccf(0x1d8)]['toUpperCase']()+_0x5eeccf(0x1d3)+this[_0x5eeccf(0x205)][_0x5eeccf(0x204)]+_0x5eeccf(0x1cd)+this[_0x5eeccf(0x205)][_0x5eeccf(0x1e5)]+']\x20'+_0x345dca);}async[a147_0x3b59df(0x1c6)](){const _0x251d52=a147_0x3b59df;let _0x423338=await this[_0x251d52(0x20a)][_0x251d52(0x1cf)](this[_0x251d52(0x205)][_0x251d52(0x204)])[_0x251d52(0x1c8)](()=>null);!_0x423338&&(_0x423338=await this[_0x251d52(0x20a)][_0x251d52(0x1ff)]({'name':this['syncData']['repositoryName'],'autoInit':!![],'defaultBranch':this[_0x251d52(0x205)]['branchName'],'private':!![]})),this['repository']=_0x423338;}async['createBranchIfNotExists'](){const _0x25c341=a147_0x3b59df;let _0x16397f=await this[_0x25c341(0x1fc)][_0x25c341(0x1db)][_0x25c341(0x1cf)](this[_0x25c341(0x205)]['branchName'])[_0x25c341(0x1c8)](()=>null);!_0x16397f&&(_0x16397f=await this[_0x25c341(0x1fc)]['branches'][_0x25c341(0x1ff)]({'name':this[_0x25c341(0x205)][_0x25c341(0x1e5)]})),this[_0x25c341(0x21a)]=_0x16397f;}async['getComponentIds'](){const _0x20faf9=a147_0x3b59df;return this[_0x20faf9(0x205)]['repositoryId']?this[_0x20faf9(0x1d5)][_0x20faf9(0x1e0)](this['syncData']['repositoryId']):this['flosumSync'][_0x20faf9(0x1c9)](this[_0x20faf9(0x205)][_0x20faf9(0x1ed)]);}async[a147_0x3b59df(0x1cb)](){const _0x1e691f=a147_0x3b59df,_0x1aa7d8=await this[_0x1e691f(0x208)](),_0x2cf773=new salesforce_retriever_service_1[(_0x1e691f(0x1ce))](this[_0x1e691f(0x1de)]),_0xc67f2e=await _0x2cf773[_0x1e691f(0x201)](_0x1aa7d8);return _0xc67f2e;}async['getCommitDto'](_0x58518b){const _0x43f376=a147_0x3b59df,_0x16b629=new commit_components_dto_1[(_0x43f376(0x1d4))]();return _0x16b629[_0x43f376(0x1f2)]='Sync\x20repository',_0x16b629['user']={'name':constants_1['DEFAULT_GIT_USER_NAME'],'email':constants_1[_0x43f376(0x1d6)]},_0x16b629[_0x43f376(0x1d2)]={'writed':await this[_0x43f376(0x1cb)]()},_0x16b629[_0x43f376(0x1e2)]=_0x58518b,_0x16b629['repo']=this[_0x43f376(0x1fc)],_0x16b629[_0x43f376(0x21a)]=this[_0x43f376(0x21a)],_0x16b629[_0x43f376(0x1cc)]=!![],_0x16b629;}async[a147_0x3b59df(0x20c)](){const _0x4f9d8a=a147_0x3b59df;this[_0x4f9d8a(0x1fe)]=await this['flosumSync'][_0x4f9d8a(0x20f)](this[_0x4f9d8a(0x205)]),this[_0x4f9d8a(0x1fd)]=await this['salesforceService'][_0x4f9d8a(0x1d7)](this['remoteStateAttachmentId'])[_0x4f9d8a(0x210)](_0xc2c0d8=>typeof _0xc2c0d8===_0x4f9d8a(0x216)?_0xc2c0d8:JSON[_0x4f9d8a(0x1f3)](_0xc2c0d8||'{}'))[_0x4f9d8a(0x1c8)](()=>({}));if(this[_0x4f9d8a(0x1fd)][this[_0x4f9d8a(0x1fc)]['gitUrl']]){if(this[_0x4f9d8a(0x1fd)][this[_0x4f9d8a(0x1fc)][_0x4f9d8a(0x219)]]['lastCommit']===this[_0x4f9d8a(0x21a)][_0x4f9d8a(0x1e7)])return!![];}return![];}async[a147_0x3b59df(0x1e8)](){const _0x338918=a147_0x3b59df,_0x3b3a72=await this['repository'][_0x338918(0x1db)][_0x338918(0x1cf)](this[_0x338918(0x21a)][_0x338918(0x1fb)]);await this['log']('[INFO]\x20Update\x20remote\x20state.'),this[_0x338918(0x1fd)]={[this[_0x338918(0x1fc)][_0x338918(0x219)]]:{'lastCommit':_0x3b3a72[_0x338918(0x1e7)]}},await this[_0x338918(0x1de)]['patchObject'](_0x338918(0x1f1),this[_0x338918(0x1fe)],{'Body':utils_1['encodeBase64'](JSON[_0x338918(0x1ee)](this[_0x338918(0x1fd)]))});}async[a147_0x3b59df(0x201)](_0x444207,_0x188273,_0xad1734){const _0x210c4b=a147_0x3b59df;this['syncData']=_0x444207,this[_0x210c4b(0x1de)]['setLoggerId'](_0x188273),this[_0x210c4b(0x1f4)]=this[_0x210c4b(0x1de)][_0x210c4b(0x1d9)]();try{await this[_0x210c4b(0x1d5)][_0x210c4b(0x1d1)](this[_0x210c4b(0x205)],_0x210c4b(0x1f0)),await this[_0x210c4b(0x1dd)]('[INFO]\x20Start\x20sync\x20job'),await this[_0x210c4b(0x1c6)](),await this[_0x210c4b(0x20b)]();const _0x49651f=await this[_0x210c4b(0x20c)]();if(_0x49651f){await this[_0x210c4b(0x1d5)]['setStatus'](this[_0x210c4b(0x205)],_0x210c4b(0x202)),await this['log']('[INFO]\x20Branch\x20synchronized.\x20Skip');return;}const _0x52380f=await this[_0x210c4b(0x1e3)](_0xad1734);this[_0x210c4b(0x1c7)][_0x210c4b(0x1f4)]=this[_0x210c4b(0x1f4)],await this[_0x210c4b(0x1c7)][_0x210c4b(0x201)](_0x52380f),await this[_0x210c4b(0x1d5)]['setStatus'](this[_0x210c4b(0x205)],_0x210c4b(0x202)),await this[_0x210c4b(0x1e8)](),await this[_0x210c4b(0x1dd)](_0x210c4b(0x21c));}catch(_0x556452){throw _0x556452;}finally{await this[_0x210c4b(0x1f4)][_0x210c4b(0x218)]();}}};function a147_0x58c9(_0x54294f,_0x3448ac){return a147_0x58c9=function(_0x282013,_0x13afbd){_0x282013=_0x282013-0x1c4;let _0x514880=a147_0x2d4b[_0x282013];return _0x514880;},a147_0x58c9(_0x54294f,_0x3448ac);}SyncJob=__decorate([typedi_1[a147_0x3b59df(0x20d)]({'transient':!![]}),__metadata(a147_0x3b59df(0x200),[git_provider_manager_1['GitProviderManager'],salesforce_sync_service_1[a147_0x3b59df(0x1e9)],salesforce_service_1[a147_0x3b59df(0x1eb)],commit_components_job_1[a147_0x3b59df(0x1ea)]])],SyncJob),exports[a147_0x3b59df(0x214)]=SyncJob;