const a186_0x48a47d=a186_0x3eeb;(function(_0x4cee6d,_0x286520){const _0x2fb54f=a186_0x3eeb,_0x2dd257=_0x4cee6d();while(!![]){try{const _0x105670=-parseInt(_0x2fb54f(0x161))/0x1+-parseInt(_0x2fb54f(0x156))/0x2+parseInt(_0x2fb54f(0x19b))/0x3+parseInt(_0x2fb54f(0x17f))/0x4*(parseInt(_0x2fb54f(0x18d))/0x5)+parseInt(_0x2fb54f(0x144))/0x6+parseInt(_0x2fb54f(0x13a))/0x7*(parseInt(_0x2fb54f(0x150))/0x8)+parseInt(_0x2fb54f(0x199))/0x9*(-parseInt(_0x2fb54f(0x180))/0xa);if(_0x105670===_0x286520)break;else _0x2dd257['push'](_0x2dd257['shift']());}catch(_0x1c220d){_0x2dd257['push'](_0x2dd257['shift']());}}}(a186_0x3a89,0x6e2e2));function a186_0x3a89(){const _0x28c44c=['10SpDHNg','find','SalesforceLogger2','getHookLinkFor','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','\x27\x20-\x20\x27','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repositoryId','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','branchId','sfLogger','default',']\x20due\x20error\x20-\x20','2510ylbDCq','SalesforceSyncService','Error','create','../../../constants','../../salesforce/services/salesforce-sync.service','syncID','__importStar','log','../../../core','catch','getAll','10276452oghddT','call','1057065VAlCko','Service','../../shared/utils','repositoryName','have\x20to\x20synchronize\x20%d\x20branches','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','toLowerCase','__metadata','url','logger','error','toUpperCase','\x27\x20in\x20repository\x20\x27','7hdvmoB','Unable\x20to\x20synchronize\x20repository\x20\x27','test','../jobs/flosum-sync.job','SalesforceError','REPOSITORY_NAME_REGEXP','salesforceSync','salesforceService','isIntersects','getOwnPropertyDescriptor','4533576PnUqTG','search','__esModule','checkValidNaming','../../hooks/hooks.utils','hooks','all','Logger','design:paramtypes','../../salesforce/services/salesforce-logger-v2.service','length','hasOwnProperty','6883048KqICHL','[INFO]\x20Start\x20sync\x20job','Waiting','send','HooksUtils','name','823726sVjfoV','handleRecordSyncError','push','apply','setStatus','createHookPayload','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','syncDto','metadata','getBranchRecords','updateRemoteState','315245FaGolZ','TooManyRequests','convertToSFDX','../../salesforce/dto/flosum-repository-sync.dto','setLoggerId','SyncService','getOrCreateRepo','toString','defineProperty','repoList','direction','prototype','repoService','decorate','get','repositoriesIntersections','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','sleep','FlosumToGit','[INFO]\x20Sync\x20job\x20done.','constructor','function','GitProviderManager','run','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','\x27\x20[','[INFO]\x20Repository\x20\x22','object','(((.+)+)+)+$','branchName','2804BZwWiN'];a186_0x3a89=function(){return _0x28c44c;};return a186_0x3a89();}const a186_0x12dce0=function(){let _0x290770=!![];return function(_0x47d3f0,_0x35daea){const _0x1f06fc=_0x290770?function(){const _0x383efe=a186_0x3eeb;if(_0x35daea){const _0x191c7f=_0x35daea[_0x383efe(0x159)](_0x47d3f0,arguments);return _0x35daea=null,_0x191c7f;}}:function(){};return _0x290770=![],_0x1f06fc;};}(),a186_0x19dc51=a186_0x12dce0(this,function(){const _0x55a25e=a186_0x3eeb;return a186_0x19dc51['toString']()[_0x55a25e(0x145)](_0x55a25e(0x17d))[_0x55a25e(0x168)]()[_0x55a25e(0x175)](a186_0x19dc51)[_0x55a25e(0x145)](_0x55a25e(0x17d));});a186_0x19dc51();function a186_0x3eeb(_0x34cc61,_0x258840){const _0x239556=a186_0x3a89();return a186_0x3eeb=function(_0x19dc51,_0x12dce0){_0x19dc51=_0x19dc51-0x137;let _0x3a89bb=_0x239556[_0x19dc51];return _0x3a89bb;},a186_0x3eeb(_0x34cc61,_0x258840);}'use strict';var __createBinding=this&&this['__createBinding']||(Object[a186_0x48a47d(0x190)]?function(_0x436e43,_0x3fa1b1,_0x2483ba,_0x532fe1){const _0x6ba27c=a186_0x48a47d;if(_0x532fe1===undefined)_0x532fe1=_0x2483ba;Object[_0x6ba27c(0x169)](_0x436e43,_0x532fe1,{'enumerable':!![],'get':function(){return _0x3fa1b1[_0x2483ba];}});}:function(_0x2a8d59,_0x3386dd,_0x54543d,_0x5127bd){if(_0x5127bd===undefined)_0x5127bd=_0x54543d;_0x2a8d59[_0x5127bd]=_0x3386dd[_0x54543d];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a186_0x48a47d(0x190)]?function(_0x4279bc,_0x4580b9){const _0x1fb4d1=a186_0x48a47d;Object[_0x1fb4d1(0x169)](_0x4279bc,_0x1fb4d1(0x18b),{'enumerable':!![],'value':_0x4580b9});}:function(_0x1cbc07,_0x40a241){const _0x1ab4f0=a186_0x48a47d;_0x1cbc07[_0x1ab4f0(0x18b)]=_0x40a241;}),__decorate=this&&this['__decorate']||function(_0x1bd0a8,_0x43f8a4,_0x2d84b5,_0x44724e){const _0x530b0e=a186_0x48a47d;var _0x1433b9=arguments[_0x530b0e(0x14e)],_0x116075=_0x1433b9<0x3?_0x43f8a4:_0x44724e===null?_0x44724e=Object[_0x530b0e(0x143)](_0x43f8a4,_0x2d84b5):_0x44724e,_0x5aa4f1;if(typeof Reflect===_0x530b0e(0x17c)&&typeof Reflect[_0x530b0e(0x16e)]===_0x530b0e(0x176))_0x116075=Reflect[_0x530b0e(0x16e)](_0x1bd0a8,_0x43f8a4,_0x2d84b5,_0x44724e);else{for(var _0x18e5d3=_0x1bd0a8[_0x530b0e(0x14e)]-0x1;_0x18e5d3>=0x0;_0x18e5d3--)if(_0x5aa4f1=_0x1bd0a8[_0x18e5d3])_0x116075=(_0x1433b9<0x3?_0x5aa4f1(_0x116075):_0x1433b9>0x3?_0x5aa4f1(_0x43f8a4,_0x2d84b5,_0x116075):_0x5aa4f1(_0x43f8a4,_0x2d84b5))||_0x116075;}return _0x1433b9>0x3&&_0x116075&&Object['defineProperty'](_0x43f8a4,_0x2d84b5,_0x116075),_0x116075;},__importStar=this&&this[a186_0x48a47d(0x194)]||function(_0x2b0320){const _0x51358c=a186_0x48a47d;if(_0x2b0320&&_0x2b0320['__esModule'])return _0x2b0320;var _0x18937a={};if(_0x2b0320!=null){for(var _0x5d6002 in _0x2b0320)if(_0x5d6002!==_0x51358c(0x18b)&&Object[_0x51358c(0x16c)][_0x51358c(0x14f)][_0x51358c(0x19a)](_0x2b0320,_0x5d6002))__createBinding(_0x18937a,_0x2b0320,_0x5d6002);}return __setModuleDefault(_0x18937a,_0x2b0320),_0x18937a;},__metadata=this&&this[a186_0x48a47d(0x1a2)]||function(_0x47cb78,_0x2033f8){const _0x41b94b=a186_0x48a47d;if(typeof Reflect===_0x41b94b(0x17c)&&typeof Reflect[_0x41b94b(0x15e)]===_0x41b94b(0x176))return Reflect[_0x41b94b(0x15e)](_0x47cb78,_0x2033f8);},SyncService_1;Object['defineProperty'](exports,a186_0x48a47d(0x146),{'value':!![]}),exports[a186_0x48a47d(0x166)]=void 0x0;const constants_1=require(a186_0x48a47d(0x191)),core_1=require(a186_0x48a47d(0x196)),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require(a186_0x48a47d(0x164)),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a186_0x48a47d(0x14d)),salesforce_sync_service_1=require(a186_0x48a47d(0x192)),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require('../../shared/git-provider.manager'),utils_1=require(a186_0x48a47d(0x19d)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a186_0x48a47d(0x148)),flosum_sync_job_1=require(a186_0x48a47d(0x13d)),git_sync_job_1=require('../jobs/git-sync.job');let SyncService=SyncService_1=class SyncService{constructor(_0x4870f6,_0x2bdaa5,_0x4a5a05){const _0x7ec3cc=a186_0x48a47d;this[_0x7ec3cc(0x141)]=_0x4870f6,this[_0x7ec3cc(0x140)]=_0x2bdaa5,this['gitManager']=_0x4a5a05,this[_0x7ec3cc(0x1a4)]=new core_1[(_0x7ec3cc(0x14b))](SyncService_1[_0x7ec3cc(0x155)]),this['repositoriesIntersections']={},this['repoList']=[];}async[a186_0x48a47d(0x157)](_0x37ff37,_0x20a2b7){const _0x1f82da=a186_0x48a47d;if(_0x20a2b7 instanceof too_many_requests_error_1[_0x1f82da(0x162)]){await this[_0x1f82da(0x140)]['setStatus'](_0x37ff37,_0x1f82da(0x152));throw _0x20a2b7;}try{await this[_0x1f82da(0x18a)][_0x1f82da(0x195)](_0x1f82da(0x184)+_0x37ff37[_0x1f82da(0x19e)]+_0x1f82da(0x17a)+_0x37ff37[_0x1f82da(0x17e)]+_0x1f82da(0x18c)+_0x20a2b7)[_0x1f82da(0x153)](),await this['salesforceSync'][_0x1f82da(0x160)](_0x37ff37,{}),await this[_0x1f82da(0x140)][_0x1f82da(0x15a)](_0x37ff37,_0x1f82da(0x18f));}catch(_0x456044){if(_0x456044 instanceof salesforce_error_1[_0x1f82da(0x13e)])throw _0x456044;}}async[a186_0x48a47d(0x142)](_0x3a8835){const _0x551dc5=a186_0x48a47d;if(_0x3a8835[_0x551dc5(0x187)]){const _0x2ba79b=_0x3a8835[_0x551dc5(0x19e)][_0x551dc5(0x1a1)](),_0x154999=this['repositoriesIntersections'][_0x2ba79b];if(!_0x154999)this[_0x551dc5(0x170)][_0x2ba79b]=_0x3a8835[_0x551dc5(0x19e)];else{if(_0x154999&&_0x154999!==_0x3a8835['repositoryName'])return await this[_0x551dc5(0x157)](_0x3a8835,new Error(_0x551dc5(0x13b)+_0x3a8835[_0x551dc5(0x19e)]+_0x551dc5(0x15c)+_0x2ba79b+_0x551dc5(0x185)+_0x154999+'\x27')),!![];}}return![];}async[a186_0x48a47d(0x147)](_0x3417e3){const _0x5d4856=a186_0x48a47d;if(!constants_1[_0x5d4856(0x13f)]['test'](_0x3417e3['repositoryName']))return await this['handleRecordSyncError'](_0x3417e3,new Error(_0x5d4856(0x13b)+_0x3417e3[_0x5d4856(0x19e)]+_0x5d4856(0x186))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x5d4856(0x13c)](_0x3417e3['branchName']))return await this['handleRecordSyncError'](_0x3417e3,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x3417e3[_0x5d4856(0x17e)]+_0x5d4856(0x139)+_0x3417e3['repositoryName']+_0x5d4856(0x1a0))),![];return!![];}async[a186_0x48a47d(0x167)](_0x2fdd43,_0x466106,_0xa127a4){const _0x4b2fe6=a186_0x48a47d;let _0x3adb1=this[_0x4b2fe6(0x16a)][_0x4b2fe6(0x181)](_0x26de54=>_0x2fdd43[_0x4b2fe6(0x19e)]===_0x26de54[_0x4b2fe6(0x155)]);!_0x3adb1&&(this[_0x4b2fe6(0x18a)][_0x4b2fe6(0x195)](_0x4b2fe6(0x17b)+_0x2fdd43['repositoryName']+_0x4b2fe6(0x179)),_0x3adb1=await this[_0x4b2fe6(0x16d)][_0x4b2fe6(0x190)]({'name':_0x2fdd43[_0x4b2fe6(0x19e)],'autoInit':!![],'defaultBranch':_0x2fdd43[_0x4b2fe6(0x17e)],'private':!![],'createHook':this[_0x4b2fe6(0x15d)]['createHooks']}));if(this['syncDto']['createHooks']){const _0x56397f=await _0x3adb1[_0x4b2fe6(0x149)][_0x4b2fe6(0x198)]();!_0x56397f[_0x4b2fe6(0x181)](_0x5df53c=>_0x5df53c[_0x4b2fe6(0x1a3)]===hooks_utils_1[_0x4b2fe6(0x154)][_0x4b2fe6(0x183)](_0x466106,_0xa127a4))&&(this[_0x4b2fe6(0x18a)][_0x4b2fe6(0x195)](_0x4b2fe6(0x17b)+_0x2fdd43[_0x4b2fe6(0x19e)]+'\x22\x20does\x20not\x20has\x20the\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.'),await _0x3adb1['hooks']['create'](hooks_utils_1[_0x4b2fe6(0x154)][_0x4b2fe6(0x15b)](_0x466106,_0x3adb1['hooks'],_0xa127a4)));}return this[_0x4b2fe6(0x16a)][_0x4b2fe6(0x158)](_0x3adb1),_0x3adb1;}async[a186_0x48a47d(0x178)](_0x4d13ef,_0x107003,_0xb0692,_0x1d2342){const _0x3472f9=a186_0x48a47d;this[_0x3472f9(0x141)][_0x3472f9(0x165)](_0x107003),this['repoService']=this['gitManager']['getRepoService'](_0xb0692),this['sfLogger']=new salesforce_logger_v2_service_1[(_0x3472f9(0x182))](_0x107003,'['+SyncService_1[_0x3472f9(0x155)]+']\x20['+_0xb0692[_0x3472f9(0x138)]()+']'),this[_0x3472f9(0x15d)]=_0x4d13ef;try{await this[_0x3472f9(0x18a)][_0x3472f9(0x195)](_0x3472f9(0x151))['send']();const [_0x440e76,_0x190d39]=await Promise[_0x3472f9(0x14a)]([this[_0x3472f9(0x140)][_0x3472f9(0x15f)](),this[_0x3472f9(0x140)]['getRepositoryRecords']()]);this['repoList']=await this[_0x3472f9(0x16d)][_0x3472f9(0x198)]();const _0x2710e1=[..._0x190d39,..._0x440e76];this[_0x3472f9(0x1a4)]['log'](_0x3472f9(0x19f),_0x2710e1[_0x3472f9(0x14e)]);for(const _0x2913b5 of _0x2710e1){this['logger'][_0x3472f9(0x195)](_0x3472f9(0x188),_0x2913b5[_0x3472f9(0x19e)],_0x2913b5[_0x3472f9(0x187)],_0x2913b5[_0x3472f9(0x17e)],_0x2913b5[_0x3472f9(0x189)]);const _0x2c5bee=await this[_0x3472f9(0x147)](_0x2913b5);if(!_0x2c5bee)continue;const _0x317511=await this[_0x3472f9(0x142)](_0x2913b5);if(_0x317511)continue;let _0x17ef99;try{_0x17ef99=await this[_0x3472f9(0x167)](_0x2913b5,_0xb0692,_0x1d2342);}catch(_0x1e5f17){await this[_0x3472f9(0x157)](_0x2913b5,_0x1e5f17 instanceof too_many_requests_error_1['TooManyRequests']?_0x1e5f17:new Error(_0x3472f9(0x171)+_0x1e5f17));continue;}if(_0x2913b5[_0x3472f9(0x16b)]===flosum_repository_sync_dto_1['SyncDirection'][_0x3472f9(0x173)]){const _0x210c0b=typedi_1[_0x3472f9(0x18b)][_0x3472f9(0x16f)](flosum_sync_job_1['FlosumSyncJob']);await _0x210c0b[_0x3472f9(0x178)]({'repository':_0x17ef99,'convertToSFDX':_0x4d13ef[_0x3472f9(0x163)],'syncRecord':_0x2913b5,'provider':_0xb0692,'logger':this[_0x3472f9(0x18a)]})[_0x3472f9(0x197)](_0x1a2a59=>this[_0x3472f9(0x157)](_0x2913b5,_0x1a2a59));}else{const _0x26a975=typedi_1['default'][_0x3472f9(0x16f)](git_sync_job_1['GitSyncJob']);await _0x26a975[_0x3472f9(0x178)]({'repository':_0x17ef99,'branch':_0x2913b5[_0x3472f9(0x17e)],'provider':_0xb0692,'repositoryGit':_0x17ef99['gitUrl'],'syncRecord':_0x2913b5,'logger':this['sfLogger']})[_0x3472f9(0x197)](_0x373fa6=>this['handleRecordSyncError'](_0x2913b5,_0x373fa6));}}}catch(_0x287b5a){this[_0x3472f9(0x1a4)][_0x3472f9(0x137)](_0x287b5a);_0x287b5a instanceof too_many_requests_error_1[_0x3472f9(0x162)]?(await this[_0x3472f9(0x18a)][_0x3472f9(0x195)]('[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.')[_0x3472f9(0x153)](),await utils_1[_0x3472f9(0x172)](0x3c*0x3c*0x3e8),this['run'](_0x4d13ef,_0x107003,_0xb0692,_0x1d2342)):await this[_0x3472f9(0x18a)][_0x3472f9(0x195)]('[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'+_0x287b5a)[_0x3472f9(0x153)]();return;}await this[_0x3472f9(0x18a)]['log'](_0x3472f9(0x174))['send'](),await this[_0x3472f9(0x140)]['disableSync'](_0x4d13ef[_0x3472f9(0x193)])[_0x3472f9(0x197)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a186_0x48a47d(0x19c)]({'transient':!![]}),__metadata(a186_0x48a47d(0x14c),[salesforce_service_1['SalesforceService'],salesforce_sync_service_1[a186_0x48a47d(0x18e)],git_provider_manager_1[a186_0x48a47d(0x177)]])],SyncService),exports[a186_0x48a47d(0x166)]=SyncService;