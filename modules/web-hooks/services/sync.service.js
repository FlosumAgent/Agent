const a182_0x5a6ca6=a182_0x2576;function a182_0x2576(_0x3c2031,_0x39e095){const _0x3212e7=a182_0x3b9e();return a182_0x2576=function(_0x312d3a,_0x10875f){_0x312d3a=_0x312d3a-0x1cd;let _0x3b9e2b=_0x3212e7[_0x312d3a];return _0x3b9e2b;},a182_0x2576(_0x3c2031,_0x39e095);}(function(_0x4ebf6d,_0x1d2f38){const _0x2c54e1=a182_0x2576,_0x3be729=_0x4ebf6d();while(!![]){try{const _0xec8a76=parseInt(_0x2c54e1(0x1e6))/0x1+parseInt(_0x2c54e1(0x22b))/0x2+-parseInt(_0x2c54e1(0x1fe))/0x3+-parseInt(_0x2c54e1(0x1db))/0x4*(-parseInt(_0x2c54e1(0x22c))/0x5)+parseInt(_0x2c54e1(0x1dd))/0x6+parseInt(_0x2c54e1(0x1de))/0x7*(-parseInt(_0x2c54e1(0x213))/0x8)+-parseInt(_0x2c54e1(0x1eb))/0x9*(parseInt(_0x2c54e1(0x1d1))/0xa);if(_0xec8a76===_0x1d2f38)break;else _0x3be729['push'](_0x3be729['shift']());}catch(_0x367a3f){_0x3be729['push'](_0x3be729['shift']());}}}(a182_0x3b9e,0xb212a));const a182_0x10875f=function(){let _0x21baa8=!![];return function(_0x4e8d72,_0x2d227b){const _0x3c63c8=_0x21baa8?function(){const _0x258a02=a182_0x2576;if(_0x2d227b){const _0x514b0e=_0x2d227b[_0x258a02(0x1f9)](_0x4e8d72,arguments);return _0x2d227b=null,_0x514b0e;}}:function(){};return _0x21baa8=![],_0x3c63c8;};}(),a182_0x312d3a=a182_0x10875f(this,function(){const _0x3cf5a3=a182_0x2576;return a182_0x312d3a[_0x3cf5a3(0x20f)]()['search'](_0x3cf5a3(0x1cf))[_0x3cf5a3(0x20f)]()[_0x3cf5a3(0x232)](a182_0x312d3a)[_0x3cf5a3(0x21a)](_0x3cf5a3(0x1cf));});a182_0x312d3a();'use strict';function a182_0x3b9e(){const _0x2b355c=['BRANCH_NAME_REGEXP','send','../../shared/git-provider.manager','1361818YuvskR','23485vNsdOz','default','repositoryId','FlosumSyncJob','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','salesforceService','constructor','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','../../../core/errors/too-many-requests.error','salesforceSync','push','Waiting','syncID','log','metadata','test','(((.+)+)+)+$','prototype','3020KloTTF','isIntersects','GitSyncJob','Service','[SYNC]\x20[','direction','Logger','../../shared/utils','setLoggerId','[INFO]\x20Sync\x20job\x20done.','1076valkhF','get','3695154xbcdfX','1652SoCAQh','find','repositoriesIntersections','\x27\x20in\x20repository\x20\x27','GitProviderManager','have\x20to\x20synchronize\x20%d\x20branches','disableSync','setStatus','512890CTusHh','FlosumToGit','repoService','catch','../../../core','26640cntvbD','getRepositoryRecords','getBranchRecords','convertToSFDX','SalesforceLogger2','all','\x27\x20-\x20\x27','sfLogger','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','Unable\x20to\x20synchronize\x20repository\x20\x27','name','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','\x22\x20does\x20not\x20has\x20a\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','apply','repoList','hasOwnProperty','typedi','gitManager','3841191TiRhHv','hooks','logger','getRepoService','../../../constants','../jobs/git-sync.job','decorate','\x27\x20[','updateRemoteState','defineProperty','branchName','../../hooks/hooks.utils','create','getHookLinkFor','__metadata','run','url','toString','repositoryName','checkValidNaming','__esModule','5744TEMeWo','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','Error','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.',']\x20due\x20error\x20-\x20','error','SyncService','search','__decorate','SalesforceError','../../salesforce/services/salesforce-logger-v2.service','function','[INFO]\x20Repository\x20\x22','SalesforceService','design:paramtypes','object','length','HooksUtils','handleRecordSyncError','[INFO]\x20Start\x20sync\x20job','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20'];a182_0x3b9e=function(){return _0x2b355c;};return a182_0x3b9e();}var __createBinding=this&&this['__createBinding']||(Object[a182_0x5a6ca6(0x20a)]?function(_0x542d06,_0x1aaefd,_0x596032,_0x2e05b9){const _0x118f1a=a182_0x5a6ca6;if(_0x2e05b9===undefined)_0x2e05b9=_0x596032;Object[_0x118f1a(0x207)](_0x542d06,_0x2e05b9,{'enumerable':!![],'get':function(){return _0x1aaefd[_0x596032];}});}:function(_0x38f88d,_0x582817,_0x57ea74,_0x554054){if(_0x554054===undefined)_0x554054=_0x57ea74;_0x38f88d[_0x554054]=_0x582817[_0x57ea74];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a182_0x5a6ca6(0x20a)]?function(_0x1209da,_0xb0230c){const _0x37e385=a182_0x5a6ca6;Object[_0x37e385(0x207)](_0x1209da,_0x37e385(0x22d),{'enumerable':!![],'value':_0xb0230c});}:function(_0x20bea8,_0xbc75b5){const _0x3fb0f1=a182_0x5a6ca6;_0x20bea8[_0x3fb0f1(0x22d)]=_0xbc75b5;}),__decorate=this&&this[a182_0x5a6ca6(0x21b)]||function(_0x50d0a6,_0x3dcb9f,_0x4d904e,_0x32045d){const _0x1ac973=a182_0x5a6ca6;var _0x40cd67=arguments['length'],_0x3efe6c=_0x40cd67<0x3?_0x3dcb9f:_0x32045d===null?_0x32045d=Object['getOwnPropertyDescriptor'](_0x3dcb9f,_0x4d904e):_0x32045d,_0x24e1de;if(typeof Reflect===_0x1ac973(0x222)&&typeof Reflect[_0x1ac973(0x204)]===_0x1ac973(0x21e))_0x3efe6c=Reflect[_0x1ac973(0x204)](_0x50d0a6,_0x3dcb9f,_0x4d904e,_0x32045d);else{for(var _0x45fea8=_0x50d0a6[_0x1ac973(0x223)]-0x1;_0x45fea8>=0x0;_0x45fea8--)if(_0x24e1de=_0x50d0a6[_0x45fea8])_0x3efe6c=(_0x40cd67<0x3?_0x24e1de(_0x3efe6c):_0x40cd67>0x3?_0x24e1de(_0x3dcb9f,_0x4d904e,_0x3efe6c):_0x24e1de(_0x3dcb9f,_0x4d904e))||_0x3efe6c;}return _0x40cd67>0x3&&_0x3efe6c&&Object[_0x1ac973(0x207)](_0x3dcb9f,_0x4d904e,_0x3efe6c),_0x3efe6c;},__importStar=this&&this['__importStar']||function(_0x3843ba){const _0x4c26a9=a182_0x5a6ca6;if(_0x3843ba&&_0x3843ba[_0x4c26a9(0x212)])return _0x3843ba;var _0x4cb8bb={};if(_0x3843ba!=null){for(var _0x5c30ba in _0x3843ba)if(_0x5c30ba!==_0x4c26a9(0x22d)&&Object[_0x4c26a9(0x1d0)][_0x4c26a9(0x1fb)]['call'](_0x3843ba,_0x5c30ba))__createBinding(_0x4cb8bb,_0x3843ba,_0x5c30ba);}return __setModuleDefault(_0x4cb8bb,_0x3843ba),_0x4cb8bb;},__metadata=this&&this[a182_0x5a6ca6(0x20c)]||function(_0x3046c1,_0x20f084){const _0x1685ee=a182_0x5a6ca6;if(typeof Reflect===_0x1685ee(0x222)&&typeof Reflect[_0x1685ee(0x1cd)]===_0x1685ee(0x21e))return Reflect[_0x1685ee(0x1cd)](_0x3046c1,_0x20f084);},SyncService_1;Object['defineProperty'](exports,a182_0x5a6ca6(0x212),{'value':!![]}),exports[a182_0x5a6ca6(0x219)]=void 0x0;const constants_1=require(a182_0x5a6ca6(0x202)),core_1=require(a182_0x5a6ca6(0x1ea)),too_many_requests_error_1=require(a182_0x5a6ca6(0x234)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require('../../salesforce/errors/salesforce.error'),salesforce_logger_v2_service_1=require(a182_0x5a6ca6(0x21d)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a182_0x5a6ca6(0x22a)),utils_1=require(a182_0x5a6ca6(0x1d8)),typedi_1=__importStar(require(a182_0x5a6ca6(0x1fc))),hooks_utils_1=require(a182_0x5a6ca6(0x209)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a182_0x5a6ca6(0x203));let SyncService=SyncService_1=class SyncService{constructor(_0xe63d57,_0x67f48c,_0x28725c){const _0x122933=a182_0x5a6ca6;this[_0x122933(0x231)]=_0xe63d57,this[_0x122933(0x235)]=_0x67f48c,this[_0x122933(0x1fd)]=_0x28725c,this[_0x122933(0x200)]=new core_1[(_0x122933(0x1d7))](SyncService_1[_0x122933(0x1f5)]),this[_0x122933(0x1e0)]={},this['repoList']=[];}async[a182_0x5a6ca6(0x225)](_0x226d42,_0x15b763){const _0x5e2a6b=a182_0x5a6ca6;if(_0x15b763 instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x5e2a6b(0x235)][_0x5e2a6b(0x1e5)](_0x226d42,_0x5e2a6b(0x237));throw _0x15b763;}try{await this[_0x5e2a6b(0x1f2)][_0x5e2a6b(0x239)](_0x5e2a6b(0x1f3)+_0x226d42[_0x5e2a6b(0x210)]+_0x5e2a6b(0x205)+_0x226d42[_0x5e2a6b(0x208)]+_0x5e2a6b(0x217)+_0x15b763)[_0x5e2a6b(0x229)](),await this[_0x5e2a6b(0x235)][_0x5e2a6b(0x206)](_0x226d42,{}),await this[_0x5e2a6b(0x235)]['setStatus'](_0x226d42,_0x5e2a6b(0x215));}catch(_0x927d41){if(_0x927d41 instanceof salesforce_error_1[_0x5e2a6b(0x21c)])throw _0x927d41;}}async[a182_0x5a6ca6(0x1d2)](_0x4a557e){const _0x573648=a182_0x5a6ca6;if(_0x4a557e['repositoryId']){const _0x51bc3b=_0x4a557e[_0x573648(0x210)]['toLowerCase'](),_0x4a19b6=this[_0x573648(0x1e0)][_0x51bc3b];if(!_0x4a19b6)this['repositoriesIntersections'][_0x51bc3b]=_0x4a557e[_0x573648(0x210)];else{if(_0x4a19b6&&_0x4a19b6!==_0x4a557e[_0x573648(0x210)])return await this[_0x573648(0x225)](_0x4a557e,new Error(_0x573648(0x1f4)+_0x4a557e[_0x573648(0x210)]+_0x573648(0x1f6)+_0x51bc3b+_0x573648(0x1f1)+_0x4a19b6+'\x27')),!![];}}return![];}async[a182_0x5a6ca6(0x211)](_0x293817){const _0xaaad0b=a182_0x5a6ca6;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0xaaad0b(0x1ce)](_0x293817[_0xaaad0b(0x210)]))return await this[_0xaaad0b(0x225)](_0x293817,new Error(_0xaaad0b(0x1f4)+_0x293817[_0xaaad0b(0x210)]+_0xaaad0b(0x214))),![];if(!constants_1[_0xaaad0b(0x228)][_0xaaad0b(0x1ce)](_0x293817['branchName']))return await this[_0xaaad0b(0x225)](_0x293817,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x293817[_0xaaad0b(0x208)]+_0xaaad0b(0x1e1)+_0x293817['repositoryName']+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async['getOrCreateRepo'](_0x20f072,_0x167f16){const _0x1382a1=a182_0x5a6ca6;let _0x24bb46=this[_0x1382a1(0x1fa)]['find'](_0x5b10fc=>_0x20f072['repositoryName']===_0x5b10fc[_0x1382a1(0x1f5)]);!_0x24bb46&&(this[_0x1382a1(0x1f2)][_0x1382a1(0x239)](_0x1382a1(0x21f)+_0x20f072[_0x1382a1(0x210)]+_0x1382a1(0x230)),_0x24bb46=await this['repoService']['create']({'name':_0x20f072['repositoryName'],'autoInit':!![],'defaultBranch':_0x20f072[_0x1382a1(0x208)],'private':!![]}));const _0x31ca81=await _0x24bb46[_0x1382a1(0x1ff)]['getAll']();return!_0x31ca81[_0x1382a1(0x1df)](_0xa65cbd=>_0xa65cbd[_0x1382a1(0x20e)]===hooks_utils_1[_0x1382a1(0x224)][_0x1382a1(0x20b)](_0x167f16))&&(this[_0x1382a1(0x1f2)][_0x1382a1(0x239)]('[INFO]\x20Repository\x20\x22'+_0x20f072['repositoryName']+_0x1382a1(0x1f7)),await _0x24bb46['hooks'][_0x1382a1(0x20a)](hooks_utils_1[_0x1382a1(0x224)]['createHookPayload'](_0x167f16,_0x24bb46[_0x1382a1(0x1ff)]))),this['repoList'][_0x1382a1(0x236)](_0x24bb46),_0x24bb46;}async[a182_0x5a6ca6(0x20d)](_0x57c1d5,_0x4e1d5b,_0x3e946a){const _0x1a9803=a182_0x5a6ca6;this['salesforceService'][_0x1a9803(0x1d9)](_0x4e1d5b),this[_0x1a9803(0x1e8)]=this[_0x1a9803(0x1fd)][_0x1a9803(0x201)](_0x3e946a),this[_0x1a9803(0x1f2)]=new salesforce_logger_v2_service_1[(_0x1a9803(0x1ef))](_0x4e1d5b,_0x1a9803(0x1d5)+_0x3e946a['toUpperCase']()+']');try{await this['sfLogger'][_0x1a9803(0x239)](_0x1a9803(0x226))[_0x1a9803(0x229)]();const [_0x234881,_0x54f403]=await Promise[_0x1a9803(0x1f0)]([this[_0x1a9803(0x235)][_0x1a9803(0x1ed)](),this[_0x1a9803(0x235)][_0x1a9803(0x1ec)]()]);this[_0x1a9803(0x1fa)]=await this[_0x1a9803(0x1e8)]['getAll']();const _0x3f8ca0=[..._0x54f403,..._0x234881];this['logger'][_0x1a9803(0x239)](_0x1a9803(0x1e3),_0x3f8ca0['length']);for(const _0x411841 of _0x3f8ca0){this['logger'][_0x1a9803(0x239)](_0x1a9803(0x1f8),_0x411841['repositoryName'],_0x411841[_0x1a9803(0x22e)],_0x411841[_0x1a9803(0x208)],_0x411841['branchId']);const _0x476a36=await this[_0x1a9803(0x211)](_0x411841);if(!_0x476a36)continue;const _0x12ad87=await this['isIntersects'](_0x411841);if(_0x12ad87)continue;let _0x180637;try{_0x180637=await this['getOrCreateRepo'](_0x411841,_0x3e946a);}catch(_0xdb67be){await this['handleRecordSyncError'](_0x411841,_0xdb67be instanceof too_many_requests_error_1['TooManyRequests']?_0xdb67be:new Error(_0x1a9803(0x233)+_0xdb67be));continue;}if(_0x411841[_0x1a9803(0x1d6)]===flosum_repository_sync_dto_1['SyncDirection'][_0x1a9803(0x1e7)]){const _0x5e643c=typedi_1[_0x1a9803(0x22d)][_0x1a9803(0x1dc)](flosum_sync_job_1[_0x1a9803(0x22f)]);await _0x5e643c[_0x1a9803(0x20d)]({'repository':_0x180637,'convertToSFDX':_0x57c1d5[_0x1a9803(0x1ee)],'syncRecord':_0x411841,'provider':_0x3e946a,'logger':this[_0x1a9803(0x1f2)]})[_0x1a9803(0x1e9)](_0x3dcbf2=>this[_0x1a9803(0x225)](_0x411841,_0x3dcbf2));}else{const _0x5499d4=typedi_1['default'][_0x1a9803(0x1dc)](git_sync_job_1[_0x1a9803(0x1d3)]);await _0x5499d4[_0x1a9803(0x20d)]({'repository':_0x180637,'branch':_0x411841['branchName'],'provider':_0x3e946a,'repositoryGit':_0x180637['gitUrl'],'syncRecord':_0x411841,'logger':this[_0x1a9803(0x1f2)]})[_0x1a9803(0x1e9)](_0x3dbfed=>this[_0x1a9803(0x225)](_0x411841,_0x3dbfed));}}}catch(_0xfc91b){this[_0x1a9803(0x200)][_0x1a9803(0x218)](_0xfc91b);_0xfc91b instanceof too_many_requests_error_1['TooManyRequests']?(await this['sfLogger'][_0x1a9803(0x239)](_0x1a9803(0x216))[_0x1a9803(0x229)](),await utils_1['sleep'](0x3c*0x3c*0x3e8),this[_0x1a9803(0x20d)](_0x57c1d5,_0x4e1d5b,_0x3e946a)):await this[_0x1a9803(0x1f2)][_0x1a9803(0x239)](_0x1a9803(0x227)+_0xfc91b)[_0x1a9803(0x229)]();return;}await this[_0x1a9803(0x1f2)][_0x1a9803(0x239)](_0x1a9803(0x1da))[_0x1a9803(0x229)](),await this['salesforceSync'][_0x1a9803(0x1e4)](_0x57c1d5[_0x1a9803(0x238)])[_0x1a9803(0x1e9)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a182_0x5a6ca6(0x1d4)]({'transient':!![]}),__metadata(a182_0x5a6ca6(0x221),[salesforce_service_1[a182_0x5a6ca6(0x220)],salesforce_sync_service_1['SalesforceSyncService'],git_provider_manager_1[a182_0x5a6ca6(0x1e2)]])],SyncService),exports[a182_0x5a6ca6(0x219)]=SyncService;