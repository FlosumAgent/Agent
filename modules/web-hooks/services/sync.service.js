const a186_0x352f21=a186_0x40f4;(function(_0x1ee8c4,_0x2cff56){const _0x206bcd=a186_0x40f4,_0x2d7e64=_0x1ee8c4();while(!![]){try{const _0x5b8139=parseInt(_0x206bcd(0xc6))/0x1+-parseInt(_0x206bcd(0xc1))/0x2*(-parseInt(_0x206bcd(0xa6))/0x3)+-parseInt(_0x206bcd(0x9f))/0x4*(parseInt(_0x206bcd(0x104))/0x5)+-parseInt(_0x206bcd(0xb4))/0x6*(parseInt(_0x206bcd(0xb1))/0x7)+parseInt(_0x206bcd(0xe3))/0x8+-parseInt(_0x206bcd(0xf1))/0x9+parseInt(_0x206bcd(0xd9))/0xa;if(_0x5b8139===_0x2cff56)break;else _0x2d7e64['push'](_0x2d7e64['shift']());}catch(_0x4e19db){_0x2d7e64['push'](_0x2d7e64['shift']());}}}(a186_0x54f1,0x9fcfb));const a186_0x43ae93=function(){let _0x30bb7a=!![];return function(_0x155fb4,_0x1832e9){const _0x518f04=_0x30bb7a?function(){const _0x31e8ce=a186_0x40f4;if(_0x1832e9){const _0x1218ba=_0x1832e9[_0x31e8ce(0xc4)](_0x155fb4,arguments);return _0x1832e9=null,_0x1218ba;}}:function(){};return _0x30bb7a=![],_0x518f04;};}(),a186_0x392440=a186_0x43ae93(this,function(){const _0x462f30=a186_0x40f4;return a186_0x392440[_0x462f30(0x97)]()[_0x462f30(0x99)](_0x462f30(0xc5))[_0x462f30(0x97)]()[_0x462f30(0xab)](a186_0x392440)[_0x462f30(0x99)](_0x462f30(0xc5));});a186_0x392440();function a186_0x54f1(){const _0x224968=['\x27\x20-\x20\x27','repoList','HooksUtils','hasOwnProperty','create','../../salesforce/dto/flosum-repository-sync.dto','GitSyncJob','defineProperty','getAll','checkValidNaming','repositoriesIntersections','10623940neoFZk','__esModule','createHookPayload','Unable\x20to\x20synchronize\x20branch\x20\x27','metadata','default','SalesforceLogger2','direction','repositoryId','setStatus','5210512peapbq','repoService','__createBinding','../../../core/errors/too-many-requests.error','../jobs/git-sync.job','../../../constants','createHooks','Service','name','gitManager','hooks','gitUrl','../../salesforce/services/salesforce.service','sleep','11474613ryRcHj','\x27\x20in\x20repository\x20\x27','SalesforceService','convertToSFDX','object','TooManyRequests','branchId','__setModuleDefault','SyncService','../../shared/git-provider.manager','__metadata','decorate','Error','have\x20to\x20synchronize\x20%d\x20branches','log','Waiting','getOrCreateRepo','catch','GitProviderManager','3485FVBmRP','\x22\x20does\x20not\x20has\x20the\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.','handleRecordSyncError','SalesforceSyncService','toString','../../hooks/hooks.utils','search','../../shared/utils',']\x20due\x20error\x20-\x20','call','FlosumSyncJob','branchName','1552pPrlJs','syncDto','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','repositoryName','url','function','849KpwFkG','FlosumToGit','syncID','sfLogger','updateRemoteState','constructor','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','disableSync','all','isIntersects','find','21dYmUnK','get','getOwnPropertyDescriptor','698826fuHgsd','run','\x27\x20[','BRANCH_NAME_REGEXP','__decorate','SyncDirection','../../salesforce/services/salesforce-logger-v2.service','length','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','getBranchRecords','../../salesforce/errors/salesforce.error','salesforceSync','590FEvHim','send','error','apply','(((.+)+)+)+$','752200JlgAab','test','logger','getHookLinkFor','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','prototype','[INFO]\x20Repository\x20\x22','salesforceService'];a186_0x54f1=function(){return _0x224968;};return a186_0x54f1();}'use strict';function a186_0x40f4(_0x55ffde,_0x24a951){const _0x3ac109=a186_0x54f1();return a186_0x40f4=function(_0x392440,_0x43ae93){_0x392440=_0x392440-0x95;let _0x54f1a9=_0x3ac109[_0x392440];return _0x54f1a9;},a186_0x40f4(_0x55ffde,_0x24a951);}var __createBinding=this&&this[a186_0x352f21(0xe5)]||(Object[a186_0x352f21(0xd2)]?function(_0x1f1527,_0x339609,_0x2b5135,_0x5a798d){if(_0x5a798d===undefined)_0x5a798d=_0x2b5135;Object['defineProperty'](_0x1f1527,_0x5a798d,{'enumerable':!![],'get':function(){return _0x339609[_0x2b5135];}});}:function(_0x21d1f6,_0x2d3860,_0x502f15,_0x301aec){if(_0x301aec===undefined)_0x301aec=_0x502f15;_0x21d1f6[_0x301aec]=_0x2d3860[_0x502f15];}),__setModuleDefault=this&&this[a186_0x352f21(0xf8)]||(Object[a186_0x352f21(0xd2)]?function(_0xff1229,_0x75833b){const _0x23ad29=a186_0x352f21;Object[_0x23ad29(0xd5)](_0xff1229,_0x23ad29(0xde),{'enumerable':!![],'value':_0x75833b});}:function(_0x18650c,_0x44ea3f){const _0x225e4f=a186_0x352f21;_0x18650c[_0x225e4f(0xde)]=_0x44ea3f;}),__decorate=this&&this[a186_0x352f21(0xb8)]||function(_0x5a19df,_0x35e79f,_0x5d04cf,_0x2930aa){const _0xd6cd27=a186_0x352f21;var _0x13518a=arguments['length'],_0x23a58a=_0x13518a<0x3?_0x35e79f:_0x2930aa===null?_0x2930aa=Object[_0xd6cd27(0xb3)](_0x35e79f,_0x5d04cf):_0x2930aa,_0x1c34b7;if(typeof Reflect===_0xd6cd27(0xf5)&&typeof Reflect[_0xd6cd27(0xfc)]==='function')_0x23a58a=Reflect[_0xd6cd27(0xfc)](_0x5a19df,_0x35e79f,_0x5d04cf,_0x2930aa);else{for(var _0xed5c8=_0x5a19df[_0xd6cd27(0xbb)]-0x1;_0xed5c8>=0x0;_0xed5c8--)if(_0x1c34b7=_0x5a19df[_0xed5c8])_0x23a58a=(_0x13518a<0x3?_0x1c34b7(_0x23a58a):_0x13518a>0x3?_0x1c34b7(_0x35e79f,_0x5d04cf,_0x23a58a):_0x1c34b7(_0x35e79f,_0x5d04cf))||_0x23a58a;}return _0x13518a>0x3&&_0x23a58a&&Object[_0xd6cd27(0xd5)](_0x35e79f,_0x5d04cf,_0x23a58a),_0x23a58a;},__importStar=this&&this['__importStar']||function(_0x25f03e){const _0x57046a=a186_0x352f21;if(_0x25f03e&&_0x25f03e[_0x57046a(0xda)])return _0x25f03e;var _0x21ff24={};if(_0x25f03e!=null){for(var _0x4d9897 in _0x25f03e)if(_0x4d9897!==_0x57046a(0xde)&&Object[_0x57046a(0xcb)][_0x57046a(0xd1)][_0x57046a(0x9c)](_0x25f03e,_0x4d9897))__createBinding(_0x21ff24,_0x25f03e,_0x4d9897);}return __setModuleDefault(_0x21ff24,_0x25f03e),_0x21ff24;},__metadata=this&&this[a186_0x352f21(0xfb)]||function(_0x541ead,_0x1a94e7){const _0x33ef50=a186_0x352f21;if(typeof Reflect==='object'&&typeof Reflect[_0x33ef50(0xdd)]===_0x33ef50(0xa5))return Reflect[_0x33ef50(0xdd)](_0x541ead,_0x1a94e7);},SyncService_1;Object[a186_0x352f21(0xd5)](exports,a186_0x352f21(0xda),{'value':!![]}),exports[a186_0x352f21(0xf9)]=void 0x0;const constants_1=require(a186_0x352f21(0xe8)),core_1=require('../../../core'),too_many_requests_error_1=require(a186_0x352f21(0xe6)),flosum_repository_sync_dto_1=require(a186_0x352f21(0xd3)),salesforce_error_1=require(a186_0x352f21(0xbf)),salesforce_logger_v2_service_1=require(a186_0x352f21(0xba)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a186_0x352f21(0xef)),git_provider_manager_1=require(a186_0x352f21(0xfa)),utils_1=require(a186_0x352f21(0x9a)),typedi_1=__importStar(require('typedi')),hooks_utils_1=require(a186_0x352f21(0x98)),flosum_sync_job_1=require('../jobs/flosum-sync.job'),git_sync_job_1=require(a186_0x352f21(0xe7));let SyncService=SyncService_1=class SyncService{constructor(_0x42c559,_0x541863,_0x31bbe2){const _0x3dc38f=a186_0x352f21;this[_0x3dc38f(0xcd)]=_0x42c559,this[_0x3dc38f(0xc0)]=_0x541863,this['gitManager']=_0x31bbe2,this[_0x3dc38f(0xc8)]=new core_1['Logger'](SyncService_1[_0x3dc38f(0xeb)]),this['repositoriesIntersections']={},this[_0x3dc38f(0xcf)]=[];}async[a186_0x352f21(0x95)](_0x9bbcaa,_0x2dcf1e){const _0x75a594=a186_0x352f21;if(_0x2dcf1e instanceof too_many_requests_error_1['TooManyRequests']){await this[_0x75a594(0xc0)][_0x75a594(0xe2)](_0x9bbcaa,_0x75a594(0x100));throw _0x2dcf1e;}try{await this['sfLogger'][_0x75a594(0xff)](_0x75a594(0xa1)+_0x9bbcaa['repositoryName']+_0x75a594(0xb6)+_0x9bbcaa[_0x75a594(0x9e)]+_0x75a594(0x9b)+_0x2dcf1e)['send'](),await this[_0x75a594(0xc0)][_0x75a594(0xaa)](_0x9bbcaa,{}),await this[_0x75a594(0xc0)][_0x75a594(0xe2)](_0x9bbcaa,_0x75a594(0xfd));}catch(_0x22214e){if(_0x22214e instanceof salesforce_error_1['SalesforceError'])throw _0x22214e;}}async[a186_0x352f21(0xaf)](_0x289b6a){const _0x37c2c0=a186_0x352f21;if(_0x289b6a['repositoryId']){const _0x4d5921=_0x289b6a[_0x37c2c0(0xa3)]['toLowerCase'](),_0x5202c1=this[_0x37c2c0(0xd8)][_0x4d5921];if(!_0x5202c1)this[_0x37c2c0(0xd8)][_0x4d5921]=_0x289b6a[_0x37c2c0(0xa3)];else{if(_0x5202c1&&_0x5202c1!==_0x289b6a[_0x37c2c0(0xa3)])return await this[_0x37c2c0(0x95)](_0x289b6a,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x289b6a[_0x37c2c0(0xa3)]+_0x37c2c0(0xac)+_0x4d5921+_0x37c2c0(0xce)+_0x5202c1+'\x27')),!![];}}return![];}async[a186_0x352f21(0xd7)](_0x445535){const _0x208c55=a186_0x352f21;if(!constants_1['REPOSITORY_NAME_REGEXP'][_0x208c55(0xc7)](_0x445535[_0x208c55(0xa3)]))return await this[_0x208c55(0x95)](_0x445535,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x445535[_0x208c55(0xa3)]+'\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];if(!constants_1[_0x208c55(0xb7)][_0x208c55(0xc7)](_0x445535[_0x208c55(0x9e)]))return await this[_0x208c55(0x95)](_0x445535,new Error(_0x208c55(0xdc)+_0x445535['branchName']+_0x208c55(0xf2)+_0x445535[_0x208c55(0xa3)]+'\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.')),![];return!![];}async[a186_0x352f21(0x101)](_0x45b3b7,_0x1c71c8,_0x2fba23){const _0x4230fb=a186_0x352f21;let _0x4f26c6=this[_0x4230fb(0xcf)][_0x4230fb(0xb0)](_0x41882c=>_0x45b3b7[_0x4230fb(0xa3)]===_0x41882c['name']);!_0x4f26c6&&(this[_0x4230fb(0xa9)][_0x4230fb(0xff)](_0x4230fb(0xcc)+_0x45b3b7[_0x4230fb(0xa3)]+'\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.'),_0x4f26c6=await this[_0x4230fb(0xe4)]['create']({'name':_0x45b3b7[_0x4230fb(0xa3)],'autoInit':!![],'defaultBranch':_0x45b3b7[_0x4230fb(0x9e)],'private':!![],'createHook':this[_0x4230fb(0xa0)][_0x4230fb(0xe9)]}));if(this[_0x4230fb(0xa0)][_0x4230fb(0xe9)]){const _0x2704d1=await _0x4f26c6['hooks'][_0x4230fb(0xd6)]();!_0x2704d1[_0x4230fb(0xb0)](_0xb460ea=>_0xb460ea[_0x4230fb(0xa4)]===hooks_utils_1[_0x4230fb(0xd0)][_0x4230fb(0xc9)](_0x1c71c8,_0x2fba23))&&(this[_0x4230fb(0xa9)]['log'](_0x4230fb(0xcc)+_0x45b3b7['repositoryName']+_0x4230fb(0x105)),await _0x4f26c6[_0x4230fb(0xed)]['create'](hooks_utils_1[_0x4230fb(0xd0)][_0x4230fb(0xdb)](_0x1c71c8,_0x4f26c6[_0x4230fb(0xed)],_0x2fba23)));}return this[_0x4230fb(0xcf)]['push'](_0x4f26c6),_0x4f26c6;}async[a186_0x352f21(0xb5)](_0x5b3ddf,_0x1d3847,_0xcdc6fb,_0x1137bd){const _0x2d2a4b=a186_0x352f21;this[_0x2d2a4b(0xcd)]['setLoggerId'](_0x1d3847),this['repoService']=this[_0x2d2a4b(0xec)]['getRepoService'](_0xcdc6fb),this[_0x2d2a4b(0xa9)]=new salesforce_logger_v2_service_1[(_0x2d2a4b(0xdf))](_0x1d3847,'['+SyncService_1[_0x2d2a4b(0xeb)]+']\x20['+_0xcdc6fb['toUpperCase']()+']'),this[_0x2d2a4b(0xa0)]=_0x5b3ddf;try{await this['sfLogger']['log']('[INFO]\x20Start\x20sync\x20job')[_0x2d2a4b(0xc2)]();const [_0x2acd65,_0x41f716]=await Promise[_0x2d2a4b(0xae)]([this[_0x2d2a4b(0xc0)][_0x2d2a4b(0xbe)](),this[_0x2d2a4b(0xc0)]['getRepositoryRecords']()]);this[_0x2d2a4b(0xcf)]=await this[_0x2d2a4b(0xe4)][_0x2d2a4b(0xd6)]();const _0x3bb6be=[..._0x41f716,..._0x2acd65];this['logger'][_0x2d2a4b(0xff)](_0x2d2a4b(0xfe),_0x3bb6be[_0x2d2a4b(0xbb)]);for(const _0x1b9d4a of _0x3bb6be){this[_0x2d2a4b(0xc8)]['log'](_0x2d2a4b(0xbc),_0x1b9d4a[_0x2d2a4b(0xa3)],_0x1b9d4a[_0x2d2a4b(0xe1)],_0x1b9d4a[_0x2d2a4b(0x9e)],_0x1b9d4a[_0x2d2a4b(0xf7)]);const _0x3fab09=await this['checkValidNaming'](_0x1b9d4a);if(!_0x3fab09)continue;const _0x4e477b=await this[_0x2d2a4b(0xaf)](_0x1b9d4a);if(_0x4e477b)continue;let _0xd501e0;try{_0xd501e0=await this['getOrCreateRepo'](_0x1b9d4a,_0xcdc6fb,_0x1137bd);}catch(_0x349922){await this['handleRecordSyncError'](_0x1b9d4a,_0x349922 instanceof too_many_requests_error_1[_0x2d2a4b(0xf6)]?_0x349922:new Error(_0x2d2a4b(0xa2)+_0x349922));continue;}if(_0x1b9d4a[_0x2d2a4b(0xe0)]===flosum_repository_sync_dto_1[_0x2d2a4b(0xb9)][_0x2d2a4b(0xa7)]){const _0x1271df=typedi_1[_0x2d2a4b(0xde)][_0x2d2a4b(0xb2)](flosum_sync_job_1[_0x2d2a4b(0x9d)]);await _0x1271df['run']({'repository':_0xd501e0,'convertToSFDX':_0x5b3ddf[_0x2d2a4b(0xf4)],'syncRecord':_0x1b9d4a,'provider':_0xcdc6fb,'logger':this[_0x2d2a4b(0xa9)]})[_0x2d2a4b(0x102)](_0x13fceb=>this[_0x2d2a4b(0x95)](_0x1b9d4a,_0x13fceb));}else{const _0x324d39=typedi_1[_0x2d2a4b(0xde)]['get'](git_sync_job_1[_0x2d2a4b(0xd4)]);await _0x324d39[_0x2d2a4b(0xb5)]({'repository':_0xd501e0,'branch':_0x1b9d4a[_0x2d2a4b(0x9e)],'provider':_0xcdc6fb,'repositoryGit':_0xd501e0[_0x2d2a4b(0xee)],'syncRecord':_0x1b9d4a,'logger':this[_0x2d2a4b(0xa9)]})[_0x2d2a4b(0x102)](_0x637852=>this[_0x2d2a4b(0x95)](_0x1b9d4a,_0x637852));}}}catch(_0x3b96f6){this[_0x2d2a4b(0xc8)][_0x2d2a4b(0xc3)](_0x3b96f6);_0x3b96f6 instanceof too_many_requests_error_1[_0x2d2a4b(0xf6)]?(await this[_0x2d2a4b(0xa9)][_0x2d2a4b(0xff)](_0x2d2a4b(0xca))[_0x2d2a4b(0xc2)](),await utils_1[_0x2d2a4b(0xf0)](0x3c*0x3c*0x3e8),this['run'](_0x5b3ddf,_0x1d3847,_0xcdc6fb,_0x1137bd)):await this['sfLogger'][_0x2d2a4b(0xff)](_0x2d2a4b(0xbd)+_0x3b96f6)['send']();return;}await this[_0x2d2a4b(0xa9)][_0x2d2a4b(0xff)]('[INFO]\x20Sync\x20job\x20done.')['send'](),await this[_0x2d2a4b(0xc0)][_0x2d2a4b(0xad)](_0x5b3ddf[_0x2d2a4b(0xa8)])[_0x2d2a4b(0x102)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a186_0x352f21(0xea)]({'transient':!![]}),__metadata('design:paramtypes',[salesforce_service_1[a186_0x352f21(0xf3)],salesforce_sync_service_1[a186_0x352f21(0x96)],git_provider_manager_1[a186_0x352f21(0x103)]])],SyncService),exports[a186_0x352f21(0xf9)]=SyncService;