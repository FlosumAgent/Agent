const a186_0xd21ea6=a186_0x1e17;(function(_0x399364,_0x4e42d3){const _0xf87116=a186_0x1e17,_0x5243fd=_0x399364();while(!![]){try{const _0x5c98d8=parseInt(_0xf87116(0x235))/0x1+parseInt(_0xf87116(0x211))/0x2+parseInt(_0xf87116(0x213))/0x3+-parseInt(_0xf87116(0x253))/0x4+parseInt(_0xf87116(0x239))/0x5*(parseInt(_0xf87116(0x238))/0x6)+parseInt(_0xf87116(0x249))/0x7+-parseInt(_0xf87116(0x256))/0x8;if(_0x5c98d8===_0x4e42d3)break;else _0x5243fd['push'](_0x5243fd['shift']());}catch(_0x1f27ab){_0x5243fd['push'](_0x5243fd['shift']());}}}(a186_0x3374,0x1a30e));function a186_0x1e17(_0x566e65,_0x3eabca){const _0x556ad8=a186_0x3374();return a186_0x1e17=function(_0x1d3245,_0x522e2f){_0x1d3245=_0x1d3245-0x1ea;let _0x33741d=_0x556ad8[_0x1d3245];return _0x33741d;},a186_0x1e17(_0x566e65,_0x3eabca);}const a186_0x522e2f=function(){let _0x7e54c3=!![];return function(_0x692275,_0x2167b8){const _0x463d04=_0x7e54c3?function(){const _0x20faf6=a186_0x1e17;if(_0x2167b8){const _0x18f05e=_0x2167b8[_0x20faf6(0x20b)](_0x692275,arguments);return _0x2167b8=null,_0x18f05e;}}:function(){};return _0x7e54c3=![],_0x463d04;};}(),a186_0x1d3245=a186_0x522e2f(this,function(){const _0x25deb3=a186_0x1e17;return a186_0x1d3245[_0x25deb3(0x21c)]()[_0x25deb3(0x1ef)](_0x25deb3(0x208))[_0x25deb3(0x21c)]()[_0x25deb3(0x22e)](a186_0x1d3245)['search'](_0x25deb3(0x208));});a186_0x1d3245();'use strict';var __createBinding=this&&this[a186_0xd21ea6(0x1f0)]||(Object['create']?function(_0x1d164b,_0x6f317,_0x17093e,_0x1dd086){const _0x25636b=a186_0xd21ea6;if(_0x1dd086===undefined)_0x1dd086=_0x17093e;Object[_0x25636b(0x20c)](_0x1d164b,_0x1dd086,{'enumerable':!![],'get':function(){return _0x6f317[_0x17093e];}});}:function(_0x2da96f,_0x3d1fdd,_0x3932b5,_0x4784a7){if(_0x4784a7===undefined)_0x4784a7=_0x3932b5;_0x2da96f[_0x4784a7]=_0x3d1fdd[_0x3932b5];}),__setModuleDefault=this&&this['__setModuleDefault']||(Object[a186_0xd21ea6(0x1fa)]?function(_0x3a52c3,_0x203aee){const _0x2fa625=a186_0xd21ea6;Object[_0x2fa625(0x20c)](_0x3a52c3,_0x2fa625(0x24e),{'enumerable':!![],'value':_0x203aee});}:function(_0x2abfba,_0x3f2d66){const _0x1d94ea=a186_0xd21ea6;_0x2abfba[_0x1d94ea(0x24e)]=_0x3f2d66;}),__decorate=this&&this[a186_0xd21ea6(0x225)]||function(_0x42fd0d,_0x562f23,_0x269015,_0x14c1c8){const _0x33931a=a186_0xd21ea6;var _0x5d50f3=arguments[_0x33931a(0x20a)],_0x12450e=_0x5d50f3<0x3?_0x562f23:_0x14c1c8===null?_0x14c1c8=Object['getOwnPropertyDescriptor'](_0x562f23,_0x269015):_0x14c1c8,_0x328688;if(typeof Reflect===_0x33931a(0x22f)&&typeof Reflect[_0x33931a(0x22d)]==='function')_0x12450e=Reflect['decorate'](_0x42fd0d,_0x562f23,_0x269015,_0x14c1c8);else{for(var _0x5d49ba=_0x42fd0d[_0x33931a(0x20a)]-0x1;_0x5d49ba>=0x0;_0x5d49ba--)if(_0x328688=_0x42fd0d[_0x5d49ba])_0x12450e=(_0x5d50f3<0x3?_0x328688(_0x12450e):_0x5d50f3>0x3?_0x328688(_0x562f23,_0x269015,_0x12450e):_0x328688(_0x562f23,_0x269015))||_0x12450e;}return _0x5d50f3>0x3&&_0x12450e&&Object['defineProperty'](_0x562f23,_0x269015,_0x12450e),_0x12450e;},__importStar=this&&this[a186_0xd21ea6(0x201)]||function(_0xd36d68){const _0x32194b=a186_0xd21ea6;if(_0xd36d68&&_0xd36d68['__esModule'])return _0xd36d68;var _0x1c633b={};if(_0xd36d68!=null){for(var _0x2e845d in _0xd36d68)if(_0x2e845d!==_0x32194b(0x24e)&&Object['prototype'][_0x32194b(0x21e)][_0x32194b(0x1eb)](_0xd36d68,_0x2e845d))__createBinding(_0x1c633b,_0xd36d68,_0x2e845d);}return __setModuleDefault(_0x1c633b,_0xd36d68),_0x1c633b;},__metadata=this&&this[a186_0xd21ea6(0x1ec)]||function(_0xd9529b,_0x30e840){const _0x44c76a=a186_0xd21ea6;if(typeof Reflect===_0x44c76a(0x22f)&&typeof Reflect[_0x44c76a(0x223)]===_0x44c76a(0x210))return Reflect[_0x44c76a(0x223)](_0xd9529b,_0x30e840);},SyncService_1;Object[a186_0xd21ea6(0x20c)](exports,'__esModule',{'value':!![]}),exports['SyncService']=void 0x0;const constants_1=require(a186_0xd21ea6(0x21d)),core_1=require(a186_0xd21ea6(0x1fe)),too_many_requests_error_1=require(a186_0xd21ea6(0x242)),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a186_0xd21ea6(0x1fc)),salesforce_logger_v2_service_1=require(a186_0xd21ea6(0x1f3)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require('../../salesforce/services/salesforce.service'),git_provider_manager_1=require(a186_0xd21ea6(0x1f9)),utils_1=require(a186_0xd21ea6(0x200)),typedi_1=__importStar(require(a186_0xd21ea6(0x230))),hooks_utils_1=require(a186_0xd21ea6(0x258)),flosum_sync_job_1=require(a186_0xd21ea6(0x252)),git_sync_job_1=require(a186_0xd21ea6(0x1f2));function a186_0x3374(){const _0x3ec976=['36ENZCaB','152335rnmmDd','updateRemoteState','createHookPayload','design:paramtypes','HooksUtils','Logger','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','send','repositoryId','../../../core/errors/too-many-requests.error','logger','hooks','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','sfLogger','getRepoService','GitSyncJob','811020HUusTz','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','Waiting','Unable\x20to\x20synchronize\x20repository\x20\x27','setStatus','default','repositoryName','branchName','\x27\x20-\x20\x27','../jobs/flosum-sync.job','625120BVTAxI','log','getAll','2461672uaAgKb','gitUrl','../../hooks/hooks.utils','\x22\x20does\x20not\x20has\x20the\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.','isIntersects','convertToSFDX','call','__metadata','SyncDirection','checkValidNaming','search','__createBinding','getHookLinkFor','../jobs/git-sync.job','../../salesforce/services/salesforce-logger-v2.service','Error',']\x20due\x20error\x20-\x20',']\x20[','error','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','../../shared/git-provider.manager','create','getBranchRecords','../../salesforce/errors/salesforce.error','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','../../../core','setLoggerId','../../shared/utils','__importStar','SalesforceSyncService','syncID','SalesforceService','salesforceSync','repositoriesIntersections','Service','(((.+)+)+)+$','name','length','apply','defineProperty','FlosumSyncJob','sleep','[INFO]\x20Sync\x20job\x20done.','function','220526Rgivqj','SalesforceError','401760wPIsCU','syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch','all','push','getOrCreateRepo','run','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','[INFO]\x20Repository\x20\x22','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','toString','../../../constants','hasOwnProperty','repoService','createHooks','SalesforceLogger2','GitProviderManager','metadata','syncDto','__decorate','catch','TooManyRequests','test','gitManager','have\x20to\x20synchronize\x20%d\x20branches','[INFO]\x20Start\x20sync\x20job','toUpperCase','decorate','constructor','object','typedi','url','toLowerCase','REPOSITORY_NAME_REGEXP','\x27\x20in\x20repository\x20\x27','28422rgZYxV','get','handleRecordSyncError'];a186_0x3374=function(){return _0x3ec976;};return a186_0x3374();}let SyncService=SyncService_1=class SyncService{constructor(_0x37cff7,_0x532011,_0x311c71){const _0x4fa940=a186_0xd21ea6;this['salesforceService']=_0x37cff7,this[_0x4fa940(0x205)]=_0x532011,this[_0x4fa940(0x229)]=_0x311c71,this['logger']=new core_1[(_0x4fa940(0x23e))](SyncService_1[_0x4fa940(0x209)]),this['repositoriesIntersections']={},this['repoList']=[];}async['handleRecordSyncError'](_0x2b0702,_0x3ec630){const _0x3a9bc4=a186_0xd21ea6;if(_0x3ec630 instanceof too_many_requests_error_1[_0x3a9bc4(0x227)]){await this[_0x3a9bc4(0x205)]['setStatus'](_0x2b0702,_0x3a9bc4(0x24b));throw _0x3ec630;}try{await this[_0x3a9bc4(0x246)]['log'](_0x3a9bc4(0x245)+_0x2b0702['repositoryName']+'\x27\x20['+_0x2b0702[_0x3a9bc4(0x250)]+_0x3a9bc4(0x1f5)+_0x3ec630)[_0x3a9bc4(0x240)](),await this['salesforceSync'][_0x3a9bc4(0x23a)](_0x2b0702,{}),await this[_0x3a9bc4(0x205)][_0x3a9bc4(0x24d)](_0x2b0702,_0x3a9bc4(0x1f4));}catch(_0x55d76c){if(_0x55d76c instanceof salesforce_error_1[_0x3a9bc4(0x212)])throw _0x55d76c;}}async[a186_0xd21ea6(0x25a)](_0x3a8d16){const _0x5b0952=a186_0xd21ea6;if(_0x3a8d16[_0x5b0952(0x241)]){const _0x14cbca=_0x3a8d16[_0x5b0952(0x24f)][_0x5b0952(0x232)](),_0x3089b1=this[_0x5b0952(0x206)][_0x14cbca];if(!_0x3089b1)this[_0x5b0952(0x206)][_0x14cbca]=_0x3a8d16['repositoryName'];else{if(_0x3089b1&&_0x3089b1!==_0x3a8d16['repositoryName'])return await this[_0x5b0952(0x237)](_0x3a8d16,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x3a8d16[_0x5b0952(0x24f)]+'\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27'+_0x14cbca+_0x5b0952(0x251)+_0x3089b1+'\x27')),!![];}}return![];}async[a186_0xd21ea6(0x1ee)](_0x4c089d){const _0x109478=a186_0xd21ea6;if(!constants_1[_0x109478(0x233)][_0x109478(0x228)](_0x4c089d[_0x109478(0x24f)]))return await this['handleRecordSyncError'](_0x4c089d,new Error(_0x109478(0x24c)+_0x4c089d[_0x109478(0x24f)]+_0x109478(0x21b))),![];if(!constants_1['BRANCH_NAME_REGEXP'][_0x109478(0x228)](_0x4c089d[_0x109478(0x250)]))return await this[_0x109478(0x237)](_0x4c089d,new Error('Unable\x20to\x20synchronize\x20branch\x20\x27'+_0x4c089d['branchName']+_0x109478(0x234)+_0x4c089d['repositoryName']+_0x109478(0x219))),![];return!![];}async[a186_0xd21ea6(0x217)](_0x586fca,_0x2d68b5,_0x4f42c4){const _0x5c100e=a186_0xd21ea6;let _0x3efcbc=this['repoList']['find'](_0x4bc428=>_0x586fca[_0x5c100e(0x24f)]===_0x4bc428[_0x5c100e(0x209)]);!_0x3efcbc&&(this['sfLogger'][_0x5c100e(0x254)](_0x5c100e(0x21a)+_0x586fca[_0x5c100e(0x24f)]+_0x5c100e(0x1f8)),_0x3efcbc=await this[_0x5c100e(0x21f)][_0x5c100e(0x1fa)]({'name':_0x586fca[_0x5c100e(0x24f)],'autoInit':!![],'defaultBranch':_0x586fca[_0x5c100e(0x250)],'private':!![],'createHook':this['syncDto'][_0x5c100e(0x220)]}));if(this[_0x5c100e(0x224)][_0x5c100e(0x220)]){const _0x2795e5=await _0x3efcbc[_0x5c100e(0x244)][_0x5c100e(0x255)]();!_0x2795e5['find'](_0x5e84b8=>_0x5e84b8[_0x5c100e(0x231)]===hooks_utils_1[_0x5c100e(0x23d)][_0x5c100e(0x1f1)](_0x2d68b5,_0x4f42c4))&&(this[_0x5c100e(0x246)][_0x5c100e(0x254)]('[INFO]\x20Repository\x20\x22'+_0x586fca[_0x5c100e(0x24f)]+_0x5c100e(0x259)),await _0x3efcbc[_0x5c100e(0x244)][_0x5c100e(0x1fa)](hooks_utils_1[_0x5c100e(0x23d)][_0x5c100e(0x23b)](_0x2d68b5,_0x3efcbc[_0x5c100e(0x244)],_0x4f42c4)));}return this['repoList'][_0x5c100e(0x216)](_0x3efcbc),_0x3efcbc;}async['run'](_0x54715b,_0x27e78d,_0x5416d6,_0x2d2579){const _0x3712d4=a186_0xd21ea6;this['salesforceService'][_0x3712d4(0x1ff)](_0x27e78d),this[_0x3712d4(0x21f)]=this[_0x3712d4(0x229)][_0x3712d4(0x247)](_0x5416d6),this['sfLogger']=new salesforce_logger_v2_service_1[(_0x3712d4(0x221))](_0x27e78d,'['+SyncService_1[_0x3712d4(0x209)]+_0x3712d4(0x1f6)+_0x5416d6[_0x3712d4(0x22c)]()+']'),this[_0x3712d4(0x224)]=_0x54715b;try{await this[_0x3712d4(0x246)]['log'](_0x3712d4(0x22b))['send']();const [_0x310fd9,_0x517e9c]=await Promise[_0x3712d4(0x215)]([this['salesforceSync'][_0x3712d4(0x1fb)](),this[_0x3712d4(0x205)]['getRepositoryRecords']()]);this['repoList']=await this[_0x3712d4(0x21f)][_0x3712d4(0x255)]();const _0x4066ca=[..._0x517e9c,..._0x310fd9];this[_0x3712d4(0x243)]['log'](_0x3712d4(0x22a),_0x4066ca[_0x3712d4(0x20a)]);for(const _0x15d4c3 of _0x4066ca){this[_0x3712d4(0x243)][_0x3712d4(0x254)](_0x3712d4(0x214),_0x15d4c3[_0x3712d4(0x24f)],_0x15d4c3[_0x3712d4(0x241)],_0x15d4c3[_0x3712d4(0x250)],_0x15d4c3['branchId']);const _0x45229e=await this[_0x3712d4(0x1ee)](_0x15d4c3);if(!_0x45229e)continue;const _0x521423=await this[_0x3712d4(0x25a)](_0x15d4c3);if(_0x521423)continue;let _0x5ba081;try{_0x5ba081=await this[_0x3712d4(0x217)](_0x15d4c3,_0x5416d6,_0x2d2579);}catch(_0x5b3e2c){await this[_0x3712d4(0x237)](_0x15d4c3,_0x5b3e2c instanceof too_many_requests_error_1[_0x3712d4(0x227)]?_0x5b3e2c:new Error(_0x3712d4(0x23f)+_0x5b3e2c));continue;}if(_0x15d4c3['direction']===flosum_repository_sync_dto_1[_0x3712d4(0x1ed)]['FlosumToGit']){const _0x379f0e=typedi_1[_0x3712d4(0x24e)][_0x3712d4(0x236)](flosum_sync_job_1[_0x3712d4(0x20d)]);await _0x379f0e[_0x3712d4(0x218)]({'repository':_0x5ba081,'convertToSFDX':_0x54715b[_0x3712d4(0x1ea)],'syncRecord':_0x15d4c3,'provider':_0x5416d6,'logger':this['sfLogger']})[_0x3712d4(0x226)](_0x4ff70f=>this['handleRecordSyncError'](_0x15d4c3,_0x4ff70f));}else{const _0x31cbd0=typedi_1['default']['get'](git_sync_job_1[_0x3712d4(0x248)]);await _0x31cbd0[_0x3712d4(0x218)]({'repository':_0x5ba081,'branch':_0x15d4c3[_0x3712d4(0x250)],'provider':_0x5416d6,'repositoryGit':_0x5ba081[_0x3712d4(0x257)],'syncRecord':_0x15d4c3,'logger':this[_0x3712d4(0x246)]})[_0x3712d4(0x226)](_0x847619=>this['handleRecordSyncError'](_0x15d4c3,_0x847619));}}}catch(_0x653511){this[_0x3712d4(0x243)][_0x3712d4(0x1f7)](_0x653511);_0x653511 instanceof too_many_requests_error_1[_0x3712d4(0x227)]?(await this[_0x3712d4(0x246)][_0x3712d4(0x254)](_0x3712d4(0x1fd))[_0x3712d4(0x240)](),await utils_1[_0x3712d4(0x20e)](0x3c*0x3c*0x3e8),this[_0x3712d4(0x218)](_0x54715b,_0x27e78d,_0x5416d6,_0x2d2579)):await this[_0x3712d4(0x246)][_0x3712d4(0x254)](_0x3712d4(0x24a)+_0x653511)['send']();return;}await this['sfLogger']['log'](_0x3712d4(0x20f))[_0x3712d4(0x240)](),await this[_0x3712d4(0x205)]['disableSync'](_0x54715b[_0x3712d4(0x203)])[_0x3712d4(0x226)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a186_0xd21ea6(0x207)]({'transient':!![]}),__metadata(a186_0xd21ea6(0x23c),[salesforce_service_1[a186_0xd21ea6(0x204)],salesforce_sync_service_1[a186_0xd21ea6(0x202)],git_provider_manager_1[a186_0xd21ea6(0x222)]])],SyncService),exports['SyncService']=SyncService;