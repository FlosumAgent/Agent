const a179_0x3c6bf2=a179_0x39ac;(function(_0x322e3b,_0x3789fd){const _0x1fdecd=a179_0x39ac,_0x264f60=_0x322e3b();while(!![]){try{const _0x800024=parseInt(_0x1fdecd(0x103))/0x1*(parseInt(_0x1fdecd(0x12b))/0x2)+-parseInt(_0x1fdecd(0xeb))/0x3*(parseInt(_0x1fdecd(0xf8))/0x4)+parseInt(_0x1fdecd(0x13e))/0x5*(parseInt(_0x1fdecd(0x109))/0x6)+-parseInt(_0x1fdecd(0xea))/0x7+parseInt(_0x1fdecd(0x10f))/0x8+-parseInt(_0x1fdecd(0xe8))/0x9*(-parseInt(_0x1fdecd(0x138))/0xa)+parseInt(_0x1fdecd(0x10a))/0xb;if(_0x800024===_0x3789fd)break;else _0x264f60['push'](_0x264f60['shift']());}catch(_0x470ef6){_0x264f60['push'](_0x264f60['shift']());}}}(a179_0x4d00,0x9dbbd));const a179_0xbb0244=function(){let _0x4d55ca=!![];return function(_0x261067,_0x475eef){const _0x23bff2=_0x4d55ca?function(){const _0x529115=a179_0x39ac;if(_0x475eef){const _0x5acfe0=_0x475eef[_0x529115(0xf7)](_0x261067,arguments);return _0x475eef=null,_0x5acfe0;}}:function(){};return _0x4d55ca=![],_0x23bff2;};}(),a179_0x8d7867=a179_0xbb0244(this,function(){const _0x2a0442=a179_0x39ac;return a179_0x8d7867[_0x2a0442(0xfc)]()[_0x2a0442(0xff)](_0x2a0442(0x12d))[_0x2a0442(0xfc)]()[_0x2a0442(0xed)](a179_0x8d7867)['search'](_0x2a0442(0x12d));});a179_0x8d7867();'use strict';var __createBinding=this&&this[a179_0x3c6bf2(0x134)]||(Object[a179_0x3c6bf2(0x11b)]?function(_0x123fea,_0x31307a,_0x476f2d,_0x4d4bed){if(_0x4d4bed===undefined)_0x4d4bed=_0x476f2d;Object['defineProperty'](_0x123fea,_0x4d4bed,{'enumerable':!![],'get':function(){return _0x31307a[_0x476f2d];}});}:function(_0x105cf9,_0x2a7a04,_0x3bcecd,_0x213e99){if(_0x213e99===undefined)_0x213e99=_0x3bcecd;_0x105cf9[_0x213e99]=_0x2a7a04[_0x3bcecd];}),__setModuleDefault=this&&this[a179_0x3c6bf2(0xe9)]||(Object[a179_0x3c6bf2(0x11b)]?function(_0x3d24b9,_0x55bba8){const _0x45e3fd=a179_0x3c6bf2;Object[_0x45e3fd(0x144)](_0x3d24b9,_0x45e3fd(0x101),{'enumerable':!![],'value':_0x55bba8});}:function(_0x46bf4a,_0x591451){const _0x3dfd5f=a179_0x3c6bf2;_0x46bf4a[_0x3dfd5f(0x101)]=_0x591451;}),__decorate=this&&this[a179_0x3c6bf2(0x119)]||function(_0x1af29f,_0x3edbb5,_0x59dd19,_0x29137a){const _0x660672=a179_0x3c6bf2;var _0x28a40a=arguments['length'],_0x38741d=_0x28a40a<0x3?_0x3edbb5:_0x29137a===null?_0x29137a=Object[_0x660672(0x150)](_0x3edbb5,_0x59dd19):_0x29137a,_0x66cc18;if(typeof Reflect===_0x660672(0xfd)&&typeof Reflect[_0x660672(0x116)]===_0x660672(0x128))_0x38741d=Reflect[_0x660672(0x116)](_0x1af29f,_0x3edbb5,_0x59dd19,_0x29137a);else{for(var _0x39d4d8=_0x1af29f[_0x660672(0xfb)]-0x1;_0x39d4d8>=0x0;_0x39d4d8--)if(_0x66cc18=_0x1af29f[_0x39d4d8])_0x38741d=(_0x28a40a<0x3?_0x66cc18(_0x38741d):_0x28a40a>0x3?_0x66cc18(_0x3edbb5,_0x59dd19,_0x38741d):_0x66cc18(_0x3edbb5,_0x59dd19))||_0x38741d;}return _0x28a40a>0x3&&_0x38741d&&Object[_0x660672(0x144)](_0x3edbb5,_0x59dd19,_0x38741d),_0x38741d;},__importStar=this&&this['__importStar']||function(_0x54ad45){const _0x2ec06e=a179_0x3c6bf2;if(_0x54ad45&&_0x54ad45['__esModule'])return _0x54ad45;var _0x5d0071={};if(_0x54ad45!=null){for(var _0x3772de in _0x54ad45)if(_0x3772de!==_0x2ec06e(0x101)&&Object[_0x2ec06e(0x131)][_0x2ec06e(0x113)]['call'](_0x54ad45,_0x3772de))__createBinding(_0x5d0071,_0x54ad45,_0x3772de);}return __setModuleDefault(_0x5d0071,_0x54ad45),_0x5d0071;},__metadata=this&&this['__metadata']||function(_0x1da226,_0x55f4e3){const _0x3600f6=a179_0x3c6bf2;if(typeof Reflect===_0x3600f6(0xfd)&&typeof Reflect[_0x3600f6(0x114)]===_0x3600f6(0x128))return Reflect[_0x3600f6(0x114)](_0x1da226,_0x55f4e3);},SyncService_1;Object[a179_0x3c6bf2(0x144)](exports,a179_0x3c6bf2(0xf0),{'value':!![]}),exports[a179_0x3c6bf2(0xe5)]=void 0x0;const constants_1=require(a179_0x3c6bf2(0x12f)),core_1=require(a179_0x3c6bf2(0x136)),too_many_requests_error_1=require('../../../core/errors/too-many-requests.error'),flosum_repository_sync_dto_1=require('../../salesforce/dto/flosum-repository-sync.dto'),salesforce_error_1=require(a179_0x3c6bf2(0x11c)),salesforce_logger_v2_service_1=require(a179_0x3c6bf2(0x11f)),salesforce_sync_service_1=require('../../salesforce/services/salesforce-sync.service'),salesforce_service_1=require(a179_0x3c6bf2(0x13b)),git_provider_manager_1=require(a179_0x3c6bf2(0x158)),utils_1=require('../../shared/utils'),typedi_1=__importStar(require(a179_0x3c6bf2(0x12e))),hooks_utils_1=require(a179_0x3c6bf2(0xf1)),flosum_sync_job_1=require(a179_0x3c6bf2(0x157)),git_sync_job_1=require(a179_0x3c6bf2(0xf2));function a179_0x39ac(_0x4b0668,_0x277efb){const _0x4cd0c5=a179_0x4d00();return a179_0x39ac=function(_0x8d7867,_0xbb0244){_0x8d7867=_0x8d7867-0xe4;let _0x4d0000=_0x4cd0c5[_0x8d7867];return _0x4d0000;},a179_0x39ac(_0x4b0668,_0x277efb);}function a179_0x4d00(){const _0x42a94a=['../../salesforce/services/salesforce-logger-v2.service','salesforceService','\x22\x20does\x20not\x20exists.\x20Creating\x20it\x20on\x20git\x20service.','all','\x27\x20due\x20repository\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','repoList','SalesforceLogger2','send','push','function','convertToSFDX','repositoryId','16396xkcRGN','gitUrl','(((.+)+)+)+$','typedi','../../../constants','[PAUSE]\x20Pause\x20sync\x20job\x20due\x20error\x20-\x20Rate\x20limit\x20quota\x20for\x20git\x20service\x20exceeded.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Paused\x20for\x201h\x20to\x20refill\x20limit\x20quota\x20continue.\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20This\x20kind\x20of\x20error\x20is\x20not\x20critical\x20just\x20need\x20to\x20wait\x20until\x20we\x20can\x20continue\x20work\x20with\x20git\x20service.','prototype','Unable\x20to\x20synchronize\x20branch\x20\x27','sleep','__createBinding','disableSync','../../../core','[SYNC]\x20[','10pKVlkF','\x27\x20due\x20branch\x20name\x20does\x20not\x20meet\x20the\x20naming\x20requirements.','handleRecordSyncError','../../salesforce/services/salesforce.service','\x27\x20due\x20it\x20intersects\x20with\x20another\x20repository\x20by\x20repository\x20key\x20\x27','setStatus','5eBFpmC','have\x20to\x20synchronize\x20%d\x20branches','HooksUtils','log','getRepoService','hooks','defineProperty','SalesforceSyncService','SalesforceService','logger','[ERROR]\x20Stop\x20sync\x20job\x20due\x20error\x20-\x20','[ERROR]\x20Could\x20not\x20find/create\x20repository.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Possible\x20error\x20reasons:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x201.\x20Git\x20service\x20is\x20unavailable\x20for\x20the\x20moment.\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x202.\x20Repository\x20with\x20this\x20name\x20already\x20created\x20in\x20git,\x20but\x20with\x20another\x20lettercase\x20(repository\x20names\x20are\x20case-sensitive\x20and\x20should\x20be\x20identical).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x203.\x20The\x20agent\x20could\x20not\x20recieve\x20all\x20repositories\x20from\x20git\x20service\x20due\x20permissions\x20that\x20you\x20provided.\x20(See\x20guide\x20how\x20to\x20setup\x20environment\x20variables\x20for\x20this\x20service).\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20Original\x20error:\x20','run','Error','Unable\x20to\x20synchronize\x20repository\x20\x27','toUpperCase','design:paramtypes','SyncDirection','getOwnPropertyDescriptor','Service','Logger','getOrCreateRepo','TooManyRequests','GitProviderManager','[INFO]\x20Repository\x20\x22','../jobs/flosum-sync.job','../../shared/git-provider.manager','repositoriesIntersections','SyncService','\x27\x20-\x20\x27','test','5550525FlOhZX','__setModuleDefault','7514549SPOiIR','24KHHAHg','catch','constructor','toLowerCase','isIntersects','__esModule','../../hooks/hooks.utils','../jobs/git-sync.job','repositoryName','Waiting','checkValidNaming','setLoggerId','apply','283784DEgInj','[INFO]\x20Sync\x20job\x20done.','getBranchRecords','length','toString','object','salesforceSync','search','branchName','default','FlosumSyncJob','35dBeXwT','syncID','BRANCH_NAME_REGEXP','\x27\x20[','name','updateRemoteState','1552596WXxsvY','4582886TZPuZJ','repoService','url','[INFO]\x20Start\x20sync\x20job','SalesforceError','5664840lMnabY','\x22\x20does\x20not\x20has\x20the\x20agent\x20webhook.\x20Creating\x20a\x20new\x20one.','get','error','hasOwnProperty','metadata','createHookPayload','decorate','getRepositoryRecords','[ERROR]\x20Stop\x20sync\x20job\x20for\x20\x27','__decorate','sfLogger','create','../../salesforce/errors/salesforce.error','getHookLinkFor','find'];a179_0x4d00=function(){return _0x42a94a;};return a179_0x4d00();}let SyncService=SyncService_1=class SyncService{constructor(_0xdd4907,_0x48edce,_0x15f7da){const _0x399993=a179_0x3c6bf2;this[_0x399993(0x120)]=_0xdd4907,this[_0x399993(0xfe)]=_0x48edce,this['gitManager']=_0x15f7da,this[_0x399993(0x147)]=new core_1[(_0x399993(0x152))](SyncService_1[_0x399993(0x107)]),this[_0x399993(0xe4)]={},this[_0x399993(0x124)]=[];}async[a179_0x3c6bf2(0x13a)](_0x478d46,_0x46a254){const _0x2694b9=a179_0x3c6bf2;if(_0x46a254 instanceof too_many_requests_error_1[_0x2694b9(0x154)]){await this[_0x2694b9(0xfe)][_0x2694b9(0x13d)](_0x478d46,_0x2694b9(0xf4));throw _0x46a254;}try{await this['sfLogger']['log'](_0x2694b9(0x118)+_0x478d46[_0x2694b9(0xf3)]+_0x2694b9(0x106)+_0x478d46[_0x2694b9(0x100)]+']\x20due\x20error\x20-\x20'+_0x46a254)[_0x2694b9(0x126)](),await this['salesforceSync'][_0x2694b9(0x108)](_0x478d46,{}),await this['salesforceSync'][_0x2694b9(0x13d)](_0x478d46,_0x2694b9(0x14b));}catch(_0x43bb1e){if(_0x43bb1e instanceof salesforce_error_1[_0x2694b9(0x10e)])throw _0x43bb1e;}}async[a179_0x3c6bf2(0xef)](_0x351ec5){const _0x56e39b=a179_0x3c6bf2;if(_0x351ec5[_0x56e39b(0x12a)]){const _0x3bb11a=_0x351ec5[_0x56e39b(0xf3)][_0x56e39b(0xee)](),_0x3e3dea=this[_0x56e39b(0xe4)][_0x3bb11a];if(!_0x3e3dea)this['repositoriesIntersections'][_0x3bb11a]=_0x351ec5['repositoryName'];else{if(_0x3e3dea&&_0x3e3dea!==_0x351ec5['repositoryName'])return await this[_0x56e39b(0x13a)](_0x351ec5,new Error('Unable\x20to\x20synchronize\x20repository\x20\x27'+_0x351ec5[_0x56e39b(0xf3)]+_0x56e39b(0x13c)+_0x3bb11a+_0x56e39b(0xe6)+_0x3e3dea+'\x27')),!![];}}return![];}async[a179_0x3c6bf2(0xf5)](_0x1e6285){const _0x381aeb=a179_0x3c6bf2;if(!constants_1['REPOSITORY_NAME_REGEXP']['test'](_0x1e6285['repositoryName']))return await this[_0x381aeb(0x13a)](_0x1e6285,new Error(_0x381aeb(0x14c)+_0x1e6285[_0x381aeb(0xf3)]+_0x381aeb(0x123))),![];if(!constants_1[_0x381aeb(0x105)][_0x381aeb(0xe7)](_0x1e6285['branchName']))return await this[_0x381aeb(0x13a)](_0x1e6285,new Error(_0x381aeb(0x132)+_0x1e6285[_0x381aeb(0x100)]+'\x27\x20in\x20repository\x20\x27'+_0x1e6285[_0x381aeb(0xf3)]+_0x381aeb(0x139))),![];return!![];}async[a179_0x3c6bf2(0x153)](_0xec6ade,_0x201ba7){const _0x552e08=a179_0x3c6bf2;let _0x177848=this[_0x552e08(0x124)][_0x552e08(0x11e)](_0x1dc660=>_0xec6ade['repositoryName']===_0x1dc660[_0x552e08(0x107)]);!_0x177848&&(this[_0x552e08(0x11a)][_0x552e08(0x141)]('[INFO]\x20Repository\x20\x22'+_0xec6ade[_0x552e08(0xf3)]+_0x552e08(0x121)),_0x177848=await this[_0x552e08(0x10b)]['create']({'name':_0xec6ade[_0x552e08(0xf3)],'autoInit':!![],'defaultBranch':_0xec6ade[_0x552e08(0x100)],'private':!![]}));const _0x14e39f=await _0x177848['hooks']['getAll']();return!_0x14e39f[_0x552e08(0x11e)](_0x2da239=>_0x2da239[_0x552e08(0x10c)]===hooks_utils_1['HooksUtils'][_0x552e08(0x11d)](_0x201ba7))&&(this[_0x552e08(0x11a)][_0x552e08(0x141)](_0x552e08(0x156)+_0xec6ade['repositoryName']+_0x552e08(0x110)),await _0x177848['hooks'][_0x552e08(0x11b)](hooks_utils_1[_0x552e08(0x140)][_0x552e08(0x115)](_0x201ba7,_0x177848[_0x552e08(0x143)]))),this[_0x552e08(0x124)][_0x552e08(0x127)](_0x177848),_0x177848;}async[a179_0x3c6bf2(0x14a)](_0x3c902b,_0x240d52,_0x222411){const _0x96a145=a179_0x3c6bf2;this[_0x96a145(0x120)][_0x96a145(0xf6)](_0x240d52),this['repoService']=this['gitManager'][_0x96a145(0x142)](_0x222411),this[_0x96a145(0x11a)]=new salesforce_logger_v2_service_1[(_0x96a145(0x125))](_0x240d52,_0x96a145(0x137)+_0x222411[_0x96a145(0x14d)]()+']');try{await this[_0x96a145(0x11a)][_0x96a145(0x141)](_0x96a145(0x10d))[_0x96a145(0x126)]();const [_0x26d168,_0x137490]=await Promise[_0x96a145(0x122)]([this['salesforceSync'][_0x96a145(0xfa)](),this[_0x96a145(0xfe)][_0x96a145(0x117)]()]);this[_0x96a145(0x124)]=await this['repoService']['getAll']();const _0xa9d0a6=[..._0x137490,..._0x26d168];this[_0x96a145(0x147)][_0x96a145(0x141)](_0x96a145(0x13f),_0xa9d0a6[_0x96a145(0xfb)]);for(const _0xd4bde6 of _0xa9d0a6){this[_0x96a145(0x147)][_0x96a145(0x141)]('syncing\x20%s[%s]\x20repository\x20%s[%s]\x20branch',_0xd4bde6[_0x96a145(0xf3)],_0xd4bde6[_0x96a145(0x12a)],_0xd4bde6[_0x96a145(0x100)],_0xd4bde6['branchId']);const _0x44487d=await this['checkValidNaming'](_0xd4bde6);if(!_0x44487d)continue;const _0x3d5e92=await this['isIntersects'](_0xd4bde6);if(_0x3d5e92)continue;let _0xc37029;try{_0xc37029=await this[_0x96a145(0x153)](_0xd4bde6,_0x222411);}catch(_0x33aca9){await this[_0x96a145(0x13a)](_0xd4bde6,_0x33aca9 instanceof too_many_requests_error_1[_0x96a145(0x154)]?_0x33aca9:new Error(_0x96a145(0x149)+_0x33aca9));continue;}if(_0xd4bde6['direction']===flosum_repository_sync_dto_1[_0x96a145(0x14f)]['FlosumToGit']){const _0x4bc18c=typedi_1[_0x96a145(0x101)][_0x96a145(0x111)](flosum_sync_job_1[_0x96a145(0x102)]);await _0x4bc18c['run']({'repository':_0xc37029,'convertToSFDX':_0x3c902b[_0x96a145(0x129)],'syncRecord':_0xd4bde6,'provider':_0x222411,'logger':this[_0x96a145(0x11a)]})[_0x96a145(0xec)](_0xcdb009=>this[_0x96a145(0x13a)](_0xd4bde6,_0xcdb009));}else{const _0x5539c4=typedi_1[_0x96a145(0x101)][_0x96a145(0x111)](git_sync_job_1['GitSyncJob']);await _0x5539c4['run']({'repository':_0xc37029,'branch':_0xd4bde6[_0x96a145(0x100)],'provider':_0x222411,'repositoryGit':_0xc37029[_0x96a145(0x12c)],'syncRecord':_0xd4bde6,'logger':this[_0x96a145(0x11a)]})[_0x96a145(0xec)](_0x69a4a1=>this[_0x96a145(0x13a)](_0xd4bde6,_0x69a4a1));}}}catch(_0xcd192){this['logger'][_0x96a145(0x112)](_0xcd192);_0xcd192 instanceof too_many_requests_error_1[_0x96a145(0x154)]?(await this[_0x96a145(0x11a)][_0x96a145(0x141)](_0x96a145(0x130))[_0x96a145(0x126)](),await utils_1[_0x96a145(0x133)](0x3c*0x3c*0x3e8),this[_0x96a145(0x14a)](_0x3c902b,_0x240d52,_0x222411)):await this[_0x96a145(0x11a)][_0x96a145(0x141)](_0x96a145(0x148)+_0xcd192)[_0x96a145(0x126)]();return;}await this[_0x96a145(0x11a)][_0x96a145(0x141)](_0x96a145(0xf9))[_0x96a145(0x126)](),await this['salesforceSync'][_0x96a145(0x135)](_0x3c902b[_0x96a145(0x104)])[_0x96a145(0xec)](()=>null);}};SyncService=SyncService_1=__decorate([typedi_1[a179_0x3c6bf2(0x151)]({'transient':!![]}),__metadata(a179_0x3c6bf2(0x14e),[salesforce_service_1[a179_0x3c6bf2(0x146)],salesforce_sync_service_1[a179_0x3c6bf2(0x145)],git_provider_manager_1[a179_0x3c6bf2(0x155)]])],SyncService),exports[a179_0x3c6bf2(0xe5)]=SyncService;