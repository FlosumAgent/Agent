const a95_0x5ce0=['default','AppSettingsService','settings','deleteCommit','115537iRxcUn','getOwnPropertyDescriptor','retrieve','apex','__metadata','1786943XkMVCY','1OlgOWF','return\x20/\x22\x20+\x20this\x20+\x20\x22/','metadata','refreshToken','post','jsforce','sobject','Connection','1TNMRPa','namespace','create\x20new\x20oauth\x20connection\x20from\x20given\x20credentials','../../../core/errors/unauthorized.error','__decorate','396998lgcLxZ','object','../../shared/services/salesforce-settings.service','/attachments/','loginUrl','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','connect','delete','SalesforceService','salesforseSettings','trying\x20to\x20establish\x20connection\x20to\x20salesforce','../../../constants/errors','log','__importDefault','1rhEWVr','typedi','/attachments','defineProperty','/flosum_git','salesforce-service','function','oauth2','connection','16924dctNrP','end','push','Attachment','constructor','error','record','test','remove\x20commit\x20%s','../../shared/services/app-settings.service','60964OupeAF','design:paramtypes','production','Logger','data','retrieve\x20%d\x20components','length','__esModule','271547leqLbr','/logger','16kgsHMg','UnauthorizedError','940123ASjfUM','hasAuthorizedCredentials','apply','salesforce\x20connection\x20established','retrieve\x20attachment\x20%s\x20from\x20salesforce','decorate','SalesforceSettingsService','hasCredentials','ERR_MISSING_SALEFORCE_CONFIGURATION'];const a95_0x400f7f=a95_0x5120;(function(_0x11752f,_0x2c5727){const _0xe372be=a95_0x5120;while(!![]){try{const _0x1006f9=parseInt(_0xe372be(0x18e))+parseInt(_0xe372be(0x1c0))*-parseInt(_0xe372be(0x1b2))+-parseInt(_0xe372be(0x19f))*-parseInt(_0xe372be(0x1ad))+parseInt(_0xe372be(0x1c9))*-parseInt(_0xe372be(0x190))+-parseInt(_0xe372be(0x1a5))*parseInt(_0xe372be(0x192))+-parseInt(_0xe372be(0x186))+parseInt(_0xe372be(0x1a4));if(_0x1006f9===_0x2c5727)break;else _0x11752f['push'](_0x11752f['shift']());}catch(_0x3b3a36){_0x11752f['push'](_0x11752f['shift']());}}}(a95_0x5ce0,0x7b546));const a95_0xc4da2b=function(){let _0x15a504=!![];return function(_0x524265,_0x43c81f){const _0xeb8c27=_0x15a504?function(){const _0x3cf5e6=a95_0x5120;if(_0x43c81f){const _0xaf6eee=_0x43c81f[_0x3cf5e6(0x194)](_0x524265,arguments);return _0x43c81f=null,_0xaf6eee;}}:function(){};return _0x15a504=![],_0xeb8c27;};}(),a95_0x2ce32c=a95_0xc4da2b(this,function(){const _0x5ca79e=function(){const _0x4c4b71=a95_0x5120,_0x2292a5=_0x5ca79e[_0x4c4b71(0x1cd)](_0x4c4b71(0x1a6))()[_0x4c4b71(0x1cd)](_0x4c4b71(0x1b7));return!_0x2292a5[_0x4c4b71(0x183)](a95_0x2ce32c);};return _0x5ca79e();});a95_0x2ce32c();'use strict';var __decorate=this&&this[a95_0x400f7f(0x1b1)]||function(_0x4e7485,_0x3308df,_0x319225,_0x32faee){const _0xa71076=a95_0x400f7f;var _0x1d0979=arguments[_0xa71076(0x18c)],_0x29165e=_0x1d0979<0x3?_0x3308df:_0x32faee===null?_0x32faee=Object[_0xa71076(0x1a0)](_0x3308df,_0x319225):_0x32faee,_0x5f29b9;if(typeof Reflect==='object'&&typeof Reflect[_0xa71076(0x197)]===_0xa71076(0x1c6))_0x29165e=Reflect[_0xa71076(0x197)](_0x4e7485,_0x3308df,_0x319225,_0x32faee);else{for(var _0x590192=_0x4e7485[_0xa71076(0x18c)]-0x1;_0x590192>=0x0;_0x590192--)if(_0x5f29b9=_0x4e7485[_0x590192])_0x29165e=(_0x1d0979<0x3?_0x5f29b9(_0x29165e):_0x1d0979>0x3?_0x5f29b9(_0x3308df,_0x319225,_0x29165e):_0x5f29b9(_0x3308df,_0x319225))||_0x29165e;}return _0x1d0979>0x3&&_0x29165e&&Object[_0xa71076(0x1c3)](_0x3308df,_0x319225,_0x29165e),_0x29165e;},__metadata=this&&this[a95_0x400f7f(0x1a3)]||function(_0x201b3e,_0x350bc9){const _0x1390fc=a95_0x400f7f;if(typeof Reflect===_0x1390fc(0x1b3)&&typeof Reflect[_0x1390fc(0x1a7)]===_0x1390fc(0x1c6))return Reflect[_0x1390fc(0x1a7)](_0x201b3e,_0x350bc9);},__importDefault=this&&this[a95_0x400f7f(0x1bf)]||function(_0xdd9cee){const _0x472ee1=a95_0x400f7f;return _0xdd9cee&&_0xdd9cee[_0x472ee1(0x18d)]?_0xdd9cee:{'default':_0xdd9cee};};Object[a95_0x400f7f(0x1c3)](exports,a95_0x400f7f(0x18d),{'value':!![]}),exports[a95_0x400f7f(0x1ba)]=void 0x0;function a95_0x5120(_0x5b211b,_0x1fb170){return a95_0x5120=function(_0x427fdb,_0x2ce32c){_0x427fdb=_0x427fdb-0x181;let _0xc4da2b=a95_0x5ce0[_0x427fdb];return _0xc4da2b;},a95_0x5120(_0x5b211b,_0x1fb170);}const typedi_1=require(a95_0x400f7f(0x1c1)),jsforce_1=__importDefault(require(a95_0x400f7f(0x1aa))),unauthorized_error_1=require(a95_0x400f7f(0x1b0)),errors_1=require(a95_0x400f7f(0x1bd)),core_1=require('../../../core'),salesforce_settings_service_1=require(a95_0x400f7f(0x1b4)),app_settings_service_1=require(a95_0x400f7f(0x185)),logger=new core_1[(a95_0x400f7f(0x189))](a95_0x400f7f(0x1c5));let SalesforceService=class SalesforceService{constructor(_0x5e518f,_0x45499f){const _0x51c6f1=a95_0x400f7f;this[_0x51c6f1(0x1bb)]=_0x5e518f,this['appSettings']=_0x45499f,this['namespace']=this['appSettings']['env']===_0x51c6f1(0x188)?_0x51c6f1(0x1c4):'';}get[a95_0x400f7f(0x19d)](){const _0x62d144=a95_0x400f7f;return this[_0x62d144(0x1bb)][_0x62d144(0x19d)];}async[a95_0x400f7f(0x1b8)](){const _0x3609f5=a95_0x400f7f;logger[_0x3609f5(0x1be)](_0x3609f5(0x1bc));if(!this['salesforseSettings'][_0x3609f5(0x199)])throw new unauthorized_error_1[(_0x3609f5(0x191))](errors_1[_0x3609f5(0x19a)]);const {clientId:_0x4831ec,clientSecret:_0x110c8d,refreshToken:_0x1f161a}=this[_0x3609f5(0x19d)],_0x437f44={'clientId':_0x4831ec,'clientSecret':_0x110c8d,'loginUrl':this[_0x3609f5(0x1bb)][_0x3609f5(0x1b6)]};if(!this[_0x3609f5(0x1bb)][_0x3609f5(0x193)]){logger[_0x3609f5(0x1be)](_0x3609f5(0x1af));const _0xb90c66=new jsforce_1[(_0x3609f5(0x19b))][(_0x3609f5(0x1ac))](_0x437f44),{access_token:_0x27c7fa,instance_url:_0xab4a59}=await _0xb90c66[_0x3609f5(0x1c7)][_0x3609f5(0x1a8)](_0x1f161a);await this['salesforseSettings']['update']({'accessToken':_0x27c7fa,'instanceUrl':_0xab4a59});}const {accessToken:_0xc9294,instanceUrl:_0x67d6d9}=this[_0x3609f5(0x19d)];this[_0x3609f5(0x1c8)]=new jsforce_1['default']['Connection']({'oauth2':_0x437f44,'refreshToken':_0x1f161a,'accessToken':_0xc9294,'instanceUrl':_0x67d6d9}),logger[_0x3609f5(0x1be)](_0x3609f5(0x195));}async[a95_0x400f7f(0x1a1)](_0x51a578){const _0x3c9568=a95_0x400f7f;return logger[_0x3c9568(0x1be)](_0x3c9568(0x18b),_0x51a578[_0x3c9568(0x18c)]),this[_0x3c9568(0x1c8)][_0x3c9568(0x1a2)][_0x3c9568(0x1a9)](this[_0x3c9568(0x1ae)]+_0x3c9568(0x1c2),{'componentIds':_0x51a578});}async[a95_0x400f7f(0x19e)](_0x3a0651){const _0x354a76=a95_0x400f7f;logger['log'](_0x354a76(0x184),_0x3a0651),await this[_0x354a76(0x1c8)]['apex'][_0x354a76(0x1b9)](this[_0x354a76(0x1ae)]+_0x354a76(0x1b5)+_0x3a0651);}async['retrieveAttachment'](_0x1a4f3c){const _0x4e55cc=a95_0x400f7f;return logger[_0x4e55cc(0x1be)](_0x4e55cc(0x196),_0x1a4f3c),new Promise((_0x44d2bc,_0x4f2698)=>{const _0x297447=_0x4e55cc,_0x190666=[],_0x3e1663=this[_0x297447(0x1c8)][_0x297447(0x1ab)](_0x297447(0x1cc))[_0x297447(0x182)](_0x1a4f3c)['blob']('Body');_0x3e1663['on'](_0x297447(0x181),_0x4f2698),_0x3e1663['on'](_0x297447(0x18a),_0x19a698=>_0x190666[_0x297447(0x1cb)](_0x19a698)),_0x3e1663['on'](_0x297447(0x1ca),()=>_0x44d2bc(_0x190666['join']('')));});}async[a95_0x400f7f(0x1be)](_0x20424c){const _0x512480=a95_0x400f7f;await this[_0x512480(0x1c8)][_0x512480(0x1a2)][_0x512480(0x1a9)](this['namespace']+_0x512480(0x18f),{'message':_0x20424c});}};SalesforceService=__decorate([typedi_1['Service'](),__metadata(a95_0x400f7f(0x187),[salesforce_settings_service_1[a95_0x400f7f(0x198)],app_settings_service_1[a95_0x400f7f(0x19c)]])],SalesforceService),exports[a95_0x400f7f(0x1ba)]=SalesforceService;