const a97_0x32b6=['metadata','connect','sobject','end','[LID:%s]\x20log\x20message\x20to\x20salesforce','join','apply','deleteCommit','error','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','typedi','production','constructor','log','383086OsrsAn','301612fWrZuJ','/attachments','post','object','remove\x20commit\x20%s','585519UdysIM','apex','../../../core/errors/internal-server.error','default','jsforce','420946pRQexS','salesforce-service','settings','__metadata','push','salesforce\x20connection\x20established','SalesforceSettingsService','refreshToken','__esModule','690863pnSOUk','UnauthorizedError','create\x20new\x20oauth\x20connection\x20from\x20given\x20credentials','InternalServerError','Connection','SalesforceService','length','connection','update','hasAuthorizedCredentials','delete','message','record','defineProperty','decorate','retrieve\x20attachment\x20%s\x20from\x20salesforce','/logger','trying\x20to\x20establish\x20connection\x20to\x20salesforce','design:paramtypes','salesforseSettings','1vgsInj','loggerId','377272cfkgSe','__decorate','return\x20/\x22\x20+\x20this\x20+\x20\x22/','AppSettingsService','namespace','../../../core','../../shared/services/salesforce-settings.service','test','350971dkypnp','hasCredentials','ERR_MISSING_SALEFORCE_CONFIGURATION','appSettings','retrieve','retrieveAttachment'];const a97_0x1a5815=a97_0x1a2e;(function(_0x3e026b,_0x33d491){const _0x6a1648=a97_0x1a2e;while(!![]){try{const _0x265940=parseInt(_0x6a1648(0xe7))+-parseInt(_0x6a1648(0xbe))+parseInt(_0x6a1648(0xc8))+parseInt(_0x6a1648(0xef))*parseInt(_0x6a1648(0xe5))+-parseInt(_0x6a1648(0xbd))+-parseInt(_0x6a1648(0xc3))+parseInt(_0x6a1648(0xd1));if(_0x265940===_0x33d491)break;else _0x3e026b['push'](_0x3e026b['shift']());}catch(_0x5bd294){_0x3e026b['push'](_0x3e026b['shift']());}}}(a97_0x32b6,0x8b1eb));function a97_0x1a2e(_0x16f27f,_0x194279){return a97_0x1a2e=function(_0x59f322,_0x10429e){_0x59f322=_0x59f322-0xab;let _0x290774=a97_0x32b6[_0x59f322];return _0x290774;},a97_0x1a2e(_0x16f27f,_0x194279);}const a97_0x290774=function(){let _0x4bef42=!![];return function(_0xbccd7b,_0x1e2e6b){const _0x4df595=_0x4bef42?function(){const _0x53f239=a97_0x1a2e;if(_0x1e2e6b){const _0x8c46d9=_0x1e2e6b[_0x53f239(0xb5)](_0xbccd7b,arguments);return _0x1e2e6b=null,_0x8c46d9;}}:function(){};return _0x4bef42=![],_0x4df595;};}(),a97_0x10429e=a97_0x290774(this,function(){const _0x2be0d8=function(){const _0x3fa937=a97_0x1a2e,_0x15d26c=_0x2be0d8[_0x3fa937(0xbb)](_0x3fa937(0xe9))()[_0x3fa937(0xbb)](_0x3fa937(0xb8));return!_0x15d26c[_0x3fa937(0xee)](a97_0x10429e);};return _0x2be0d8();});a97_0x10429e();'use strict';var __decorate=this&&this[a97_0x1a5815(0xe8)]||function(_0xf04fa4,_0x12e671,_0x188d03,_0x628a6a){const _0x20d9c4=a97_0x1a5815;var _0x26bf8b=arguments[_0x20d9c4(0xd7)],_0x3fcbf8=_0x26bf8b<0x3?_0x12e671:_0x628a6a===null?_0x628a6a=Object['getOwnPropertyDescriptor'](_0x12e671,_0x188d03):_0x628a6a,_0x378737;if(typeof Reflect==='object'&&typeof Reflect[_0x20d9c4(0xdf)]==='function')_0x3fcbf8=Reflect['decorate'](_0xf04fa4,_0x12e671,_0x188d03,_0x628a6a);else{for(var _0x3f6b27=_0xf04fa4[_0x20d9c4(0xd7)]-0x1;_0x3f6b27>=0x0;_0x3f6b27--)if(_0x378737=_0xf04fa4[_0x3f6b27])_0x3fcbf8=(_0x26bf8b<0x3?_0x378737(_0x3fcbf8):_0x26bf8b>0x3?_0x378737(_0x12e671,_0x188d03,_0x3fcbf8):_0x378737(_0x12e671,_0x188d03))||_0x3fcbf8;}return _0x26bf8b>0x3&&_0x3fcbf8&&Object[_0x20d9c4(0xde)](_0x12e671,_0x188d03,_0x3fcbf8),_0x3fcbf8;},__metadata=this&&this[a97_0x1a5815(0xcb)]||function(_0x1cfbc3,_0x2e3a76){const _0x30849f=a97_0x1a5815;if(typeof Reflect===_0x30849f(0xc1)&&typeof Reflect['metadata']==='function')return Reflect[_0x30849f(0xaf)](_0x1cfbc3,_0x2e3a76);},__importDefault=this&&this['__importDefault']||function(_0x24d1bb){const _0xef898b=a97_0x1a5815;return _0x24d1bb&&_0x24d1bb[_0xef898b(0xd0)]?_0x24d1bb:{'default':_0x24d1bb};};Object[a97_0x1a5815(0xde)](exports,a97_0x1a5815(0xd0),{'value':!![]}),exports['SalesforceService']=void 0x0;const typedi_1=require(a97_0x1a5815(0xb9)),jsforce_1=__importDefault(require(a97_0x1a5815(0xc7))),unauthorized_error_1=require('../../../core/errors/unauthorized.error'),errors_1=require('../../../constants/errors'),core_1=require(a97_0x1a5815(0xec)),salesforce_settings_service_1=require(a97_0x1a5815(0xed)),app_settings_service_1=require('../../shared/services/app-settings.service'),internal_server_error_1=require(a97_0x1a5815(0xc5)),logger=new core_1['Logger'](a97_0x1a5815(0xc9));let SalesforceService=class SalesforceService{constructor(_0x33fe89,_0x193387){const _0x40f895=a97_0x1a5815;this[_0x40f895(0xe4)]=_0x33fe89,this[_0x40f895(0xac)]=_0x193387,this[_0x40f895(0xeb)]=this[_0x40f895(0xac)]['env']===_0x40f895(0xba)?'/flosum_git':'';}get[a97_0x1a5815(0xca)](){const _0xdc7110=a97_0x1a5815;return this[_0xdc7110(0xe4)]['settings'];}async[a97_0x1a5815(0xb0)](){const _0x3b3a48=a97_0x1a5815;logger[_0x3b3a48(0xbc)](_0x3b3a48(0xe2));if(!this[_0x3b3a48(0xe4)][_0x3b3a48(0xf0)])throw new unauthorized_error_1[(_0x3b3a48(0xd2))](errors_1[_0x3b3a48(0xab)]);const {clientId:_0x25652e,clientSecret:_0x1a0f67,refreshToken:_0x5a9b3b}=this[_0x3b3a48(0xca)],_0x383f14={'clientId':_0x25652e,'clientSecret':_0x1a0f67,'loginUrl':this[_0x3b3a48(0xe4)]['loginUrl']};if(!this[_0x3b3a48(0xe4)][_0x3b3a48(0xda)]){logger['log'](_0x3b3a48(0xd3));const _0x5dc8eb=new jsforce_1[(_0x3b3a48(0xc6))][(_0x3b3a48(0xd5))](_0x383f14),{access_token:_0x3a4954,instance_url:_0x4b3fb5}=await _0x5dc8eb['oauth2'][_0x3b3a48(0xcf)](_0x5a9b3b);await this[_0x3b3a48(0xe4)][_0x3b3a48(0xd9)]({'accessToken':_0x3a4954,'instanceUrl':_0x4b3fb5});}const {accessToken:_0x3e8463,instanceUrl:_0x399440}=this[_0x3b3a48(0xca)];this['connection']=new jsforce_1[(_0x3b3a48(0xc6))][(_0x3b3a48(0xd5))]({'oauth2':_0x383f14,'refreshToken':_0x5a9b3b,'accessToken':_0x3e8463,'instanceUrl':_0x399440}),logger[_0x3b3a48(0xbc)](_0x3b3a48(0xcd));}async[a97_0x1a5815(0xad)](_0xc2218){const _0x161afe=a97_0x1a5815;logger[_0x161afe(0xbc)]('[LID:%s]\x20retrieve\x20components\x20from\x20salesforce',this[_0x161afe(0xca)]['loggerId']);try{const _0x1cb480=await this[_0x161afe(0xd8)][_0x161afe(0xc4)][_0x161afe(0xc0)](this[_0x161afe(0xeb)]+_0x161afe(0xbf),{'componentIds':_0xc2218,'loggerId':this[_0x161afe(0xca)][_0x161afe(0xe6)]});return _0x1cb480;}catch(_0x1dd171){throw new internal_server_error_1[(_0x161afe(0xd4))](_0x1dd171);}}async[a97_0x1a5815(0xb6)](_0x13575c){const _0xc6bc61=a97_0x1a5815;logger['log'](_0xc6bc61(0xc2),_0x13575c);try{await this[_0xc6bc61(0xd8)][_0xc6bc61(0xb1)]('Attachment')[_0xc6bc61(0xdd)](_0x13575c)[_0xc6bc61(0xdb)]();}catch(_0x5ec3f5){await this[_0xc6bc61(0xbc)](_0x5ec3f5[_0xc6bc61(0xdc)]);}}async[a97_0x1a5815(0xae)](_0x3eb4cc){const _0x3e56e9=a97_0x1a5815;try{logger[_0x3e56e9(0xbc)](_0x3e56e9(0xe0),_0x3eb4cc);const _0xc54493=await new Promise((_0x43b852,_0x3e9e70)=>{const _0x27f938=_0x3e56e9,_0xfec061=[],_0x2ab76f=this['connection'][_0x27f938(0xb1)]('Attachment')['record'](_0x3eb4cc)['blob']('Body');_0x2ab76f['on'](_0x27f938(0xb7),_0x3e9e70),_0x2ab76f['on']('data',_0x4106cc=>_0xfec061[_0x27f938(0xcc)](_0x4106cc)),_0x2ab76f['on'](_0x27f938(0xb2),()=>_0x43b852(_0xfec061[_0x27f938(0xb4)]('')));});return _0xc54493;}catch(_0x1f57ad){this['log'](_0x1f57ad[_0x3e56e9(0xdc)]);throw new internal_server_error_1[(_0x3e56e9(0xd4))](_0x1f57ad);}}async[a97_0x1a5815(0xbc)](_0x36b7ab){const _0x4f185a=a97_0x1a5815;try{logger[_0x4f185a(0xbc)](_0x4f185a(0xb3),this[_0x4f185a(0xca)][_0x4f185a(0xe6)]),await this[_0x4f185a(0xd8)][_0x4f185a(0xc4)][_0x4f185a(0xc0)](this['namespace']+_0x4f185a(0xe1),{'message':_0x36b7ab,'loggerId':this['settings'][_0x4f185a(0xe6)]});}catch(_0x92bc5a){throw new internal_server_error_1[(_0x4f185a(0xd4))](_0x92bc5a);}}};SalesforceService=__decorate([typedi_1['Service'](),__metadata(a97_0x1a5815(0xe3),[salesforce_settings_service_1[a97_0x1a5815(0xce)],app_settings_service_1[a97_0x1a5815(0xea)]])],SalesforceService),exports[a97_0x1a5815(0xd6)]=SalesforceService;