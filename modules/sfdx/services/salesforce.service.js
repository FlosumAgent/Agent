const a92_0xa855=['constructor','Service','retrieveAttachment','UnauthorizedError','defineProperty','oauth2','join','1WZduxL','data','/logger','retrieve\x20%d\x20components','hasAuthorizedCredentials','hasCredentials','/attachments','record','Logger','create\x20new\x20oauth\x20connection\x20from\x20given\x20credentials','../../../core','update','default','ERR_MISSING_SALEFORCE_CONFIGURATION','apply','1767387YxNJOu','object','settings','env','SalesforceSettingsService','../../../constants/errors','blob','function','appSettings','design:paramtypes','1109929llLUmb','deleteCommit','post','end','1Upgicx','refreshToken','loginUrl','__decorate','/flosum_git','salesforce-service','1790482HUnYNw','1489657KjQPwj','length','delete','__esModule','372625EdmQmB','Attachment','connection','SalesforceService','AppSettingsService','apex','Connection','jsforce','connect','__importDefault','push','../../shared/services/app-settings.service','namespace','salesforseSettings','../../shared/services/salesforce-settings.service','1388038xxgOan','1750090BbDqWY','decorate','production','sobject','salesforce\x20connection\x20established','error','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','retrieve\x20attachment\x20%s\x20from\x20salesforce','log'];const a92_0x32fe4d=a92_0x14ce;(function(_0x5e9f92,_0x3938e8){const _0x15095e=a92_0x14ce;while(!![]){try{const _0x577a33=-parseInt(_0x15095e(0xef))+-parseInt(_0x15095e(0xf3))*-parseInt(_0x15095e(0xe5))+parseInt(_0x15095e(0xb1))+parseInt(_0x15095e(0xc6))+-parseInt(_0x15095e(0xb2))+-parseInt(_0x15095e(0xb6))+-parseInt(_0x15095e(0xc5))*parseInt(_0x15095e(0xd6));if(_0x577a33===_0x3938e8)break;else _0x5e9f92['push'](_0x5e9f92['shift']());}catch(_0x3530fd){_0x5e9f92['push'](_0x5e9f92['shift']());}}}(a92_0xa855,0xe75fe));const a92_0x21bfaa=function(){let _0x18bb4b=!![];return function(_0x3e5681,_0x3c3bbe){const _0xe690f4=_0x18bb4b?function(){const _0x803891=a92_0x14ce;if(_0x3c3bbe){const _0x73a94d=_0x3c3bbe[_0x803891(0xe4)](_0x3e5681,arguments);return _0x3c3bbe=null,_0x73a94d;}}:function(){};return _0x18bb4b=![],_0xe690f4;};}(),a92_0x14a6f7=a92_0x21bfaa(this,function(){const _0x20b9bd=function(){const _0x18b1c5=a92_0x14ce,_0x4fe96b=_0x20b9bd[_0x18b1c5(0xcf)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x18b1c5(0xcf)](_0x18b1c5(0xcc));return!_0x4fe96b['test'](a92_0x14a6f7);};return _0x20b9bd();});a92_0x14a6f7();'use strict';var __decorate=this&&this[a92_0x32fe4d(0xf6)]||function(_0x34a83e,_0x3c2019,_0x40545b,_0x1773d8){const _0x129612=a92_0x32fe4d;var _0xd75f26=arguments[_0x129612(0xb3)],_0x153df3=_0xd75f26<0x3?_0x3c2019:_0x1773d8===null?_0x1773d8=Object['getOwnPropertyDescriptor'](_0x3c2019,_0x40545b):_0x1773d8,_0x3f014e;if(typeof Reflect===_0x129612(0xe6)&&typeof Reflect[_0x129612(0xc7)]==='function')_0x153df3=Reflect[_0x129612(0xc7)](_0x34a83e,_0x3c2019,_0x40545b,_0x1773d8);else{for(var _0x5c3bda=_0x34a83e[_0x129612(0xb3)]-0x1;_0x5c3bda>=0x0;_0x5c3bda--)if(_0x3f014e=_0x34a83e[_0x5c3bda])_0x153df3=(_0xd75f26<0x3?_0x3f014e(_0x153df3):_0xd75f26>0x3?_0x3f014e(_0x3c2019,_0x40545b,_0x153df3):_0x3f014e(_0x3c2019,_0x40545b))||_0x153df3;}return _0xd75f26>0x3&&_0x153df3&&Object[_0x129612(0xd3)](_0x3c2019,_0x40545b,_0x153df3),_0x153df3;},__metadata=this&&this['__metadata']||function(_0x585f45,_0x2e094){const _0x395efc=a92_0x32fe4d;if(typeof Reflect==='object'&&typeof Reflect['metadata']===_0x395efc(0xec))return Reflect['metadata'](_0x585f45,_0x2e094);},__importDefault=this&&this[a92_0x32fe4d(0xbf)]||function(_0x3116fb){const _0x1463dc=a92_0x32fe4d;return _0x3116fb&&_0x3116fb[_0x1463dc(0xb5)]?_0x3116fb:{'default':_0x3116fb};};Object[a92_0x32fe4d(0xd3)](exports,a92_0x32fe4d(0xb5),{'value':!![]}),exports[a92_0x32fe4d(0xb9)]=void 0x0;const typedi_1=require('typedi'),jsforce_1=__importDefault(require(a92_0x32fe4d(0xbd))),unauthorized_error_1=require('../../../core/errors/unauthorized.error'),errors_1=require(a92_0x32fe4d(0xea)),core_1=require(a92_0x32fe4d(0xe0)),salesforce_settings_service_1=require(a92_0x32fe4d(0xc4)),app_settings_service_1=require(a92_0x32fe4d(0xc1)),logger=new core_1[(a92_0x32fe4d(0xde))](a92_0x32fe4d(0xf8));function a92_0x14ce(_0x22c0fb,_0x5de978){return a92_0x14ce=function(_0x38da4e,_0x14a6f7){_0x38da4e=_0x38da4e-0xb1;let _0x21bfaa=a92_0xa855[_0x38da4e];return _0x21bfaa;},a92_0x14ce(_0x22c0fb,_0x5de978);}let SalesforceService=class SalesforceService{constructor(_0x53adec,_0x45167c){const _0x2d45a1=a92_0x32fe4d;this['salesforseSettings']=_0x53adec,this[_0x2d45a1(0xed)]=_0x45167c,this['namespace']=this['appSettings'][_0x2d45a1(0xe8)]===_0x2d45a1(0xc8)?_0x2d45a1(0xf7):'';}get['settings'](){const _0x50c8e0=a92_0x32fe4d;return this[_0x50c8e0(0xc3)][_0x50c8e0(0xe7)];}async[a92_0x32fe4d(0xbe)](){const _0x3510f6=a92_0x32fe4d;logger[_0x3510f6(0xce)]('trying\x20to\x20establish\x20connection\x20to\x20salesforce');if(!this[_0x3510f6(0xc3)][_0x3510f6(0xdb)])throw new unauthorized_error_1[(_0x3510f6(0xd2))](errors_1[_0x3510f6(0xe3)]);const {clientId:_0x2dbe51,clientSecret:_0x30e99f,refreshToken:_0x15cbb7}=this['settings'],_0x432184={'clientId':_0x2dbe51,'clientSecret':_0x30e99f,'loginUrl':this[_0x3510f6(0xc3)][_0x3510f6(0xf5)]};if(!this[_0x3510f6(0xc3)][_0x3510f6(0xda)]){logger[_0x3510f6(0xce)](_0x3510f6(0xdf));const _0x147bb0=new jsforce_1[(_0x3510f6(0xe2))][(_0x3510f6(0xbc))](_0x432184),{access_token:_0x1748c0,instance_url:_0x53eca1}=await _0x147bb0[_0x3510f6(0xd4)][_0x3510f6(0xf4)](_0x15cbb7);await this[_0x3510f6(0xc3)][_0x3510f6(0xe1)]({'accessToken':_0x1748c0,'instanceUrl':_0x53eca1});}const {accessToken:_0x3b92f3,instanceUrl:_0x47e475}=this[_0x3510f6(0xe7)];this[_0x3510f6(0xb8)]=new jsforce_1['default']['Connection']({'oauth2':_0x432184,'refreshToken':_0x15cbb7,'accessToken':_0x3b92f3,'instanceUrl':_0x47e475}),logger['log'](_0x3510f6(0xca));}async['retrieve'](_0x1683f1){const _0x8cd85d=a92_0x32fe4d;return logger[_0x8cd85d(0xce)](_0x8cd85d(0xd9),_0x1683f1[_0x8cd85d(0xb3)]),this['connection'][_0x8cd85d(0xbb)]['post'](this['namespace']+_0x8cd85d(0xdc),{'componentIds':_0x1683f1});}async[a92_0x32fe4d(0xf0)](_0x1dbd03){const _0x96d5ff=a92_0x32fe4d;logger[_0x96d5ff(0xce)]('remove\x20commit\x20%s',_0x1dbd03),await this[_0x96d5ff(0xb8)][_0x96d5ff(0xbb)][_0x96d5ff(0xb4)](this[_0x96d5ff(0xc2)]+'/attachments/'+_0x1dbd03);}async[a92_0x32fe4d(0xd1)](_0x526987){const _0x338889=a92_0x32fe4d;return logger['log'](_0x338889(0xcd),_0x526987),new Promise((_0x1152de,_0xb2c4f4)=>{const _0x2ee0a7=_0x338889,_0x2ee7de=[],_0x3a2951=this['connection'][_0x2ee0a7(0xc9)](_0x2ee0a7(0xb7))[_0x2ee0a7(0xdd)](_0x526987)[_0x2ee0a7(0xeb)]('Body');_0x3a2951['on'](_0x2ee0a7(0xcb),_0xb2c4f4),_0x3a2951['on'](_0x2ee0a7(0xd7),_0x42cccf=>_0x2ee7de[_0x2ee0a7(0xc0)](_0x42cccf)),_0x3a2951['on'](_0x2ee0a7(0xf2),()=>_0x1152de(_0x2ee7de[_0x2ee0a7(0xd5)]('')));});}async[a92_0x32fe4d(0xce)](_0x3a3b7c){const _0x50e704=a92_0x32fe4d;await this[_0x50e704(0xb8)][_0x50e704(0xbb)][_0x50e704(0xf1)](this['namespace']+_0x50e704(0xd8),{'message':_0x3a3b7c});}};SalesforceService=__decorate([typedi_1[a92_0x32fe4d(0xd0)](),__metadata(a92_0x32fe4d(0xee),[salesforce_settings_service_1[a92_0x32fe4d(0xe9)],app_settings_service_1[a92_0x32fe4d(0xba)]])],SalesforceService),exports[a92_0x32fe4d(0xb9)]=SalesforceService;