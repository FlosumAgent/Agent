const a22_0x8bbe=['__importDefault','controllerType','path','name','../utils','normalizePaths','708190YJTSZE','handlers','META_CONTROLLER_PATH','nestedPath','defineProperty','41663sxNTdp','prefix','injectNestedController','../constants','inject','getHandlerMeta','getPrototypeOf','get','126VfrJZk','injectHandlers','default','265163crYqyX','__esModule','middlewares','1661MQKaiX','map','948824SBRVwV','ControllerInjector','use','injectMiddlewares','Logger','\x20at\x20','injecting\x20','META_CONTROLLER_VERSION','root','router','Router','../classes/logger.class','constructor','1183357yIyOSO','META_CONTROLLER_PREFIX','controller-injector','686216oYGKjz','52zbnbqc','instance','META_CONTROLLER','getOwnMetadata','\x20is\x20not\x20a\x20Controller','return\x20/\x22\x20+\x20this\x20+\x20\x22/','getOwnPropertyNames','nested','method','test','injecting\x20nested\x20','handlerWrapper','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','express','log'];const a22_0x3dbfd0=a22_0x37ab;(function(_0x5560a8,_0x570a6e){const _0x5eda1b=a22_0x37ab;while(!![]){try{const _0x4d7c5e=parseInt(_0x5eda1b(0x8d))*-parseInt(_0x5eda1b(0x93))+parseInt(_0x5eda1b(0xa5))+parseInt(_0x5eda1b(0xbb))+parseInt(_0x5eda1b(0xa2))+parseInt(_0x5eda1b(0x95))+-parseInt(_0x5eda1b(0x90))+parseInt(_0x5eda1b(0xa6))*-parseInt(_0x5eda1b(0xc0));if(_0x4d7c5e===_0x570a6e)break;else _0x5560a8['push'](_0x5560a8['shift']());}catch(_0xa28f07){_0x5560a8['push'](_0x5560a8['shift']());}}}(a22_0x8bbe,0xd839e));const a22_0x377677=function(){let _0x1c4f6a=!![];return function(_0xcbe299,_0x2381bc){const _0x294089=_0x1c4f6a?function(){if(_0x2381bc){const _0x2b6d5a=_0x2381bc['apply'](_0xcbe299,arguments);return _0x2381bc=null,_0x2b6d5a;}}:function(){};return _0x1c4f6a=![],_0x294089;};}(),a22_0x59bbee=a22_0x377677(this,function(){const _0x165a2a=function(){const _0x1b623f=a22_0x37ab,_0x390576=_0x165a2a[_0x1b623f(0xa1)](_0x1b623f(0xab))()[_0x1b623f(0xa1)](_0x1b623f(0xb2));return!_0x390576[_0x1b623f(0xaf)](a22_0x59bbee);};return _0x165a2a();});function a22_0x37ab(_0xe0c930,_0x416e1d){return a22_0x37ab=function(_0x49c49a,_0x59bbee){_0x49c49a=_0x49c49a-0x8c;let _0x377677=a22_0x8bbe[_0x49c49a];return _0x377677;},a22_0x37ab(_0xe0c930,_0x416e1d);}a22_0x59bbee();'use strict';var __importDefault=this&&this[a22_0x3dbfd0(0xb5)]||function(_0x415d0a){const _0x28a004=a22_0x3dbfd0;return _0x415d0a&&_0x415d0a[_0x28a004(0x91)]?_0x415d0a:{'default':_0x415d0a};};Object[a22_0x3dbfd0(0xbf)](exports,a22_0x3dbfd0(0x91),{'value':!![]}),exports['ControllerInjector']=void 0x0;const express_1=require(a22_0x3dbfd0(0xb3)),typedi_1=__importDefault(require('typedi')),logger_class_1=require(a22_0x3dbfd0(0xa0)),constants_1=require(a22_0x3dbfd0(0xc3)),utils_1=require(a22_0x3dbfd0(0xb9)),handler_wrapper_1=require('../wrappers/handler.wrapper'),middleware_injector_1=require('./middleware.injector'),logger=new logger_class_1[(a22_0x3dbfd0(0x99))](a22_0x3dbfd0(0xa4));class ControllerInjector{constructor(_0x4dfdf2,_0x36e39f){const _0x55c6e4=a22_0x3dbfd0;this[_0x55c6e4(0xb6)]=_0x4dfdf2,this[_0x55c6e4(0x9d)]=_0x36e39f,this[_0x55c6e4(0x9e)]=express_1[_0x55c6e4(0x9f)]({'mergeParams':!![]}),this[_0x55c6e4(0xbe)]='';if(!Reflect[_0x55c6e4(0xa9)](constants_1[_0x55c6e4(0xa8)],_0x4dfdf2))throw TypeError(_0x4dfdf2[_0x55c6e4(0xb8)]+_0x55c6e4(0xaa));}get[a22_0x3dbfd0(0xbc)](){const _0x35990a=a22_0x3dbfd0,_0x5f28dd=Object[_0x35990a(0xc6)](this[_0x35990a(0xa7)]);return Object[_0x35990a(0xac)](_0x5f28dd)[_0x35990a(0x94)](_0x10c7db=>_0x5f28dd[_0x10c7db])['filter'](_0x520370=>!!Reflect['getOwnMetadata'](constants_1['META_HANDLER'],_0x520370));}get['middlewares'](){const _0x45d2bc=a22_0x3dbfd0;return Reflect[_0x45d2bc(0xa9)](constants_1['META_CONTROLLER_MIDDLEWARES'],this[_0x45d2bc(0xa7)])||[];}get[a22_0x3dbfd0(0xc1)](){const _0x63ce12=a22_0x3dbfd0;var _0xeef5c6;const _0x10d963=(_0xeef5c6=Reflect[_0x63ce12(0xa9)](constants_1[_0x63ce12(0xa3)],this[_0x63ce12(0xb6)]))!==null&&_0xeef5c6!==void 0x0?_0xeef5c6:constants_1['CONTROLLER_DEFAULT_PREFIX'],_0x25a6b5=Reflect['getOwnMetadata'](constants_1[_0x63ce12(0x9c)],this[_0x63ce12(0xb6)])||'';return this[_0x63ce12(0xbe)]?'':utils_1['normalizePaths'](_0x10d963,_0x25a6b5);}get[a22_0x3dbfd0(0xb7)](){const _0x5d146e=a22_0x3dbfd0;if(this['nestedPath'])return this[_0x5d146e(0xbe)];const _0x2219f8=Reflect[_0x5d146e(0xa9)](constants_1[_0x5d146e(0xbd)],this[_0x5d146e(0xb6)])||'';return utils_1[_0x5d146e(0xba)](_0x2219f8);}get[a22_0x3dbfd0(0xa7)](){const _0x1d66b1=a22_0x3dbfd0;return typedi_1[_0x1d66b1(0x8f)][_0x1d66b1(0x8c)](this['controllerType']);}async[a22_0x3dbfd0(0x98)](){const _0x4e9dd9=a22_0x3dbfd0;for(const _0x593484 of this[_0x4e9dd9(0x92)]){const _0x1f4f67=await middleware_injector_1['middlewareInjector'](_0x593484);this[_0x4e9dd9(0x9e)][_0x4e9dd9(0x97)](_0x1f4f67);}}async[a22_0x3dbfd0(0xc2)](_0x593143){const _0x5a62b1=a22_0x3dbfd0,_0x4d2351=_0x593143[_0x5a62b1(0xad)];logger[_0x5a62b1(0xb4)](_0x5a62b1(0xb0)+_0x4d2351[_0x5a62b1(0xb8)]+_0x5a62b1(0x9a)+this['path']+_0x593143[_0x5a62b1(0xb7)]);const _0x482fe8=new ControllerInjector(_0x4d2351,this);_0x482fe8[_0x5a62b1(0xbe)]=_0x593143[_0x5a62b1(0xb7)],await _0x482fe8[_0x5a62b1(0xc4)](this[_0x5a62b1(0x9e)]);}async[a22_0x3dbfd0(0x8e)](){const _0x27456a=a22_0x3dbfd0;var _0x3c579f;for(const _0x402ba5 of this['handlers']){const _0x142246=utils_1[_0x27456a(0xc5)](_0x402ba5);if(_0x142246['nested'])await this['injectNestedController'](_0x142246);else{const _0x1938a3=_0x142246[_0x27456a(0xae)]['toString']()['toLowerCase']();logger[_0x27456a(0xb4)](_0x27456a(0x9b)+this[_0x27456a(0xb6)]['name']+'#'+_0x402ba5['name']+'\x20at\x20['+_0x142246[_0x27456a(0xae)]+']\x20'+utils_1['normalizePaths'](((_0x3c579f=this[_0x27456a(0x9d)])===null||_0x3c579f===void 0x0?void 0x0:_0x3c579f['path'])||'',this[_0x27456a(0xb7)],_0x142246[_0x27456a(0xb7)])),this[_0x27456a(0x9e)][_0x1938a3](_0x142246[_0x27456a(0xb7)],handler_wrapper_1[_0x27456a(0xb1)](_0x402ba5,this['instance']));}}}async[a22_0x3dbfd0(0xc4)](_0x2bf84a){const _0x55adae=a22_0x3dbfd0;!this[_0x55adae(0xbe)]&&logger[_0x55adae(0xb4)](_0x55adae(0x9b)+this[_0x55adae(0xb6)][_0x55adae(0xb8)]+'\x20{'+this[_0x55adae(0xc1)]+'}'),await this['injectMiddlewares'](),await this['injectHandlers'](),_0x2bf84a[_0x55adae(0x97)](''+this['prefix']+this[_0x55adae(0xb7)],this['router']);}}exports[a22_0x3dbfd0(0x96)]=ControllerInjector;